----- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">

!#TXCD
!T(3,L1907)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,0)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,132)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,20)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)


#BTNADDBUF=X,18,S
T(2,1+        +000)

#BtnAddA=x,100,S
T(2,{cmd=CHAIN; ntxcd=L1107; ntxbuf=#BTNADDBUF; ntxbuf5=type})
ASGN(BTN_NEW1$)
K(MODIFYBUTTON,1,新增)

</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[150,850];printer.width=[20,20];">
[
["[L1907]                                 公司戶財務報表查詢"],
["#FdCustId+統一編號",#CustId,#BTN2,#CustName],
]

#FdCustId=X,2,L
T(3,*)

!---------- AP Button AREA ----------
![Buttom資料查詢]
! #BTN1=X,15,I,ui:button;value:新增;enable:0;tabbable:0;title:L1107 公司戶財務狀況管理
#BTN2=X,15,I,ui:button;value:顧客資料查詢;enable:1;tabbable:0
!#BTN3=X,15,I,ui:button;value:瀏覽;enable:0;tabbable:0
! #BUF1=X,42,S
! ENABLE(#BTN1)
!ENABLE(#BTN2)ENABLE(#BTN3)
#Submit=A,1,S
K(MODIFYBUTTON,查詢)
!---------- AP TEXT AREA Variables ----------
#CHAIN=A,1,S
T(4,CHAIN$)


#NTXBUF=X,12,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
T(1,@CustId,#NTXBUF,2,8)

#NTXBUF5=X,10,S
C(3,#CHAIN,1,T(4,NTXBUF5$),S)

#BUFA=X,1,S

#BINDA=X,1,S
BIND(#BTN2,click, {cmd=CHAIN; ntxcd=L1001; ntxbuf=#BUFA;ntxbuf5=type<-1:CustId<-OOCustId})

!統一編號
#CustId=X,8,I
C(3,#CHAIN,1,s,$)
@
V(7)
A(ID_UNINO,0,#CustId)


!RIM參數使用
#RimCustId=X,10,S
#RimCustNo=A,7,S
#RimFunCd=A,1,S
E(0,5)
<include src="ROM.icf::L1R01.dec"/>

#RimL1r01=X,1,S
T(2,@RimCustId,#CustId)
C(4,#CustId,S,$)
RESET_RIM(#RimL1r01,L1R01)
S(L1R01,1,#RimCustId,#RimCustNo,#RimFunCd)
R(1,L1R01)
T(2,@CustName,#L1r01CustName)

!戶名
#CustName=X,100,L

#RETURN=A,1,S
E(0,0)

![折返KEY]
#RTNTXT=X,9,S

#FunCd1=A,1,S
T(3,1)
#FunCd2=A,1,S
T(3,2)
#FunCd3=A,1,S
T(3,3)
#FunCd4=A,1,S
T(3,4)
#FunCd5=A,1,S
T(3,5)


#FunCd=A,1,S
E(0,2)

! #BUF1=X,9,S
! C(4,#CustId,HIDE(#BTN1),SHOW(#BTN1))
! T(2,1+#CustId)

! #BIND1=X,1,S
! BIND(#BTN1,click, {cmd=CHAIN; ntxcd=L1107; ntxbuf=#BUF1})


!<include src="COM.icf::RPTFG.dec"/>

#RPTFG=A,1,S
E(0,0)

#TXMT=A,1,S
C(3,#CHAIN,0,$,E(0,@CHAIN,0)XMT())

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>


!---------- TXFORM = L1907 ----------
<sub type="FORM" name="L1907">

!#SCRPRT=_,_,S
!C(5,#TXFORM,L1907,$,S)

#SCRTIL=_,_,S
T(3,[L1907] 公司戶財務報表查詢)

!------ TOM(HEAD)   Variables (FOR OUTPUT SCREEN) ------
!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------

#LOOP=X,1,S
T(3,1)ASGN(LOOP$)
#OCustUKey=x,32,S
#OUKey=x,32,S
#OCustId=X,8,S
#OYear=A,3,S
#OMonth=x,7,S
#OLastUpdate=x,20,S
#OLastEmp=x,30,S

!修改
#OOBUF1=X,65,S
T(2,#FunCd2+#OCustUKey+#OUKey)
#OOBTN1=X,1,S
BIND(grid,{ cmd=CHAIN; ntxcd=L1107; ntxbuf=#OOBUF1})

!刪除
#OOBUF3=X,73,S
T(2,#FunCd4+#OCustUKey+#OUKey)
#OOBTN3=X,1,S
BIND(grid,{ cmd=CHAIN; ntxcd=L1107; ntxbuf=#OOBUF3})

!查詢
#OOBUF4=X,73,S
T(2,#FunCd5+#OCustUKey+#OUKey)
#OOBTN4=X,1,S
BIND(grid,{ cmd=CHAIN; ntxcd=L1107; ntxbuf=#OOBUF4})
</sub>


!------ 上行電文 ------
<sub type="TIM">
#CustId
</sub>


!------ 下行電文TOM ------
<sub type="TOM">

TXFORM=L1907
#OCustUKey
#OUKey
#OCustId
#OYear
#OMonth
#OLastUpdate
#OLastEmp

^
<include src="COM.icf::TRCTL.tom"/>
<include src="ROM.icf::L1R01.tom"/>
</sub>

!--------- OUTPUT畫面 --------
<sub type="PART" name="L1907" layout="cols=1;screen.width=[150,850];printer.width=[20,20];">
[
["[L1907]                                 公司戶財務報表查詢                                                                   "],
[""],
["@統一編號",#CustId,#CustName],
]
</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">
#RPTFG=0,QUERY.GRID,L1907
#any={detail:true, header:'L1907.part', caption:'', width:1000, rowNum:20, rowList:[20,40,60]}

#OOBTN1=修改
{width:50,search:false,formatter:'cust:bind-button:修改',align:'center',canExport:false}
!#OOBTN2=複製
!{width:50,search:false,formatter:'cust:bind-button:複製',align:'center',canExport:false}
#OOBTN3=刪除
{width:50,search:false,formatter:'cust:bind-button:刪除',align:'center',canExport:false}
#OOBTN4=查詢
{width:50,search:false,formatter:'cust:bind-button:查詢',align:'center',canExport:false}
!#OCustId=統一編號
!{width:80,align:'center'}

#OYear=年度
{width:80,align:'center'}

#OMonth=月份
{width:120,align:'center'}

#OLastEmp=最後異動人員
{width:120,align:'left'}

#OLastUpdate=最後異動日期
{width:150,align:'center'}

</sub>
