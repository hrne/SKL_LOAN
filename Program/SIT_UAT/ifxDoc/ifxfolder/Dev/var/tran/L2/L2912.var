----- BASIC LABEL Variables ----------
<sub type="SYS">
#Submit=A,1,S
K(MODIFYBUTTON,查詢)
</sub>

<sub type="SYS" name="label">

!#TXCD
!T(3,L2912)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,535)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,0)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,20)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
! 權限檢查
<include src="COM.icf::BFHEAD2.dec"/>
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[130,1100];printer.width=[20,20];">
[
["[L2912]                                 動產擔保品資料查詢"],
["#FdClCode1+擔保品代號1",#ClCode1,#ClCode1X],
["#FdClCode2+擔保品代號2",#ClCode2,#ClCode2X],
["#FdClNo+擔保品編號",#ClNo],
]

#FdClCode1=X,2,L
#FdClCode2=X,2,L
#FdClNo=X,2,L

#FdOCustId=X,2,L
#FdOClCode1=X,2,L
#FdOClTypeCode=X,2,L
#FdOOwnerId=X,2,L
#FdOOwnerRelCode=X,2,L
#FdOEvaDate=X,2,L
#FdOServiceLife=X,2,L
#FdOProductType=X,2,L
#FdOProductCC=X,2,L
#FdOEngineSN=X,2,L
#FdOCityCode=X,2,L
#FdOOwnerName=X,2,L
#FdOEvaAmt=X,2,L
#FdOProductSpec=X,2,L
#FdOProductBrand=X,2,L
#FdOProductColor=X,2,L

#FdOLicenseNo=X,2,L
#FdOLicenseUsageCode=X,2,L
#FdOMfgYearMonth=X,2,L
#FdOVehicleStyleCode=X,2,L
#FdOCurrency=X,2,L
#FdOInsurance=X,2,L
#FdOSalvageValue=X,2,L
#FdOLicenseTypeCode=X,2,L
#FdOLiceneIssueDate=X,2,L
#FdOVehicleTypeCode=X,2,L
#FdOVehicleOfficeCode=X,2,L
#FdOExchangeRate=X,2,L
#FdOLoanToValue=X,2,L

#FdOMtgCode=X,2,L
#FdKind=X,2,L
#FdOMtgCheck=X,2,L
#FdOMtgLoan=X,2,L
#FdOMtgPledge=X,2,L
#FdOSynd=X,2,L
#FdODispPrice=X,2,L
#FdOSettingStatX=X,2,L
#FdOSettingAmt=X,2,L
#FdOMtgNo=X,2,L
#FdOMortgageIssueStartDate=X,2,L
#FdOClStatus=X,2,L
#FdORemark=X,2,L
#FdOSyndCode=X,2,L
#FdODispDate=X,2,L
#FdOClStatX=X,2,L
#FdOReceiptNo=X,2,L
#FdOReceivedDate=X,2,L
#FdOMortgageIssueEndDate=X,2,L

!---------- AP Button AREA ----------
![Buttom資料查詢]
#BUF1=X,42,S
!---------- AP TEXT AREA Variables ----------
<include src="HELPRIM.icf::HELPRIM.rtn"/>
!ClCode2
#CDDEF01=x,20,S
T(3,CdCode.ClCode29)

#ClCode2Help=x,1024,S

!ClTypeCode
#CDDEF02=x,20,S
T(3,CdCode.ClTypeCode)

#ClTypeCodeHelp=x,1024,S


!VehicleType 車別
#CDDEF03=x,30,S
T(3,CdCode.VehicleTypeCode)

#VehicleTypeHelp=x,1024,S

!VehicleStyle 車身樣式
#CDDEF04=x,30,S
T(3,CdCode.VehicleStyleCode)

#VehicleStyleHelp=x,1024,S

!VehicleOffice 監理處所
#CDDEF05=x,30,S
T(3,CdCode.VehicleOfficeCode)

#VehicleOfficeHelp=x,1024,S

!Currency 幣別中文名稱
#CDDEF06=x,30,S
T(3,CdCode.Currency)

#CurrencyHelp=x,1024,S

!SyndCode 聯貸案類型
#CDDEF07=x,30,S
T(3,CdCode.SyndCode)

#SyndCodeHelp=x,1024,S

!ClStat擔保品狀態
#CDDEF08=x,30,S
T(3,CdCode.ClStatus)

#ClStatusHelp=x,1024,S

!MtgCode 抵押權註記
#CDDEF09=x,30,S
T(3,CdCode.MtgCode)

#MtgCodeHelp=x,1024,S

!LicenseUsage 牌照用途
#CDDEF10=x,30,S
T(3,CdCode.LicenseUsage)

#LicenseUsageHelp=x,1024,S

!ClStat擔保品狀態
#CDDEF11=x,30,S
T(3,CdCode.ClStatCode)

#ClStatHelp=x,1024,S

!SettingStat 設定狀態
#CDDEF12=x,30,S
T(3,CdCode.SettingStatCode)

#SettingStatHelp=x,1024,S


#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#CDDEF01,#CDDEF02,#CDDEF03,#CDDEF04,#CDDEF05,#CDDEF06,#CDDEF07,#CDDEF08,#CDDEF09,#CDDEF10)
R(1,XXR99)
CALL(#HelpProc)
T(2,@ClCode2Help,#HelpDesc1) 
T(2,@ClTypeCodeHelp,#HelpDesc2)
T(2,@VehicleTypeHelp,#HelpDesc3)
T(2,@VehicleStyleHelp,#HelpDesc4)
T(2,@VehicleOfficeHelp,#HelpDesc5)
T(2,@CurrencyHelp,#HelpDesc6)
T(2,@SyndCodeHelp,#HelpDesc7) 
T(2,@ClStatusHelp,#HelpDesc8)
T(2,@MtgCodeHelp,#HelpDesc9)
T(2,@LicenseUsageHelp,#HelpDesc10)

#RelationCodeHelp=x,3000,S

#CDDEF13=x,20,S
T(3,CdGuarantor)

#HelpRim2=X,1,S
RESET_RIM(#HelpRim2,XXR99)
S(XXR99,01,#CDDEF11,#CDDEF12,#CDDEF13)
R(1,XXR99)
CALL(#HelpProc)
T(2,@ClStatHelp,#HelpDesc1)
T(2,@SettingStatHelp,#HelpDesc2)
T(2,@RelationCodeHelp,#HelpDesc3)


#YNHelp=x,20,S
T(3,Y:是;N:否)

#CHAIN=A,1,S
T(4,CHAIN$)
IF(#CHAIN!=1,V(P,此為連動交易，請從交易:[L2038擔保品明細資料查詢]進入),$)

#NTXBUF=X,17,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
T(1,@ClCode1,#NTXBUF,1,1)
T(1,@ClCode2,#NTXBUF,2,2)
T(1,@ClNo,#NTXBUF,4,7)
T(1,@ApplNo,#NTXBUF,11,7)

!代號1
#ClCode1=A,1,L
E(0,9)

#ClCode1X=X,8,L
T(3,動產)

!代號2
#ClCode2=A,2,L
C(3,#CHAIN,1,s,$)
HELP(#ClCode2Help)
@V(H,#ClCode2Help)

#COLIND=A,3,S
T(2,#ClCode1+#ClCode2)

#ClCode2X=X,14,L
T(H,#COLIND,#ClCode2Help)

!擔保品編號
#ClNo=A,7,L
C(3,#CHAIN,1,s,$)
@V(2,0)

#ApplNo=A,7,L

#RimClCode1=A,1,S
#RimClCode2=A,2,S
#RimClNo=A,7,S

<include src="ROM.icf::L2R17.dec"/>
!RIM取原擔保品編號
#RimL2r17=X,1,S
E(0,@RimClCode1,#ClCode1)
E(0,@RimClCode2,#ClCode2)
E(0,@RimClNo,#ClNo)
RESET_RIM(#RimL2r17,L2R17)
S(L2R17,1,#RimClCode1,#RimClCode2,#RimClNo)
R(1,L2R17)
E(0,@OGdRid1,#L2r17GdrId1)
E(0,@OGdRid2,#L2r17GdrId2)
E(0,@OGdRnum,#L2r17GdrNum)

#FunCd=X,1,S

#ApproveNo=A,7,L

<include src="ROM.icf::L2R52.dec"/>
#RimL2R52=X,1,S
C(3,#ApplNo,0,S,$)
RESET_RIM(#RimL2R52,L2R52)
E(0,@ApproveNo,#ApplNo)
E(0,@FunCd,5)
S(L2R52,1,#FunCd,#ClCode1,#ClCode2,#ClNo,#ApproveNo)
R(1,L2R52)
T(2,@OOwnerRelCode,#L2r52OwnerRelCode1)


!與授信戶關係
#OOwnerRelCode=X,2,L

#OOwnerRelCodeX=X,40,L
C(4,#OOwnerRelCode,S,$)
T(H,#OOwnerRelCode,#RelationCodeHelp)

#RPTFG=A,1,S

#QuickXMT=A,1,S
C(3,#CHAIN,1,$,s)
XMT()

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>


!---------- TXFORM = L2912 ----------
<sub type="FORM" name="L2912">

!#SCRPRT=_,_,S
!C(5,#TXFORM,L2912,$,S)

#SCRTIL=_,_,S
T(3,[L2912] 動產擔保品資料)

!------ TOM(HEAD)   Variables (FOR OUTPUT SCREEN) ------
!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------

!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------

!統一編號
#OCustId=x,10,L
#OCustName=x,100,L

!擔保品編號
#OClCode1=A,1,L
T(2,#ClCode1)
#OClCode2=A,2,L
T(2,#ClCode2)
#OClNo=A,7,L
T(2,#ClNo)

![原擔保品編號]
#FdOGdRid=X,2,L

#OGdRid1=A,1,L
#OGdRid2=A,2,L
#OGdRnum=A,7,L

#OGdALL=X,12,L
C(3,#OGdRid1,0,S,$)
T(2,#OGdRid1+-+#OGdRid2+-+#OGdRnum)

!地區別
#OCityCode=X,2,L

#OCityCodeX=X,20,L

!擔保品類別
#OClTypeCode=X,3,L

#OClTypeCodeX=X,20,L
T(H,#OClTypeCode,#ClTypeCodeHelp)

!所有權人統編
#OOwnerId=X,10,L
!所有權人姓名
#OOwnerName=X,18,L
!鑑估日期
#OEvaDate=D,7,L
!鑑價總值
#OEvaAmt=m,14,L
!耐用年限
#OServiceLife=A,2,L
!型式/規格
#OProductSpec=X,20,L
!產品代碼/型號
#OProductType=X,10,L
!品牌/廠牌/船名
#OProductBrand=X,20,L
!排氣量
#OProductCC=X,10,L
!顏色
#OProductColor=X,10,L
!引擎號碼
#OEngineSN=X,50,L
!牌照號碼
#OLicenseNo=X,10,L
!牌照類別
#OLicenseTypeCode=A,1,L

#OLicenseTypeCodeX=X,20,L
!牌照用途
#OLicenseUsageCode=A,1,L

#LicenseUsageCodeX=X,20,L
T(3,)T(H,#OLicenseUsageCode,#LicenseUsageHelp)

!發照日期
#OLiceneIssueDate=D,7,L
!製造年月  
#OMfgYearMonth=X,5,L
!車別
#OVehicleTypeCode=A,2,L

#OVehicleTypeCodeX=X,20,L
C(4,#OVehicleTypeCode,S,$)T(H,#OVehicleTypeCode,#VehicleTypeHelp)

!車身樣式
#OVehicleStyleCode=A,2,L

#OVehicleStyleCodeX=X,20,L
C(4,#OVehicleStyleCode,S,$)T(H,#OVehicleStyleCode,#VehicleStyleHelp)
!監理(處) 所
#OVehicleOfficeCode=A,3,L

#OVehicleOfficeCodeX=X,30,L
C(4,#OVehicleOfficeCode,S,$)T(H,#OVehicleOfficeCode,#VehicleOfficeHelp)

!幣別
#OCurrency=X,3,L

#OCurrencyX=X,10,L
C(4,#OCurrency,S,$)
T(H,#OCurrency,#CurrencyHelp)

!匯率
#OExchangeRate=n,3.5,L
!投保註記
#OInsurance=X,3,L


#OInsuranceX=X,3,L
T(3,)T(H,#OInsurance,#YNHelp)
!貸放成數
#OLoanToValue=n,3.2,L
!殘值
#OSalvageValue=m,14,L
!抵押權註記
#OMtgCode=X,1,L
#OMtgCodeX=X,25,L
T(3,)T(H,#OMtgCode,#MtgCodeHelp)
!最高限額抵押權之擔保債權種類
#OMtgCheck=X,1,L
#OMtgLoan=X,1,L
#OMtgPledge=X,1,L

#OMtgAllfg=X,1,L
IF(#OMtgCheck == "Y" && #OMtgLoan == "Y" && #OMtgPledge == "Y",T(3,@OMtgAllfg,V),T(3,@OMtgAllfg, ))

#OMtgCheckfg=X,1,L
IF(#OMtgCheck == "Y",T(3,@OMtgCheckfg,V),T(3,@OMtgCheckfg,))

#OMtgLoanfg=X,1,L
IF(#OMtgLoan == "Y",T(3,@OMtgLoanfg,V),T(3,@OMtgLoanfg,))

#OMtgPledgefg=X,1,L
IF(#OMtgPledge == "Y",T(3,@OMtgPledgefg,V),T(3,@OMtgPledgefg,))

!聯貸案
#OSynd=X,1,L

#OSyndX=X,20,L
T(3,)T(H,#OSynd,#YNHelp)
!聯貸案類型
#OSyndCode=A,1,L

#OSyndCodeX=X,20,L
C(4,#OSyndCode,S,$)T(H,#OSyndCode,#SyndCodeHelp)
!處分價格
#ODispPrice=m,14,L
!處分日期
#ODispDate=D,7,L

! [設定狀態]
#OSettingStat=A,1,I

#OSettingStatX=X,10,L
C(4,#OSettingStat,S,$)
T(H,#OSettingStat,#SettingStatHelp)

! [擔保品狀態]
#OClStat=A,1,L

#OClStatX=X,10,L
T(3,)T(H,#OClStat,#ClStatHelp)

!抵押設定金額
#OSettingAmt=m,14,L
!收件字號
#OReceiptNo=X,20,L
!抵押登記字號
#OMtgNo=X,20,L
!抵押收件日
#OReceivedDate=D,7,L
!抵押登記起日
#OMortgageIssueStartDate=D,7,L
!抵押登記迄日
#OMortgageIssueEndDate=D,7,L
!擔保品狀況碼
#OClStatus=A,1,L

#OClStatusX=X,20,L
T(3,)T(H,#OClStatus,#ClStatusHelp)

!備註
#ORemark=X,60,L


</sub>


!------ 上行電文 ------
<sub type="TIM">
#ClCode1
#ClCode2
#ClNo
#END
</sub>


!------ 下行電文TOM ------
<sub type="TOM">
TXFORM=L2912
#OCustId
#OCustName
#OCityCode
#OCityCodeX
#OClTypeCode
#OOwnerId
#OOwnerName
#OEvaDate
#OEvaAmt
#OServiceLife
#OProductSpec
#OProductType
#OProductBrand
#OProductCC
#OProductColor
#OEngineSN
#OLicenseNo
#OLicenseTypeCode
#OLicenseUsageCode
#OLiceneIssueDate
#OMfgYearMonth
#OVehicleTypeCode
#OVehicleStyleCode
#OVehicleOfficeCode
#OCurrency
#OExchangeRate
#OInsurance
#OLoanToValue
#OSalvageValue
#OMtgCode
#OMtgCheck
#OMtgLoan
#OMtgPledge
#OSynd
#OSyndCode
#ODispPrice
#ODispDate
#OSettingStat
#OClStat
#OSettingAmt
#OReceiptNo
#OMtgNo
#OReceivedDate
#OMortgageIssueStartDate
#OMortgageIssueEndDate
#OClStatus
#ORemark
^
<include src="COM.icf::TRCTL.tom"/>
<include src="ROM.icf::L2R17.tom"/>
<include src="ROM.icf::L2R52.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
</sub>
<sub type="PART" name="L2912" layout="cols=3;screen.width=[150,260,300,350];printer.width=[15,30,15,30];order=1">
[
["[L2912]                                 動產擔保品資料查詢"],
["#FdOClCode1+擔保品編號",#OClCode1,"-",#OClCode2,"-",#OClNo],["#FdOGdRid+原擔保品編號",#OGdALL],
["#FdOClTypeCode+擔保品類別",#OClTypeCode,#OClTypeCodeX],["#FdOCityCode+地區別",#OCityCode,#OCityCodeX],
["#FdOOwnerId+所有權人統編",#OOwnerId],["#FdOOwnerName+所有權人姓名",#OOwnerName],
[#<->#,"#FdOOwnerRelCode+與授信戶關係",#OOwnerRelCode,#OOwnerRelCodeX],
["#FdOEvaDate+鑑估日期",#OEvaDate],["#FdOEvaAmt+鑑價總值",#OEvaAmt],
["#FdOServiceLife+耐用年限",#OServiceLife],["#FdOProductSpec+型式+/+規格",#OProductSpec],
["#FdOProductType+產品代碼/型號",#OProductType],["#FdOProductBrand+品牌+/+廠牌+/+船名",#OProductBrand],
["#FdOProductCC+排氣量",#OProductCC],["#FdOProductColor+顏色",#OProductColor],
[#<->#,"#FdOEngineSN+引擎號碼",#OEngineSN],
[#<->#,"@@@@@<font color=red>@牌照"],
["#FdOLicenseNo+牌照號碼",#OLicenseNo],["#FdOLicenseTypeCode+牌照類別",#OLicenseTypeCode,#OLicenseTypeCodeX],
["#FdOLicenseUsageCode+牌照用途",#OLicenseUsageCode,#LicenseUsageCodeX],["#FdOLiceneIssueDate+發照日期",#OLiceneIssueDate],
["#FdOMfgYearMonth+製造年月",#OMfgYearMonth],["#FdOVehicleTypeCode+車別",#OVehicleTypeCode,#OVehicleTypeCodeX],
["#FdOVehicleStyleCode+車身樣式",#OVehicleStyleCode,#OVehicleStyleCodeX],["#FdOVehicleOfficeCode+監理+(+處+)+ 所",#OVehicleOfficeCode,#OVehicleOfficeCodeX],
["#FdOCurrency+幣別",#OCurrency,#OCurrencyX],["#FdOExchangeRate+匯率",#OExchangeRate],
[#<->#,"@@@@@<font color=red>@抵押"],
["#FdOInsurance+投保註記",#OInsurance,#OInsuranceX],["#FdOLoanToValue+貸放成數",#OLoanToValue,"%"],
["#FdOMtgCode+抵押權註記",#OMtgCode,#OMtgCodeX],["#FdKind+最高限額抵押權之擔保債權種類",#OMtgAllfg,"全選",#OMtgCheckfg,"票據",#OMtgLoanfg,"借款",#OMtgPledgefg,"保證債務"],
[#<->#,"#FdOSalvageValue+殘值",#OSalvageValue],
[#<->#,"@@@@@<font color=red>@處分"],
["#FdODispPrice+處分價格",#ODispPrice],["#FdODispDate+處分日期",#ODispDate],
["#FdOSettingStatX+設定狀態",#OSettingStatX],["#FdOClStatX+擔保品狀態",#OClStatX],
["#FdOSettingAmt+抵押設定金額",#OSettingAmt],["#FdOReceiptNo+收件字號",#OReceiptNo],
["#FdOMtgNo+抵押登記字號",#OMtgNo],["#FdOReceivedDate+抵押收件日",#OReceivedDate],
["#FdOMortgageIssueStartDate+抵押登記起日",#OMortgageIssueStartDate],["#FdOMortgageIssueEndDate+抵押登記迄日",#OMortgageIssueEndDate],
[#<->#,"#FdOClStatus+擔保品狀況碼",#OClStatus,#OClStatusX],
[#<->#,"#FdORemark+備註",#ORemark],
]
</sub>
!---------- 單據輸出組合 ----------
<sub type="SELECT">

#RPTFG=0,QUERY.GRID,L2912
#any={detail:false, header:'L2912.part', caption:'', width:1000, rowNum:20, rowList:[20,40,60]}

^
<include src="PRT.icf::INQ01.sel" map="i=L2912;cpi=15"/>


<include src="PRT.icf::INQ01.sel"/>
</sub>
