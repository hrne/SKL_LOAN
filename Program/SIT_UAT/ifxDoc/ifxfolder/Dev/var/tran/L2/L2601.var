----- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">

!#TXCD
!T(3,L2601)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,200)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,75)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,20)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)

</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[130,1100];printer.width=[20,120];">
[
["[L2601]                                 法拍費用新增"],
["#FdCustNo+借戶戶號",#CustNo,#CustNoX],
["#FdFacmNo+額度編號",#FacmNo],
["#FdReceiveDate+收件日",#ReceiveDate],
["#FdDocDate+單據日期",#DocDate],
["#FdTwFee+法拍費用",#TwFee,#UsFee],
["#FdFeeCode+科目",#FeeCode,#FeeCodeX],
["#FdLegalStaff+法務人員",#LegalStaff,#BTN1,#LegalStaffName],
["#FdCloseNo+銷帳編號",#CloseNo],
["#FdRmk+備註",#Rmk],
]
!---------- AP Button AREA ----------
![Buttom資料查詢]
#BTN1=X,15,I,ui:button;value:員工資料查詢;enable:1;tabbable:0

#Submit=A,1,S
K(MODIFYBUTTON,新增)
!---------- AP TEXT AREA Variables ----------
<include src="HELPRIM.icf::HELPRIM.rtn"/>

#FdCustNo=X,2,L
T(3,*)
#FdFacmNo=X,2,L
T(3,*)
#FdReceiveDate=X,2,L
T(3,*)
#FdDocDate=X,2,L
T(3,*)
#FdTwFee=X,2,L
T(3,*)
#FdFeeCode=X,2,L
T(3,*)
#FdLegalStaff=X,2,L
T(3,*)
#FdCloseNo=X,2,L
#FdRmk=X,2,L

#SetSysPar=X,1,S
E(0,1)ASGN(AGAIN$)

!FeeCode
#CDDEF0001=x,20,S
T(3,CdCode.FeeCode)
#FeeCodeHelp=x,1024,S

#CDDEF0002=x,26,S
T(3,CdCode.CurrPrecision)
#CurrPrecisionHelp=x,1024,S


#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#CDDEF0001,#CDDEF0002)
R(1,XXR99)
CALL(#HelpProc)
T(2,@FeeCodeHelp,#HelpDesc1)
T(2,@CurrPrecisionHelp,#HelpDesc2)


![幣別]
#CurrencyCode=X,3,S
T(3,TWD)

#Precision=N,1,S
T(H,#CurrencyCode,#CurrPrecisionHelp)

#CHAIN=A,1,S
T(4,CHAIN$)
IF(#CHAIN!=1,V(P,此為連動交易，請從交易:L2078進入),$)
T(2,@RimTxCode,#TXCD)
E(0,@RimFKey,#FKEY)

#init=X,1,S
HIDE(#UsFee)

#NTXBUF=X,179,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
C(4,#NTXBUF,E(0,@CHAIN,0),$)
T(1,@CustNo,#NTXBUF,1,7)
T(1,@FacmNo,#NTXBUF,8,3)
! T(1,@ReceiveDate,#NTXBUF,11,7)
! T(1,@DocDate,#NTXBUF,18,7)
! T(1,@TwFee,#NTXBUF,25,14)
! T(1,@UsFee,#NTXBUF,25,14)
! T(1,@FeeCode,#NTXBUF,41,2)
! T(1,@LegalStaff,#NTXBUF,43,6)
T(1,@RimRecordNo,#NTXBUF,49,7)
! T(1,@Rmk,#NTXBUF,56,60)

!調RIM參數
#RimRecordNo=A,7,S

<include src="ROM.icf::L2R34.dec"/>

!調RIM取法拍費用檔
#FEEL2R34=X,1,S
C(3,#CHAIN,1,$,S)
RESET_RIM(#FEEL2R34,L2R34)
S(L2R34,1,#RimRecordNo)
R(1,L2R34)

#checkL2R34=X,1,S
C(3,#CHAIN,1,$,S)
E(0,@ReceiveDate,#L2r34ReceiveDate)
E(0,@DocDate,#L2r34DocDate)
E(0,@TwFee,#L2r34Fee)
E(0,@UsFee,#L2r34Fee)
E(0,@FeeCode,#L2r34FeeCode)
T(2,@LegalStaff,#L2r34LegalStaff)
T(2,@Rmk,#L2r34Rmk)

!借戶戶號 必須輸入
#CustNo=A,7,I
@V(2,0)

#RimL1r09=X,1,S
E(0,@RimFunCd,1)
T(2,@RimCustId,)
E(0,@RimCustNo,#CustNo)
RESET_RIM(#RimL1r09,L1R09)
S(L1R09,1,#RimFunCd,#RimCustId,#RimCustNo)
R(1,L1R09)

#CheckL1R09=X,1,S
T(2,@CustNoX,#L1r09CustName)


#CustNoX=X,100,L


![額度編號]
#FacmNo=A,3,I
@V(2,0)

!用CustNo,FacmNo調L2R05
#SendL2r05B=X,1,S
IF(#FKEY==0 || #FKEY==7,$,s)
E(0,@RimFuncCode,5)
E(0,@RimCustNo,#CustNo)
E(0,@RimFacmNo,#FacmNo)
E(0,@RimApplNo,0)
E(0,@RimCaseNo,0)
RESET_RIM(#SendL2r05B,L2R05)
S(L2R05,1,#RimFuncCode,#RimTxCode,#RimFKey,#RimCustNo,#RimFacmNo,#RimApplNo,#RimCaseNo)
R(1,L2R05)


#POSINTDT=D,8,S
!T(4,CDATE$)
!!取日曆日7碼
T(4,CDATE$)
!取會計日7碼
#PosIntDt7=D,7,S
T(1,#POSINTDT,2,7)

#AcDate=D,8,S
T(4,DATE$)

!收件日 必須輸入 預設日期 系統帳務日期
#ReceiveDate=D,7,I
C(3,#CHAIN,1,$,T(1,#POSINTDT,2,7))
@V(2,0)V(7)
A(DATE,0,#ReceiveDate)
IF(#ReceiveDate>#PosIntDt7,V(P,不得超過日曆日),$)

!單據日期 必須輸入
#DocDate=D,7,I
@V(2,0)V(7)
A(DATE,0,#DocDate)

!法拍費用 必須輸入
#TwFee=m,14,I
C(3,#Precision,0,$,s)
@V(2,0)

#UsFee=m,14.2,I
C(3,#Precision,0,s,$)
@V(2,0)

#TimFee=m,14.2,S
C(3,#Precision,0,E(0,#TwFee),E(0,#UsFee))

!科目 必須輸入
#FeeCode=A,2,I
HELP(#FeeCodeHelp,cols:2)
@V(H,#FeeCodeHelp)

#FeeCodeX=X,20,L
T(H,#FeeCode,#FeeCodeHelp) 


#BUF1=X,42,S
T(2,      Y)

#BIND1=X,1,S
BIND(#BTN1,click, {cmd=CHAIN; ntxcd=L190A; ntxbuf=#BUF1;ntxbuf5=type<-1:LegalStaff<-OOEmployeeNo})

!法務人員 必須輸入
#LegalStaff=X,6,I
!C(3,#CHAIN,1,T(1,#NTXBUF,1,7),$)
@V(7)




! 修改、刪除時，調RIM查員工檔資料

#RimL6r17=X,1,S
E(0,@RimFuncCode,5)
T(2,@RimTxCode,L2601)
T(2,@RimEmployeeNo,#LegalStaff)
RESET_RIM(#RimL6r17,L6R17)
S(L6R17,1,#RimFuncCode,#RimTxCode,#RimEmployeeNo)
R(1,L6R17)

#checkL6r17=X,1,S
T(2,@LegalStaffName,#L6R17Fullname)

#LegalStaffName=X,100,L

!銷帳編號 系統自動編號,不必輸入
#CloseNo=A,7,L
E(0,0)

!備註 可不輸入
#Rmk=c,60,I


#RPTFG=A,1,S

<include src="ROM.icf::L1R09.dec"/>
<include src="ROM.icf::L2Rim.dec"/>
<include src="ROM.icf::L2R05.dec"/>
<include src="ROM.icf::L0Rim.dec"/>
<include src="ROM.icf::L6R17.dec"/>
</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>


!---------- TXFORM = L2601 ----------
<sub type="FORM" name="L2601">

!#SCRPRT=_,_,S
!C(5,#TXFORM,L2601,$,S)

#SCRTIL=_,_,S
T(3,[L2601] 法拍費用管理系統-法拍費用新增)

!------ TOM(HEAD)   Variables (FOR OUTPUT SCREEN) ------
#OCloseNo=A,7,S
E(0,@CloseNo,#OCloseNo)

#OWarningMsg=x,200,O
C(4,#OWarningMsg,$,ALERT(#OWarningMsg))


!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------

!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------

</sub>


!------ 上行電文 ------
<sub type="TIM">
#CustNo
#FacmNo
#ReceiveDate
#AcDate
#DocDate
#TimFee
#FeeCode
#LegalStaff
#CloseNo
#Rmk
</sub>


!------ 下行電文TOM ------
<sub type="TOM">
TXFORM=L2601
#OCloseNo
#OWarningMsg
^
<include src="COM.icf::TRCTL.tom"/>
<include src="ROM.icf::L1R09.tom"/>
<include src="ROM.icf::L2R05.tom"/>
<include src="ROM.icf::L2R34.tom"/>
<include src="ROM.icf::L6R17.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
</sub>

<sub type="PART" name="L2601" layout="cols=3;screen.width=[130,370,130,370];printer.width=[15,30,15,30];order=1">
[
["[L2601]                                 法拍費用新增"],
[#<->#,"@案件編號"],
[#<->#,"@統一編號"],
["@借戶戶號"],
["@核准編號"],
]
</sub>
!---------- 單據輸出組合 ----------
<sub type="SELECT">

<include src="PRT.icf::UPD01.sel"/>
</sub>
