----- BASIC LABEL Variables ----------
<sub type="SYS">
#Submit=A,1,S
K(MODIFYBUTTON,查詢)
</sub>

<sub type="SYS" name="label">

!#TXCD
!T(3,L2914)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,938)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,0)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,20)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
! 權限檢查
<include src="COM.icf::BFHEAD2.dec"/>
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[130,1100];printer.width=[20,20];">
[
["[L2914]                                 其他擔保品資料查詢"],
["#FdClCode1+擔保品別1",#ClCode1,#ClCode1X],
["#FdClCode2+擔保品別2",#ClCode2,#ClCode2X],
["#FdClNo+擔保品號碼",#ClNo],
]

#FdClCode1=X,2,L
#FdClCode2=X,2,L
#FdClNo=X,2,L
T(3,*)

!---------- AP Button AREA ----------
![Buttom資料查詢]
#BUF1=X,42,S
!---------- AP TEXT AREA Variables ----------
<include src="HELPRIM.icf::HELPRIM.rtn"/>

!ClTypeCode 擔保品類別
#CDDEF01=x,20,S
T(3,CdCode.ClTypeCode4)

#ClTypeCodeHelp=x,1024,S

!PledgeBankCode 保證銀行
#CDDEF02=x,30,S
T(3,CdCode.PledgeBankCode)

#PledgeBankCodeHelp=x,1024,S

!SettingStat 設定狀態
#CDDEF03=x,30,S
T(3,CdCode.SettingStatCode)

#SettingStatHelp=x,1024,S

!ClStat擔保品狀態
#CDDEF04=x,30,S
T(3,CdCode.ClStatCode)

#ClStatHelp=x,1024,S

!SyndCode 聯貸案類型
#CDDEF05=x,30,S
T(3,CdCode.SyndCode)

#SyndCodeHelp=x,1024,S

#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#CDDEF01,#CDDEF02,#CDDEF03,#CDDEF04,#CDDEF05)
R(1,XXR99)
CALL(#HelpProc)
T(2,@ClTypeCodeHelp,#HelpDesc1)
T(2,@PledgeBankCodeHelp,#HelpDesc2) 
T(2,@SettingStatHelp,#HelpDesc3)
T(2,@ClStatHelp,#HelpDesc4)
T(2,@SyndCodeHelp,#HelpDesc5) 

#YNHelp=x,10,S
T(3,Y:是;N:否)

#CHAIN=A,1,S
T(4,CHAIN$)

#NTXBUF=X,10,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
T(1,@ClCode1,#NTXBUF,1,1)
T(1,@ClCode2,#NTXBUF,2,2)
T(1,@ClNo,#NTXBUF,4,7)

!擔保品別1
#ClCode1=A,1,L
E(0,5)

#ClCode1X=X,10,L
T(3,銀行保證)

!擔保品別2
#ClCode2=A,2,L
E(0,1)

#ClCode2X=X,13,L


!擔保品號碼
#ClNo=A,7,I
C(3,#CHAIN,1,s,$)
@V(2,0)

#RimClCode1=A,1,S
#RimClCode2=A,2,S
#RimClNo=A,7,S

<include src="ROM.icf::L2R17.dec"/>
!RIM取原擔保品編號
#RimL2r17=X,1,S
E(0,@RimClCode1,#ClCode1)
E(0,@RimClCode2,#ClCode2)
E(0,@RimClNo,#ClNo)
RESET_RIM(#RimL2r17,L2R17)
S(L2R17,1,#RimClCode1,#RimClCode2,#RimClNo)
R(1,L2R17)
E(0,@OGdRid1,#L2r17GdrId1)
E(0,@OGdRid2,#L2r17GdrId2)
E(0,@OGdRnum,#L2r17GdrNum)

#RPTFG=A,1,S
E(0,0)

#QuickXMT=A,1,S
C(3,#CHAIN,1,$,s)
XMT()



</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>


#OClCode1=A,1,L
T(2,#ClCode1)
#OClCode2=A,2,L
T(2,#ClCode2)
#OClNo=A,7,L
T(2,#ClNo)

![原擔保品編號]

#OGdRid1=A,1,L
#OGdRid2=A,2,L
#OGdRnum=A,7,L

#OGdALL=X,12,L
C(3,#OGdRid1,0,S,$)
T(2,#OGdRid1+-+#OGdRid2+-+#OGdRnum)

!地區別
#OCityCode=X,2,L

#OCityCodeX=X,20,L

!擔保品類別
#OClTypeCode=X,3,L

#OClTypeCodeX=X,30,L
C(4,#OClTypeCode,S,$)T(H,#OClTypeCode,#ClTypeCodeHelp)

!鑑估日期
#OEvaDate=D,7,L
!保證金額
#OPledgeAmt=m,14,L
!保證起日
#OPledgeStartDate=D,7,L
!保證迄日
#OPledgeEndDate=D,7,L
!保證銀行
#OPledgeBankCode=X,2,L

#OPledgeBankCodeX=X,20,L
C(4,#OPledgeBankCode,S,$)T(H,#OPledgeBankCode,#PledgeBankCodeHelp)

!保證書字號
#OPledgeNO=X,30,L
!所有權人統編
#OOwnerId=X,10,L
!所有權人姓名
#OOwnerName=X,100,L
!發行機構統編
#OIssuingId=X,10,L
!發行機構所在國別
#OIssuingCounty=X,3,L
!憑證編號
#ODocNo=X,30,L
!貸放成數
#OLoanToValue=m,3.2,L

#SecuritiesTypeHelp=x,50,S
T(3,01:股票;02:基金;03:債券;04:票券/國庫儲蓄券;05:其他)
!有價證券類別 SecuritiesType
#OSecuritiesType=X,2,L

#OSecuritiesTypeX=X,20,L
C(4,#OSecuritiesType,S,$)
T(H,#OSecuritiesType,#SecuritiesTypeHelp)

#ListedHelp=x,120,S
T(3,01:臺灣證交所;02:櫃檯買賣中心;03:紐約證券交易所（NYSE）;04:那斯達克（Nasdaq）;05:倫敦證券交易所（LSE）;06:德國證券交易所（GSE）;07:歐洲交易所（Euronext）;08:東京證券交易所（TSE）;99:無)))
!掛牌交易所 Listed
#OListed=X,2,L

#OListedX=X,30,L
C(4,#OListed,S,$)
T(H,#OListed,#ListedHelp)

!發行日 OfferingDate
#OOfferingDate=D,7,L

!到期日 ExpirationDate 
#OExpirationDate=D,7,L

#TargetIssuerHelp=x,50,S
T(3,01:主權國家;02:銀行;03:企業;04:無;99:其他)
!發行者對象別 TargetIssuer
#OTargetIssuer=X,2,L

#OTargetIssuerX=X,15,L
C(4,#OTargetIssuer,S,$)
T(H,#OTargetIssuer,#TargetIssuerHelp)

!發行者次對象別 SubTargetIssuer
#OSubTargetIssuer=X,2,L

#OSubTargetIssuerX=X,15,L
C(4,#OSubTargetIssuer,S,$)
T(H,#OSubTargetIssuer,#TargetIssuerHelp)

!評等日期 CreditDate
#OCreditDate=D,7,L

#CreditHelp=x,100,S
T(3,10:中華信評;20:穆迪;30:惠譽;40:TCRI;50:標準普爾;90:其他)
!評等公司 Credit
#OCredit=X,2,L

#OCreditX=X,15,L
C(4,#OCredit,S,$)
T(H,#OCredit,#CreditHelp)


!外部評等 ExternalCredit
#OExternalCredit=X,3,L

#IndexHelp=x,50,S
T(3,01:臺灣加權指數;02:日經指數;03:恆生指數;99:無)
!主要指數 Index
#OIndex=X,2,L

#OIndexX=X,15,L
C(4,#OIndex,S,$)
T(H,#OIndex,#IndexHelp)

#TradingMethodHelp=X,20,S
T(3,0:正常;1:全額交割)
!交易方法 TradingMethod
#OTradingMethod=X,1,L

#OTradingMethodX=X,10,L
C(4,#OTradingMethod,S,$)
T(H,#OTradingMethod,#TradingMethodHelp)

!受償順位 Compensation
#OCompensation=X,3,L

!投資內容 Investment
#OInvestment=c,300,S
T(1,@OInvestment1,#OInvestment,1,100)
T(1,@OInvestment2,#OInvestment,101,100)
T(1,@OInvestment3,#OInvestment,201,100)
#OInvestment1=c,100,L
#OInvestment2=c,100,L
#OInvestment3=c,100,L

!公開價值 PublicValue
#OPublicValue=c,300,S
T(1,@OPublicValue1,#OPublicValue,1,100)
T(1,@OPublicValue2,#OPublicValue,101,100)
T(1,@OPublicValue3,#OPublicValue,201,100)
#OPublicValue1=c,100,L
#OPublicValue2=c,100,L
#OPublicValue3=c,100,L

#OSettingStat=A,1,S

#OSettingStatX=x,4,L
T(3,)T(H,#OSettingStat,#SettingStatHelp)

#OClStat=A,1,L

#OClStatX=x,10,L
T(3,)T(H,#OClStat,#ClStatHelp)

#OSettingDate=D,7,L
#OSettingAmt=m,14,L
!聯貸案
#OSynd=X,1,L

#OSyndX=X,20,L
T(3,)T(H,#OSynd,#YNHelp)

!聯貸案類型
#OSyndCode=A,1,L

#OSyndCodeX=X,20,L
C(4,#OSyndCode,S,$)T(H,#OSyndCode,#SyndCodeHelp)

!處分價格
#ODispPrice=m,14,L

!處分日期
#ODispDate=D,7,L

!擔保品狀況碼
#OClStatus=A,1,L

#OClStatusX=X,20,L


#ORPTFG=A,1,S
E(0,@RPTFG,#ORPTFG)

</sub>


!---------- TXFORM = L2914 ----------
<sub type="FORM" name="L2914">

!#SCRPRT=_,_,S
!C(5,#TXFORM,L2914,$,S)


!------ TOM(HEAD)   Variables (FOR OUTPUT SCREEN) ------
!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------

!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------

</sub>

<sub type="FORM" name="L291A">

!#SCRPRT=_,_,S
!C(5,#TXFORM,L2914,$,S)

#SCRTIL=_,_,S
T(3,[L2914] 其他擔保品資料)

</sub>

!------ 上行電文 ------
<sub type="TIM">
#ClCode1
#ClCode2
#ClNo
#END
</sub>


!------ 下行電文TOM ------
<sub type="TOM">
TXFORM=L2914
#OCityCode
#OCityCodeX
#OClTypeCode
#OEvaDate
#OPledgeAmt
#OPledgeStartDate
#OPledgeEndDate
#OPledgeBankCode
#OPledgeNO
#OOwnerId
#OOwnerName
#OIssuingId
#OIssuingCounty
#ODocNo
#OLoanToValue
#OSecuritiesType
#OListed
#OOfferingDate
#OExpirationDate
#OTargetIssuer
#OSubTargetIssuer
#OCreditDate
#OCredit
#OExternalCredit
#OIndex
#OTradingMethod
#OCompensation
#OInvestment
#OPublicValue
#OSettingStat
#OClStat
#OSettingDate
#OSettingAmt
#OSynd
#OSyndCode
#ODispPrice
#ODispDate
#OClStatus
#ORPTFG
^
<include src="COM.icf::TRCTL.tom"/>
<include src="ROM.icf::L2R17.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
</sub>

<sub type="PART" name="L2914" layout="cols=3;screen.width=[150,370,150,370];printer.width=[15,30,15,30];order=1">
[
["[L2914]                                 其他擔保品資料查詢"],
["擔保品編號",#OClCode1,"-",#OClCode2,"-",#OClNo],["原擔保品編號",#OGdALL],
[#<->#,"地區別",#OCityCode,#OCityCodeX],
[#<->#,"擔保品類別",#OClTypeCode,#OClTypeCodeX],
["鑑估日期",#OEvaDate],["估值／現值",#OPledgeAmt],
["保證金額",#OPledgeAmt],["保證銀行",#OPledgeBankCode,#OPledgeBankCodeX],
["保證起日",#OPledgeStartDate],["保證迄日",#OPledgeEndDate],
[#<->#,"保證書字號",#OPledgeNO],
["所有權人統編",#OOwnerId],["所有權人姓名",#OOwnerName],
[#<->#,"發行機構統編",#OIssuingId],
[#<->#,"發行機構所在國別",#OIssuingCounty],
["憑證編號",#ODocNo],["貸放成數",#OLoanToValue,"％"],
["有價證券類別",#OSecuritiesType,#OSecuritiesTypeX],["掛牌交易所",#OListed,#OListedX],
["發行日",#OOfferingDate],["到期日",#OExpirationDate],
["發行者對象別",#OTargetIssuer,#OTargetIssuerX],["發行者次對象別",#OSubTargetIssuer,#OSubTargetIssuerX],
["評等日期",#OCreditDate],["評等公司",#OCredit,#OCreditX],
["外部評等",#OExternalCredit],["主要指數",#OIndex,#OIndexX],
["交易方法",#OTradingMethod,#OTradingMethodX],["受償順位",#OCompensation],
[#<->#,"投資內容",#OInvestment1],
[#<->#,"@",#OInvestment2],
[#<->#,"@",#OInvestment3],
[#<->#,"公開價值",#OPublicValue1],
[#<->#,"@",#OPublicValue2],
[#<->#,"@",#OPublicValue3],
["設定狀態",#OSettingStatX],["擔保品狀態",#OClStatX],
["設定日期",#OSettingDate],["設定金額",#OSettingAmt],
["聯貸案",#OSynd,#OSyndX],["聯貸案類型",#OSyndCode,#OSyndCodeX],
["處分價格",#ODispPrice],["處分日期",#ODispDate],
[#<->#,"擔保品狀況碼",#OClStatus,#OClStatusX],
]
</sub>

<sub type="PART" name="L291A" layout="cols=3;screen.width=[150,370,150,370];printer.width=[15,30,15,30];order=1">
[
["[L2914]                                 其他擔保品資料查詢"],
["擔保品編號",#OClCode1,"-",#OClCode2,"-",#OClNo],["原擔保品編號",#OGdALL],
[#<->#,"地區別",#OCityCode,#OCityCodeX],
[#<->#,"擔保品類別",#OClTypeCode,#OClTypeCodeX],
["鑑估日期",#OEvaDate],["保證金額",#OPledgeAmt],
["保證起日",#OPledgeStartDate],["保證迄日",#OPledgeEndDate],
["保證銀行",#OPledgeBankCode,#OPledgeBankCodeX],["保證書字號",#OPledgeNO],
["所有權人統編",#OOwnerId],["所有權人姓名",#OOwnerName],
["發行機構統編",#OIssuingId],["發行機構所在國別",#OIssuingCounty],
["憑證編號",#ODocNo],["貸放成數",#OLoanToValue,"%"],
["設定狀態",#OSettingStatX],["擔保品狀態",#OClStatX],
["設定日期",#OSettingDate],["設定金額",#OSettingAmt],
["聯貸案",#OSynd,#OSyndX],["聯貸案類型",#OSyndCode,#OSyndCodeX],
["處分價格",#ODispPrice],["處分日期",#ODispDate],
[#<->#,"擔保品狀況碼",#OClStatus,#OClStatusX],
]
</sub>

<sub type="PART" name="L291B" layout="cols=3;screen.width=[150,370,150,370];printer.width=[15,30,15,30];order=1">
[
["[L2914]                                 其他擔保品資料查詢"],
["擔保品編號",#OClCode1,"-",#OClCode2,"-",#OClNo],["原擔保品編號",#OGdALL],
[#<->#,"地區別",#OCityCode,#OCityCodeX],
[#<->#,"擔保品類別",#OClTypeCode,#OClTypeCodeX],
["鑑估日期",#OEvaDate],["估值／現值",#OPledgeAmt],
["所有權人統編",#OOwnerId],["所有權人姓名",#OOwnerName],
["發行機構統編",#OIssuingId],["發行機構所在國別",#OIssuingCounty],
["憑證編號",#ODocNo],["貸放成數",#OLoanToValue,"%"],
["設定狀態",#OSettingStatX],["擔保品狀態",#OClStatX],
["設定日期",#OSettingDate],["設定金額",#OSettingAmt],
["聯貸案",#OSynd,#OSyndX],["聯貸案類型",#OSyndCode,#OSyndCodeX],
["處分價格",#ODispPrice],["處分日期",#ODispDate],
[#<->#,"擔保品狀況碼",#OClStatus,#OClStatusX],
]
</sub>
<sub type="PART" name="L291C" layout="cols=3;screen.width=[150,370,150,370];printer.width=[15,30,15,30];order=1">
[
["[L2914]                                 其他擔保品資料查詢"],
["擔保品編號",#OClCode1,"-",#OClCode2,"-",#OClNo],["原擔保品編號",#OGdALL],
[#<->#,"地區別",#OCityCode,#OCityCodeX],
[#<->#,"擔保品類別",#OClTypeCode,#OClTypeCodeX],
["鑑估日期",#OEvaDate],["估值／現值",#OPledgeAmt],
["所有權人統編",#OOwnerId],["所有權人姓名",#OOwnerName],
["發行機構統編",#OIssuingId],["發行機構所在國別",#OIssuingCounty],
["憑證編號",#ODocNo],["貸放成數",#OLoanToValue,"%"],
["有價證券類別",#OSecuritiesType,#OSecuritiesTypeX],["掛牌交易所",#OListed,#OListedX],
["發行日",#OOfferingDate],["到期日",#OExpirationDate],
["發行者對象別",#OTargetIssuer,#OTargetIssuerX],["發行者次對象別",#OSubTargetIssuer,#OSubTargetIssuerX],
["評等日期",#OCreditDate],["評等公司",#OCredit,#OCreditX],
["外部評等",#OExternalCredit],["主要指數",#OIndex,#OIndexX],
["交易方法",#OTradingMethod,#OTradingMethodX],["受償順位",#OCompensation],
[#<->#,"投資內容",#OInvestment1],
[#<->#,"@",#OInvestment2],
[#<->#,"@",#OInvestment3],
[#<->#,"公開價值",#OPublicValue1],
[#<->#,"@",#OPublicValue2],
[#<->#,"@",#OPublicValue3],
["設定狀態",#OSettingStatX],["擔保品狀態",#OClStatX],
["設定日期",#OSettingDate],["設定金額",#OSettingAmt],
["聯貸案",#OSynd,#OSyndX],["聯貸案類型",#OSyndCode,#OSyndCodeX],
["處分價格",#ODispPrice],["處分日期",#ODispDate],
[#<->#,"擔保品狀況碼",#OClStatus,#OClStatusX],
]
</sub>


!---------- 單據輸出組合 ----------
<sub type="SELECT">
#RPTFG=0,QUERY.GRID,L2914
#any={detail:false, header:'L2914.PART', caption:' ', width:1000, rowNum:20, rowList:[20,40,60]}
^
#RPTFG=1,QUERY.GRID,L291A
#any={detail:false, header:'L291A.PART', caption:' ', width:1000, rowNum:20, rowList:[20,40,60]}
^
#RPTFG=2,QUERY.GRID,L291B
#any={detail:false, header:'L291B.PART', caption:' ', width:1000, rowNum:20, rowList:[20,40,60]}
^
#RPTFG=3,QUERY.GRID,L291C
#any={detail:false, header:'L291C.PART', caption:' ', width:1000, rowNum:20, rowList:[20,40,60]}
^
</sub>
