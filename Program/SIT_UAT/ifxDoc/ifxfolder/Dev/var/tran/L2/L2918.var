----- BASIC LABEL Variables ----------
<sub type="SYS">
#Submit=A,1,S
K(MODIFYBUTTON,查詢)
</sub>

<sub type="SYS" name="label">

!#TXCD
!T(3,L2918)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,0)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,83)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,20)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

#BUF1=X,18,S
T(2,1+0+00+0000000+0000000)

#button=x,100,S
T(2,{ cmd=CHAIN; ntxcd=L2418; ntxbuf=#BUF1})ASGN(BTN_NEW1$)
K(MODIFYBUTTON,1,新增)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)



</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[130,1100];printer.width=[20,20];">
[
["[L2918]                                 擔保品他項權利查詢"],
["#FdClCode1+擔保品代號1",#ClCode1,#ClCode1X],
["#FdClCode2+擔保品代號2",#ClCode2,#ClCode2X],
["#FdClNo+擔保品編號",#ClNo],
]


!---------- AP Button AREA ----------
![Buttom資料查詢]


!---------- AP TEXT AREA Variables ----------
<include src="ROM.icf::L2R48.dec"/>
<include src="HELPRIM.icf::HELPRIM.rtn"/>
!#CDDEF01=x,20,S
!T(3,CdCode.ClCode1)

#ClCode1Help=X,1024,S
T(3,1:房地;2:土地)

!#HelpRim=X,1,S
!RESET_RIM(#HelpRim,XXR99)
!S(XXR99,01,#CDDEF01)
!R(1,XXR99)
!CALL(#HelpProc)
!T(2,@ClCode1Help,#HelpDesc1)

#CHAIN=A,1,S
T(4,CHAIN$)

#NTXBUF=X,200,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
T(1,@ClCode1,#NTXBUF,1,1)
T(1,@ClCode2,#NTXBUF,2,2)
T(1,@ClNo,#NTXBUF,4,7)


#Init=X,1,S
T(2,@FdClCode1,*)
T(2,@FdClCode2,)
T(2,@FdClNo,)

#FdClCode1=X,2,L
#FdClCode2=X,2,L
#FdClNo=X,2,L


! [擔保品代號1]
#ClCode1=A,1,I
C(3,#CHAIN,1,s,$)
HELP(#ClCode1Help)
@V(H,#ClCode1Help)
T(2,@BUF1,1+#ClCode1+#ClCode2+#ClNo+0000000)

#ClCode1X=X,20,L
T(H,#ClCode1,#ClCode1Help)

!調RIM參數
!L2r46 取他項權利資料
!L2r48 取擔保品代號2Help
#RimClCode1=A,1,S
#RimClCode2=A,2,S
#RimClNo=A,7,S
#RimFunCd=A,1,S

!取擔保品代號2Help
#RimL2R48=X,1,S
E(0,@RimClCode1,#ClCode1)
RESET_RIM(#RimL2R48,L2R48)
S(L2R48,1,#RimClCode1)
R(1,L2R48)

! [擔保品代號2]
#ClCode2=A,2,I
C(3,#CHAIN,1,s,$)
HELP(#L2r48Help1)
@V(H,#L2r48Help1)T(2,@BUF1,1+#ClCode1+#ClCode2+#ClNo+0000000)

#ClCode2X=X,30,L
T(3,)
T(H,#ClCode2,#L2r48Help1)

! [擔保品編號]

#ClNo=A,7,I
C(3,#CHAIN,1,s,$)
@T(2,@BUF1,1+#ClCode1+#ClCode2+#ClNo+0000000)



#RPTFG=A,1,S
E(0,0)

!L2418 
#button=_,_,S
T(2,@BUF1,1+#ClCode1+#ClCode2+#ClNo+0000000)

#QuickXMT=A,1,S
C(3,#CHAIN,1,$,s)
XMT()

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>


!---------- TXFORM = L2918 ----------
<sub type="FORM" name="L2918">

!#SCRPRT=_,_,S
!C(5,#TXFORM,L2918,$,S)

#SCRTIL=_,_,S
T(3,[L2918] 擔保品他項權利查詢)


#Precision=N,1,S
!------ TOM(HEAD)   Variables (FOR OUTPUT SCREEN) ------
!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------
#LOOP=X,1,S
T(3,1)ASGN(LOOP$)


#OOClCode1=A,1,S
#OOClCode2=A,2,S
#OOClNo=A,7,S
#OOCl=X,12,L
T(2,#OOClCode1+-+#OOClCode2+-+#OOClNo)
#OOClSeq=X,8,S
!縣市
#OOCity=X,6,L
!地政
#OOLandAdm=X,6,L
!收件年
#OORecYear=A,3,L
!收件字
#OORecWord=X,8,L
!收件號
#OORecNumber=X,6,L
!權利價值說明
#OORightsNote=X,20,L
!擔保債權總金額
#OOSecuredTotal=m,14.2,L

#OOSecuredTotalX=X,22,L
CALL2(#ADJUSTDOT,#Precision,#OOSecuredTotal,#OOSecuredTotalX)
P(R,#OOSecuredTotalX)

#FUNC2=A,1,S
E(0,2)
#FUNC4=A,1,S
E(0,4)
#FUNC5=A,1,S
E(0,5)


#BUF2=X,200,S
T(2,#FUNC2+#OOClCode1+#OOClCode2+#OOClNo+#OOClSeq)

#BUF4=X,200,S
T(2,#FUNC4+#OOClCode1+#OOClCode2+#OOClNo+#OOClSeq)

#BUF5=X,200,S
T(2,#FUNC5+#OOClCode1+#OOClCode2+#OOClNo+#OOClSeq)

#OOBTN1=X,1,S
BIND(grid,{ cmd=CHAIN; ntxcd=L2418;ntxbuf=#BUF2})

#OOBTN2=X,1,S
BIND(grid,{ cmd=CHAIN; ntxcd=L2418;ntxbuf=#BUF4})

#OOBTN3=X,1,S
BIND(grid,{ cmd=CHAIN; ntxcd=L2418;ntxbuf=#BUF5})

!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------

</sub>


!------ 上行電文 ------
<sub type="TIM">
#ClCode1
#ClCode2
#ClNo
</sub>


!------ 下行電文TOM ------
<sub type="TOM">
TXFORM=L2918
#OOClCode1
#OOClCode2
#OOClNo
#OOClSeq
#OOCity
#OOLandAdm
#OORecYear
#OORecWord
#OORecNumber
#OORightsNote
#OOSecuredTotal
^
<include src="COM.icf::TRCTL.tom"/>
<include src="ROM.icf::L2R48.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
</sub>

<sub type="PART" name="L2918" layout="cols=1;screen.width=[130,870];printer.width=[15,30]">
[
["[L2918]                                 擔保品他項權利查詢查詢"],
[""],
]
</sub>
!---------- 單據輸出組合 ----------
<sub type="SELECT">


#RPTFG=0,QUERY.GRID,L2918
#any={detail:true, header:'L2918.part', caption:'', width:1000, rowNum:20, rowList:[20,40,60]}


#OOBTN1=
{width:40,search:false,formatter:'cust:bind-button:修改',align:'center',canExport:false}
#OOBTN2=
{width:40,search:false,formatter:'cust:bind-button:刪除',align:'center',canExport:false}
#OOBTN3=
{width:40,search:false,formatter:'cust:bind-button:查詢',align:'center',canExport:false}


#OOCl=擔保品號碼
{width:100,align:'center'}
#OOClSeq=他項權利序號
{width:120,align:'center'}
#OOCity=縣市
{width:80,align:'center'}
#OOLandAdm=地政
{width:80,align:'center'}
#OORecYear=收件年
{width:80,align:'center'}
#OORecWord=收件字
{width:80,align:'center'}
#OORecNumber=收件號
{width:80,align:'center'}
#OORightsNote=權利價值說明
{width:150,align:'center'}
#OOSecuredTotalX=擔保債權總金額
{width:180,align:'center'}


^

<include src="PRT.icf::INQ01.sel" map="i=L2918;cpi=15"/>

#OOCl#OOClSeq#OOCity#OOLandAdm#OORecYear#OORecWord#OORecNumber#OORightsNote#OOSecuredTotalX
<include src="PRT.icf::INQ01.sel"/>
</sub>
