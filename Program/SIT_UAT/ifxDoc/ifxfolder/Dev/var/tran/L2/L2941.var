----- BASIC LABEL Variables ----------
<sub type="SYS">
#Submit=A,1,S
K(MODIFYBUTTON,查詢)
</sub>

<sub type="SYS" name="label">

!#TXCD
!T(3,L2941)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,35)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,50)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,20)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)

!#BTNADDBUF=X,18,S



!#BtnAddA=x,100,S
!T(2,{cmd=CHAIN; ntxcd=L2601; ntxbuf=#BTNADDBUF; ntxbuf5=type})
!ASGN(BTN_NEW1$)
!K(MODIFYBUTTON,1,新增)
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[130,1100];printer.width=[20,20];">
[
["[L2941]                                 法拍費用查詢-依借戶戶號"],
["#FdCustNo+借戶戶號",#CustNo,#BTN1,#CustName],
]

#FdCustNo=X,2,L
T(3,*)

!---------- AP Button AREA ----------
![Buttom資料查詢]
#BTN1=X,15,I,ui:button;value:顧客資料查詢;enable:1;tabbable:0
!---------- AP TEXT AREA Variables ----------
! Help
<include src="HELPRIM.icf::HELPRIM.rtn"/>
#CDDEF0001=x,26,S
T(3,CdCode.CurrPrecision)

#CDDEF0002=x,26,S
T(3,CdCode.FeeCode)

#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#CDDEF0001,#CDDEF0002)
R(1,XXR99)
CALL(#HelpProc) 
T(2,@CurrPrecisionHelp,#HelpDesc1)
T(2,@FeeCodeHelp,#HelpDesc2)

#CurrPrecisionHelp=x,1024,S

#FeeCodeHelp=x,1024,S

#CHAIN=A,1,S
T(4,CHAIN$) 

#NTXBUF=X,7,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)


#BUF1=X,42,S

#BIND1=X,1,S
BIND(#BTN1,click, {cmd=CHAIN; ntxcd=L1001; ntxbuf=#BUF1;ntxbuf5=type<-1:CustNo<-OOCustNo})


!借戶戶號
#CustNo=A,7,I
C(3,#CHAIN,1,T(2,#NTXBUF),$)
C(3,#CHAIN,1,s,$)
@
T(3,#CustName,)
V(2,0)

<include src="ROM.icf::L1R09.dec"/>
<include src="ROM.icf::L2Rim.dec"/>
#RimL1r09=X,1,S
E(0,@RimFunCd,1)
T(2,@RimCustId,)
E(0,@RimCustNo,#CustNo)
RESET_RIM(#RimL1r09,L1R09)
S(L1R09,1,#RimFunCd,#RimCustId,#RimCustNo)
R(1,L1R09)

#CheckL1R09=X,1,S
T(2,@CustName,#L1r09CustName)


#CustName=X,100,L


#RPTFG=A,1,S

#MRKEY=_,_,S
T(2,#CustNo)

#CHAINXMT=X,1,S
C(3,#CHAIN,1,E(0,@CHAIN,0)XMT(),$)

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>


!---------- TXFORM = L2941 ----------
<sub type="FORM" name="L2941">

!#SCRPRT=_,_,S
!C(5,#TXFORM,L2941,$,S)

#SCRTIL=_,_,S
T(3,[L2941] 法拍費用-依借戶戶號)

#OCUSTNO=A,7,L
E(2,#CustNo)

#OCUSTNAME=X,20,L
T(2,#CustName)

#OOCurrencyCode=X,3,O
T(3,TWD)

#Precision=N,1,S
E(0,0)T(H,#OOCurrencyCode,#CurrPrecisionHelp)

#OFeeAmt=m,14.2,L

#OFeeAmtX=X,22,L
CALL2(#ADJUSTDOT,#Precision,#OFeeAmt,#OFeeAmtX)


#OOverdueLawFee=m,14.2,L

#OOverdueLawFeeX=X,22,L
CALL2(#ADJUSTDOT,#Precision,#OOverdueLawFee,#OOverdueLawFeeX)


#OFileCnt=A,3,L


!------ TOM(HEAD)   Variables (FOR OUTPUT SCREEN) ------
!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------
#LOOP=X,1,S
T(3,1)ASGN(LOOP$)

#OOReceiveDate=D,7,L

#OOFee=m,14.2,L

#OOFeex=X,22,L
CALL2(#ADJUSTDOT,#Precision,#OOFee,#OOFeex)
P(R,#OOFeex)

#OOFeeCode=A,2,S

#OOFeeCodeX=X,12,L
T(3,)T(H,#OOFeeCode,#FeeCodeHelp) 

#OODrCr=X,2,L

#OOCaseCode=A,1,S

#OOCaseCodeX=X,10,S
!SWITCH(#OOCaseCode,2,T(3,匯款),
!                    ,T(3,))

#OOCaseCodeXX=X,12,L
T(2,#OOCaseCode+-+#OOCaseCodeX)

#OOEntryDate=D,7,L

#OOCloseDate=D,7,L

#OOOverdue=X,1,L

#OOCUSTNO=A,7,S
E(0,#CustNo)

#OORecordNo=A,7,S

!修改
!#OOBUF3=X,179,S
!T(2,2+#OORecordNo+#OOCUSTNO)

!#OOBTN3=X,1,S
!BIND(grid,{ cmd=CHAIN; ntxcd=L2602; ntxbuf=#OOBUF3})

!刪除
!#OOBUF4=X,179,S
!T(2,4+#OORecordNo+#OOCUSTNO)

!#OOBTN4=X,1,S
!BIND(grid,{ cmd=CHAIN; ntxcd=L2602; ntxbuf=#OOBUF4})


!查詢
!#OOBUF2=X,179,S
!T(2,5+#OORecordNo+#OOCUSTNO)

!#OOBTN2=X,1,S
!BIND(grid,{ cmd=CHAIN; ntxcd=L2602; ntxbuf=#OOBUF2})


!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------

</sub>


!------ 上行電文 ------
<sub type="TIM">
#CustNo
#END
</sub>


!------ 下行電文TOM ------
<sub type="TOM">
TXFORM=L2941
#OFeeAmt
#OOverdueLawFee
#OFileCnt
#OOReceiveDate
#OOFee
#OOFeeCode
#OODrCr
#OOCaseCode
#OOEntryDate
#OOCloseDate
#OOOverdue
#OORecordNo
^
<include src="COM.icf::TRCTL.tom"/>
<include src="ROM.icf::L1R09.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
</sub>

<sub type="PART" name="L2941" layout="cols=3;screen.width=[130,370,130,370];printer.width=[15,30,15,30];order=1">
[
["[L2941]                                 法拍費用查詢-依借戶戶號"],
["@借戶戶號",#OCUSTNO],["@借款人戶名",#OCUSTNAME],
["@法拍費用",#OFeeAmtX],["@催收法務費",#OOverdueLawFeeX],
["@筆數",#OFileCnt],
]
</sub>
!---------- 單據輸出組合 ----------
<sub type="SELECT">


#RPTFG=0,QUERY.GRID,L2941
#any={detail:true, header:'L2941.part', caption:'', width:1000, rowNum:20, rowList:[20,40,60]}

!#OOBTN3=
!{width:50,search:false,formatter:'cust:bind-button:修改',align:'center',canExport:false}

!#OOBTN4=
!{width:50,search:false,formatter:'cust:bind-button:刪除',align:'center',canExport:false}

!#OOBTN2=
!{width:50,search:false,formatter:'cust:bind-button:查詢',align:'center',canExport:false}

#OOReceiveDate=收件日
{width:100,align:'center'}

#OOFeex=法拍費用
{width:180,align:'right'}

#OOFeeCodeX=科目名稱
{width:180,align:'left'}

#OODrCr=借貸
{width:50,align:'center'}

#OOEntryDate=單據日期
{width:100,align:'center'}

#OOCloseDate=銷號日期
{width:100,align:'center'}

#OOOverdue=催收
{width:50,align:'center'}



^

<include src="PRT.icf::INQ01.sel" map="i=L2941;cpi=15"/>

<include src="PRT.icf::INQ01.sel"/>
</sub>
