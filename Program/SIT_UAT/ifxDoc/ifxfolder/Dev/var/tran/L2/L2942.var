----- BASIC LABEL Variables ----------
<sub type="SYS">
#Submit=A,1,S
K(MODIFYBUTTON,查詢)
</sub>

<sub type="SYS" name="label">

!#TXCD
!T(3,L2942)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,54)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,57)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,20)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)

</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[120,980];printer.width=[20,20];">
[
["[L2942]                                 法拍費用查詢-依會計日期"],
["#FdACCDATE+會計日期",#AccDateStart,"@到@",#AccDateEnd],
]
!---------- AP Button AREA ----------
![Buttom資料查詢]

#BUF1=X,42,S

#FdACCDATE=X,2,L
T(3,*)
!---------- AP TEXT AREA Variables ----------
! Help
<include src="HELPRIM.icf::HELPRIM.rtn"/>
#CDDEF0001=x,26,S
T(3,CdCode.CurrPrecision)

#CDDEF0002=x,26,S
T(3,CdCode.FeeCode)

#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#CDDEF0001,#CDDEF0002)
R(1,XXR99)
CALL(#HelpProc) 
T(2,@CurrPrecisionHelp,#HelpDesc1)
T(2,@FeeCodeHelp,#HelpDesc2)

#CurrPrecisionHelp=x,1024,S

#FeeCodeHelp=x,1024,S

#CHAIN=A,1,S
T(4,CHAIN$)

!會計日期
#AccDateStart=D,7,I
@A(DATE,0,#AccDateStart)
V(7)

#AccDateEnd=D,7,I
@A(DATE,0,#AccDateEnd)
V(7)V(5,#AccDateStart,9991231)

#RPTFG=A,1,S

#CurrencyCode=X,3,S
T(3,TWD)

#PRECISION=N,1,S
E(0,0)T(H,#CurrencyCode,#CurrPrecisionHelp)

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>


!---------- TXFORM = L2942 ----------
<sub type="FORM" name="L2942">

!#SCRPRT=_,_,S
!C(5,#TXFORM,L2942,$,S)

#SCRTIL=_,_,S
T(3,[L2942] 法拍費用-依會計日期)


!件數
#OCNT=N,6,L



!法拍費用
#OFEEAMT=m,14.2,S

#OFEEAMTX=X,22,L
CALL2(#ADJUSTDOT,#PRECISION,#OFEEAMT,#OFEEAMTX)
P(R,#OFEEAMTX)


!法拍費用累餘
#OFEEAMTCUMBAL=m,14.2,S

#OFEEAMTCUMBALX=X,22,L
CALL2(#ADJUSTDOT,#PRECISION,#OFEEAMTCUMBAL,#OFEEAMTCUMBALX)
P(R,#OFEEAMTCUMBALX)

!催收法務累餘
#OOVDULAWFEECUMBAL=m,14.2,S

#OOVDULAWFEECUMBALX=X,22,L
CALL2(#ADJUSTDOT,#PRECISION,#OOVDULAWFEECUMBAL,#OOVDULAWFEECUMBALX)
P(R,#OOVDULAWFEECUMBALX)


!------ TOM(HEAD)   Variables (FOR OUTPUT SCREEN) ------
!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------
#LOOP=X,1,S
T(3,1)ASGN(LOOP$)

#OOACCTDATE=D,7,L

#OOENTRYDATE=D,7,L

#OOCustNo=A,7,S

#OOFacmNo=A,3,S

#OOCustName=X,100,S

#OOCustNoFacmNo=X,11,L
T(2,#OOCustNo+-+#OOFacmNo)

#OOFEEAMT=m,14.2,S

#OOFee=X,22,L
CALL2(#ADJUSTDOT,#PRECISION,#OOFEEAMT,#OOFee)
P(R,#OOFee)

#OOFeeCode=A,2,S

#OOFeeCodeX=X,20,L
T(3,)T(H,#OOFeeCode,#FeeCodeHelp) 


#OOReceiveDate=D,7,L

#OOCloseDate=D,7,L

#OOVERDUE=X,1,L

!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------

</sub>


!------ 上行電文 ------
<sub type="TIM">
#AccDateStart
#AccDateEnd
#END
</sub>


!------ 下行電文TOM ------
<sub type="TOM">
TXFORM=L2942
#OCNT
#OFEEAMT
#OFEEAMTCUMBAL
#OOVDULAWFEECUMBAL
#OOACCTDATE
#OOENTRYDATE
#OOCustNo
#OOFacmNo
#OOCustName
#OOFEEAMT
#OOFeeCode
#OOReceiveDate
#OOCloseDate
#OOVERDUE
^
<include src="COM.icf::TRCTL.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
</sub>

<sub type="PART" name="L2942" layout="cols=3;screen.width=[130,370,130,370];printer.width=[15,30,15,30];order=1">
[
["[L2942]                                 法拍費用查詢-依會計日期"],
["@件數",#OCNT],
["@法拍費用",#OFEEAMTX],
[#<->#,"@法拍費用累餘",#OFEEAMTCUMBALX],
[#<->#,"@催收法務累餘",#OOVDULAWFEECUMBALX],
]
</sub>
!---------- 單據輸出組合 ----------
<sub type="SELECT">


#RPTFG=0,QUERY.GRID,L2942
#any={detail:true, header:'L2942.part', caption:'', width:1000, rowNum:20, rowList:[20,40,60]}

#OOACCTDATE=會計日期
{width:100,align:'center'}

#OOCustNoFacmNo=戶號
{width:100,align:'center'}

#OOCustName=戶名
{width:100,align:'center'}

#OOFee=法拍費用
{width:180,align:'center'}

#OOFeeCodeX=科目
{width:100,align:'left'}

#OOReceiveDate=收件日
{width:100,align:'center'}

#OOENTRYDATE=單據日期
{width:100,align:'center'}

#OOCloseDate=銷號日期
{width:100,align:'center'}

#OOVERDUE=催收
{width:50,align:'center'}

^

<include src="PRT.icf::INQ01.sel" map="i=L2942;cpi=15"/>


<include src="PRT.icf::INQ01.sel"/>
</sub>
