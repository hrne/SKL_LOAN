----- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">


![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,161)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,110)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,20)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD2.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)

</sub>
!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[150,850];printer.width=[20,20];">
[
["[L6901]                                 交易分錄清單查詢"],
["#FD_AcDate+@會計日期",#AcDate],
["#FD_RelDy+@登放日期",#RelDy],
["#FD_SlipNo+@傳票號碼",#SlipNo],
[#FD_RelTxseq+#SeqName,#RelTxseq]
]
!---------- AP Button AREA ----------
![Buttom資料查詢]
!#BTN1=X,15,I,ui:button;value:瀏覽;enable:0;tabbable:0
!#BTN2=X,15,I,ui:button;value:瀏覽;enable:0;tabbable:0
!#BTN3=X,15,I,ui:button;value:瀏覽;enable:0;tabbable:0
#BUF1=X,42,S
!ENABLE(#BTN1)ENABLE(#BTN2)ENABLE(#BTN3)

#SubmitButton=X,4,S
K(MODIFYBUTTON,查詢)

!---------- AP TEXT AREA Variables ----------
#CHAIN=A,1,S
T(4,CHAIN$)
T(2,@SeqName,登放序號)
!IF(#CHAIN!=1,V(P,此為連動交易),$)

#NTXBUF=X,32,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
T(1,@AcDate,#NTXBUF,1,7)
T(1,@RelDy,#NTXBUF,8,7)
T(1,@RelTxseq,#NTXBUF,15,18)

#FD_AcDate=X,2,L
C(2,#CHAIN,$,S)
T(3,*)

#FD_RelDy=X,2,L
C(2,#CHAIN,$,S)
#FD_SlipNo=X,2,L

#FD_RelTxseq=X,2,L
C(2,#CHAIN,$,S)


#ShowFrame=A,1,S
C(2,#CHAIN,T(3,1),T(3,0))
T(F,@AcDate,#ShowFrame)
T(F,@RelDy,#ShowFrame)
T(F,@RelTxseq,#ShowFrame)

#RPTFG=A,1,S
E(0,0)

#RelDyX=X,7,S

#AcDate=D,7,I
C(3,#CHAIN,0,$,s)
E(0,#SYSDATE)
D(8)
@V(7)A(4,0,#AcDate)

#RelDy=D,7,I
INVOKEJS(SHOW,p1,2,2,1)
C(3,#CHAIN,0,$,C(3,#RelDy,0,INVOKEJS(SHOW,p1,2,2,0),s))
C(3,#CHAIN,0,$,s)
@C(3,#RelDy,0,INVOKEJS(SHOW,p1,2,2,0),INVOKEJS(SHOW,p1,2,2,1))
C(3,#RelDy,0,$,A(4,0,#RelDy))


#SlipNo=A,6,I
INVOKEJS(SHOW,p1,3,3,1)
C(3,#CHAIN,0,$,C(3,#SlipNo,0,INVOKEJS(SHOW,p1,3,3,0),s))
C(3,#CHAIN,0,$,s)
@C(3,#SlipNo,0,INVOKEJS(SHOW,p1,3,3,0),INVOKEJS(SHOW,p1,3,3,1))
C(3,#SlipNo,0,INVOKEJS(SHOW,p1,4,4,1),INVOKEJS(SHOW,p1,4,4,0))

!登放序號 必須輸入
#SeqName=x,8,L
T(3,登放序號)
C(3,#RelDy,0,T(3,交易序號),T(3,登放序號))


#RelTxseq=X,18,I
C(3,#CHAIN,0,$,s)
C(3,#SlipNo,0,$,S)
@
IF(#SlipNo==0 && #RelTxseq=="",V(P,傳票號碼、交易（登放）序號擇一輸入),$)

#Submit=A,1,S
C(3,#CHAIN,1,XMT(),$)


</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
<include src="PRT.icf::FM101.rtn"/>
</sub>


!------ 上行電文 ------
<sub type="TIM">
#AcDate
#RelDy
#SlipNo
#RelTxseq
#END
</sub>


!------ 下行電文TOM ------
<sub type="TOM">
<include src="COM.icf::TRCTL.tom"/>
TXFORM=L6901
#ORelTxseq
#OTitaTxCd
#OTitaSecNo
#OTitaBatchNo
#OTitaTlrNo
#OTitaSupNo
#OEntAc
#OSlipNote
#OOSumNo
#OOCustNo
#OOFacmNo
#OOBormNo
#OOAcNoCode
#OOCurrencyCode
#OODrTxAmt
#OOCrTxAmt
#OOSlipNo
^
<include src="PRT.icf::FM101.tom"/>

</sub>
!---------- TXFORM = FM101 交易分錄----------
<sub type="FORM" name="FM101">
<include src="PRT.icf::FM101.form"/>
</sub>


!---------- 單據輸出組合 ----------
<sub type="SELECT">


<include src="PRT.icf::FM101.sel" map="landscape=1;size=830:1170" />

</sub>
