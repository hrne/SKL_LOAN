----- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">

!#TXCD
!T(3,L6972)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,0)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,75)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,20)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)

#BUF2=X,11,S
T(2,1+          )

#ORGFG=_,_,S
E(0,0)

</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[120,850];printer.width=[20,20];">
[
["[L6972] 搬運資料"],
["@搬運種類",#InputType,#InputTypeX],
["@搬運方向",#InputRoute,#InputRouteX],
["@",#CustNoText,#InputCustNo],
["@",#FacmNoText,#InputFacmNo],
["@",#BormNoText,#InputBormNo],
]
!---------- AP Button AREA ----------
![Buttom資料查詢]
!#BTN1=X,15,I,ui:button;value:瀏覽;enable:0;tabbable:0
!#BTN2=X,15,I,ui:button;value:瀏覽;enable:0;tabbable:0
!#BTN3=X,15,I,ui:button;value:瀏覽;enable:0;tabbable:0
!ENABLE(#BTN1)ENABLE(#BTN2)ENABLE(#BTN3)
!---------- AP TEXT AREA Variables ----------

! Help
<include src="HELPRIM.icf::HELPRIM.rtn"/>

#RPTFG=A,1,S
E(0,0)

#HideThings=A,1,S
HIDE(#CustNoText)HIDE(#InputCustNo)HIDE(#FacmNoText)HIDE(#InputFacmNo)HIDE(#BormNoText)HIDE(#InputBormNo)

#InputTypeHelp=X,40,S
T(3,1:已結清並領取清償證明五年之交易明細)

#InputType=A,1,I
HELP(#InputTypeHelp)
@T(3,@InputTypeX,)
V(H,#InputTypeHelp)

#InputTypeX=X,40,L
T(H,#InputType,#InputTypeHelp)

#InputRouteHelp=X,50,S
T(3,0:連線環境至歷史環境;1:歷史環境至連線環境)

#InputRoute=A,1,I
HELP(#InputRouteHelp)
@T(3,@InputRouteX,)
V(H,#InputRouteHelp)
SWITCH(#InputRoute,0,HIDE(#CustNoText)HIDE(#InputCustNo)HIDE(#FacmNoText)HIDE(#InputFacmNo)HIDE(#BormNoText)HIDE(#InputBormNo),
                   1,SHOW(#CustNoText)SHOW(#InputCustNo)SHOW(#FacmNoText)SHOW(#InputFacmNo)SHOW(#BormNoText)SHOW(#InputBormNo),
                   $)

#InputRouteX=X,50,L
T(H,#InputRoute,#InputRouteHelp)

! 戶號文字
#CustNoText=X,4,L
T(3,戶號)

! 額度文字
#FacmNoText=X,4,L
T(3,額度)

! 撥款文字
#BormNoText=X,8,L
T(3,撥款序號)

! 戶號輸入
#InputCustNo=A,7,I
! InputRoute 為 0 時，代入 0 以防意外結果
@C(3,#InputRoute,1,V(5,1,9999999),E(0,0))

! 額度輸入
#InputFacmNo=A,3,I
! InputRoute 為 0 時，代入 0 以防意外結果
@C(3,#InputRoute,1,V(5,1,999),E(0,0))

! 撥款輸入
! InputRoute 為 0 時，代入 0 以防意外結果
#InputBormNo=A,3,I
@C(3,#InputRoute,1,V(5,1,999),E(0,0))

! 連動交易傳入參數:
! 執行種類
#NTXBUF=X,1,S
T(2,#InputType)
ASGN(NTXBUF$)

! 連動交易: L9729 產結果明細表
#NTXCD=X,5,S
T(3,L9729)ASGN(NTXCD$)
</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!---------- TXFORM = L6972 ----------
<sub type="FORM" name="L6972">

!#SCRPRT=_,_,S
!C(5,#TXFORM,L6972,$,S)

#SCRTIL=_,_,S
T(3,[L6972] 封存資料)

!------ TOM(HEAD)   Variables (FOR OUTPUT SCREEN) ------

!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------

#LOOP=X,1,S
T(3,1)ASGN(LOOP$)

</sub>


!------ 上行電文 ------
<sub type="TIM">
#InputType
#InputRoute
#InputCustNo
#InputFacmNo
#InputBormNo
#END
</sub>


!------ 下行電文TOM ------
<sub type="TOM">

TXFORM=L6972
^

<include src="HELPRIM.icf::HELPRIM.tom"/>
<include src="COM.icf::TRCTL.tom"/>
</sub>
!--------- OUTPUT畫面 --------
<sub type="PART" name="L6972" layout="cols=3;screen.width=[250,250,100,250];printer.width=[20,20,20,20];order=1">
[
["[L6972]                                   封存資料                                                                            "],
]
</sub>


!---------- 單據輸出組合 ----------
<sub type="SELECT">
<include src="PRT.icf::UPD01.sel"/>
</sub>
