----- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">

![一段式/二段式/三段式]
!#RELCD=_,_,S
!E(0,1)

!#ACTFG=_,_,S
!E(0,1)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD2.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[200,800];printer.width=[20,60];">
[
["[L6608]                                 報表代號對照檔維護"],
["#FdFuncCode+功能",#FuncCodeX],
["#FdFormNo+報表代號",#FormNo],
["#FdFormName+報表名稱",#FormName],
["#FdCycle+報表週期",#Cycle,#CycleX],
["#FdSignCode+簽核記號",#SignCode,#SignCodeX],
["#FdUsageDesc+用途說明",#UsageDesc],
["#FdWatermark+浮水印記號",#Watermark,#WatermarkX],
["#FdEnable+啟用記號",#Enable,#EnableX],
["#FdSendCode+寄送記號",#SendCode,#SendCodeX],
]
!---------- AP Button AREA ----------
![Buttom資料查詢]
!#BUF1=X,42,S

! 必輸欄位

! 永遠為必輸欄位
#FdFuncCode=X,2,L
T(3,*)
#FdFormNo=X,2,L
T(3,*)
#FdFormName=X,2,L
T(3,*)
#FdCycle=X,2,L
T(3,*)
#FdSendCode=X,2,L
T(3,*)
#FdSignCode=X,2,L
T(3,*)
#FdUsageDesc=X,2,L
T(3,*)
#FdWatermark=X,2,L
T(3,*)
#FdEnable=X,2,L
T(3,*)


!---------- AP TEXT AREA Variables ----------


#CHAIN=A,1,S
T(4,CHAIN$)
T(2,@RimTxCode,#TXCD)
IF(#CHAIN!=1,V(P,此為連動交易，請由L6068連動進入),$)

#NTXBUF=X,179,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)

#CHAIN_FuncCode=X,1,S
T(1,#NTXBUF,1,1)

#CHAIN_FormNo=X,10,S
T(1,#NTXBUF,2,10)

#CHAIN_FormName=x,80,S
T(1,#NTXBUF,12,80)

#CHAIN_Cycle=A,2,S
T(1,#NTXBUF,92,2)

#CHAIN_SendCode=A,1,S
T(1,#NTXBUF,94,1)

#CHAIN_Letter=A,1,S
T(1,#NTXBUF,95,1)

#CHAIN_Message=A,1,S
T(1,#NTXBUF,96,1)

#CHAIN_Email=A,1,S
T(1,#NTXBUF,97,1)

#CHAIN_SignCode=A,1,S
T(1,#NTXBUF,98,1)

#CHAIN_UsageDesc=x,80,S
T(1,#NTXBUF,99,80)

#CHAIN_Enable=X,1,S
T(1,#NTXBUF,179,1)


#CHAINSET=X,1,S
C(3,#CHAIN,1,$,S)
T(2,@FuncCode,#CHAIN_FuncCode)
C(3,#FuncCode,1,S,$)
T(2,@FormNo,#CHAIN_FormNo)

!---------------------------------
! Help
<include src="HELPRIM.icf::HELPRIM.rtn"/>

!FuncCode2(1:新增;2:修改;4:刪除)
#CODEFuncCode2=x,20,S                  
T(3,CdCode.FuncCode2)                  
#FuncCode2Help=x,50,S     

!報表週期
#CODERptCycle=x,20,S
T(3,CdCode.RptCycle)
#RptCycle=x,1000,S

!寄送記號
#CODERptSendCode=x,30,S
T(3,CdCode.RptSendCode)
#RptSendCode=x,1000,S

!簽核記號
#CODERptSignCode=x,30,S
T(3,CdCode.RptSignCode)
#RptSignCode=x,1000,S

!浮水印
#CODERptWaterCode=x,100,S
T(3,CdCode.RptWaterCode)
#RptWaterCode=x,1000,S

!啟用記號
#CODEEnableFg=x,20,S
T(3,CdCode.EnableFg)
#EnableFg=x,1000,S

#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#CODEFuncCode2,#CODERptCycle,#CODERptSendCode,#CODERptSignCode,#CODEEnableFg,#CODERptWaterCode)
R(1,XXR99)
CALL(#HelpProc)
T(2,@FuncCode2Help,#HelpDesc1)
T(2,@RptCycle,#HelpDesc2)
T(2,@RptSendCode,#HelpDesc3)
T(2,@RptSignCode,#HelpDesc4)
T(2,@EnableFg,#HelpDesc5)
T(2,@RptWaterCode,#HelpDesc6)
!---------------------------------

! 功能 必須輸入(1: 新增;2: 修改;4: 刪除)
#FuncCode=A,1,S
T(F,@FuncCode,0)
C(3,#CHAIN,1,s,$)
HELP(#FuncCode2Help)
@V(H,#FuncCode2Help)

#SetSysPar=X,1,S
C(3,#FuncCode,1,E(0,0),E(0,1))ASGN(AGAIN$)

#FuncCodeX=X,12,L
T(H,#FuncCode,#FuncCode2Help)
C(2,#FuncCode,$,K(MODIFYBUTTON,新增),K(MODIFYBUTTON,修改),$,K(MODIFYBUTTON,刪除))

#AGAIN=X,1,S
C(3,#FuncCode,4,$,S)
E(0,1)ASGN(AGAIN$)

#FUNCIND=_,_,S
E(0,#FuncCode)
<include src="COM.icf::CheckAuth.rtn"/>


!FuncCode=1,2 顯示框線
#WKTF=X,1,S
IF (#FuncCode==1 || #FuncCode==2 ,T(F,@FormName,1)T(F,@Cycle,1)T(F,@SendCode,1)T(F,@Letter,1)T(F,@Message,1)T(F,@Email,1)T(F,@SignCode,1)T(F,@UsageDesc,1)T(F,@Watermark,1)T(F,@Enable,1),
                                  T(F,@FormName,0)T(F,@Cycle,0)T(F,@SendCode,0)T(F,@Letter,0)T(F,@Message,0)T(F,@Email,0)T(F,@SignCode,0)T(F,@UsageDesc,0)T(F,@Watermark,0)T(F,@Enable,0))

IF (#FuncCode==1 ,T(F,@FormNo,1),T(F,@FormNo,0))
                  
#WKPSC=X,2,S

#WKSTAR=X,2,S
C(3,#CHAIN,1,S,T(3,*))

#WKSTAR1=X,2,S
C(3,#CHAIN,1,C(2,#FuncCode,S,T(3,*)),T(3,*))

#WKSTAR2=X,2,S
C(2,#FuncCode,S,T(3,*),T(3,*),S,S,S)

#WKNAME=X,1,S
T(2,@FdFuncCode,#WKSTAR)
T(2,@FdFormNo,#WKSTAR1)
T(2,@FdFormName,#WKSTAR2)
T(2,@FdCycle,#WKSTAR2)
T(2,@FdSendCode,#WKSTAR2)
T(2,@FdLetter,#WKSTAR2)
T(2,@FdMessage,#WKSTAR2)
T(2,@FdEmail,#WKSTAR2)
T(2,@FdSignCode,#WKSTAR2)
T(2,@FdUsageDesc,#WKSTAR2)
T(2,@FdEnable,#WKSTAR2)

! 報表代號
#FormNo=X,10,I
C(3,#CHAIN,1,C(3,#FuncCode,1,$,s),$)
C(2,#FuncCode,$,$,$,$,s,s)
@V(7)

#SendL6R31=X,1,S
E(0,@RimFuncCode,#FuncCode)
T(2,@RimL6R31FormNo,#FormNo)
RESET_RIM(#SendL6R31,L6R31)
S(L6R31,1,#RimFuncCode,#RimTxCode,#RimL6R31FormNo)
R(1,L6R31)

#RecL6R31=X,1,S
T(2,@FormName,#L6R31FormName)
E(0,@Cycle,#L6R31Cycle)
E(0,@SendCode,#L6R31SendCode)
E(0,@Letter,#L6R31Letter)
E(0,@Message,#L6R31Message)
E(0,@Email,#L6R31Email)
E(0,@SignCode,#L6R31SignCode)
T(2,@UsageDesc,#L6R31UsageDesc)
E(0,@Watermark,#L6R31Watermark)
T(2,@Enable,#L6R31Enable)
T(H,@CycleX,#Cycle,#RptCycle)
T(H,@SendCodeX,#SendCode,#RptSendCode)
T(H,@SignCodeX,#SignCode,#RptSignCode)
T(H,@WatermarkX,#Watermark,#RptWaterCode)
T(H,@EnableX,#Enable,#EnableFg)
C(3,#SendCode,2,INVOKEJS(SHOW,p2,1),INVOKEJS(SHOW,p2,0))

! 報表名稱
#FormName=x,80,I
C(2,#FuncCode,$,$,$,$,s,s)
@V(7)

! 報表週期
#Cycle=A,2,I
C(2,#FuncCode,$,$,$,$,s,s)
HELP(#RptCycle)
@V(H,#RptCycle)

#CycleX=X,20,L
!C(2,#FuncCode,$,$,$,$,s,s)
T(H,#Cycle,#RptCycle)


! 簽核記號
#SignCode=A,1,I
C(2,#FuncCode,$,$,$,$,s,s)
HELP(#RptSignCode)
@V(H,#RptSignCode)

#SignCodeX=X,20,L
!C(2,#FuncCode,$,$,$,$,s,s)
T(H,#SignCode,#RptSignCode)

! 用途說明
#UsageDesc=x,80,I
C(2,#FuncCode,$,$,$,$,s,s)
@V(7)

! 浮水印記號
#Watermark=A,1,I
C(2,#FuncCode,$,$,$,$,s,s)
HELP(#RptWaterCode)
@V(H,#RptWaterCode)

#WatermarkX=X,20,L
T(H,#Watermark,#RptWaterCode)

! 啟用記號
#Enable=X,1,I
C(2,#FuncCode,$,$,$,$,s,s)
HELP(#EnableFg)
@V(H,#EnableFg)

#EnableX=X,20,L
!C(2,#FuncCode,$,$,$,$,s,s)
T(H,#Enable,#EnableFg)

! 寄送記號
#SendCode=A,1,I
C(2,#FuncCode,$,$,$,$,s,s)
HELP(#RptSendCode)
@V(H,#RptSendCode)

#SendCodeX=X,40,L
!C(2,#FuncCode,$,$,$,$,s,s)
T(H,#SendCode,#RptSendCode)
C(3,#SendCode,2,INVOKEJS(SHOW,p2,1),INVOKEJS(SHOW,p2,0))

</sub>

<sub type="DC" name="p2" layout="cols=1;screen.width=[200,800];printer.width=[40,60];order=1;">
[
["設定寄送優先順序：書面、簡訊、EMAIL寄送請輸入優先序，若不寄送輸入0，優先序同為1時則同時寄送"],
["#FdLetter+書面寄送",#Letter],
["#FdMessage+簡訊寄送",#Message],
["#FdEmail+EMAIL寄送",#Email],
]

#FdLetter=X,2,L
C(2,#FuncCode,S,$,$,S,S,S)
C(3,#SendCode,2,T(3,*),S)

#FdMessage=X,2,L
C(2,#FuncCode,S,$,$,S,S,S)
C(3,#SendCode,2,T(3,*),S)

#FdEmail=X,2,L
C(2,#FuncCode,S,$,$,S,S,S)
C(3,#SendCode,2,T(3,*),S)

! 書面寄送
#Letter=A,1,I
C(2,#FuncCode,$,$,$,$,s,s)
C(3,#SendCode,2,$,S)
@V(1,0,1,2,3)


! 簡訊寄送
#Message=A,1,I
C(2,#FuncCode,$,$,$,$,s,s)
C(3,#SendCode,2,$,S)
C(3,#Letter,0,s,$)
@C(3,#SendCode,2,C(2,#Message,$,$,IF(#Letter==2,V(P,優先序重複),$),IF(#Letter==3,V(P,優先序重複),$)),$)
V(1,0,1,2,3)

! EMAIL寄送
#Email=A,1,I
C(2,#FuncCode,$,$,$,$,s,s)
C(3,#SendCode,2,$,S)
C(3,#Letter,0,s,$)
@C(3,#SendCode,2,C(2,#Email,$,$,IF(#Letter==2||#Message==2,V(P,優先序重複),$),IF(#Letter==3||#Message==3,V(P,優先序重複),$)),$)
V(1,0,1,2,3)

#RPTFG=A,1,S
E(0,0)

<include src="ROM.icf::L0Rim.dec"/>
<include src="ROM.icf::L6R31Rim.dec"/>
<include src="ROM.icf::L6R31.dec"/>
</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!---------- TXFORM = L6608 ----------
<sub type="FORM" name="L6608">

#SCRPRT=_,_,S
C(5,#TXFORM,L6608,$,S)

#SCRTIL=_,_,S
T(3,[L6608] 報表代號對照檔維護)

</sub>


!------ 上行電文 ------
<sub type="TIM">
#FuncCode#FormNo#FormName#Cycle#SendCode#Letter#Message#Email#SignCode#UsageDesc#Watermark#Enable
#END
</sub>


!------ 下行電文TOM ------
<sub type="TOM">

TXFORM=L6608

^

<include src="COM.icf::TRCTL.tom"/>
<include src="ROM.icf::L6R31.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
</sub>


!---------- 單據輸出組合 ----------
<sub type="SELECT">
<include src="PRT.icf::UPD01.sel"/>
</sub>
