----- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">

![一段式/二段式/三段式]
!#RELCD=_,_,S
!E(0,1)

!#ACTFG=_,_,S
!E(0,1)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD2.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[150,850];printer.width=[20,20];">
[
["[L6708]                                 利息收入預算數維護"],
["#FdFuncCode+功能",#FuncCodeX],
["#FdYear+預算年度",#Year],
["@ 1月份",#Budget1],
["@ 2月份",#Budget2],
["@ 3月份",#Budget3],
["@ 4月份",#Budget4],
["@ 5月份",#Budget5],
["@ 6月份",#Budget6],
["@ 7月份",#Budget7],
["@ 8月份",#Budget8],
["@ 9月份",#Budget9],
["@10月份",#Budget10],
["@11月份",#Budget11],
["@12月份",#Budget12],
["@  合計",#Total],
]
!---------- AP Button AREA ----------
![Buttom資料查詢]
!#BUF1=X,42,S

! 必輸欄位

! 永遠為必輸欄位
#FdFuncCode=X,2,L
T(3,*)
#FdYear=X,2,L
T(3,*)

!---------- AP TEXT AREA Variables ----------
<include src="HELPRIM.icf::HELPRIM.rtn"/>

!FuncCode2(1:新增;2:修改;4:刪除)
#CODEFuncCode2=x,20,S                  
T(3,CdCode.FuncCode2)                  
#FuncCode2Help=x,50,S     

#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#CODEFuncCode2)
R(1,XXR99)
CALL(#HelpProc)
T(2,@FuncCode2Help,#HelpDesc1)

#CHAIN=A,1,S
T(4,CHAIN$)
T(2,@RimTxCode,#TXCD)
IF(#CHAIN!=1,V(P,此為連動交易，請從交易:[L6078 利息收入預算數查詢]進入),$)

#NTXBUF=X,4,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)

#CHAIN_FuncCode=X,1,S
T(1,#NTXBUF,1,1)

#CHAIN_Year=A,3,S
T(1,#NTXBUF,2,3)

#CHAINSET=X,1,S
C(3,#CHAIN,1,$,S)
T(2,@FuncCode,#CHAIN_FuncCode)
C(3,#FuncCode,1,S,$)
T(2,@Year,#CHAIN_Year)


! 功能 必須輸入(1: 新增;2: 修改;4: 刪除)
#FuncCode=A,1,S
T(F,@FuncCode,0)
C(3,#CHAIN,1,s,$)
HELP(#FuncCode2Help)
@V(H,#FuncCode2Help)

#FuncCodeX=X,12,L
T(H,#FuncCode,#FuncCode2Help)
C(2,#FuncCode,$,K(MODIFYBUTTON,新增),K(MODIFYBUTTON,修改),$,K(MODIFYBUTTON,刪除))

#FUNCIND=_,_,S
E(0,#FuncCode)
<include src="COM.icf::CheckAuth.rtn"/>


!FuncCode=1,2 顯示框線
#WKTF=X,1,S
IF (#FuncCode==1 || #FuncCode==2 ,T(F,@Budget1,1)T(F,@Budget2,1)T(F,@Budget3,1)T(F,@Budget4,1)T(F,@Budget5,1)T(F,@Budget6,1)T(F,@Budget7,1)T(F,@Budget8,1)T(F,@Budget9,1)T(F,@Budget10,1)T(F,@Budget11,1)T(F,@Budget12,1)T(F,@Total,1),
                                  T(F,@Budget1,0)T(F,@Budget2,0)T(F,@Budget3,0)T(F,@Budget4,0)T(F,@Budget5,0)T(F,@Budget6,0)T(F,@Budget7,0)T(F,@Budget8,0)T(F,@Budget9,0)T(F,@Budget10,0)T(F,@Budget11,0)T(F,@Budget12,0)T(F,@Total,0))
IF (#FuncCode==1 ,T(F,@Year,1),T(F,@Year,0))

#WKPSC=X,2,S

#WKSTAR=X,2,S
C(3,#CHAIN,1,S,T(3,*))

#WKSTAR1=X,2,S
C(3,#CHAIN,1,C(2,#FuncCode,S,T(3,*)),T(3,*))

#WKSTAR2=X,2,S
C(2,#FuncCode,S,T(3,*),T(3,*),S,S,S)

#WKNAME=X,1,S
T(2,@FdFuncCode,#WKSTAR)
T(2,@FdYear,#WKSTAR1)


! 預算年度
#Year=A,3,I
C(3,#CHAIN,1,C(3,#FuncCode,1,$,s),$)
C(2,#FuncCode,$,$,$,$,s,s)
@V(7)V(2,0)


#SendL6R16=X,1,S
E(0,@RimFuncCode,#FuncCode)
T(2,@RimYear,#Year)
RESET_RIM(#SendL6R16,L6R16)
S(L6R16,1,#RimFuncCode,#RimTxCode,#RimYear)
R(1,L6R16)

#RecL6R16=X,1,S
E(0,@Budget1,#L6R16Budget1)
E(0,@Budget2,#L6R16Budget2)
E(0,@Budget3,#L6R16Budget3)
E(0,@Budget4,#L6R16Budget4)
E(0,@Budget5,#L6R16Budget5)
E(0,@Budget6,#L6R16Budget6)
E(0,@Budget7,#L6R16Budget7)
E(0,@Budget8,#L6R16Budget8)
E(0,@Budget9,#L6R16Budget9)
E(0,@Budget10,#L6R16Budget10)
E(0,@Budget11,#L6R16Budget11)
E(0,@Budget12,#L6R16Budget12)

! 1月份
#Month1=N,2,S
E(0,1)

#Budget1=m,14,I
C(2,#FuncCode,$,$,$,$,s,s)

! 2月份
#Month2=N,2,S
E(0,2)

#Budget2=m,14,I
C(2,#FuncCode,$,$,$,$,s,s)

! 3月份
#Month3=N,2,S
E(0,3)

#Budget3=m,14,I
C(2,#FuncCode,$,$,$,$,s,s)

! 4月份
#Month4=N,2,S
E(0,4)

#Budget4=m,14,I
C(2,#FuncCode,$,$,$,$,s,s)

! 5月份
#Month5=N,2,S
E(0,5)

#Budget5=m,14,I
C(2,#FuncCode,$,$,$,$,s,s)

! 6月份
#Month6=N,2,S
E(0,6)

#Budget6=m,14,I
C(2,#FuncCode,$,$,$,$,s,s)

! 7月份
#Month7=N,2,S
E(0,7)

#Budget7=m,14,I
C(2,#FuncCode,$,$,$,$,s,s)

! 8月份
#Month8=N,2,S
E(0,8)

#Budget8=m,14,I
C(2,#FuncCode,$,$,$,$,s,s)

! 9月份
#Month9=N,2,S
E(0,9)

#Budget9=m,14,I
C(2,#FuncCode,$,$,$,$,s,s)

! 10月份
#Month10=N,2,S
E(0,10)

#Budget10=m,14,I
C(2,#FuncCode,$,$,$,$,s,s)

! 11月份
#Month11=N,2,S
E(0,11)

#Budget11=m,14,I
C(2,#FuncCode,$,$,$,$,s,s)

! 12月份
#Month12=N,2,S
E(0,12)

#Budget12=m,14,I
C(2,#FuncCode,$,$,$,$,s,s)

#AGAIN=X,1,S
IF(#FuncCode==2 || #FuncCode==4,$,S)
E(0,1)ASGN(AGAIN$)

! 合計
#Total=m,14,L
E(0,#Budget1+#Budget2+#Budget3+#Budget4+#Budget5+#Budget6+#Budget7+#Budget8+#Budget9+#Budget10+#Budget11+#Budget12)

#RPTFG=A,1,S
E(0,0)

!參考編號
#MRKEY=_,_,S
T(2,#Year)

<include src="ROM.icf::L0Rim.dec"/>
<include src="ROM.icf::L6R16Rim.dec"/>
<include src="ROM.icf::L6R16.dec"/>
</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!---------- TXFORM = L6708 ----------
<sub type="FORM" name="L6708">

#SCRPRT=_,_,S
C(5,#TXFORM,L6708,$,S)

#SCRTIL=_,_,S
T(3,[L6708] 利息收入預算維護)

</sub>


!------ 上行電文 ------
<sub type="TIM">
#FuncCode
#Year
##loop{times:12,i:1}
#Month{i}
#Budget{i}
##end
#END
</sub>


!------ 下行電文TOM ------
<sub type="TOM">

TXFORM=L6708

^

<include src="COM.icf::TRCTL.tom"/>
<include src="ROM.icf::L6R16.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
</sub>


!---------- 單據輸出組合 ----------
<sub type="SELECT">
<include src="PRT.icf::UPD01.sel"/>
</sub>
