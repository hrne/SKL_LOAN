----- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">

![一段式/二段式/三段式]
!#RELCD=_,_,S
!E(0,1)

!#ACTFG=_,_,S
!E(0,1)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD2.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[150,850];printer.width=[20,30];">
[
["[L6703]                                 保險/鑑定公司資料維護"],
["#FdFuncCode+功能",#FuncCodeX],
["#FdInsurerType+公司種類",#InsurerType,#InsurerTypeX],
["#FdInsurerCode+公司代號",#InsurerCode],
["#FdInsurerItem+公司名稱",#InsurerItem],
["#FdInsurerShort+公司簡稱",#InsurerShort],
["#FdId+統一編號",#InsurerId],
["#FdTel+連絡電話",#TelArea,"-",#TelNo,"-",#TelExt],
]
!---------- AP Button AREA ----------
![Buttom資料查詢]
!#BUF1=X,42,S

! 必輸欄位

! 永遠為必輸欄位
#FdFuncCode=X,2,L
#FdInsurerType=X,2,L
#FdInsurerCode=X,2,L
#FdInsurerShort=X,2,L
#FdInsurerItem=X,2,L
#FdTel=X,2,L
#FdId=X,2,L

!---------- AP TEXT AREA Variables ----------
! Help
<include src="HELPRIM.icf::HELPRIM.rtn"/>

!FuncCode2(1:新增;2:修改;4:刪除)
#CODEFuncCode2=x,20,S                  
T(3,CdCode.FuncCode2)                  
#FuncCode2Help=x,50,S     

!公司種類
#CODEInsurerType=x,20,S
T(3,CdCode.InsurerType)
#InsurerTypeHelp=x,100,S

#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#CODEFuncCode2,#CODEInsurerType)
R(1,XXR99)
CALL(#HelpProc)
T(2,@FuncCode2Help,#HelpDesc1)
T(2,@InsurerTypeHelp,#HelpDesc2)

#CHAIN=A,1,S
T(4,CHAIN$)
T(2,@RimTxCode,#TXCD)
IF(#CHAIN!=1,V(P,此為連動交易，請從交易:[L6073 保險/鑑定公司資料查詢]進入),$)

#NTXBUF=X,124,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)

#CHAIN_FuncCode=X,1,S
T(1,#NTXBUF,1,1)

#CHAIN_InsurerType=X,1,S
T(1,#NTXBUF,2,1)

#CHAIN_InsurerCode=X,2,S
T(1,#NTXBUF,3,2)

#CHAIN_InsurerItem=x,80,S
T(1,#NTXBUF,5,80)

#CHAIN_InsurerShort=x,20,S
T(1,#NTXBUF,85,20)

#CHAIN_TelArea=X,5,S
T(1,#NTXBUF,105,5)

#CHAIN_TelNo=X,10,S
T(1,#NTXBUF,110,10)

#CHAIN_TelExt=X,5,S
T(1,#NTXBUF,120,5)

#CHAINSET=X,1,S
C(3,#CHAIN,1,$,S)
T(2,@FuncCode,#CHAIN_FuncCode)
C(3,#FuncCode,1,S,$)
T(2,@InsurerType,#CHAIN_InsurerType)
T(2,@InsurerCode,#CHAIN_InsurerCode)
T(2,@InsurerItem,#CHAIN_InsurerItem)
T(2,@InsurerShort,#CHAIN_InsurerShort)
T(2,@TelArea,#CHAIN_TelArea)
T(2,@TelNo,#CHAIN_TelNo)
T(2,@TelExt,#CHAIN_TelExt)

! 功能 必須輸入(1: 新增;2: 修改;4: 刪除)
#FuncCode=A,1,S
T(F,@FuncCode,0)
C(3,#CHAIN,1,s,$)
HELP(#FuncCode2Help)
@V(H,#FuncCode2Help)

#FuncCodeX=X,12,L
T(H,#FuncCode,#FuncCode2Help)
C(2,#FuncCode,$,K(MODIFYBUTTON,新增),K(MODIFYBUTTON,修改),$,K(MODIFYBUTTON,刪除))

#AGAIN=X,1,S
IF(#FuncCode==4 || #FuncCode==2,$,S)
E(0,1)ASGN(AGAIN$)

#FUNCIND=_,_,S
E(0,#FuncCode)
<include src="COM.icf::CheckAuth.rtn"/>


!FuncCode=1,2 顯示框線
#WKTF=X,1,S
IF (#FuncCode==1 ||#FuncCode==2 ,T(F,@InsurerItem,1)T(F,@InsurerShort,1)T(F,@TelArea,1)T(F,@TelNo,1)T(F,@TelExt,1)T(F,@InsurerId,1),
                                 T(F,@InsurerItem,0)T(F,@InsurerShort,0)T(F,@TelArea,0)T(F,@TelNo,0)T(F,@TelExt,0)T(F,@InsurerId,0))
IF (#FuncCode==1 ,T(F,@InsurerType,1)T(F,@InsurerCode,1),
                  T(F,@InsurerType,0)T(F,@InsurerCode,0))

#WKPSC=X,2,S

#WKSTAR=X,2,S
C(3,#CHAIN,1,S,T(3,*))

#WKSTAR1=X,2,S
C(3,#CHAIN,1,C(2,#FuncCode,S,T(3,*)),T(3,*))

#WKSTAR2=X,2,S
C(2,#FuncCode,S,T(3,*),T(3,*),S,S,S)

#WKSTAR3=X,2,S
C(2,#FuncCode,S,T(3, ),T(3, ),S,S,S)

#WKNAME=X,1,S
T(2,@FdFuncCode,#WKSTAR)
T(2,@FdInsurerType,#WKSTAR1)
T(2,@FdInsurerCode,#WKSTAR1)
T(2,@FdInsurerItem,#WKSTAR2)
T(2,@FdInsurerShort,#WKSTAR2)
T(2,@FdTel,#WKSTAR3)

! 公司種類
#InsurerType=X,1,I
C(3,#CHAIN,1,C(3,#FuncCode,1,$,s),$)
C(3,#FuncCode,4,s)
HELP(#InsurerTypeHelp)
@T(3,@InsurerTypeX,)
V(H,#InsurerTypeHelp)

#InsurerTypeX=X,8,L
C(4,#InsurerType,S,$)
T(3, )
T(H,#InsurerType,#InsurerTypeHelp)

! 公司代號
#InsurerCode=X,2,I
C(3,#CHAIN,1,C(3,#FuncCode,1,$,s),$)
C(3,#FuncCode,4,s)
@
V(7)V(NL)
!A(ID_UNINO,0,#InsurerCode)


#RimL6R10InsurerType=X,1,S
#RimL6R10InsurerCode=X,8,S

#SendL6R10=X,1,S
E(0,@RimFuncCode,#FuncCode)
T(2,@RimL6R10InsurerType,#InsurerType)
T(2,@RimL6R10InsurerCode,#InsurerCode)
RESET_RIM(#SendL6R10,L6R10)
S(L6R10,1,#RimFuncCode,#RimTxCode,#RimL6R10InsurerType,#RimL6R10InsurerCode)
R(1,L6R10)
T(2,@InsurerItem,#L6R10InsurerItem)
T(2,@InsurerShort,#L6R10InsurerShort)
T(2,@TelArea,#L6R10TelArea)
T(2,@TelNo,#L6R10TelNo)
T(2,@TelExt,#L6R10TelExt)
T(2,@InsurerId,#L6R10InsurerId)

! 公司名稱
#InsurerItem=x,80,I
C(3,#FuncCode,4,s)	
@V(7)

! 公司簡稱
#InsurerShort=x,20,I
C(3,#FuncCode,4,s)
@V(7)

#InsurerId=X,8,I
C(3,#FuncCode,4,s)
@
C(4,#InsurerId,$,A(ID_UNINO,0,#InsurerId))

! 連絡電話
#TelArea=X,5,I
C(3,#FuncCode,4,s)
@C(4,#TelArea,S,$)
V(9)

#TelNo=X,10,I
C(3,#FuncCode,4,s)
@C(4,#TelNo,S,$)
V(9)

#TelExt=X,5,I
C(3,#FuncCode,4,s)
@C(4,#TelExt,S,$)
V(9)

#RPTFG=A,1,S
E(0,0)

!參考編號
#MRKEY=_,_,S
T(2,#InsurerType+-+#InsurerCode)

<include src="ROM.icf::L0Rim.dec"/>
!<include src="ROM.icf::L6R10Rim.dec"/>
<include src="ROM.icf::L6R10.dec"/>
</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!---------- TXFORM = L6703 ----------
<sub type="FORM" name="L6703">

#SCRPRT=_,_,S
C(5,#TXFORM,L6703,$,S)

#SCRTIL=_,_,S
T(3,[L6703] 保險/鑑定公司資料維護)

</sub>

!------ 上行電文 ------
<sub type="TIM">
#FuncCode#InsurerType#InsurerCode#InsurerItem#InsurerShort#TelArea#TelNo#TelExt#InsurerId
#END
</sub>

!------ 下行電文TOM ------
<sub type="TOM">

TXFORM=L6703

^

<include src="COM.icf::TRCTL.tom"/>
<include src="ROM.icf::L6R10.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">
<include src="PRT.icf::UPD01.sel"/>
</sub>
