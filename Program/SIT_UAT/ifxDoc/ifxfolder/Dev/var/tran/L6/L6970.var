!---------- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">



![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,0)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,88)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,20)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)
</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD2.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)

</sub>

<sub type="DC" name="p1" layout="cols=1;screen.width=[120,880];printer.width=[15,45];order=1;">
[
["[L6970] 批次執行結果查詢"],
["@執行結果篩選",#Choice,#ChoiceItem],
["@執行日期區間",#InputStartDate,#InputEndDate],
]

!---------- AP Button AREA ----------
![Buttom資料查詢]
! 功能 必須輸入(1: 新增;2: 修改;4: 刪除;5: 查詢)
#FUNCIND=_,_,S
E(0,5)

#CHAIN=A,1,S
T(4,CHAIN$)

#NTXBUF=X,6,S

#HideAll=A,1,S

!---------- AP TEXT AREA Variables ----------
#Choice=A,1,I
HELP(0:全部;
     1:成功;
     2:失敗)
@V(1,0,1,2)

! [執行結果篩選]
#ChoiceItem=X,20,L
SWITCH(#Choice,0,T(3,全部),
               1,T(3,成功),
               2,T(3,失敗)
)

! [執行日期區間-起日]
#InputStartDate=D,7,I
E(0,#SYSCDATE)
@A(4,0,#InputStartDate)
V(5,0,#SYSCDATE)

! [執行日期區間-迄日]
#InputEndDate=D,7,I
E(0,#SYSCDATE)
@A(4,0,#InputEndDate)
V(5,#InputStartDate,#SYSCDATE)

#RPTFG=A,1,S
E(0,0)

</sub>


!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>


!---------- TXFORM = L6970 ----------
<sub type="FORM" name="L6970">

#SCRTIL=_,_,S
T(3,[L6970] 夜間批次控制檔查詢)

#LOOP=X,1,S
T(3,1)ASGN(LOOP$)

!批次執行日期
#OOExecDate=D,7,L
!批次代號
#OOJobCode=x,10,L
!步驟代號
#OOStepId=x,30,L
!執行結果
#OOStatus=x,1,L
#OOStatusX=x,10,L
SWITCH(#OOStatus,S,T(3,成功),
                 F,T(3,失敗),
                 T(3,))
!啟動時間 yyyy-MM-dd hh:mm:ss
#OOStepStartTime=x,20,L
!結束時間 yyyy-MM-dd hh:mm:ss
#OOStepEndTime=x,20,L

</sub>

!------ 上行電文TIM：BASIC LABEL + AP TEXT AREA + AP TEXT ------
<sub type="TIM">
#Choice
#InputStartDate
#InputEndDate
#END
</sub>

!------ 下行電文TOM ------
<sub type="TOM">
<include src="COM.icf::TRCTL.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
TXFORM=L6970
#OOExecDate
#OOJobCode
#OOStepId
#OOStatus
#OOStepStartTime
#OOStepEndTime
^

</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">
#RPTFG=0,QUERY.GRID,L6970
#any={detail:true, header:'L6970.part', caption:'', width:1005, rowNum:20, rowList:[20,40,60]}

#OOExecDate=批次執行日期
{width:160,align:'center'}

#OOJobCode=批次代號
{width:120,align:'left'}

#OOStepId=步驟代號
{width:180,align:'left'}

#OOStatusX=執行結果
{width:100,align:'left'}

#OOStepStartTime=啟動時間
{width:120,align:'center'}

#OOStepEndTime=結束時間
{width:120,align:'center'}
^
</sub>
