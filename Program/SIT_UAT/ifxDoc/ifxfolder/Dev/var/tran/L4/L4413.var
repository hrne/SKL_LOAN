!---------- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">
!#TXCD
!T(3,L4413)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,0)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,87)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,40)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="L4413" layout="cols=1;screen.width=[130,870];printer.width=[20,80];order=1">
[
["[L4413]@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@產生郵局授權資料"],
[#<->#,"@提出日期",#ACHSENDINDATE],
]
#CHAIN=A,1,S
T(4,CHAIN$) 

! 提出日期
#ACHSENDINDATE=D,7,I

![顯示方式]
#RPTFG=A,1,S
E(0,0)

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!------------ TXFORM = L4413 -----------
<sub type="FORM" name="L4413">
#LOOP=X,1,S
E(0,1)ASGN(LOOP$)

! 戶號
#OOCUSTNO=A,7,O
! 額度
#OOFACMNO=A,3,O
! 產生日期
#OOPRODUCEDATE=D,7,O
! 帳戶別
#OOACCTFG=X,1,O
#OOACCTFGX=X,4,O
SWITCH(#OOACCTFG,P,T(3,存簿),G,T(3,劃撥))

! 扣款帳號
#OOREPAYACCTNO=A,14,O
! 提出日期
#OOACHSENDINDATE=D,7,O
! 提回日期
#OOACHSENDBKDATE=D,7,O
! 提回訊息
#OONOTE=X,20,O

#secret-no=X,85,S

#batch-detail=x,100000,S

#batch-print=A,1,S

!#batch-rows 總筆數
#batch-rows=X,2,S

!#batch-rows-selected 勾選之筆數
#batch-rows-selected=X,2,S

!#batch-rows-ok  傳送成功筆數
#batch-rows-ok=X,2,S

!#batch-rows-error 傳送失敗筆數
#batch-rows-error=X,2,S

!#batch-row-status 該列傳送狀態
#batch-row-status=X,50,S

!#batch-row-txtno 該列傳送序號
#batch-row-txtno=X,14,O
</sub>

!------ 上行電文 TEXT ------
<sub type="TIM">
#ACHSENDINDATE#END
</sub>

!------ 下行電文TOM ------
<sub type="TOM">
<include src="COM.icf::TRCTL.tom"/>
TXFORM=L4413
#OOCUSTNO#OOFACMNO#OOPRODUCEDATE#OOACCTFG#OOREPAYACCTNO#OOACHSENDINDATE#OOACHSENDBKDATE#OONOTE
^
</sub>


!---------- 單據輸出組合 ----------
<sub type="SELECT">
#batch-print=1,L4413.PFNX,NA,,,,,,1169:827
^

#YN=9,QUERY.GRID,L4413
#any={caption:'[L4413]',width:1200,rowNum:40,
ifxBatch:{
	name:'批次執行',
	type:'5',
	rim:'L4413',
	txtno:'#secret-no',
	pfnx:"L4413.PFNX",
	col_captions:["總筆數","勾選之筆數","傳送成功筆數","傳送失敗筆數","放行傳輸序號","放行狀態"],
	col_names:["#batch-rows","#batch-rows-selected","#batch-rows-ok","#batch-rows-error","#batch-row-txtno","#batch-row-status"]
	}
}

#secret-no

#OOCUSTNO=戶號
{width:70}
#OOFACMNO=額度
{width:40}
#OOPRODUCEDATE=產生日期
{width:70}
#OOACCTFGX=帳戶別
{width:90}
#OOREPAYACCTNO=扣款帳號
{width:90}
#OOACHSENDINDATE=提出日期
{width:70}
#OOACHSENDBKDATE=提回日期
{width:70}
#OONOTE=提回訊息
{width:220}

^
</sub>
