----- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">

!#TXCD
!T(3,L4060)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,0)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,297)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,20)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

#button=x,1,S
K(MODIFYBUTTON,查詢)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)




</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="L4060" layout="cols=1;screen.width=[130,870];printer.width=[];">
[
["[L4060]                                 額度擔保品保險單關聯查詢"],
["#FdFunctionCode+查詢選項",#FunctionCode,#FunctionCodeX],
["#FdCustNo+戶號",#CustNo,"-",#FacmNo,#BTN1,#CustNm],
["#FdClCode1+擔保品編號",#ClCode1,"-",#ClCode2,"-",#ClNo],
]
!---------- AP Button AREA ----------
![Buttom資料查詢]
#BTN1=X,15,I,ui:button;value:額度資料查詢;enable:1;tabbable:0

!---------- AP TEXT AREA Variables ----------

#FdFunctionCode=X,2,L
T(3,*)
#FdCustNo=X,2,L
T(3,*)
#FdClCode1=X,2,L

#CHAIN=A,1,S
T(4,CHAIN$)

#NTXBUF=X,20,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
T(1,@FunctionCode,#NTXBUF,1,1)

#C1=X,1,S
C(3,#CHAIN,1,$,S)
C(3,#FunctionCode,1,$,S)
T(1,@CustNo,#NTXBUF,2,7)
T(1,@FacmNo,#NTXBUF,9,3)

#C2=X,1,S
C(3,#CHAIN,1,$,S)
C(3,#FunctionCode,2,$,S)
T(1,@ClCode1,#NTXBUF,2,1)
T(1,@ClCode2,#NTXBUF,3,2)
T(1,@ClNo,#NTXBUF,5,7)

! 查詢選項
#FunctionHelp=x,20,S
T(3,1:戶號;2:擔保品編號)

#FunctionCode=A,1,I
C(3,#CHAIN,1,s,$)
HELP(#FunctionHelp)
@V(H,#FunctionHelp)
#FunctionCodeX=X,10,L
T(3,)T(H,#FunctionCode,#FunctionHelp)
!SWITCH(#FunctionCode,1,T(2,戶號),
!                   2,T(2,擔保品編號))

#COLDIS=A,1,S
C(3,#FunctionCode,1,INVOKEJS(SHOW,L4060_2,1)INVOKEJS(SHOW,L4060_3,0),INVOKEJS(SHOW,L4060_2,0)INVOKEJS(SHOW,L4060_3,1))

#RimCustId=X,10,S

#RimCustNo=A,7,S

#ExistFlag=X,1,S

#RimEntryCode=A,1,S

#BindCustNo=X,14,S
T(2,#CustNo+#CustNo)
#BIND1=X,1,S
BIND(#BTN1,click, {cmd=CHAIN; ntxcd=L2015; ntxbuf=#BindCustNo;ntxbuf5=type<-1:FacmNo<-OOFacmNo:CustNo<-OOCustNo})

! 戶號
#CustNo=A,7,I
C(3,#CHAIN,1,s,$)
C(3,#FunctionCode,1,$,S)
@E(0,@RimEntryCode,2)
@V(2,0)

<include src="ROM.icf::L4R02.dec"/>

#RimL4r02_CustNo=X,1,S
C(3,#CHAIN,1,s,$)
C(3,#FunctionCode,1,$,s)
E(0,@RimCustNo,#CustNo)
RESET_RIM(#RimL4r02_CustNo,L4R02)
S(L4R02,1,#RimCustId,#RimCustNo,#RimEntryCode)
R(1,L4R02)
T(2,@CustNm,#L4r02CustName)

! 調rim
#CustNm=X,100,L
C(3,#FunctionCode,1,$,S)

! 額度號碼
#FacmNo=A,3,I
C(3,#CHAIN,1,s,$)
C(3,#FunctionCode,1,$,S)

#MRKEY=_,_,S
C(3,#CustNo,0,S,$)
C(3,#FacmNo,0,T(2,#CustNo),T(2,#CustNo+-+#FacmNo)) 

! 擔保品編號
#ClCode1=A,1,I
C(3,#CHAIN,1,s,$)
C(3,#FunctionCode,2,$,S)
@V(2,0)

#ClCode2=A,2,I
C(3,#CHAIN,1,s,$)
C(3,#FunctionCode,2,$,S)
@V(2,0)

#ClNo=A,7,I
C(3,#CHAIN,1,s,$)
C(3,#FunctionCode,2,$,S)
@V(2,0)

#RPTFG=A,1,S
C(3,#FunctionCode,1,E(0,2),E(0,3))

#CHAINXMT=X,1,S
C(3,#CHAIN,1,E(0,@CHAIN,0)XMT(),$)

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>


!---------- TXFORM = L4060 ----------
<sub type="FORM" name="L4060">

!#SCRPRT=_,_,S
!C(5,#TXFORM,L4060,$,S)


#SCRTIL=_,_,S
T(3,[L4060] 額度擔保品保險單關聯)


! O1
#OHCustNo=A,7,L
IF(#CustNo == 0,S,T(2,#CustNo))
#OHFacmNo=A,3,L
IF(#CustNo == 0,S,T(2,#FacmNo))
#OHCustNm=X,100,L
IF(#CustNo == 0,S,T(2,#CustNm))

! O2
#OHClCode1=A,1,L
IF(#CustNo == 0,T(2,#ClCode1),S)
#OHClCode2=A,2,L
IF(#CustNo == 0,T(2,#ClCode2),S)
#OHClNo=A,7,L
IF(#CustNo == 0,T(2,#ClNo),S)

!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------
#LOOP=X,1,S
T(3,1)ASGN(LOOP$)
! 戶號
#OOCustNo=A,7,S

#OOFacmNo=A,3,S

! 戶名
#OOCustNm=X,100,L

! 擔保品編號
#OOClCode1=A,1,S

#OOClCode2=A,2,S

#OOClNo=A,7,S

! 鑑價總值
! #OOEvaAmt=鑑價總值
! {width:140,align:'right'}
! #OOEvaAmt=m,14,L
#OONEWINSU=X,1,S
#OODTLINSU=X,1,S

! 建物門牌
#OOBdLocation=x,100,L

! 核准額度
#OOLineAmt=m,14,L

! 貸放金額
#OODrawdownAmt=m,14,L

! 貸放餘額
#OOLoanBalance=m,14,L

! 狀態
#OOStatus=X,10,L

! 核准日期
#OOApproveDate=D,7,L

! 保單號碼
#OONowInsuNo=X,16,L

#OOCustNoLB=X,11,L
T(2,#OOCustNo+-+#OOFacmNo)

#OOClNoLB=X,12,L
T(2,#OOClCode1+-+#OOClCode2+-+#OOClNo)

! 新保:1 、 自保:2
#OOBUF_CREATE=X,12,S
T(2,1+#OOClCode1+#OOClCode2+#OOClNo)

#OOBUF_DETAIL=X,20,S
T(2,#OOClCode1+#OOClCode2+#OOClNo+#OOCustNo+#OOFacmNo)

#OOBTN_CREATE=X,1,S
C(5,#OONEWINSU,Y,BIND(grid,{ cmd=CHAIN; ntxcd=L4610;ntxbuf=#OOBUF_CREATE}),
BIND(grid,cancel))

#OOBTN_DETAIL=X,1,S
C(5,#OODTLINSU,Y,BIND(grid,{ cmd=CHAIN; ntxcd=L4964;ntxbuf=#OOBUF_DETAIL}),
BIND(grid,cancel))


</sub>


!------ 上行電文 ------
<sub type="TIM">
#FunctionCode
#CustNo
#FacmNo
#ClCode1
#ClCode2
#ClNo
#END
</sub>


!------ 下行電文TOM ------
<sub type="TOM">
TXFORM=L4060
#OOCustNo
#OOFacmNo
#OOCustNm
#OOClCode1
#OOClCode2
#OOClNo
#OONEWINSU
#OODTLINSU
#OOBdLocation
#OOLineAmt
#OODrawdownAmt
#OOLoanBalance
#OOStatus
#OOApproveDate
#OONowInsuNo
^
<include src="COM.icf::TRCTL.tom"/>
<include src="ROM.icf::L4R02.tom"/>
</sub>

!---------- 單據輸出組合 ----------
<sub type="PART" prompt='{{#SCRTIL}} world' name="L4060" layout="cols=1;screen.width=[100,900];order=1;">
[
["[L4060]@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@額度擔保品保險單關聯查詢"],
[""],

]
</sub>

<sub type="SELECT">

#RPTFG=2,QUERY.GRID
#any={detail:true, header:'L4060.part',caption:'', rowNum:20, rowList:[20,40,60]}

#OOBTN_CREATE=
{width:50,search:false,formatter:'cust:bind-button:新保單;L4610 保險單明細資料登錄',align:'center',canExport:false}

#OOBTN_DETAIL=
{width:65,search:false,formatter:'cust:bind-button:保單明細;L4964 不動產保險單資料查詢',align:'center',canExport:false}

#OOCustNoLB=戶號
{width:100,align:'center'}

#OOCustNm=戶名
{width:100,align:'left'}

#OOClNoLB=擔保品編號
{width:100,align:'center'}

#OOBdLocation=建物門牌
{width:140,align:'left'}

#OOApproveDate=核准日期
{width:100,align:'center'}

#OOLineAmt=核准額度
{width:140,align:'right'}

#OODrawdownAmt=貸放金額
{width:140,align:'right'}

#OOLoanBalance=貸放餘額
{width:140,align:'right'}

#OOStatus=狀態
{width:50,align:'center'}

^

#RPTFG=3,QUERY.GRID
#any={detail:true, header:'L4060.part',caption:'', rowNum:20, rowList:[20,40,60]}

#OOBTN_CREATE=
{width:50,search:false,formatter:'cust:bind-button:新保單;L4610 保險單明細資料登錄',align:'center',canExport:false}

#OOBTN_DETAIL=
{width:65,search:false,formatter:'cust:bind-button:保單明細;L4964 不動產保險單資料查詢',align:'center',canExport:false}

#OOCustNoLB=戶號
{width:100,align:'center'}

#OOCustNm=戶名
{width:100,align:'left'}

#OOClNoLB=擔保品編號
{width:100,align:'center'}

#OOBdLocation=建物門牌
{width:140,align:'right'}

#OOApproveDate=核准日期
{width:100,align:'center'}

#OOLineAmt=核准額度
{width:140,align:'right'}

#OODrawdownAmt=貸放金額
{width:140,align:'right'}

#OOLoanBalance=貸放餘額
{width:140,align:'right'}

#OOStatus=狀態
{width:50,align:'center'}

^

</sub>
