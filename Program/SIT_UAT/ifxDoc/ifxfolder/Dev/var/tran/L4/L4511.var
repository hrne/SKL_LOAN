!---------- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">
!#TXCD
!T(3,L4511)
</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="L4511" layout="cols=1;screen.width=[130,870];printer.width=[20,80];order=1">
[
["[L4511]@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@產出員工扣薪媒體檔"],
[#<->#,"#FdMediaDate+媒體檔日期",#MediaDate],
[#<->#,"#FdFunctionCode+查詢選項",#FunctionCode,#FunctionCodeX],
]

#FdMediaDate=X,2,L
T(3,*)

#FdFunctionCode=X,2,L
T(3,*)

#CHAIN=A,1,S
T(4,CHAIN$) 

#NTXBUF=X,8,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
T(1,@FunctionCode,#NTXBUF,7,1)

#NEXT_DATE=D,8,S
T(4,NBSDY$)


! 會計日期
#MediaDate=D,7,I
E(0,#SYSDATE)
@
V(7)A(DATE,0,#MediaDate)

! 查詢選項
#FunctionHelp=x,20,S
T(3,1:15日薪;2:非15日薪)

#FunctionCode=A,1,I
HELP(#FunctionHelp)
@V(H,#FunctionHelp)
#FunctionCodeX=X,10,L
T(3,)T(H,#FunctionCode,#FunctionHelp)
</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!------------ TXFORM = L4511 -----------
<sub type="FORM" name="L4511">
</sub>

!------ 上行電文 TEXT ------
<sub type="TIM">
#MediaDate
#FunctionCode
</sub>

!------ 下行電文TOM ------
<sub type="TOM">
<include src="COM.icf::TRCTL.tom"/>
TXFORM=L4511

^
</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">
<include src="PRT.icf::UPD01.sel"/>
</sub>
