!---------- BASIC LABEL Variables ----------
<sub type="SYS">
![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,0)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,0)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,40)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)
</sub>

<sub type="SYS" name="label">
!#TXCD
!T(3,L4602)
</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="L4602" layout="cols=1;screen.width=[150,850];printer.width=[20,80];order=1">
[
["[L4602]@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@火險出單明細表與媒體"],
[#<->#,"#FdInsuEndMonth+火險到期年月",#InsuEndMonth],
]

#FdInsuEndMonth=X,2,L
T(3,*)

#CHAIN=A,1,S
T(4,CHAIN$) 

#NEXT_MONTH=D,8,S
D(7,2,#SYSDATE,1,0)

#COLDIS=A,1,S
T(1,@InsuEndMonth,#NEXT_MONTH,2,5)

#CheckDays=m,2,S
T(1,#SYSDATE,7,2)

! 火險到期年月 15號前為當月，15號後為下個月
#InsuEndMonth=A,5,I
IF(#CheckDays<15,T(1,#SYSDATE,2,5),T(1,#NEXT_MONTH,2,5))
@A(YM,1,#InsuEndMonth)

#RPTFG=A,1,S
E(0,0)
</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!------------ TXFORM = L4602 -----------
<sub type="FORM" name="L4602">

#LOOP=X,1,S
E(0,1)ASGN(LOOP$)

</sub>

!------ 上行電文 TEXT ------
<sub type="TIM">
#InsuEndMonth
#END
</sub>

!------ 下行電文TOM ------
<sub type="TOM">
<include src="COM.icf::TRCTL.tom"/>
TXFORM=L4602
^
</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">
<include src="PRT.icf::INQ01.sel"/>


</sub>
