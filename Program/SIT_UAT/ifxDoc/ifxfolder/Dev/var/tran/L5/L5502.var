!---------- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">
![一段式/二段式/三段式]
#RELCD=_,_,S
E(0,1)

#ACTFG=_,_,S
C(2,#FKEY,E(0,1),$)

</sub>

<sub type="PREDC" name="PreDC">

<include src="COM.icf::TITLE-RUN.pre"/>

</sub>


<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="L5502" layout="cols=3;screen.width=[180,350,180,350];printer.width=[20,80];order=1">
[
["[L5502]                                 房貸專員件數金額資料維護"],
["#<->#,"#FdFunCode+功能選項",#FunCodeX],
["#<->#,"#FdCustNo+借款人戶號",#CustNo,"-",#FacmNo,"-",#BormNo],
["#<->#,"#FdCustNm+戶名",#CustNm],
["#<->#,"#FdIntroducer+介紹人",#Introducer,#IntroducerName],
["#<->#,"#FdBsOfficer+房貸專員",#BsOfficer,#BsOfficerName],
["#<->#,"#FdPerfAmt+業績金額",#PerfAmt],
["#<->#,"#FdPerfCnt+業績件數",#PerfCnt],
["@","※僅可異動本月資料！"],["工作年月",#WorkMonth],
]


<include src="HELPRIM.icf::HELPRIM.rtn"/>

!不可重新交易
#AGAIN=X,1,S
E(0,1)ASGN(AGAIN$)

!FuncCode1(1:新增;2:修改;4:刪除;5:查詢)
#CODEFuncCode1=x,20,S                  
T(3,CdCode.FuncCode1)                  
#FuncCode1Help=x,50,S
!
#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#CODEFuncCode1)
R(1,XXR99)
CALL(#HelpProc)
T(2,@FuncCode1Help,#HelpDesc1)

![Buttom資料查詢]
!#BtnEmpno=X,15,I,ui:button;value:員工資料查詢;enable:1;tabbable:0;title:L190A 員工資料檔查詢;

#CHAIN=A,1,S
T(4,CHAIN$) 
IF(#CHAIN==0,V(P,本交易為連動交易，請由L5052連動進入),$)


! 連動L5052
#NTXBUF=X,21,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
T(1,@FunCode,#NTXBUF,1,1)
T(1,@LogNo,#NTXBUF,2,8)

#FdFunCode=X,2,L
#FdCustNo=X,2,L
#FdCustNm=X,2,L
#FdIntroducer=X,2,L
#FdBsOfficer=X,2,L
#FdPerfCnt=X,2,L
C(3,#FunCode,2,T(3,*),$)
#FdPerfAmt=X,2,L
C(3,#FunCode,2,T(3,*),$)

#Tf=x,1,S
C(3,#FunCode,4,$,S)
T(F,@PerfCnt,0)
T(F,@PerfAmt,0)

#LogNo=A,8,S
#AdjLogNo=A,8,S

! FuncCode1(1:新增;2:修改;4:刪除;5:查詢)
#FunCode=A,1,S

![維護記號名稱]
#FunCodeX=X,4,L
!C(3,#FunCode,2,T(3,調整),T(H,#FunCode,#FuncCode1Help))
T(H,#FunCode,#FuncCode1Help)
K(MODIFYBUTTON,#FunCodeX)
C(3,#FunCode,5,K(NOBUTTON,CLOSEY),$)

<include src="ROM.icf::L5R29.dec"/>
#RimCustNo=A,7,S
#RimFacmNo=A,3,S
#RimBormNo=A,3,S
#RimPerfDate=D,7,S

#RimL5r29=X,1,S
C(3,#CHAIN,1,$,S)
RESET_RIM(#RimL5r29,L5R29)
S(L5R29,1,#LogNo)
R(1,L5R29)
E(0,@CustNo,#L5r29CustNo)
E(0,@FacmNo,#L5r29FacmNo)
E(0,@BormNo,#L5r29BormNo)
T(2,@CustNm,#L5r29CustNm)
E(0,@WorkMonth,#L5r29WorkMonth)
T(2,@Introducer,#L5r29Introducer)
T(2,@IntroducerName,#L5r29IntroducerName)
T(2,@BsOfficer,#L5r29BsOfficer)
T(2,@BsOfficerName,#L5r29BsOfficerName)
E(0,@PerfCnt,#L5r29PerfCnt)
E(0,@PerfAmt,#L5r29PerfAmt)
E(0,@AdjLogNo,#L5r29AdjLogNo)


! 借款人戶號
#CustNo=A,7,L
! C(2,#FUNCTIONCD,S,$,s,s,s,s)

! 額度編號
#FacmNo=A,3,L
! C(2,#FUNCTIONCD,S,$,s,s,s,s)

! 撥款序號
#BormNo=A,3,L
! C(2,#FUNCTIONCD,S,$,s,s,s,s)

!工作年月
#WorkMonth=X,5,L

#MRKEY=_,_,S
T(2,#CustNo+-+#FacmNo+-+#WorkMonth)

! 戶名
#CustNm=X,2.100,L


! 介紹人NM
#Introducer=X,6,L
#IntroducerName=X,50,L

! 房貸專員NM
#BsOfficer=X,6,L
#BsOfficerName=X,50,L


<include src="ROM.icf::L5R28.dec"/>
#RimEmployeeNo=X,6,S
#RimErrorSkip=X,1,S


! 調整後業績金額
#PerfAmt=+m,15,I
C(3,#FunCode,2,$,s)

! 調整後件數
#PerfCnt=+m,5.1,I
C(3,#FunCode,2,$,s)

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!------------ TXFORM = L5502 -----------
<sub type="FORM" name="L5502">
</sub>

!------ 上行電文 TEXT ------
<sub type="TIM">
#FunCode
#LogNo
#CustNo
#FacmNo
#BormNo
#PerfAmt
#PerfCnt
#AdjLogNo
</sub>

!------ 下行電文TOM ------
<sub type="TOM">
<include src="COM.icf::TRCTL.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
<include src="ROM.icf::L5R28.tom"/>
<include src="ROM.icf::L5R29.tom"/>
TXFORM=L5502
^
</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">
<include src="PRT.icf::UPD01.sel"/>
</sub>
