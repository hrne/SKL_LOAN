!---------- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">
!#TXCD
!T(3,L5902)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,0)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,682)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,40)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)

#button=x,100,S
T(2,{cmd=CHAIN; ntxcd=L5102; ntxbuf=1; ntxbuf5=type})ASGN(BTN_NEW1$)
K(MODIFYBUTTON,1,新增資料)
K(MODIFYBUTTON,查詢)

</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="L5902" layout="cols=1;screen.width=[130,870];printer.width=[20,80];order=1">
[
["[L5902]                                 授信審議委員會會議紀錄明細資料查詢"],
[#<->#,"#FdMeetingDateFrom+日期",#MeetingDateFrom,"~",#MeetingDateTo],
]

#FdMeetingDateFrom=X,2,L
T(3,*)

#CHAIN=A,1,S
T(4,CHAIN$) 

<include src="HELPRIM.icf::HELPRIM.rtn"/>
! 功能下拉選單
#EntCodeRimName=x,20,S
T(3,CdCode.InnEntCode)
#EntCodeHelpRim=X,1,S
RESET_RIM(#EntCodeHelpRim,XXR99)
S(XXR99,01,#EntCodeRimName)
R(1,XXR99)
CALL(#HelpProc)
T(2,@InnEntCodeHelp,#HelpDesc1)
#InnEntCodeHelp=x,1024,S

#NTXBUF=X,14,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
T(1,@MeetingDateFrom,#NTXBUF,1,7)
T(1,@MeetingDateTo,#NTXBUF,8,7)

#TODAY=A,7,S
T(1,#SYSCDATE,2,7)
E(0,@MeetingDateFrom,#TODAY)
E(0,@MeetingDateTo,#TODAY)

#TmpDateFrom=A,7,S
E(0,0)
#TmpDateTo=A,7,S
E(0,0)

! 日期
#MeetingDateFrom=D,7,I
C(3,#CHAIN,0,$,s)
@V(7)
A(DATE,0,#MeetingDateFrom)
E(0,@TmpDateFrom,0)
E(0,@TmpDateFrom,#MeetingDateFrom)


! 日期
#MeetingDateTo=D,7,I
C(3,#CHAIN,0,$,s)
@V(7)
A(DATE,0,#MeetingDateTo)
E(0,@TmpDateTo,0)
E(0,@TmpDateTo,#MeetingDateTo)
IF(#TmpDateFrom>#TmpDateTo,V(P,起日不可大於迄日),$)

#RPTFG=A,1,S

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!------------ TXFORM = L5902 -----------
<sub type="FORM" name="L5902">
#SCRTIL=_,_,S
T(3,[L5902] 授信審議委員會會議紀錄明細資料)
#LOOP=X,1,S
E(0,1)ASGN(LOOP$)

! 日期
#OOMeetingDate=D,7,O
! 事項
#OOCustCode=A,1,O
#OOCustCodeX=X,100,O
C(3,#OOCustCode,0,S,T(H,@OOCustCodeX,#OOCustCode,#InnEntCodeHelp))
! 項次
#OOCustCnt=m,4,O
! 金額
#OOAmount=m,14,O
! 當日合計
#OODaySumAmt=m,14,O
! 流水號
#OOMeetNo=A,6,S
! 議題
#OOIssue=X,50,O
! 備註
#OORemark=x,500,O

#Convert=A,1,O
T(2,@OOAmountX,#OOAmount)

#OOAmountX=X,14,O

! 異動日期
#OOLastUpdate=X,30,L

! 異動人員
#OOLastUpdateEmpNo=X,6,L
#OOLastUpdateEmpNoX=X,50,L

#OOLastUpdateEmpNo_Combine=X,57,L
T(2,#OOLastUpdateEmpNo+ +#OOLastUpdateEmpNoX)

! 1+7+1+14+6=29 +550 = 579
#OOBUF_EDIT=x,579,S
T(2,2+#OOMeetingDate+#OOCustCode+#OOAmountX+#OOMeetNo+#OOIssue+#OORemark)
#OOBUF_DELETE=x,579,S
T(2,4+#OOMeetingDate+#OOCustCode+#OOAmountX+#OOMeetNo+#OOIssue+#OORemark)
#OOBUF_SEARCH=x,579,S
T(2,5+#OOMeetingDate+#OOCustCode+#OOAmountX+#OOMeetNo+#OOIssue+#OORemark)


#OOBTN_EDIT=A,2,O
BIND(grid,{ cmd=CHAIN; ntxcd=L5102; ntxbuf=#OOBUF_EDIT})
#OOBTN_DELETE=A,2,O
BIND(grid,{ cmd=CHAIN; ntxcd=L5102; ntxbuf=#OOBUF_DELETE})
#OOBTN_SEARCH=A,2,O
BIND(grid,{ cmd=CHAIN; ntxcd=L5102; ntxbuf=#OOBUF_SEARCH})

</sub>

!------ 上行電文 TEXT ------
<sub type="TIM">
#MeetingDateFrom
#MeetingDateTo
#END
</sub>

!------ 下行電文TOM ------
<sub type="TOM">
<include src="COM.icf::TRCTL.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
TXFORM=L5902
#OOMeetingDate
#OOCustCode
#OOCustCnt
#OOAmount
#OODaySumAmt
#OOMeetNo
#OOIssue
#OORemark
#OOLastUpdate
#OOLastUpdateEmpNo
#OOLastUpdateEmpNoX
^
</sub>

!---------- 單據輸出組合 ----------
<sub type="PART" prompt='{{#SCRTIL}} world' name="L5902" layout="cols=1;screen.width=[130,870];order=1;">
[
["[L5902]                                 授信審議委員會會議紀錄明細資料查詢"],
[""],
]
</sub>

<sub type="SELECT">

#RPTFG=0,QUERY.GRID,L5902
#any={detail:true, header:'L5902.part', caption:'', width:1000, rowNum:20, rowList:[20,40,60]}

#OOBTN_EDIT=
{search:false,formatter:'cust:bind-button:修改',align:'center',canExport:false,width:35}
#OOBTN_DELETE=
{search:false,formatter:'cust:bind-button:刪除',align:'center',canExport:false,width:35}
#OOBTN_SEARCH=
{search:false,formatter:'cust:bind-button:查詢',align:'center',canExport:false,width:35}
#OOCustCnt=項次
{width:45}
#OOMeetingDate=日期
{width:65,align:'center'}
#OOIssue=議題
{width:250}
#OOCustCodeX=事項
{width:200,align:'left'}
#OOAmount=金額(千元)
{width:105}
#OODaySumAmt=當日合計(千元)
{width:140}
#OORemark=備註
{width:105}
#OOLastUpdate=異動時間
{width:130}
#OOLastUpdateEmpNo_Combine=異動人員
{width:105}
^
</sub>
