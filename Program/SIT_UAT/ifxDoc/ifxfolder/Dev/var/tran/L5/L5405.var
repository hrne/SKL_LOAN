!---------- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">
!#TXCD
!T(3,L5405)
</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="L5405" layout="cols=1;screen.width=[160,840];printer.width=[20,80];order=1">
[
["[L5405]                                 更改目標金額、累計目標金額"],
[#<->#,"#FdFunctionCdX+功能",#FunctionCdX],
["#FdMain+請選擇輸入條件",#Director],
["#FdUnitCode+單位代號",#UnitCode,#UnitCodeBTN],["#FdUnitItem+單位中文",#UnitItem],
["#FdDistCode+區部代號",#DistCode,#DistCodeBTN],["#FdDistItem+區部中文",#DistItem],
["#FdDeptCode+部室代號",#DeptCode,#DeptCodeBTN],["#FdDeptItem+部室中文",#DeptItem],
["#FdDirectorCode+處長主任別",#DirectorCode,#DirectorCodeX],
["#FdEmpNo+員工代號",#EmpNo],["#FdEmpName+員工姓名",#EmpName],
[#<->#,"#FdDepartOfficer+專員姓名",#DepartOfficer,#BTNB],
["#FdGoalCnt+目標件數",#GoalCnt],["#FdSumGoalCnt+累計目標件數",#SumGoalCnt],
["#FdGoalAmt+目標金額",#GoalAmt],["#FdSumGoalAmt+累計目標金額",#SumGoalAmt],
]
!---------- AP TEXT AREA Variables ----------
!功能
<include src="HELPRIM.icf::HELPRIM.rtn"/>
#FuncCodeRimName=x,20,S
T(3,CdCode.FunctionCd)
#FuncHelp=x,1024,S

#DirectorCodeHelpRimName=x,30,S
T(3,CdCode.DirectorCode)
#DirectorCodeHelp=x,1024,S

#FuncHelpRim=X,1,S
RESET_RIM(#FuncHelpRim,XXR99)
S(XXR99,01,#FuncCodeRimName,#DirectorCodeHelpRimName)
R(1,XXR99)
CALL(#HelpProc)
T(2,@FuncHelp,#HelpDesc1)
T(2,@DirectorCodeHelp,#HelpDesc2)

#CHAIN=A,1,S
T(4,CHAIN$) 
IF(#CHAIN!=1,V(P,此為連動交易，請從交易:L5024進入),$)

#NTXBUF=X,210,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
T(1,@FunctionCd,#NTXBUF,1,1)
T(1,@UnitCode,#NTXBUF,2,6)
T(1,@UnitItem,#NTXBUF,8,40)
T(1,@DistCode,#NTXBUF,48,6)
T(1,@DistItem,#NTXBUF,54,40)
T(1,@DeptCode,#NTXBUF,94,6)
T(1,@DeptItem,#NTXBUF,100,40)
T(1,@DirectorCode,#NTXBUF,140,1)
T(1,@EmpNo,#NTXBUF,141,6)
T(1,@EmpName,#NTXBUF,147,8)
T(1,@DepartOfficer,#NTXBUF,155,8)
T(1,@GoalCnt,#NTXBUF,163,5)
T(1,@SumGoalCnt,#NTXBUF,168,5)
T(1,@GoalAmt,#NTXBUF,173,14)
T(1,@SumGoalAmt,#NTXBUF,187,14)
T(H,@FunctionCdX,#FunctionCd,#FuncHelp)
T(H,@DirectorCodeX,#DirectorCode,#DirectorCodeHelp)
C(2,#FunctionCd,$,K(MODIFYBUTTON,新增),K(MODIFYBUTTON,修改),K(MODIFYBUTTON,新增),K(MODIFYBUTTON,刪除))
HIDE(#UnitCodeBTN)HIDE(#DistCodeBTN)HIDE(#DeptCodeBTN)
C(3,#FunctionCd,4,HIDE(#BTNB),$)

#FdFunctionCdX=X,1,L
T(2, )
#FdMain=X,1,L
T(2, )
#FdUnitCode=X,1,L
T(2,*)
#FdUnitItem=X,1,L
T(2,)
#FdDistCode=X,1,L
T(2,*)
#FdDistItem=X,1,L
T(2, )
#FdDeptCode=X,1,L
T(2,*)
#FdDeptItem=X,1,L
T(2, )
#FdDirectorCode=X,1,L
T(2, )
#FdEmpNo=X,1,L
T(2,*)
#FdEmpName=X,1,L
T(2, )
#FdDepartOfficer=X,1,L
T(2, )
#FdGoalCnt=X,1,L
T(2, )
#FdSumGoalCnt=X,1,L
T(2, )
#FdGoalAmt=X,1,L
T(2, )
#FdSumGoalAmt=X,1,L
T(2, )

! 作業項目
#FunctionCd=A,1,S
E(0,@FUNCIND,#FunctionCd)
T(H,@FunctionCdX,#FunctionCd,#FuncHelp)

#FunctionCdX=X,4,L


#Init=X,1,S
IF(#FunctionCd==2 ,T(2,@FdUnitCode, )T(2,@FdDistCode, )T(2,@FdDeptCode, ),$)
IF(#FunctionCd==4 ,T(2,@FdUnitCode, )T(2,@FdDistCode, )T(2,@FdDeptCode, )T(2,@FdEmpNo, ),$)


!刪除隱藏重新交易按鈕
#AGAIN=X,1,S
C(3,#FunctionCd,1,S,$)
E(0,1)ASGN(AGAIN$)

!顯示框線
#WKTF=X,1,S
C(3,#FunctionCd,2,T(F,@UnitCode,0)T(F,@DistCode,0)T(F,@DeptCode,0),$)
C(3,#FunctionCd,4,T(F,@UnitCode,0)T(F,@DistCode,0)T(F,@DeptCode,0)T(F,@DirectorCode,0)
                  T(F,@EmpNo,0)T(F,@EmpName,0)T(F,@DepartOfficer,0)T(F,@WorkMonth,0)T(F,@GoalCnt,0)
                  T(F,@SumGoalCnt,0)T(F,@GoalAmt,0)T(F,@SumGoalAmt,0),$)

#OpenDirsctor=X,1,S
C(3,#FunctionCd,1,INVOKEJS(SHOW,L5405,02,02,1),INVOKEJS(SHOW,L5405,02,02,0))

! 輸入條件
#Director=X,1,I
C(3,#FunctionCd,1,$,S)
T(2,@UnitCode, )T(2,@UnitItem, )T(2,@DistCode, )T(2,@DistItem, )T(2,@DeptCode, )T(2,@DeptItem, )
C(3,#FunctionCd,1,INVOKEJS(SHOW,L5405,03,08,0),$)
HELP(#DirectorCodeHelp)
@V(H,#DirectorCodeHelp)
C(5,#Director,M,INVOKEJS(SHOW,L5405,03,04,1),$)
C(5,#Director,B,INVOKEJS(SHOW,L5405,05,06,1),$)
C(5,#Director,D,INVOKEJS(SHOW,L5405,07,08,1),$)
! 單位代號
#UnitCodeBTN=X,1,I,ui:button;value:單位代號查詢;enable:1;tabbable:0
#UnitCodeBUF=X,6,S
#UnitCodeBIND=X,1,S
BIND(#UnitCodeBTN,click, {cmd=CHAIN; ntxcd=L6086; ntxbuf=#UnitCodeBUF;ntxbuf5=type<-1:UnitCode<-OOUnitCode:DistCode<-OODistCode:DeptCode<-OODeptCode:UnitItem<-OOUnitItem:DistItem<-OODistItem:DeptItem<-OODeptItem})

#UnitCode=X,6,I
C(2,#FunctionCd,s,$,s,s,s)
C(5,#Director,M,$,s)
@V(7)
<include src="ROM.icf::L5R14.dec"/>     
#RimAreaCode=X,6,S
#RimChoose=X,1,S
#RimL5R14=X,1,S
T(2,@RimAreaCode,#UnitCode)
T(2,@RimChoose,1)
C(4,#UnitCode,S,$)
C(3,#FunctionCd,1,$,S)
RESET_RIM(#RimL5R14,L5R14)
S(L5R14,1,#RimAreaCode,#RimChoose)
R(1,L5R14)
T(2,@EmpNo,#L5R14UnitManager)
T(2,@EmpName,#L5R14EmpName)
T(2,@DeptCode,#L5R14DeptCode)
T(2,@DistCode,#L5R14DistCode)
T(2,@UnitItem,#L5R14AreaItem)
T(2,@DeptItem,#L5R14DeptItem)
T(2,@DistItem,#L5R14DistItem)
T(2,@DirectorCode,#L5R14DirectorCode)
T(H,@DirectorCodeX,#DirectorCode,#DirectorCodeHelp)
! 單位中文
#UnitItem=x,40,L

! 區部代號
#DistCodeBTN=X,1,I,ui:button;value:區部代號查詢;enable:1;tabbable:0
#DistCodeBUF=X,6,S
#DistCodeBIND=X,1,S
BIND(#DistCodeBTN,click, {cmd=CHAIN; ntxcd=L6086; ntxbuf=#DistCodeBUF;ntxbuf5=type<-1:DistCode<-OODistCode})

#DistCode=X,6,I
C(2,#FunctionCd,s,$,s,s,s)
C(5,#Director,B,$,s)
@V(7)
#RimDistCode=X,6,S
T(2,@RimDistCode,#DistCode)
T(2,@RimChoose,2)
C(3,#FunctionCd,1,$,S)
C(4,#UnitCode,$,s)
C(4,#DistCode,S,$)
RESET_RIM(#RimL5R14,L5R14)
S(L5R14,1,#RimDistCode,#RimChoose)
R(1,L5R14)
T(2,@EmpNo,#L5R14DistManager)
T(2,@EmpName,#L5R14EmpName)
T(2,@DeptCode,#L5R14DeptCode)
T(2,@DistCode,#L5R14DistCode)
T(2,@UnitItem,#L5R14AreaItem)
T(2,@DeptItem,#L5R14DeptItem)
T(2,@DistItem,#L5R14DistItem)
T(2,@DirectorCode,#L5R14DirectorCode)
T(H,@DirectorCodeX,#DirectorCode,#DirectorCodeHelp)
! 區部中文
#DistItem=x,40,L  

! 部室代號
#DeptCodeBTN=X,1,I,ui:button;value:部室代號查詢;enable:1;tabbable:0
#DeptCodeBUF=X,6,S
#DeptCodeBIND=X,1,S
BIND(#DeptCodeBTN,click, {cmd=CHAIN; ntxcd=L6086; ntxbuf=#DeptCodeBUF;ntxbuf5=type<-1:DeptCode<-OODeptCode})

#DeptCode=X,6,I
C(2,#FunctionCd,s,$,s,s,s)
C(5,#Director,D,$,s)
@V(7)
#RimDeptCode=X,6,S
T(2,@RimDeptCode,#DeptCode)
T(2,@RimChoose,3)
C(3,#FunctionCd,1,$,S)
C(4,#UnitCode,$,s)
C(4,#DistCode,$,s)
C(4,#DeptCode,S,$)
RESET_RIM(#RimL5R14,L5R14)
S(L5R14,1,#RimDeptCode,#RimChoose)
R(1,L5R14)
T(2,@EmpNo,#L5R14DeptManager)
T(2,@EmpName,#L5R14EmpName)
T(2,@DeptCode,#L5R14DeptCode)
T(2,@DistCode,#L5R14DistCode)
T(2,@UnitItem,#L5R14AreaItem)
T(2,@DeptItem,#L5R14DeptItem)
T(2,@DistItem,#L5R14DistItem)
T(2,@DirectorCode,#L5R14DirectorCode)
T(H,@DirectorCodeX,#DirectorCode,#DirectorCodeHelp)
! 部室中文
#DeptItem=x,40,L

! 處長主任別
#DirectorCode=X,1,L

#DirectorCodeX=X,10,L

! 員工代號
#EmpNo=X,6,I
C(3,#FunctionCd,4,s,$)
@V(7)

<include src="ROM.icf::L5R06.dec"/>     
#RimL5R06=X,1,S
#CdEmpRimEmpNo=X,6,S
T(2,#EmpNo)
RESET_RIM(#RimL5R06,L5R06)
S(L5R06,1,#CdEmpRimEmpNo)
R(1,L5R06)
T(2,@EmpName,#L5R06FullName)

! 員工姓名
#EmpName=X,8,L

#BTNB=X,1,I,ui:button;value:員工資料查詢;enable:1;tabbable:0
#BTNBBUF=X,7,S
T(3,      Y)
#BINDB=X,1,S
BIND(#BTNB,click, {cmd=CHAIN; ntxcd=L190A; ntxbuf=#BTNBBUF;ntxbuf5=type<-1:DepartOfficer<-OOFullname})

! 專員姓名
#DepartOfficer=X,8,I
C(3,#FunctionCd,4,s,$)

! 目標件數
#GoalCnt=m,4,I
C(3,#FunctionCd,4,s,$)
@V(7)
! 累計目標件數
#SumGoalCnt=m,5,I
C(3,#FunctionCd,4,s,$)
@V(7)
! 目標金額
#GoalAmt=m,14,I
C(3,#FunctionCd,4,s,$)
@V(7)
! 累計目標金額
#SumGoalAmt=m,14,I
C(3,#FunctionCd,4,s,$)
@V(7)


</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!------------ TXFORM = L5405 -----------
<sub type="FORM" name="L5405">
</sub>

!------ 上行電文 TEXT ------
<sub type="TIM">
#FunctionCd
#GoalAmt
#SumGoalAmt
#UnitCode
#DistCode
#DeptCode
#DirectorCode
#UnitItem
#DistItem
#DeptItem
#EmpNo
#EmpName
#DepartOfficer
#GoalCnt
#SumGoalCnt
#END
</sub>

!------ 下行電文TOM ------
<sub type="TOM">
<include src="COM.icf::TRCTL.tom"/>
<include src="ROM.icf::L5R14.tom"/>
<include src="ROM.icf::L5R06.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
TXFORM=L5405

^
</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">
</sub>
