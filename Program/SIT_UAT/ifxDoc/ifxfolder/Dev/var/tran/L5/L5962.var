!---------- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">
!#TXCD
!T(3,L5962)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,0)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,707)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,40)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
K(MODIFYBUTTON,查詢)
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="L5962" layout="cols=1;screen.width=[130,870];printer.width=[20,80];order=1">
[
["[L5962]                                 面催明細資料查詢"],
[#<->#,"@案件種類",#CaseCode,#CaseCodeX],
[#<->#,"@借款人戶號",#CustNo,#CustNoX],
[#<->#,"@額度編號",#FacmNo],
[#<->#,"@項目",#DateFlag,#DateFlagX],
]
!---------- AP TEXT AREA Variables ----------

#CHAIN=A,1,S
T(4,CHAIN$) 
IF(#CHAIN!=1,V(P,此為連動交易),$)

#NTXBUF=X,11,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
T(1,@CaseCode,#NTXBUF,1,1)
T(1,@CustNo,#NTXBUF,2,7)
T(1,@FacmNo,#NTXBUF,9,3)
INVOKEJS(SHOW,p1,02,02,1)

<include src="HELPRIM.icf::HELPRIM.rtn"/>
! 案件種類下拉選單1
#CaseCodeRimName=x,20,S
T(3,CdCode.CaseCode)
#CaseCodeHelp=x,1024,S

! 項目期間下拉選單2
#DateFlagRimName=x,20,S
T(3,CdCode.DateFlag)
#DateFlagHelp=x,1024,S

! 面催對象下拉選單3
#ContactCodeRimName=x,20,S
T(3,CdCode.ContactCode)
#ContactCodeHelp=x,1024,S

! 面晤人下拉選單4
#MeetPsnCodeRimName=x,20,S
T(3,CdCode.MeetPsnCode)
#MeetPsnCodeHelp=x,1024,S

! 面催地址下拉選單5
#MeetPlaceCodeRimName=x,20,S
T(3,CdCode.MeetPlaceCode)
#MeetPlaceCodeHelp=x,1024,S

! 催收人員類別下拉選單6
#AccCollPsnCodeRimName=x,25,S
T(3,CdCode.AccCollPsnCode)
#AccCollPsnCodeHelp=x,1024,S

#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#CaseCodeRimName,#DateFlagRimName,#ContactCodeRimName,#MeetPsnCodeRimName,#MeetPlaceCodeRimName,#AccCollPsnCodeRimName)
R(1,XXR99)
CALL(#HelpProc)
T(2,@CaseCodeHelp,#HelpDesc1)
T(2,@DateFlagHelp,#HelpDesc2)
T(2,@ContactCodeHelp,#HelpDesc3)
T(2,@MeetPsnCodeHelp,#HelpDesc4)
T(2,@MeetPlaceCodeHelp,#HelpDesc5)
T(2,@AccCollPsnCodeHelp,#HelpDesc6)


! 案件種類
#CaseCode=A,1,I
HELP(#CaseCodeHelp)
@V(H,#CaseCodeHelp)
#CaseCodeX=X,4,L
T(H,#CaseCode,#CaseCodeHelp)

! 借款人戶號
#CustNo=A,7,I
! C(3,#CHAIN,0,$,s)
@V(2,0)

! 借款人戶名----調RIM
#CustNoX=X,20,L

! 額度編號
#FacmNo=A,3,I
! C(3,#CHAIN,0,$,s)
C(3,#CaseCode,2,S,$)
@V(2,0)

#MRKEY=_,_,S
C(3,#CustNo,0,S,$)
C(3,#FacmNo,0,T(2,#CustNo),T(2,#CustNo+-+#FacmNo)) 

! 項目
#DateFlag=A,1,I
HELP(#DateFlagHelp)
@V(H,#DateFlagHelp)
#DateFlagX=X,9,L
T(H,#DateFlag,#DateFlagHelp)


#RPTFG=A,1,S

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!------------ TXFORM = L5962 -----------
<sub type="FORM" name="L5962">
#SCRTIL=_,_,S
T(3,[L5962] 面催明細資料)

#LOOP=X,1,S
E(0,1)ASGN(LOOP$)

! 面催日期
#OOMeetDate=D,7,O
! 面催時間
#OOMeetTime=X,4,O
! 聯絡對象
#OOContactCode=A,1,O
#OOContactCodeX=X,6,O
C(1,#OOContactCode,S,S,$)
T(H,#OOContactCode,#ContactCodeHelp)

! 面晤人
#OOMeetPsnCode=A,1,O
#OOMeetPsnCodeX=X,6,O
C(1,#OOMeetPsnCode,S,S,$)
T(H,#OOMeetPsnCode,#MeetPsnCodeHelp)
! 催收人員
#OOCollPsnCode=A,1,O
#OOCollPsnCodeX=X,6,O
T(H,#OOCollPsnCode,#AccCollPsnCodeHelp)
! 催收人員姓名
#OOCollPsnName=X,6,O
#OOCollPsnNameX=X,40,O
#Space=X,1,S
T(2, )
#CollNameCombine=X,47,S
T(2,#OOCollPsnName+#Space+#OOCollPsnNameX)
! 面催地點
#OOMeetPlace=X,60,O
! 其他記錄(160)
#OORemark=X,10.50,O
! 增修人員
#OOEditEmpNo=X,6,O
#OOEditEmpNoX=X,40,S
#EditEmpCombine=X,47,S
T(2,#OOEditEmpNo+#Space+#OOEditEmpNoX)
! 登放序號
#OOActSeq=X,20,O
! 交易序號
#OOTitaTxtNo=X,8,L
! 經辦
#OOTitaTlrNo=X,6,L
! 系統日期
#OOTitaAcDate=X,7,L

! 1+7+3+1 +7+5+1+1+1+2+60+160+6+20=275
#OOBUF_EDIT=X,296,S
T(2,2+#CaseCode+#CustNo+#FacmNo+#OOTitaTlrNo+#OOTitaTxtNo+#OOTitaAcDate)
#OOBUF_COPY=X,296,S
T(2,3+#CaseCode+#CustNo+#FacmNo+#OOTitaTlrNo+#OOTitaTxtNo+#OOTitaAcDate)
#OOBUF_DELETE=X,586,S
T(2,4+#CaseCode+#CustNo+#FacmNo+#OOTitaTlrNo+#OOTitaTxtNo+#OOTitaAcDate)
#OOBUF_SEARCH=X,296,S
T(2,5+#CaseCode+#CustNo+#FacmNo+#OOTitaTlrNo+#OOTitaTxtNo+#OOTitaAcDate)

#OOBTN_EDIT=A,2,O
BIND(grid,{ cmd=CHAIN; ntxcd=L5602; ntxbuf=#OOBUF_EDIT})
#OOBTN_COPY=A,2,O
BIND(grid,{ cmd=CHAIN; ntxcd=L5602; ntxbuf=#OOBUF_COPY})
#OOBTN_DELETE=A,2,O
BIND(grid,{ cmd=CHAIN; ntxcd=L5602; ntxbuf=#OOBUF_DELETE})
#OOBTN_SEARCH=A,2,O
BIND(grid,{ cmd=CHAIN; ntxcd=L5602; ntxbuf=#OOBUF_SEARCH})

</sub>

!------ 上行電文 TEXT ------
<sub type="TIM">
#CustNo#FacmNo#DateFlag#CaseCode
#END
</sub>

!------ 下行電文TOM ------
<sub type="TOM">
<include src="COM.icf::TRCTL.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
TXFORM=L5962
#OOMeetDate#OOMeetTime#OOContactCode#OOMeetPsnCode#OOCollPsnCode#OOCollPsnName#OOCollPsnNameX#OOMeetPlace#OORemark#OOEditEmpNo#OOActSeq#OOTitaTxtNo#OOTitaTlrNo#OOTitaAcDate
#OOEditEmpNoX
^
</sub>


!---------- 單據輸出組合 ----------
<sub type="PART" prompt='{{#SCRTIL}} world' name="L5962" layout="cols=1;screen.width=[130,870];order=1;">
[
["[L5962]                                 面催明細資料查詢                                                                               "],
! [#<->#,"@借款人戶號",#CustNo,#CustNoX],
! [#<->#,"@額度編號",#FacmNo],
! [#<->#,"@項目",#DateFlag,#DateFlagX],
! [#<->#,"@案件種類",#CaseCode,#CaseCodeX],
]
</sub>

<sub type="SELECT">

#RPTFG=0,QUERY.GRID,L5962
#any={detail:true, header:'L5962.part', caption:'', width:1020, rowNum:20, rowList:[20,40,60]}

#OOBTN_EDIT=修改
{search:false,formatter:'cust:bind-button:修改',align:'center',canExport:false,width:40}
#OOBTN_COPY=複製
{search:false,formatter:'cust:bind-button:複製',align:'center',canExport:false,width:40}
#OOBTN_DELETE=刪除
{search:false,formatter:'cust:bind-button:刪除',align:'center',canExport:false,width:40}
#OOBTN_SEARCH=查詢
{search:false,formatter:'cust:bind-button:查詢',align:'center',canExport:false,width:40}

#OOMeetDate=面催日期
{width:80,align:'center'}
#OOMeetTime=面催時間
{width:80,align:'center'}
#OOContactCodeX=聯絡對象
{width:80,align:'center'}
#OOMeetPsnCodeX=面晤人
{width:60}
#OOCollPsnCodeX=催收人員
{width:80}
#CollNameCombine=催收人員姓名
{width:120}
#OOMeetPlace=面催地點
{width:80}
#OORemark=其他記錄
{width:80}
#EditEmpCombine=增修人員
{width:80,align:'center'}
#OOActSeq=登放序號
{width:80,align:'center'}
#OOTitaTlrNo=
{width:1,hidden:true}
#OOTitaTxtNo=
{width:1,hidden:true}
#OOTitaAcDate=
{width:1,hidden:true}
^
<include src="PRT.icf::INQ04.sel" map="i=L5962;cpi=15"/>
#CustNo#FacmNo#DateFlag#CaseCode
%
#OOMeetDate#OOMeetTime#OOContactCode#OOMeetPsnCode#OOCollPsnCode#OOCollPsnName#OOMeetPlace#OORemark#OOEditEmpNo#OOActSeq
@^
</sub>
