!---------- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">
!#TXCD
!T(3,L5061)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,0)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,40)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,40)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="L5061" layout="cols=1;screen.width=[130,870];printer.width=[20,80];order=1">
[
["[L5061]                                 催收催繳明細"],
["#FdMain+查詢條件","@(催收日期、戶號，需擇一輸入)"],
["#FdDateS+催收日期",#DateS,"至",#DateE],
["#FdCustS+戶號",#CustS,"至",#CustE],
["#FdOptionCode+查詢選項",#OptionCode,#OptionCodeX],
]
!---------- AP TEXT AREA Variables ----------
<include src="HELPRIM.icf::HELPRIM.rtn"/>
#FdMain=X,2,L
T(2,*)
#FdDateS=X,2,L
#FdCustS=X,2,L
#FdOptionCode=X,2,L

#CHAIN=A,1,S
T(4,CHAIN$) 

! 戶況下拉選單-1
#StatusRimName=x,20,S
T(3,CdCode.ColStatus)
#StatusHelp=x,1024,S

! 通話結果下拉選單-2
#ResultCodeRimName=x,20,S
T(3,CdCode.ResultCode)
#ResultCodeHelp=x,1024,S

! 發函種類下拉選單-3
#MailTypeCodeRimName=x,20,S
T(3,CdCode.MailTypeCode)
#MailTypeCodeHelp=x,1024,S

! 查詢選項下拉選單-4
#OptionCodeRimName=x,20,S
T(3,CdCode.OptionCd)
#OptionCdHelp=x,1024,S

#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#StatusRimName,#ResultCodeRimName,#MailTypeCodeRimName,#OptionCodeRimName)
R(1,XXR99)
CALL(#HelpProc)
T(2,@StatusHelp,#HelpDesc1)
T(2,@ResultCodeHelp,#HelpDesc2)
T(2,@MailTypeCodeHelp,#HelpDesc3)
T(2,@OptionCdHelp,#HelpDesc4)

#TODAY=X,8,S
T(4,#SYSCDATE)

! 催收日期
#DateS=D,7,I
! T(1,#TODAY,2,7)
D(8)
@A(DATE,0,#DateS)


#DateE=D,7,I
T(2,#DateS)
C(4,#DateS,S,$)
D(8)
@A(DATE,0,#DateE)
IF(#DateE<#DateS,V(P,起日不可大於迄日),$)

! 戶號
#CustS=A,7,I
C(4,#DateS,$,S)
@C(4,#DateS,C(3,#CustS,0,V(P,需擇一輸入查詢條件),$),$)
#CustE=A,7,I
C(4,#DateS,$,S)
@C(4,#DateS,$,S)
IF(#CustE < #CustS,V(P,迄號不可小於起號),$)

! 查詢選項
#OptionCode=A,1,I
HELP(#OptionCdHelp)
@T(3,#OptionCodeX,)
V(H,#OptionCdHelp)
#OptionCodeX=X,20,L
T(H,#OptionCode,#OptionCdHelp)

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!------------ TXFORM = L5061 -----------
<sub type="FORM" name="L5061">
#SCRTIL=_,_,S
T(3,[L5061] 催收催繳明細)

!#OFlag=A,1,S
!C(3,#OFlag,1,ALERT(資料產生成功),$)

#ExcelSnoM=X,8,S
E(2,@SnoM,#ExcelSnoM)
#SnoM=A,8,S


#ExcelPrtF=A,1,S
C(3,#SnoM,0,E(0,0),E(0,1))

</sub>

!------ 上行電文 TEXT ------
<sub type="TIM">
#DateS
#DateE
#CustS
#CustE
#OptionCode
</sub>

!------ 下行電文TOM ------
<sub type="TOM">
<include src="COM.icf::TRCTL.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
TXFORM=L5061
#ExcelSnoM
^
</sub>


!---------- 單據輸出組合 ----------
<sub type="SELECT">
#ExcelPrtF=1,PDF,,,,,,,,,,,,,ExcelSnoM;2,催收催繳明細表
^
</sub>
