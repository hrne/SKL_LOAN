!---------- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">
!#TXCD
!T(3,L5074)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,0)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,455)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,40)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="L5074" layout="cols=1;screen.width=[130,870];printer.width=[20,80];order=1">
[
["[L5074]                                 債務協商作業－債協應處理事項清單"],
! ["@會計日期",#AcDate],
]

#FdAcDate=X,2,L

#CHAIN=A,1,S
T(4,CHAIN$) 

! 會計日期--系統日期 不可修改
#AcDate=D,7,L
E(0,#SYSDATE)

![顯示方式]
#RPTFG=A,1,S
E(0,0)

#Send=A,1,S
! C(3,#CHAIN,1,E(0,@CHAIN,0)XMT(),$)
XMT()
</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!------------ TXFORM = L5074 -----------
<sub type="FORM" name="L5074">

#SCRTIL=_,_,S
T(3,[L5074] 債務協商作業－應處理事項清單)

#LOOP=X,1,S
E(0,1)ASGN(LOOP$)

! 位階
#OORank=A,2,S
! 位階-X軸
! #OORankX=X,1,S
! T(1,#OORank,1,1)
! 位階-Y軸
! #OORankY=X,1,S
! T(1,#OORank,2,1)

#OOLabelA=x,60,O

! 本日處理
#OOLabelB=x,60,O

! 本日處理-1
#OOLabelC=x,60,O

! 本日處理-1-1
#OOLabelD=x,60,O

! 筆數
#OOTodayWorkCnt=m,6,O
#OOTodayWorkCntX=X,6,O
C(3,#OOTodayWorkCnt,0,T(2, ),X(#OOTodayWorkCnt))
! 金額
#OOTodayWorkAmt=m,14,O
#OOTodayWorkAmtX=X,21,O
C(3,#OOTodayWorkAmt,0,T(2, ),X(#OOTodayWorkAmt))

! 累計處理
#OOLabelE=x,60,O

! 筆數 
#OOSummaryWorkCnt=m,6,O
#OOSummaryWorkCntX=X,6,O
C(3,#OOSummaryWorkCnt,0,T(2, ),X(#OOSummaryWorkCnt))
! 金額
#OOSummaryWorkAmt=m,14,O
#OOSummaryWorkAmtX=X,21,O
C(3,#OOSummaryWorkAmt,0,T(2, ),X(#OOSummaryWorkAmt))

! 處理事項 BTN名稱-入帳還款,撥付製檔,撥付出帳,暫收解入
#OOIssue=x,60,O

! Y-本日應處理 (Y/OK)
#OOTodayIssue=x,60,O 

! 本日_數字按鈕
#OOBufToday=X,13,S
! SWITCH(#OORank,
!   1,T(2,1+01+00),
!   2,T(2,1+02+00),
!   3,T(2,1+03+00),
!   4,T(2,1+04+00),
!   6,T(2,1+04+01),
!   7,T(2,1+04+02),
!   8,T(2,1+04+03),
!   9,T(2,1+04+04),
!   A,T(2,1+04+05),
!   B,T(2,1+04+06),
!   C,T(2,1+04+07),
!   D,T(2,1+05+00),
!   E,T(2,2+07+00),
!   F,T(2,2+08+00),
!   G,T(2,2+09+00),
!   H,T(2,2+02+00),
!   I,T(2,2+10+00)
! )

! 累計_數字按鈕
#OOBufSummary=X,13,S
! SWITCH(#OORank,
!   4,T(2,1+06+00),
!   6,T(2,1+06+01),
!   7,T(2,1+06+02),
!   8,T(2,1+06+03),
!   9,T(2,1+06+04),
!   A,T(2,1+06+08),
!   B,T(2,1+06+09),
!   C,T(2,1+06+10),
!   I,T(2,2+06+08)
! )

! 處理事項按鈕
#OOBufIssue=X,13,S
! SWITCH(#OORank,
!   1,T(2,1+01+00),
!   2,T(2,1+02+00),
!   3,T(2,1+03+00),
!   4,T(2,1+04+00),
!   6,T(2,1+04+01),
!   7,T(2,1+04+02),
!   8,T(2,1+04+03),
!   9,T(2,1+04+04),
!   A,T(2,1+04+05),
!   B,T(2,1+04+06),
!   C,T(2,1+04+07),
!   D,T(2,1+05+00),
!   E,T(2,2+07+00),
!   F,T(2,2+08+00),
!   G,T(2,2+09+00),
!   H,T(2,2+02+00),
!   I,T(2,2+10+00)
! )

#OOBtnToday=A,1,O
C(1,#OOTodayWorkCnt,BIND(grid,cancel),BIND(grid,cancel),
                    BIND(grid,{ cmd=CHAIN;ntxcd=L597A; text=#OOTodayWorkCntX; ntxbuf=#OOBufToday}))
#OOBtnSummary=A,1,O
C(1,#OOSummaryWorkCnt,BIND(grid,cancel),BIND(grid,cancel),
                      BIND(grid,{ cmd=CHAIN;ntxcd=L597A; text=#OOSummaryWorkCntX; ntxbuf=#OOBufSummary}))

! 顯示與否
#OOBtnCode=A,1,S
! E(0,1)
! SWITCH(#OORank,
!   2,E(0,@OOBtnCode,1),
!   3,E(0,@OOBtnCode,1),
!   6,E(0,@OOBtnCode,1),
!   7,E(0,@OOBtnCode,1),
!   8,E(0,@OOBtnCode,1),
!   9,E(0,@OOBtnCode,1),
!   ! E,E(0,@OOBtnCode,1),
!   H,E(0,@OOBtnCode,1),
!   J,E(0,@OOBtnCode,1),
!   K,E(0,@OOBtnCode,1),
!   L,E(0,@OOBtnCode,1),
!   M,E(0,@OOBtnCode,1),
!   E(0,0)
! )
! String Issue[]= {"","入帳還款","撥付製檔","撥付出帳","撥付提兌","暫收解入"};//製檔日,傳票日,提兌日
#OOBtnIssue=A,1,O
C(2,#OOBtnCode,
    BIND(grid,cancel),
    BIND(grid,{ cmd=CHAIN; ntxcd=L597A;text=#OOIssue;ntxbuf=#OOBufIssue}),
    BIND(grid,{ cmd=CHAIN; ntxcd=L5707;text=#OOIssue;ntxbuf=#OOBufIssue}),
    BIND(grid,{ cmd=CHAIN; ntxcd=L5708;text=#OOIssue;ntxbuf=#OOBufIssue}),
    BIND(grid,{ cmd=CHAIN; ntxcd=L5709;text=#OOIssue;ntxbuf=#OOBufIssue})
!    BIND(grid,{ cmd=CHAIN; ntxcd=L5712;text=#OOIssue;ntxbuf=#OOBufIssue})
)
</sub>

!------ 上行電文 TEXT ------
<sub type="TIM">
#AcDate
</sub>

!------ 下行電文TOM ------
<sub type="TOM">
<include src="COM.icf::TRCTL.tom"/>
TXFORM=L5074
#OORank
#OOLabelA
#OOLabelB
#OOLabelC
#OOLabelD
#OOTodayWorkCnt
#OOTodayWorkAmt
#OOLabelE
#OOSummaryWorkCnt
#OOSummaryWorkAmt
#OOIssue
#OOTodayIssue
#OOBufToday
#OOBufSummary
#OOBufIssue
#OOBtnCode
^
</sub>

<sub type="PART" name="L5074" layout="cols=1;screen.width=[130,1020];printer.width=[15,30,15,30];order=1">
[
["[L5074]@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@債務協商作業－應處理事項清單"],
["#FdAcDate+會計日期",#AcDate],
]
</sub>
!---------- 單據輸出組合 ----------
<sub type="SELECT">


#RPTFG=0,QUERY.GRID,L5074
#any={detail:true , exportExcel:false, header:'L5074.part', caption:'', width:1020, rowNum:40, rowList:[20,40,60]}

#OOLabelA=
{width:60,align:'left'}
#OOLabelB=本日處理
{width:80,align:'left'}
#OOLabelC=
{width:80,align:'left'}
#OOLabelD=
{width:80,align:'right'}
#OOBtnToday=筆數
{search:false,formatter:'cust:bind-button:#OOTodayWorkCntX',align:'right',canExport:false,width:60}
#OOTodayWorkAmtX=金額
{width:110,align:'right'}
#OOLabelE=累計處理
{width:120,align:'left'}
#OOBtnSummary=筆數
{search:false,formatter:'cust:bind-button:#OOSummaryWorkCntX',align:'right',canExport:false,width:60}
#OOSummaryWorkAmtX=金額
{width:120,align:'right'}
#OOBtnIssue=處理事項
{width:80,search:false,formatter:'cust:bind-button:#OOIssue',align:'center',canExport:false}
#OOTodayIssue=本日應處理
{width:140,align:'center'}

^
<include src="PRT.icf::INQ04.sel" map="i=L5074;cpi=15"/>
#AcDate
%
#OORank
#OOLabelA
#OOLabelB
#OOLabelC
#OOLabelD
#OOTodayWorkCnt
#OOTodayWorkAmt
#OOLabelE
#OOSummaryWorkCnt
#OOSummaryWorkAmt
#OOIssue
#OOTodayIssue
#OOBufToday
#OOBufSummary
#OOBufIssue
#OOBtnCode
@^
</sub>
