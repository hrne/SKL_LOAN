!---------- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">
!#TXCD
!T(3,L5908)
![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,0)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,40)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,40)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)
</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
K(MODIFYBUTTON,查詢)
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="L5908" layout="cols=1;screen.width=[130,870];printer.width=[20,80];order=1">
[
["[L5908]                                 房貸專員撥款筆數統計表"],
[#<->#,"#FdYyyMmFm+業績年月",#YyyMmFm,"-",#YyyMmTo],
]

#FdYyyMmFm=X,2,L
T(3,*)

#CHAIN=A,1,S
T(4,CHAIN$) 

#NTXBUF=X,11,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
T(1,@YyyMmFm,#NTXBUF,1,5)
T(1,@YyyMmTo,#NTXBUF,6,5)
INVOKEJS(SHOW,p1,02,02,1)

#TmpYyyMmFm=n,5,S
#TmpYyyMmTo=n,5,S
! 業績年月
#YyyMmFm=A,5,I
@A(YM13,1,#YyyMmFm)
E(0,@TmpYyyMmFm,#YyyMmFm)
#YyyMmTo=A,5,I
@A(YM13,1,#YyyMmTo)
E(0,@TmpYyyMmTo,#YyyMmTo)
IF(#TmpYyyMmTo<#TmpYyyMmFm,V(P,結束年月不可小於起始年月),$)
#RPTFG=A,1,S

! 檢查是否為工作月的最後一天，HOW???
</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!------------ TXFORM = L5908 -----------
<sub type="FORM" name="L5908">

#SCRTIL=_,_,S
T(3,[L5908] 房貸專員撥款筆數統計表)

#LOOP=X,1,S
E(0,1)ASGN(LOOP$)
!業績年月
#OOPerfDate=X,5,O
!部室代號
#OODeptCode=X,6,O
!部室名稱
#OODeptCodeX=X,20,O
!專員代號
#OOBsOfficer=X,6,O
!專員名稱
#OOBsOfficerX=X,10,O
!撥款筆數
#OOTotal=m,4,O
</sub>

!------ 上行電文 TEXT ------
<sub type="TIM">
#YyyMmFm#YyyMmTo
#END
</sub>

!------ 下行電文TOM ------
<sub type="TOM">
<include src="COM.icf::TRCTL.tom"/>
TXFORM=L5908
#OOPerfDate#OODeptCode#OODeptCodeX#OOBsOfficer#OOBsOfficerX#OOTotal
^
</sub>

!---------- 單據輸出組合 ----------
<sub type="PART" prompt='{{#SCRTIL}} world' name="L5908" layout="cols=1;screen.width=[130,870];order=1;">
[
["[L5908]                                 房貸專員撥款筆數統計表"],
! [#<->#,"@業績年月",#YyyMmFm,"-",#YyyMmTo],
]
</sub>

<sub type="SELECT">
#RPTFG=0,QUERY.GRID,L5908
#any={detail:true, header:'L5908.part', caption:'', width:1020, rowNum:20, rowList:[20,40,60]}
!業績年月
#OOPerfDate=業績年月
{width:105,align:'center'}
!部室代號
#OODeptCode=部室代號
{width:105,align:'center'}
!部室名稱
#OODeptCodeX=部室名稱
{width:105}
!專員代號
#OOBsOfficer=專員代號
{width:105,align:'center'}
!專員名稱
#OOBsOfficerX=專員名稱
{width:105,align:'center'}
!撥款筆數
#OOTotal=撥款筆數
{width:105,align:'right'}
^
<include src="PRT.icf::INQ04.sel" map="i=L5908;cpi=15"/>
#YyyMmFm#YyyMmTo
%
#OOPerfDate#OODeptCode#OODeptCodeX#OOBsOfficer#OOBsOfficerX#OOTotal
@^
</sub>
