----- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">

!#TXCD
!T(3,L7022)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,0)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,37)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,20)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD2.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
!HIDE(#BTN1)

#button=x,100,S
T(2,{cmd=CHAIN; ntxcd=L7202; ntxbuf=1; ntxbuf5=type})ASGN(BTN_NEW1$)
K(MODIFYBUTTON,1,新增類別)
K(MODIFYBUTTON,查詢)

</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[120,1080];printer.width=[20,20];">
[
["[L7022]                                 違約損失率檔查詢"],
["#FdDateStart+生效日期",#DateStart,"@～@",#DateEnd],
["#FdType+類別",#Type],
!["#FdRPTFG+顯示方式",
!<include src="COM.icf::RPTFG.scr"/>
!],
]
!---------- AP Button AREA ----------
![Buttom資料查詢]
!#BTN1=X,15,I,ui:button;value:新增類別;Enable:1;tabbable:0;title:L7202 違約損失率檔登錄
!#BUF1=X,42,S


!---------- AP TEXT AREA Variables ----------

#FdDateStart=X,2,L
#FdType=X,2,L
#FdRPTFG=X,2,L
T(3,*)

#CHAIN=A,1,S
T(4,CHAIN$)

#NTXBUF=X,4,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)

#RPTFG=A,1,S
E(0,0)

#DATE=D,8,S
T(4,DATE$)

! 生效日期起
#DateStart=D,7,I
T(1,#DATE,2,7)
D(8)
@A(DATE,0,#DateStart)

! 生效日期迄
#DateEnd=D,7,I
E(0,#DateStart)
D(8)
@A(DATE,0,#DateEnd)
C(4,#DateEnd,$,V(5,#DateStart,9991231))


! 類別
#Type=A,2,I

!<include src="COM.icf::RPTFG.dec"/>

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!---------- TXFORM = L7022 ----------
<sub type="FORM" name="L7022">

!#SCRPRT=_,_,S
!C(5,#TXFORM,L7022,$,S)

#SCRTIL=_,_,S
T(3,[L7022] 違約損失率檔)

!------ TOM(HEAD)   Variables (FOR OUTPUT SCREEN) ------
!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------
#LOOP=X,1,S
T(3,1)ASGN(LOOP$)

! 生效日期(TOTA)
#OODate=D,7,S

! 類別(TOTA)
#OOType=A,2,S

! 類別說明(TOTA)
#OOTypeDesc=X,20,S
#OOTypeDescX=X,23,S
T(2,#OOType+-+#OOTypeDesc)

! 違約損失率％(TOTA)
#OOLGDPercent=m,2.5,S
#OOLGDPercentX=X,8,S
X(#OOLGDPercent)
#OOLGDPercentX1=X,9,S
T(B,#OOLGDPercentX+%)

! 啟用記號(TOTA)
#OOEnable=X,1,S
#OOEnableX=X,6,S
SWITCH(#OOEnable,Y,T(3,啟用),
                 N,T(3,未啟用))

! 修改的按鈕
#OOFunc2=A,1,S
E(0,2)

#OOBUF2=X,38,S
T(2,#OOFunc2+#OODate+#OOType+#OOTypeDesc+#OOLGDPercent+#OOEnable)

#OOBTN2=X,4,S
BIND(grid,{cmd=CHAIN;ntxcd=L7202;text=修改;ntxbuf=#OOBUF2})

!! 刪除的按鈕  (移除刪除功能)
!#OOFunc4=A,1,S
!E(0,4)
!
!#OOBUF4=X,38,S
!T(2,#OOFunc4+#OODate+#OOType+#OOTypeDesc+#OOLGDPercent+#OOEnable)
!
!#OOBTN4=X,4,S
!BIND(grid,{cmd=CHAIN;ntxcd=L7202;text=刪除;ntxbuf=#OOBUF4})

</sub>


!------ 上行電文 ------
<sub type="TIM">
#DateStart#DateEnd#Type
#END
</sub>


!------ 下行電文TOM ------
<sub type="TOM">
TXFORM=L7022
#OODate
#OOType
#OOTypeDesc
#OOLGDPercent
#OOEnable
^
<include src="COM.icf::TRCTL.tom"/>
</sub>

!--------- OUTPUT畫面 --------
<sub type="PART" name="L7022" layout="cols=1;screen.width=[100,1000];printer.width=[20,20];">
[
["[L7022]                                 違約損失率檔查詢"],
[""],
]
</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">

#RPTFG=0,QUERY.GRID,L7022
#any={detail:true, header:'L7022.part', caption:'', width:1000, rowNum:20, rowList:[20,40,60]}

#OOBTN2=
{width:50,search:false,formatter:'cust:bind-button:#OOBTN2',align:'center',canExport:false}

!#OOBTN4=
!{width:50,search:false,formatter:'cust:bind-button:#OOBTN4',align:'center',canExport:false}

#OODate=生效日期
{width:100,align:'center'}

#OOTypeDescX=類別
{width:150,align:'center'}

#OOLGDPercentX1=違約損失率％
{width:150,align:'center'}

#OOEnableX=啟用記號
{width:100,align:'center'}

^

</sub>
