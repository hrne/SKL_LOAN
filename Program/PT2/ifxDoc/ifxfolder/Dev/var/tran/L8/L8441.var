!---------- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">
!#TXCD
!T(3,L8441)
</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)

#button=x,100,S
K(MODIFYBUTTON,執行)
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[150,850];printer.width=[20,20];">
[
["[L8441]                                 聯徵檔案回傳上傳"],
["#FdBUTTON_FLD+選擇檔案",#BUTTON_FLD],
]

!---------- AP TEXT AREA Variables ----------
#BUTTON_FLD=X,1,O,ui:button;value:瀏覽;enable:1;tabbable:1;file:true;multiple:true;fieldName:#FILENA;width:600

#ReportDate=D,7,S
E(0,#SYSCDATE)
!T(3,*)
#FdBUTTON_FLD=X,2,L

! 宣告按鈕事件
#BIND_ABA=X,1,S
BIND(#BUTTON_FLD,click)

! 上傳欄名返回傳接收變數
#FILENA=x,1000,S


#RPTFG=A,1,S
E(0,0)

#CHAIN=A,1,S
T(4,CHAIN$) 

!#NEXT_MONTH=D,8,S
!D(7,2,#SYSDATE,1,0)

!#DATE=D,8,S
!T(4,DATE$)


</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!---------- TXFORM = L8441 ----------
<sub type="FORM" name="L8441">

#SCRPRT=_,_,S
C(5,#TXFORM,L8441,$,S)

#SCRTIL=_,_,S
T(3,[L8441] 聯徵檔案回傳上傳)

!------ TOM(HEAD)   Variables (FOR OUTPUT SCREEN) ------

#Submitkey=X,3,L

#JcicDate=D,7,L

#ReportTotal=m,8,L

#CorrectCount=m,8,L

#MistakeCount=m,8,L

!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------

</sub>


!------ 上行電文 ------
<sub type="TIM">
#FILENA
#END
</sub>


!------ 下行電文TOM ------
<sub type="TOM">
TXFORM=L8441

#Submitkey

#JcicDate

#ReportTotal

#CorrectCount

#MistakeCount


^
<include src="COM.icf::TRCTL.tom"/>
</sub>

!--------- OUTPUT畫面 --------
<sub type="PART" name="L8441" layout="cols=1;screen.width=[300,700];printer.width=[20,20];">
[
["[L8441]                                 聯徵檔案回傳上傳"],
["@申報種類",#Submitkey],
["@報送日期",#JcicDate],
["@報送總筆數",#ReportTotal],
["@正確筆數",#CorrectCount],
["@錯誤筆數",#MistakeCount],
!["@","聯徵回傳檔案上傳更新中...."],
]
</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">

#RPTFG=0,QUERY.GRID,L8441
#any={detail:false, header:'L8441.part', caption:'', width:1000, rowNum:20, rowList:[60,40,60]}
^
</sub>
