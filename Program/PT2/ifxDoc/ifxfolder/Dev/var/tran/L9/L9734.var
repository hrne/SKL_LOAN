----- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">

!#TXCD
!T(3,L9734)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,27)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,75)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,20)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)

</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[147,850];printer.width=[20,80];">

[
["[L9734]                                 覆審報表產製"],
["#FdAcDate+會計日期",#AcDate],
["#FdYearMonth+覆審年月",#ReChkYearMonth,"（預設00000為全部）"],
["#grid#,{id:1,expand:false,loop:6,row_height:1,s_cols:[50,50,50], p_cols:[8,8]}","","",
["全選",#BtnAllShell1,"報表名稱"],
["",#BtnShell1,#ReportName1],
],

]


!---------- PREMADE VARIABLES ----------
! This makes the trades possible to execute on DEV,SIT,UAT
! 功能 必須輸入(1: 新增;2: 修改;4: 刪除;5: 查詢)
#FUNCIND=_,_,S
E(0,5)
<include src="COM.icf::CheckAuth.rtn"/>

#Report1=X,30,S
T(3,A/1/個金3000萬以上)
#Report2=X,30,S
T(3,B/2/企金3000萬以上)
#Report3=X,30,S
T(3,C/3/個金2000萬以上小於3000萬)
#Report4=X,30,S
T(3,D/4/個金100萬以上小於2000萬)
#Report5=X,30,S
T(3,E/5/企金未達3000萬)
#Report6=X,30,S
T(3,F/6/土地覆審)

##loop{times:6,i:1}
#ReportCat{i}=X,1,L
T(1,#Report{i},1,1)
HIDE(#ReportCat{i})

#Condition{i}=X,1,L
T(1,#Report{i},3,1)
HIDE(#Condition{i})

#ReportName{i}=X,25,L
T(1,#Report{i},5,25)
##end


!全選勾選功能 start..........

#BtnAllShell1=X,1,I,ui:button;value:  ;enable:1;tabbable:0

#ApAllBIND1=X,1,S
BIND(#BtnAllShell1,click, {cmd=CALLSEND;DOCODE=ApAllBtnProc1})

#ApAllBtnProc1=@,1,S
C(5,#BtnAllShell1,V,T(3,@BtnAllShell1,  ),T(3,@BtnAllShell1,V))
##loop{times:6,i:1}
!全勾選前，先排除沒有交易代號行數不勾選
C(5,#BtnAllShell1,V,T(3,@BtnShell{i},V),T(3,@BtnShell{i},  ))
##end


!全選勾選功能 end..........

##loop{times:6,i:1}
!權限勾選按鈕
#BtnShell{i}=X,1,I,ui:button;value:  ;enable:1;tabbable:0

#Ap1GBIND{i}=X,1,S
BIND(#BtnShell{i},click, {cmd=CALLSEND;DOCODE=Ap1GBtnProc{i}})

#Ap1GBtnProc{i}=@,1,S
C(5,#BtnShell{i},V,T(3,@BtnShell{i},  ),T(3,@BtnShell{i},V))

##end


#FdYearMonth=X,1,L
T(2,*)
#FdAcDate=X,1,L
T(2,*)

!會計日期 必須輸入
#DATE=D,8,S
T(4,DATE$)

#DT=D,7,S
T(1,#DATE,2,7)

#AcDate=D,7,I
T(2,#DT)
@V(7)A(4,0,#AcDate)
IF(#AcDate > #DT,V(P,不可大於會計日),$)
!#Today=A,8,S
!D(6,2,#SYSDATE,0)


#DATEYear=A,3,S
T(1,#DATE,2,3)

![年月]
#DataYear=A,3,S
T(1,#DATE,2,3)
@V(5,0,#DATEYear)

#DataMonth=A,2,S
T(1,#DATE,5,2)
@V(5,1,12)


#ReChkYearMonth=A,5,I
E(0,0)

#ReChkYear=A,3,S
E(0,#ReChkYearMonth/100)


#ReChkMonth=A,2,S
T(1,#ReChkYearMonth,4,2)






!前一個月日期
!#LastDay=A,8,S
!D(7,3,#Today,1,0)

!本月底營業日
!#MFBSDYDate=A,8,S
!D(6,2,#MFBSDY,0)

!當月年份    
!#ThisYearMonth=A,5,S
!T(1,#Today,2,5)


!上月年份    
!#LastYearMonth=A,5,S
!T(1,#LastDay,2,5)


!#YearMonth=A,5,I
!C(3,#Today,#MFBSDYDate,E(0,#ThisYearMonth),E(0,#LastYearMonth))
!E(0,#ThisYearMonth)
!@V(2,0)
!V(5,0,#ThisYearMonth)


#TotalItem=A,1,S
E(0,6)


</sub>


!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>


!---------- TXFORM = L9734 ----------
<sub type="FORM" name="L9734">

</sub>


!------ 上行電文 ------
! 修改這裡的 loop times
<sub type="TIM">
#TotalItem
#AcDate
#ReChkYearMonth
##loop{times:6,i:1}
#BtnShell{i}
#ReportCat{i}
#Condition{i}
#ReportName{i}
##end
</sub>


!------ 下行電文TOM ------
<sub type="TOM">
TXFORM=L9734^
#COUNT
<include src="COM.icf::TRCTL.tom"/>
</sub>

<sub type="PART" name="L9734" layout="cols=3;screen.width=[130,800];printer.width=[15,80];order=1">
[
["[L9734]                                覆審報表產製"], 
]
</sub>
!---------- 單據輸出組合 ----------
<sub type="SELECT">

<include src="PRT.icf::UPD01.sel"/>
</sub>