----- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">

!#TXCD
!T(3,L9704)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,27)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,75)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,20)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)

</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[150,850];printer.width=[20,20];">
[
["[L9704]                                 催收款明細表"],
["#R1+@年月",#InputYear," / ",#InputMonth],
]
!---------- AP Button AREA ----------
![Buttom資料查詢]
! 功能 必須輸入(1: 新增;2: 修改;4: 刪除;5: 查詢)
#FUNCIND=_,_,S
E(0,5)
<include src="COM.icf::CheckAuth.rtn"/>

! 必輸欄位
##loop{times:1,i:1}
#R{i}=X,1,L
INVOKEJS(SHOW,#R{i},0)
K(LIGHT,#R{i},TXTRED,0)
##end

! 永遠為必輸欄位
#ALWAYS_HIGHLIGHT=@,1,S
T(3,@R1,*)

!---------- AP TEXT AREA Variables ----------
#CHAIN=A,1,S
T(4,CHAIN$)

#INIT=X,1,S
CALL(#ALWAYS_HIGHLIGHT)

!今天明天日期
#Today=A,8,S
D(6,2,#SYSDATE,0)
#Tomorrow=A,8,S
D(6,2,#SYSDATE,1)

!上個月日期
#LastMonthDay=A,8,S
D(7,3,#SYSDATE,1,0)

!上個月月份    
#tLastMonth=A,2,S
T(1,#LastMonthDay,5,2)

!今天明天日期之年
#TodayYear=A,3,S
T(1,#Today,2,3)
#TomorrowYear=A,3,S
T(1,#Tomorrow,2,3)
!今天明天日期之月份
#TodayMonth=A,2,S
T(1,#Today,5,2)
#TomorrowMonth=A,2,S
T(1,#Tomorrow,5,2)

#DefaultYear=A,3,S
C(3,#TodayYear,#TomorrowYear,E(0,#TodayYear),E(0,#TodayYear))

#DefaultMonth=A,2,S
C(3,#TodayMonth,#TomorrowMonth,E(0,#tLastMonth),E(0,#TodayMonth))

#ThisMonthDate=D,8,S
E(0,0)

! 資料年
#InputYear=A,3,I
E(0,#DefaultYear)
@V(2,0)
V(5,0,#DefaultYear)

! 資料月
#InputMonth=A,2,I
E(0,#DefaultMonth)
@V(2,0)
IF(#InputYear==#DefaultYear,V(5,0,#DefaultMonth),V(5,0,12))

#ThisMonth=A,5,S
E(0,@ThisMonthDate,#InputYear*100)
E(0,@ThisMonthDate,#ThisMonthDate+#InputMonth)
E(0,@ThisMonthDate,#ThisMonthDate*100)
E(0,@ThisMonthDate,#ThisMonthDate+1)
E(0,#ThisMonthDate/100)

#LastMonthDate=D,8,S
D(7,3,#ThisMonthDate,1,0)

#LastMonth=A,5,S
T(1,#LastMonthDate,2,5)

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
<include src="COM.icf::RPTFG.dec"/>
</sub>


!---------- TXFORM = L9704 ----------
<sub type="FORM" name="L9704">

!#SCRPRT=_,_,S
!C(5,#TXFORM,L9704,$,S)

#SCRTIL=_,_,S
T(3,[L9704] 催收款明細表)

!------ TOM(HEAD)   Variables (FOR OUTPUT SCREEN) ------
!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------

!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------

</sub>


!------ 上行電文 ------
<sub type="TIM">
#ThisMonth
#LastMonth
</sub>


!------ 下行電文TOM ------
<sub type="TOM">
TXFORM=L9704^
<include src="COM.icf::TRCTL.tom"/>
</sub>

<sub type="PART" name="L9704" layout="cols=3;screen.width=[130,370,130,370];printer.width=[15,30,15,30];order=1">
[
["[L9704]                                 催收款明細表"],
]
</sub>
!---------- 單據輸出組合 ----------
<sub type="SELECT">

!<include src="PRT.icf::INQ01.sel"/>
<include src="PRT.icf::UPD01.sel"/>
</sub>
