----- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">

#TXCD=_,_,S
T(3,L9739)

</sub>
<sub type="PREDC" name="PreDC">
<include src="COM.icf::TITLE-RUN.pre"/>
</sub>


<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD2.dec"/>



</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[140,850];printer.width=[20,20];">
[
["[L9739]                                檢核政府優惠房貸利率脫勾表                                                             "],
["",#SP,"逐項檢核政府優惠房貸利率不符當時利率"],
["#grid#,{id:1,expand:false,loop:9,row_height:0,s_cols:[100,100]}","","",
["商品代碼","中文名稱","生效日期","利率"],
[#ProdNo1,#ProdName1,#EffectDate1,#FitRate1],
], 
]
!---------- AP TEXT AREA Variables ----------

!<include src="HELPRIM.icf::HELPRIM.rtn"/>

#CHAIN=A,1,S
T(4,CHAIN$)

#NTXBUF=X,3,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
! T(1,@FUNCD,#NTXBUF,1,1)
! T(1,@TLR,#NTXBUF,2,2)
T(2,@FKEY,7)


#SP=X,35,L

#RPTFG=X,1,S
E(0,0) 

#tranNo=X,5,S
T(3,L9739)
!#SendLMR42=X,1,S
!RESET_RIM(#SendLMR42,L9R99)
S(L9R99,0,#tranNo)
R(1,L9R99)


##loop{times:9,i:1}
#OOProdNo{i}=X,2,L
#OOProdName{i}=X,80,L
#OOEffectDate{i}=X,8,L
#OOFitRate{i}=n,4.2,L
##end

#ProdGroup1=X,25,S
T(3,IA/1200 億青年優惠房貸)
#ProdGroup2=X,25,S
T(3,IB/2000 億優惠房貸)
#ProdGroup3=X,25,S
T(3,IC/2000 億優惠房貸)
#ProdGroup4=X,25,S
T(3,ID/20 億優惠房貸)
#ProdGroup5=X,25,S
T(3,IE/15 億優惠房貸)
#ProdGroup6=X,25,S
T(3,IF/12 億優惠房貸)
#ProdGroup7=X,25,S
T(3,IG/10 億優惠房貸)
#ProdGroup8=X,25,S
T(3,IH/2000 億優惠房貸)
#ProdGroup9=X,25,S
T(3,II/2000 億優惠房貸 - 續)

! 修改這裡的 loop times
##loop{times:9,i:1}

! TradeCat: 1st byte of TradeDic. Trade's category.
#ProdNo{i}=X,15,L
T(1,#ProdGroup{i},1,2)

! TradeCode: 3-7 th bytes of TradeDic. The TXCD of a trade.
#ProdName{i}=X,70,L
T(1,#ProdGroup{i},4,25)

#EffectDate{i}=X,15,L
IF(#OOEffectDate{i} >= 0,E(0,#OOEffectDate{i}),E(0,0))

#FitRate{i}=n,10.2,L
IF(#OOFitRate{i} >= 0,E(0,#OOFitRate{i}),E(0,0.00))

##end




!S(L9739,0,#FunctionCode)
!R(1,L9739)
!E(0,@RiskFactor1,#LMR42RiskFactor1)
!#RiskFactor1=n,1.4,I
!@V(5,0.0000,0.9999)
!#ProdNo=X,2,S
!T(2,#OOProdNo)
!#ProdName=X,80,S
!T(2,#OOProdName)
!#EffectDate=X,8,S
!E(0,#OOEffectDate)
!#FitRate=X,4.2,S
!E(0,#OOFitRate)





</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!---------- TXFORM = L9739 ----------
<sub type="FORM" name="L9739">

#SCRPRT=_,_,S
C(5,#TXFORM,L9739,$,S)

#SCRTIL=_,_,S
T(3,[L9739] 檢核政府優惠房貸利率脫勾表)

#LOOP=X,1,S
T(3,1)ASGN(LOOP$)


</sub>


!------ 上行電文 ------
<sub type="TIM">
#tranNo

</sub>


!------ 下行電文TOM ------
<sub type="TOM">
TXFORM=L9739


^
TXFORM=L9R99
##loop{times:9,i:1}
#OOProdNo{i}
#OOProdName{i}
#OOEffectDate{i}
#OOFitRate{i}
##end
^

<include src="COM.icf::TRCTL.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
</sub>


!--------- OUTPUT畫面 --------
<sub type="PART" name="L9739" layout="cols=3;screen.width=[250,250,100,250];printer.width=[20,20,20,20];order=1">

</sub>


!---------- 單據輸出組合 ----------
<sub type="SELECT">
<include src="PRT.icf::UPD01.sel"/>
</sub>
