!---------- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">

#TXCD=_,_,S
T(3,L9742)

</sub>
<sub type="PREDC" name="PreDC">
<include src="COM.icf::TITLE-RUN.pre"/>
</sub>


<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD2.dec"/>



! 功能 (2: 修改)
#FuncCode=A,1,S
E(0,2)
K(MODIFYBUTTON,確定)

#FUNCIND=_,_,S
E(0,#FuncCode)


</sub>



!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[150,850];printer.width=[20,20];">
[
["[L9742]                              L9742企金戶還本收據及繳息收據"],
[#<->#,"功能",#FunctionCode,#FunctionCodeX],
[#<->#,"會計日期",#inputAcDate],
[#<->#,"經辦",#inputTitaTlrNo],
[#<->#,"交易序號(起)",#inputTitaTxtNoStart],
[#<->#,"交易序號(迄)",#inputTitaTxtNoEnd],
[#<->#,"傳票號碼(起)",#inputSlipNoStart,#BTN2],
[#<->#,"傳票號碼(迄)",#inputSlipNoEnd,#BTN3],
[#<->#,"作業選項",#inputOption,#inputOptionX]
]

!---------- AP Button AREA ----------

 

![Buttom資料查詢]
#Submit=A,1,S
K(MODIFYBUTTON,查詢)


!---------- AP TEXT AREA Variables ----------
#CHAIN=A,1,S
T(4,CHAIN$)

!-----------------------------------------------------

#FunctionCodeHelp=X,30,S
T(3,1:手動輸入;2:整批列印)

! 作業項目
#FunctionCode=A,1,I
HELP(#FunctionCodeHelp)
@V(H,#FunctionCodeHelp)
@C(3,#FunctionCode,1,INVOKEJS(SHOW,p1,3,7,1))
@C(3,#FunctionCode,2,INVOKEJS(SHOW,p1,3,7,0))

#FunctionCodeX=X,8,L
T(H,#FunctionCode,#FunctionCodeHelp)

#inputAcDate=D,7,I
E(0,#SYSDATE)
@V(7)
A(DATE,0,#inputAcDate)
V(5,0,#SYSDATE)

#inputTitaTlrNo=X,6,I
!@C(4,#inputTitaTlrNo,T(F,@inputTitaTxtNo,0),T(F,@inputTitaTxtNo,1))
!C(4,#inputTitaTlrNo,E(0,@inputTitaTxtNo,00000000)E(0,@inputTitaTxtNoEnd,99999999),$)

#inputTitaTxtNoStart=A,8,I
V(7)
@V(5,00000000,99999999)

#inputTitaTxtNoEnd=A,8,I
E(0,0)
C(3,#inputTitaTxtNoEnd,0,E(0,99999999),$)
@V(5,#inputTitaTxtNoStart,99999999)
V(2,0)

#BTN2=X,15,I,ui:button;value:會計明細;enable:1;tabbable:0
#BTN3=X,15,I,ui:button;value:會計明細;enable:1;tabbable:0

!會計明細按鈕
#BUF2B=X,62,S
T(2,000+   +0000+   +           +     +  +#inputAcDate+2+#inputTitaTlrNo+0+#inputTitaTxtNoStart++#inputTitaTxtNoEnd)



#BIND2B=X,1,S
BIND(#BTN2,click, {cmd=CHAIN; ntxcd=L6905; ntxbuf=#BUF2B;ntxbuf5=type<-1:
inputSlipNoStart<-OOSlipNo})

!會計明細按鈕
#BUF3B=X,62,S
T(2,000+   +0000+   +           +     +  +#inputAcDate+2+#inputTitaTlrNo+0+#inputTitaTxtNoStart+#inputTitaTxtNoEnd)
C(4,#inputTitaTlrNo,$,s)
T(2,000+   +0000+   +           +     +  +#inputAcDate+0+      +0+#inputTitaTxtNoStart+#inputTitaTxtNoEnd)

#BIND3B=X,1,S
BIND(#BTN3,click, {cmd=CHAIN; ntxcd=L6905; ntxbuf=#BUF3B;ntxbuf5=type<-1:
inputSlipNoEnd<-OOSlipNo})






#inputSlipNoStart=A,6,I
#inputSlipNoEnd=A,6,I
C(3,#inputSlipNoEnd,0,E(0,999999),$)
@V(5,#inputSlipNoStart,999999)
V(2,0)



#inputOptionHelp=X,60,S
T(3,0:全部;1:還本收據;2:繳息收據;3:手續費收據)

! 作業項目
#inputOption=A,1,I
HELP(#inputOptionHelp)
@V(H,#inputOptionHelp)

#inputOptionX=X,30,L
T(H,#inputOption,#inputOptionHelp)

</sub>


!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>

#PRTSC_RFG=X,1,S
C(3,#HCODE,1,S,$)
C(5,#TXFORM,L9742,$,S)
C(3,#FKEY,2,E(0,0),E(0,1))

</sub>


!---------- TXFORM = C5100 ----------
<sub type="FORM" name="L9742">

#SCRPRT=_,_,S
C(5,#TXFORM,C5100,$,S)

#SCRTIL=_,_,S
T(3,[L9742] L9742企金戶還本收據及繳息收據)

</sub>

!---------- TXFORM = L9742 ----------
<sub type="FORM" name="L9742">

#SCRPRT=_,_,S
C(5,#TXFORM,L9742,$,S)

#SCRTIL=_,_,S
T(3,[L9742] L9742企金戶還本收據及繳息收據)


#OEMPNOS=X,6,S
IF(#KINBR=="0009"||#KINBR=="0008",T(2,#KINBR+#TlrNoNO),T(2,#EMPNOS))

</sub>


!------ 上行電文TIM：BASIC LABEL + AP TEXT AREA + AP TEXT ------
<sub type="TIM">
#inputAcDate
#inputSlipNoStart
#inputSlipNoEnd
#inputTitaTxtNoStart
#inputTitaTxtNoEnd
#inputOption
#FunctionCode
#inputTitaTlrNo
#END
</sub>
!------ 下行電文TOM ------
<sub type="TOM">
<include src="COM.icf::TRCTL.tom"/>

TXFORM=L9742
^

</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">
<include src="PRT.icf::UPD01.sel"/>
</sub>

