!---------- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">

#TXCD=_,_,S
T(3,L9742)

</sub>
<sub type="PREDC" name="PreDC">
<include src="COM.icf::TITLE-RUN.pre"/>
</sub>


<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD2.dec"/>


</sub>



!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[147,850];printer.width=[20,80];">
[
["[L9742]                                  L9742企金戶還本收據及繳息收據"],
["會計日期",#inputAcDate],
["傳票號碼",#inputSlipNoStart,"～",#inputSlipNoEnd,#BTN2],
["交易序號",#inputTitaTxtNoStart,"～",#inputTitaTxtNoEnd],
["作業選項",#inputOption,#inputOptionX]
]

!---------- AP Button AREA ----------

 
![Buttom資料查詢]

#BTN2=X,15,I,ui:button;value:會計明細;enable:1;tabbable:0


!會計明細按鈕
#BUF2=X,6,S
#BIND2=X,1,S
!BIND(#BTN2,click, {cmd=CHAIN; ntxcd=L6903; ntxbuf=#BUF2;ntxbuf5=type<-1:
BIND(#BTN2,click, {cmd=CHAIN; ntxcd=L6905; ntxbuf=#BUF2;ntxbuf5=type<-1:
inputSlipNoStart<-OOSlipNo:
inputSlipNoEnd<-OOSlipNo:
inputTitaTxtNoStart<-OOTitaTxtNo:
inputTitaTxtNoEnd<-OOTitaTxtNo})

!ENABLE(#BTN2)ENABLE(#BTN3)
#Submit=A,1,S
K(MODIFYBUTTON,查詢)


!---------- AP TEXT AREA Variables ----------
#CHAIN=A,1,S
T(4,CHAIN$)

! #NTXBUF=X,3,S
! C(3,#CHAIN,1,T(4,NTXBUF$),S)
! T(1,@FUNCD,#NTXBUF,1,1)
! T(1,@TLR,#NTXBUF,2,2)
! T(2,@FKEY,7)

!ALERT(#BTN2)

!-----------------------------------------------------

#TXCD2=X,5,S
T(3,L9742)

#inputAcDate=D,7,I
E(0,#SYSDATE)
@V(7)
A(DATE,0,#inputAcDate)
V(5,0,#SYSDATE)

#inputSlipNoStart=A,6,I
#inputSlipNoEnd=A,6,I
C(5,#inputSlipNoStart,000000,E(0,999999),E(0,#inputSlipNoStart))
@V(5,#inputSlipNoEnd,999999)
V(2,0)

#inputTitaTxtNoStart=A,8,I
#inputTitaTxtNoEnd=A,8,I
C(5,#inputTitaTxtNoStart,00000000,E(0,99999999),E(0,#inputTitaTxtNoStart))
@V(5,#inputTitaTxtNoEnd,99999999)
V(2,0)


#inputOptionHelp=X,50,S
T(3,0:全部;1:還本繳息收據;2:支出收入傳票)

! 作業項目
#inputOption=A,1,I
HELP(#inputOptionHelp)
@V(H,#inputOptionHelp)

#inputOptionX=X,30,L
T(H,#inputOption,#inputOptionHelp)

</sub>


!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>

#PRTSC_RFG=X,1,S
C(3,#HCODE,1,S,$)
C(5,#TXFORM,L9742,$,S)
C(3,#FKEY,2,E(0,0),E(0,1))

</sub>


!---------- TXFORM = C5100 ----------
<sub type="FORM" name="L9742">

#SCRPRT=_,_,S
C(5,#TXFORM,C5100,$,S)

#SCRTIL=_,_,S
T(3,[L9742] L9742企金戶還本收據及繳息收據)

</sub>

!---------- TXFORM = L9742 ----------
<sub type="FORM" name="L9742">

#SCRPRT=_,_,S
C(5,#TXFORM,L9742,$,S)

#SCRTIL=_,_,S
T(3,[L9742] L9742企金戶還本收據及繳息收據)


#OEMPNOS=X,6,S
IF(#KINBR=="0009"||#KINBR=="0008",T(2,#KINBR+#TlrNoNO),T(2,#EMPNOS))

</sub>


!------ 上行電文TIM：BASIC LABEL + AP TEXT AREA + AP TEXT ------
<sub type="TIM">
#inputAcDate
#inputSlipNoStart
#inputSlipNoEnd
#inputTitaTxtNoStart
#inputTitaTxtNoEnd
#inputOption
#END
</sub>
!------ 下行電文TOM ------
<sub type="TOM">
<include src="COM.icf::TRCTL.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>

TXFORM=L9742
^

</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">
<include src="PRT.icf::UPD01.sel"/>
</sub>

