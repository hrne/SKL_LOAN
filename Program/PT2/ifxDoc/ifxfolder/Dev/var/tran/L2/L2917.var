----- BASIC LABEL Variables ----------
<sub type="SYS">
#Submit=A,1,S
K(MODIFYBUTTON,查詢)
</sub>

<sub type="SYS" name="label">

!#TXCD
!T(3,L2917)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,0)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,93)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,20)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)


</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)



</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[130,1100];printer.width=[20,20];">
[
["[L2917]                                 不動產建物土地關聯維護"],
["#FdMain+查詢條件","(戶號、擔保品編號，擇一輸入)"],
["#FdCustNo+戶號",#CustNo,"-",#FacmNo,#CustName],
["#FdClNo+擔保品編號",#ClCode1,"-",#ClCode2,"-",#ClNo,#ClNoX],
]
!---------- AP Button AREA ----------
![Buttom資料查詢]
#FdMain=X,2,L
T(3,*)
#FdCustNo=X,2,L
T(3,．)
#FdClNo=X,2,L
T(3,．)

!---------- AP TEXT AREA Variables ----------
<include src="HELPRIM.icf::HELPRIM.rtn"/>


! [擔保品編號-代號1]
#CDDEF0000=x,20,S
T(3,CdCode.ClCode1)
#ClCode1Help=x,1024,S
! [擔保品編號-代號2]
#CDDEF0001=x,20,S
T(3,CdCode.ClCode21)
#ClCode21Help=x,1024,S
#CDDEF0002=x,20,S
T(3,CdCode.ClCode22)
#ClCode22Help=x,1024,S
#CDDEF0003=x,20,S
T(3,CdCode.ClCode23)
#ClCode23Help=x,1024,S
#CDDEF0004=x,20,S
T(3,CdCode.ClCode24)
#ClCode24Help=x,1024,S
#CDDEF0005=x,20,S
T(3,CdCode.ClCode25)
#ClCode25Help=x,1024,S
#CDDEF0006=x,20,S
T(3,CdCode.ClCode29)
#ClCode29Help=x,1024,S


#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#CDDEF0000,#CDDEF0001,#CDDEF0002,#CDDEF0003,#CDDEF0004,#CDDEF0005,#CDDEF0006)
R(1,XXR99)
CALL(#HelpProc)
T(2,@ClCode1Help,#HelpDesc1)
T(2,@ClCode21Help,#HelpDesc2)
T(2,@ClCode22Help,#HelpDesc3)
T(2,@ClCode23Help,#HelpDesc4)
T(2,@ClCode24Help,#HelpDesc5)
T(2,@ClCode25Help,#HelpDesc6)
T(2,@ClCode29Help,#HelpDesc7)



#CHAIN=A,1,S
T(4,CHAIN$)

#NTXBUF=X,200,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
T(1,@CustNo,#NTXBUF,1,7)
T(1,@FacmNo,#NTXBUF,8,3)
T(1,@ClCode1,#NTXBUF,11,1)
T(1,@ClCode2,#NTXBUF,12,2)
T(1,@ClNo,#NTXBUF,14,7)





! [戶號]
#CustNo=A,7,I
C(3,#CHAIN,1,s,$)

#RimL1r09=X,1,S
E(0,@RimFunCd,1)
T(2,@RimCustId,)
T(3,#CustName,)
E(0,@RimCustNo,#CustNo)
RESET_RIM(#RimL1r09,L1R09)
S(L1R09,1,#RimFunCd,#RimCustId,#RimCustNo)
R(1,L1R09)
T(2,@CustName,#L1r09CustName)




#CustName=X,100,L


! [額度號碼]
#FacmNo=A,3,I
C(3,#CHAIN,1,s,$)
IF(#CustNo == 0,S,$)

! [擔保品編號-代號1]
#ClCode1=A,1,L
C(3,#CHAIN,1,s,$)
IF(#CustNo > 0,S,$)
E(0,1)
! HELP(#ClCode1Help)
! @V(H,#ClCode1Help)

#ClCode2Help=x,1024,S
SWITCH(#ClCode1,1,T(2,#ClCode21Help),
                2,T(2,#ClCode22Help),
                3,T(2,#ClCode23Help),
                4,T(2,#ClCode24Help),
                5,T(2,#ClCode25Help),
                9,T(2,#ClCode29Help))

#ClCode2=A,2,I
C(3,#CHAIN,1,s,$)
IF(#CustNo > 0,S,$)
IF(#ClCode1 > 0,$,S)
SWITCH(#ClCode1,1,$,2,$,3,E(0,1),4,E(0,1),5,E(0,1),9,$)
HELP(#ClCode2Help)
@C(3,#ClCode1,0,S,$)
V(H,#ClCode2Help)

#ClCode=A,3,S
T(2,#ClCode1+#ClCode2)

#ClNoX=X,26,L
IF(#ClCode1 > 0 && #ClCode2 > 0,$,S)
T(H,#ClCode2,#ClCode2Help)

! [擔保品編號]
#ClNo=A,7,I
C(3,#CHAIN,1,s,$)
IF(#CustNo > 0,S,$)
C(3,#ClCode1,0,S,$)


#CheinXmt=X,1,S
C(3,#CHAIN,1,E(0,@CHAIN,0)XMT(),$)


#RPTFG=A,1,S
E(0,0)

<include src="ROM.icf::L2Rim.dec"/>
<include src="ROM.icf::L1R09.dec"/>
</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>


!---------- TXFORM = L2917 ----------
<sub type="FORM" name="L2917">

!#SCRPRT=_,_,S
!C(5,#TXFORM,L2917,$,S)

#SCRTIL=_,_,S
T(3,[L2917] 不動產建物土地關聯維護)


!------ TOM(HEAD)   Variables (FOR OUTPUT SCREEN) ------

!戶號
#OCustNo=A,7,L
E(0,#CustNo)
#OFacmNo=A,3,L
E(0,#FacmNo)
!戶名
#OCustName=x,60,L
T(2,#CustName)
!擔保品
#OClCode1=A,1,L
E(0,#ClCode1)
#OClCode2=A,2,L
E(0,#ClCode2)
#OClNo=A,7,L
E(0,#ClNo)

!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------
#LOOP=X,1,S
T(3,1)ASGN(LOOP$)

!擔保品代號1
#OOClCode1=A,1,S
!擔保品代號2
#OOClCode2=A,2,S
!擔保品編號
#OOClNo=A,7,S
!擔保品代號1+擔保品代號2+擔保品編號
#OOCl=X,12,L
T(2,#OOClCode1+-+#OOClCode2+-+#OOClNo)
!建物門牌
#OOBdLocation=x,60,L
!土地序號
#OOClLandSeq=A,3,S
!土地坐落
#OOLandLocation=x,60,L

#FunCd=A,1,S
E(0,4)
#TXCD=_,_,S
T(2,L2917)
#secret-no=x,1000,S
T(6A,#TXCD+#FunCd+#OOClCode1+#OOClCode2+#OOClNo+#OOClLandSeq)


#batch-detail=x,100000,S
#batch-print=A,1,S
!#batch-rows 總筆數
#batch-rows=X,2,S
!#batch-rows-selected 勾選之筆數
#batch-rows-selected=X,2,S
!#batch-rows-ok  傳送成功筆數
#batch-rows-ok=X,2,S
!#batch-rows-error 傳送失敗筆數
#batch-rows-error=X,2,S
!#batch-row-txtno 該列傳送序號
#batch-row-txtno=X,18,O
!#batch-row-status 該列傳送狀態
#batch-row-status=X,50,S

!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------

</sub>


!------ 上行電文 ------
<sub type="TIM">
#CustNo
#FacmNo
#ClCode1
#ClCode2
#ClNo
</sub>


!------ 下行電文TOM ------
<sub type="TOM">
TXFORM=L2917
#OOClCode1
#OOClCode2
#OOClNo
#OOBdLocation
#OOClLandSeq
#OOLandLocation
^
<include src="COM.icf::TRCTL.tom"/>
<include src="ROM.icf::L1R09.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
</sub>

<sub type="PART" name="L2917" layout="cols=1;screen.width=[130,870];printer.width=[15,30]">
[
["[L2917]                                 不動產建物土地關聯維護"],
[""],
! ["戶號",#OCustNo,"-",#OFacmNo,#OCustName],
! ["擔保品",#OClCode1,#OClCode2,#OClNo],
]
</sub>
!---------- 單據輸出組合 ----------
<sub type="SELECT">

#batch-print=1,L2917.PFNX,NA,,,,,,1169:827
^
#RPTFG=0,QUERY.GRID,L2917
#any={detail:true, header:'L2917.part', caption:'[L2917]不動產建物土地關聯維護', width:1000, rowNum:20, rowList:[20,40,60],
ifxBatch:{
	name:'刪除',
	type:'5',
	rim:'L2416',
	txtno:'#secret-no',
	pfnx:"L2917.PFNX",
	col_captions:["擔保品","土地序號","處理結果"],
	col_names:["#OOCl","#OOClLandSeq","#batch-row-status"]
	}
}

#secret-no
#batch-row-status

#OOCl=擔保品號碼
{width:100,align:'center'}
#OOBdLocation=建物門牌
{width:300}
#OOClLandSeq=土地序號
{width:80,align:'center'}
#OOLandLocation=土地坐落
{width:300}

^
</sub>
