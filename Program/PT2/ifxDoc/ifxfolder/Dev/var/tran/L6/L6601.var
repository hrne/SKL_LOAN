----- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">

![一段式/二段式/三段式]
!#RELCD=_,_,S
!E(0,1)

!#ACTFG=_,_,S
!E(0,1)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD2.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=3;screen.width=[200,300,150,350];printer.width=[20,20,20,20];order=1">
[
["[L6601]                                 會計科子細目維護"],
[#<->#,"#FdFuncCode+功能",#FuncCodeX],
["#FdAcNoCode+科子細目",#AcNoCode,"-",#AcSubCode,"-",#AcDtlCode],["#FdAcNoItem+科子細目名稱",#AcNoItem],
["#FdAcctCode+業務科目代號",#AcctCode],["#FdAcctItem+業務科目名稱",#AcctItem],
[#<->#,"#FdClassCode+科子目級別",#ClassCode,#ClassCodeX],
[#<->#,"#FdAcBookFlag+帳冊別記號",#AcBookFlag,#AcBookFlagX],
[#<->#,"#FdDbCr+借貸別",#DbCr,#DbCrX],
[#<->#,"#FdAcctFlag+業務科目記號",#AcctFlag,#AcctFlagX],
[#<->#,"#FdReceivableFlag+銷帳科目記號",#ReceivableFlag,#ReceivableFlagX],
[#<->#,"#FdClsChkFlag+日結餘額檢查記號",#ClsChkFlag,#ClsChkFlagX],
[#<->#,"#FdInuseFlag+放款部使用記號",#InuseFlag,#InuseFlagX],
]
!---------- AP Button AREA ----------
![Buttom資料查詢]
!#BUF1=X,42,S

! 必輸欄位
#FdAcNoItem=X,2,L
#FdAcctCode=X,2,L
#FdAcctItem=X,2,L
#FdClassCode=X,2,L
#FdAcBookFlag=X,2,L
#FdDbCr=X,2,L
#FdAcctFlag=X,2,L
#FdReceivableFlag=X,2,L
#FdClsChkFlag=X,2,L
#FdInuseFlag=X,2,L

! 永遠為必輸欄位
#FdFuncCode=X,2,L
T(3,*)
#FdAcNoCode=X,2,L
T(3,*)

!---------- AP TEXT AREA Variables ----------
<include src="HELPRIM.icf::HELPRIM.rtn"/>

!FuncCode2(1:新增;2:修改;4:刪除)
#CODEFuncCode2=x,20,S                  
T(3,CdCode.FuncCode2)                  
                                      
#FuncCode2Help=x,50,S        

!業務科目代號
#CODEAcctCode=x,20,S                  
T(3,CdCode.AcctCode)                  
                                        
#AcctCodeHelp=x,1024,S

!科子目級別
#CODEClassCode=x,20,S                  
T(3,CdCode.ClassCode)                  
                                         
#ClassCodeHelp=x,200,S

!帳冊別記號
#CODEAcBookFlag=x,20,S                  
T(3,CdCode.AcBookFlag)                  
                                         
#AcBookFlagHelp=x,200,S

!業務科目記號
#CODEAcctFlag=x,30,S                  
T(3,CdCode.AcctFlag)                  
                                         
#AcctFlagHelp=x,100,S

!銷帳科目記號
#CODEReceivableFlag=x,25,S                  
T(3,CdCode.ReceivableFlag)                  
                                         
#ReceivableFlagHelp=x,100,S

!日結餘額檢查記號
#CODEClsChkFlag=x,25,S                  
T(3,CdCode.ClsChkFlag)                  
                                         
#ClsChkFlagHelp=x,100,S

#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#CODEFuncCode2,#CODEAcctCode,#CODEClassCode,#CODEAcBookFlag,#CODEAcctFlag,#CODEReceivableFlag,#CODEClsChkFlag)
R(1,XXR99)
CALL(#HelpProc)
T(2,@FuncCode2Help,#HelpDesc1)
T(2,@AcctCodeHelp,#HelpDesc2)
T(2,@ClassCodeHelp,#HelpDesc3)
T(2,@AcBookFlagHelp,#HelpDesc4)
T(2,@AcctFlagHelp,#HelpDesc5)
T(2,@ReceivableFlagHelp,#HelpDesc6)
T(2,@ClsChkFlagHelp,#HelpDesc7)

! 借貸別
#DbCrHelp=X,50,S
T(3,D:借;C:貸)

! 放款部使用記號
#UseHelp=X,50,S
T(3,0:可以使用;1:不可使用)


#CHAIN=A,1,S
T(4,CHAIN$)
T(2,@RimTxCode,#TXCD)
IF(#CHAIN!=1,V(P,此為連動交易，請從交易:[L6061 會計科子細目查詢]進入),$)

#NTXBUF=X,20,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)

#CHAIN_FuncCode=X,1,S
C(3,#CHAIN,1,T(1,#NTXBUF,1,1),S)

#CHAIN_AcNoCode=X,11,S
C(3,#CHAIN,1,T(1,#NTXBUF,2,11),S)

#CHAIN_AcSubCode=X,5,S
C(3,#CHAIN,1,T(1,#NTXBUF,13,5),S)

#CHAIN_AcDtlCode=X,2,S
C(3,#CHAIN,1,T(1,#NTXBUF,18,2),S)

#CHAINSET=X,1,S
C(3,#CHAIN,1,$,S)
T(2,@FuncCode,#CHAIN_FuncCode)
C(3,#FuncCode,1,S,$)
T(2,@AcNoCode,#CHAIN_AcNoCode)
T(2,@AcSubCode,#CHAIN_AcSubCode)
T(2,@AcDtlCode,#CHAIN_AcDtlCode)


! 功能 必須輸入(1: 新增;2: 修改;4: 刪除)
#FuncCode=A,1,S
T(F,@FuncCode,0)
C(3,#CHAIN,1,s,$)
HELP(#FuncCode2Help)
@V(H,#FuncCode2Help)

#FuncCodeX=X,12,L
T(H,#FuncCode,#FuncCode2Help)
C(2,#FuncCode,$,K(MODIFYBUTTON,新增),K(MODIFYBUTTON,修改),$,K(MODIFYBUTTON,刪除))

!刪除隱藏重新交易按鈕
#AGAIN=X,1,S
C(3,#FuncCode,4,$,S)
E(0,1)ASGN(AGAIN$)

#FUNCIND=_,_,S
E(0,#FuncCode)
<include src="COM.icf::CheckAuth.rtn"/>

! FuncCode=1,2 新增時為必輸欄位
#WKPSC=X,2,S

#WKSTAR=X,2,S
C(3,#CHAIN,1,S,T(3,*))

#WKSTAR1=X,2,S
C(3,#CHAIN,1,C(2,#FuncCode,S,T(3,*)),T(3,*))

#WKSTAR2=X,2,S
C(2,#FuncCode,S,T(3,*),T(3,*),S,S,S)

#WKNAME=X,1,S
T(2,@FdFuncCode,#WKSTAR)
T(2,@FdAcNoCode,#WKSTAR1)
T(2,@FdAcNoItem,#WKSTAR2)
T(2,@FdAcctCode,#WKPSC)
T(2,@FdAcctItem,#WKPSC)
T(2,@FdClassCode,#WKSTAR2)
T(2,@FdAcBookFlag,#WKSTAR2)
T(2,@FdDbCr,#WKSTAR2)
T(2,@FdAcctFlag,#WKSTAR2)
T(2,@FdReceivableFlag,#WKSTAR2)
T(2,@FdClsChkFlag,#WKSTAR2)
T(2,@FdInuseFlag,#WKSTAR2)

!顯示INPUT,LABEL
#WKSHOW=X,1,S
IF (#FuncCode==1 || #FuncCode==2,T(F,@AcNoItem,1)T(F,@AcctCode,1)T(F,@AcctItem,1)T(F,@ClassCode,1)T(F,@AcBookFlag,1)
                                 T(F,@DbCr,1)T(F,@AcctFlag,1)T(F,@ReceivableFlag,1)T(F,@ClsChkFlag,1)T(F,@InuseFlag,1)
                                ,T(F,@AcNoItem,0)T(F,@AcctCode,0)T(F,@AcctItem,0)T(F,@ClassCode,0)T(F,@AcBookFlag,0)
                                 T(F,@DbCr,0)T(F,@AcctFlag,0)T(F,@ReceivableFlag,0)T(F,@ClsChkFlag,0)T(F,@InuseFlag,0))

IF (#FuncCode==1 ,T(F,@AcNoCode,1)T(F,@AcSubCode,1)T(F,@AcDtlCode,1),
                  T(F,@AcNoCode,0)T(F,@AcSubCode,0)T(F,@AcDtlCode,0))

! 科子細目
#AcNoCode=X,11,I
C(3,#CHAIN,1,C(3,#FuncCode,1,$,s),$)
@V(2,0)

#AcSubCode=X,5,I
C(3,#CHAIN,1,C(3,#FuncCode,1,$,s),$)
!@C(4,#AcSubCode,s,$)
!V(9)

#AcDtlCode=X,2,I
C(3,#CHAIN,1,C(3,#FuncCode,1,$,s),$)
!@C(4,#AcDtlCode,s,$)
!V(9)

#SendL6R23=X,1,S
E(0,@RimFuncCode,#FuncCode)
T(2,@RimAcNoCode,#AcNoCode)
T(2,@RimAcSubCode,#AcSubCode)
T(2,@RimAcDtlCode,#AcDtlCode)
RESET_RIM(#SendL6R23,L6R23)
S(L6R23,1,#RimFuncCode,#RimTxCode,#RimAcNoCode,#RimAcSubCode,#RimAcDtlCode)
R(1,L6R23)

#RecL6R23=X,1,S
T(2,@AcNoItem,#L6R23AcNoItem)
T(2,@AcctCode,#L6R23AcctCode)
T(2,@AcctItem,#L6R23AcctItem)

E(0,@ClassCode,#L6R23ClassCode)
#ClassCodeTmp=X,10,L
T(H,#ClassCode,#ClassCodeHelp)
T(2,@ClassCodeX,#ClassCodeTmp)

E(0,@AcBookFlag,#L6R23AcBookFlag)
#AcBookFlagTmp=X,6,L
T(H,#AcBookFlag,#AcBookFlagHelp)
T(2,@AcBookFlagX,#AcBookFlagTmp)

T(2,@DbCr,#L6R23DbCr)
#DbCrTmp=X,2,L
T(H,#DbCr,#DbCrHelp)
T(2,@DbCrX,#DbCrTmp)

E(0,@AcctFlag,#L6R23AcctFlag)
#AcctFlagTmp=X,12,L
T(H,#AcctFlag,#AcctFlagHelp)
T(2,@AcctFlagX,#AcctFlagTmp)

E(0,@ReceivableFlag,#L6R23ReceivableFlag)
#ReceivableFlagTmp=X,16,L
T(H,#ReceivableFlag,#ReceivableFlagHelp)
T(2,@ReceivableFlagX,#ReceivableFlagTmp)

E(0,@ClsChkFlag,#L6R23ClsChkFlag)
#ClsChkFlagTmp=X,12,L
T(H,#ClsChkFlag,#ClsChkFlagHelp)
T(2,@ClsChkFlagX,#ClsChkFlagTmp)

E(0,@InuseFlag,#L6R23InuseFlag)
#InuseFlagTmp=X,12,L
T(H,#InuseFlag,#UseHelp)
T(2,@InuseFlagX,#InuseFlagTmp)

! 科子細目名稱
#AcNoItem=x,80,I
C(2,#FuncCode,$,$,$,$,s,s)
@V(7)

! 業務科目代號
#AcctCode=X,3,I
C(2,#FuncCode,$,$,$,$,s,s)
HELP(#AcctCodeHelp)
@T(2,@AcctItem,#L6R23AcctItem)
T(H,@AcctItem,#AcctCode,#AcctCodeHelp)
!HELP(310: 短期擔保放款;
!     320: 中期擔保放款;
!     330: 長期擔保放款;
!     990: 催收款項)
!@SWITCH(#AcctCode,310,T(2,@AcctItem,短期擔保放款),
!                  320,T(2,@AcctItem,中期擔保放款),
!                  330,T(2,@AcctItem,長期擔保放款),
!                  990,T(2,@AcctItem,催收款項),
!                     ,T(2,@AcctItem,#L6R23AcctItem))

! 業務科目名稱
#AcctItem=X,40,I
C(2,#FuncCode,$,$,$,$,s,s)
C(4,#AcctCode,S,$)


! 科子目級別
#ClassCode=A,1,I
C(2,#FuncCode,$,$,$,$,s,s)
HELP(#ClassCodeHelp)
@T(3,@ClassCodeX,)
V(H,#ClassCodeHelp)
!HELP(0: 可入帳科目;
!     1: 下編子細目)
!@V(1,0,1)

#ClassCodeX=X,10,L
T(H,#ClassCode,#ClassCodeHelp)
!C(2,#ClassCode,T(3,可入帳科目),
!               T(3,下編子細目))

! 帳冊別記號
#AcBookFlag=A,1,I
C(2,#FuncCode,$,$,$,$,s,s)
HELP(#AcBookFlagHelp)
@T(3,@AcBookFlagX,)
V(H,#AcBookFlagHelp)
!HELP(0: 不細分;
!     1: 細分;
!     2: 中介)
!@V(1,0,1,2)

#AcBookFlagX=X,6,L
T(H,#AcBookFlag,#AcBookFlagHelp)
!C(2,#AcBookFlag,T(3,不細分),
!                T(3,細分),
!                T(3,中介))

! 借貸別
#DbCr=X,1,I
C(2,#FuncCode,$,$,$,$,s,s)
HELP(#DbCrHelp)
@T(3,@DbCrX,)
V(H,#DbCrHelp)
!HELP(D: 借;
!     C: 貸)
!@V(3,D,C)

#DbCrX=X,2,L
T(H,#DbCr,#DbCrHelp)
!SWITCH(#DbCr,D,T(3,借),
!             C,T(3,貸))

! 業務科目記號
#AcctFlag=A,1,I
C(2,#FuncCode,$,$,$,$,s,s)
HELP(#AcctFlagHelp)
@T(3,@AcctFlagX,)
V(H,#AcctFlagHelp)
!HELP(0: 一般科目;
!     1: 資負明細科目)
!@V(1,0,1)

#AcctFlagX=X,12,L
T(H,#AcctFlag,#AcctFlagHelp)
!C(2,#AcctFlag,T(3,一般科目),
!              T(3,資負明細科目))

! 銷帳科目記號
#ReceivableFlag=A,1,I
C(2,#FuncCode,$,$,$,$,s,s)
HELP(#ReceivableFlagHelp)
@T(3,@ReceivableFlagX,)
V(H,#ReceivableFlagHelp)
!HELP(0: 非銷帳科目;
!     1: 會計銷帳科目;
!     2: 業務銷帳科目)
!@V(1,0,1,2)

#ReceivableFlagX=X,16,L
T(H,#ReceivableFlag,#ReceivableFlagHelp)
!C(2,#ReceivableFlag,T(3,非銷帳科目),
!                    T(3,會計銷帳科目),
!                    T(3,業務銷帳科目))

! 日結餘額檢查記號
#ClsChkFlag=A,1,I
C(2,#FuncCode,$,$,$,$,s,s)
HELP(#ClsChkFlagHelp)
@T(3,@ClsChkFlagX,)
V(H,#ClsChkFlagHelp)
!HELP(0: 不檢查;
!     1: 不過餘額;
!     2: 應大於等於零;
!     3: 應等於零;
!     4: 應小於等於零)
!@V(1,0,1,2,3,4)

#ClsChkFlagX=X,12,L
T(H,#ClsChkFlag,#ClsChkFlagHelp)
!C(2,#ClsChkFlag,T(3,不檢查),
!                T(3,不過餘額),
!                T(3,應大於等於零),
!                T(3,應等於零),
!                T(3,應小於等於零))

! 使用記號
#InuseFlag=A,1,I
C(2,#FuncCode,$,$,$,$,s,s)
HELP(#UseHelp)
@T(3,@InuseFlagX,)
V(H,#UseHelp)
!HELP(0: 可以使用;
!     1: 不可使用)
!@V(1,0,1)

#InuseFlagX=X,12,L
T(H,#InuseFlag,#UseHelp)
!C(2,#InuseFlag,T(3,可以使用),
!               T(3,不可使用))

#RPTFG=A,1,S
E(0,0)

!參考編號
#MRKEY=_,_,S
T(2,#AcNoCode+-+#AcSubCode+-+#AcDtlCode)

<include src="ROM.icf::L0Rim.dec"/>
<include src="ROM.icf::L6R23.dec"/>
</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!---------- TXFORM = L6601 ----------
<sub type="FORM" name="L6601">

#SCRPRT=_,_,S
C(5,#TXFORM,L6601,$,S)

#SCRTIL=_,_,S
T(3,[L6601] 會計科子細目維護)

</sub>


!------ 上行電文 ------
<sub type="TIM">
#FuncCode#AcNoCode#AcSubCode#AcDtlCode#AcNoItem#AcctCode#AcctItem#ClassCode#AcBookFlag#DbCr#AcctFlag#ReceivableFlag#ClsChkFlag#InuseFlag
#END
</sub>


!------ 下行電文TOM ------
<sub type="TOM">

TXFORM=L6601

^

<include src="COM.icf::TRCTL.tom"/>
<include src="ROM.icf::L6R23.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
</sub>


!---------- 單據輸出組合 ----------
<sub type="SELECT">
<include src="PRT.icf::UPD01.sel"/>
</sub>
