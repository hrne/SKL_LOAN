----- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">

#TXCD
T(3,L6501)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD2.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=3;screen.width=[250,250,250,250];printer.width=[30,25,30,20];order=1;">
[
["[L6501]                                 系統變數及系統值設定"],
["#FdGraceDays+違約寬限天數（營業日）",#GraceDays],
["#FdAchAuthOneTime+ACH授權提出一日一批",#AchAuthOneTime,#AchAuthOneTimeX],
[#<->#,"#FdAchDeductFlag+ACH扣款方式",#AchDeductFlag,#AchDeductFlagX],
["#FdDeductDD1+扣款特定日1",#AchDeductDD1],
["#FdDeductDD2+扣款特定日2",#AchDeductDD2],
["#FdDeductDD3+扣款特定日3",#AchDeductDD3],
["#FdDeductDD4+扣款特定日4",#AchDeductDD4],
["#FdDeductDD5+扣款特定日5",#AchDeductDD5],
["#FdSecondDeductDays+特定日二扣營業日差",#AchSecondDeductDays],
[#<->#,"#FdDeductMethod+連續日扣款方式",#AchDeductMethod,#AchDeductMethodX],
[#<->#,"#FdPostDeductFlag+POST扣款方式",#PostDeductFlag,#PostDeductFlagX],
["#FdDeductDD6+扣款特定日1",#PostDeductDD1],
["#FdDeductDD7+扣款特定日2",#PostDeductDD2],
["#FdDeductDD8+扣款特定日3",#PostDeductDD3],
["#FdDeductDD9+扣款特定日4",#PostDeductDD4],
["#FdDeductDD10+扣款特定日5",#PostDeductDD5],
["#FdSecondDeductDays2+特定日二扣營業日差",#PostSecondDeductDays],
[#<->#,"#FdDeductMethod2+連續日扣款方式",#PostDeductMethod,#PostDeductMethodX],
["#FdLoanDeptCustNo+放款部收款專戶戶號",#LoanDeptCustNo],
["#FdNegDeptCustNo+前置協商收款專戶戶號",#NegDeptCustNo],
["#FdPerfBackRepayAmt+業績追回之部分還款金額條件",#PerfBackRepayAmt],
["#FdPerfBackPeriodS+業績追回之起止期數",#PerfBackPeriodS,"期～",#PerfBackPeriodE,"期"],
[#<->#,"#FdEmpNoList+業績追回通知員工代碼清單",#EmpNoList],
[#<->#,"#FdAcctCode310A+擔保放款年限","短期",#AcctCode310A,"年～",#AcctCode310B,"年 ， 中期"
                                            ,#AcctCode320A,"年以上～",#AcctCode320B,"年 ， 長期"
                                            ,#AcctCode330A,"年以上～",#AcctCode330B,"年"],
[#<->#,"#FdReduceAmtLimit1+經辦減免金額限額",#ReduceAmtLimit1],
[#<->#,"#FdReduceAmtLimit2+課主管金額限額",#ReduceAmtLimit2],
[#<->#,"#FdReduceAmtLimit3+部主管金額限額",#ReduceAmtLimit3],
[#<->#,"#FdCoreRemitLimit+核心匯款金額上限",#CoreRemitLimit],
["#FdPreRepayTerms+單筆預收期數",#PreRepayTerms],["#FdPreRepayTermsBatch+批次預收期數",#PreRepayTermsBatch],
["#FdShortPrinPercent+回收時可短繳本金金額之百分比",#ShortPrinPercent," 限額",#ShortPrinLimit],
["#FdShortIntPercent+回收時可短繳利息金額之百分比",#ShortIntPercent],
["#FdPerfDate+業績日期",#PerfDate],["#FdAcBookAdjDate+帳冊別帳務調整日期",#AcBookAdjDate],
[#<->#,"#FdBatchFireFeeFg+批次收取當月火險費",#BatchFireFeeFg],
[#<->#,"#FdInsuSettleDate+火險保費已解付新產日期",#InsuSettleDate],
[#<->#,"#FdAmlFg+AML檢查記號",#AmlFg,#AmlFgX],
[#<->#,"#FdAmlUrl+AML網址",#AmlUrl],
[#<->#,"#FdFtpUrl+FTP網址（撥款匯款媒體檔）",#FtpUrl],
[#<->#,"#FdSmsFtpUrl+FTP網址（簡訊媒體檔）",#SmsFtpUrl],
[#<->#,"#FdEbsUrl+EBS網址(會計資訊系統)",#EbsUrl],
[#<->#,"#FdIcsUrl+ICS網址",#IcsUrl],
]
!---------- AP Button AREA ----------
![Buttom資料查詢]
!#BUF1=X,42,S

#FdFuncCode=X,2,L
T(3,*)
#FdGraceDays=X,2,L
T(3,*)
#FdAchAuthOneTime=X,2,L
T(3,*)
#FdAchDeductFlag=X,2,L
T(3,*)
#FdPostDeductFlag=X,2,L
T(3,*)
#FdDeductDD1=X,2,L
T(3,*)
#FdDeductDD2=X,2,L
T(3,*)
#FdDeductDD3=X,2,L
T(3,*)
#FdDeductDD4=X,2,L
T(3,*)
#FdDeductDD5=X,2,L
T(3,*)
#FdDeductDD6=X,2,L
T(3,*)
#FdDeductDD7=X,2,L
T(3,*)
#FdDeductDD8=X,2,L
T(3,*)
#FdDeductDD9=X,2,L
T(3,*)
#FdDeductDD10=X,2,L
T(3,*)
#FdSecondDeductDays=X,2,L
T(3,*)
#FdDeductMethod=X,2,L
T(3,*)
#FdSecondDeductDays2=X,2,L
T(3,*)
#FdDeductMethod2=X,2,L
T(3,*)
#FdLoanDeptCustNo=X,2,L
T(3,*)
#FdNegDeptCustNo=X,2,L
T(3,*)
#FdPerfBackRepayAmt=X,2,L
T(3,*)
#FdPerfBackPeriodS=X,2,L
T(3,*)
#FdAcctCode310A=X,2,L
T(3,*)
!!#FdAcctCode320A=X,2,L
!!T(3,*)
!!#FdAcctCode330A=X,2,L
!!T(3,*)
#FdEmpNoList=X,2,L
T(3,*)
#FdReduceAmtLimit1=X,2,L
T(3,*)
#FdReduceAmtLimit2=X,2,L
T(3,*)
#FdReduceAmtLimit3=X,2,L
T(3,*)
#FdCoreRemitLimit=X,2,L
T(3,*)
#FdPreRepayTerms=X,2,L
T(3,*)
#FdPreRepayTermsBatch=X,2,L
T(3,*)
#FdShortPrinPercent=X,2,L
T(3,*)
#FdShortIntPercent=X,2,L
T(3,*)
#FdAmlFg=X,2,L
T(3,*)
#FdAmlUrl=X,2,L
T(3,*)
#FdFtpUrl=X,2,L
T(3,*)
#FdSmsFtpUrl=X,2,L
T(3,*)
#FdPerfDate=X,2,L
T(3, )
#FdAcBookAdjDate=X,2,L
T(3, )
#FdEbsUrl=X,2,L
T(3,*)
#FdIcsUrl=X,2,L
T(3,*)
#FdBatchFireFeeFg=X,2,L
T(3,*)
#FdInsuSettleDate=X,2,L

!---------- AP TEXT AREA Variables ----------
<include src="HELPRIM.icf::HELPRIM.rtn"/>

!AchAuthOneTime(Y:一日一批,N:一日多批)
#CDCODEAchAuthOneTime=x,30,S                  
T(3,CdCode.AchAuthOneTime)                  
#AchAuthOneTimeHelp=x,100,S

!SpcDateFlag(1:特定日,2:連續日)
#CDCODSpcDateFlag=x,30,S                  
T(3,CdCode.SpcDateFlag)                  
#SpcDateHelp=x,100,S

!DeductMethod(1:連續扣款扣五個營業日（寬限期內）2:每次均重算至當日為止應繳期數之期金、延滯息&違約金合計)
#CDCODEDeductMethod=x,30,S                  
T(3,CdCode.DeductMethod)                  
#DeductMethodHelp=x,300,S

!AmlFg(0:系統自動檢核,1:需人工確認),2:不檢核（測試套用）)
#CDCODEAmlFg=x,30,S                  
T(3,CdCode.AmlFg)                  
#AmlFgHelp=x,100,S

!YesNo YesNo
#CDDEF05=x,20,S
T(3,CdCode.YesNo)

#YesNoHelp=x,1024,S


#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#CDCODEAchAuthOneTime,#CDCODSpcDateFlag,#CDCODEDeductMethod,#CDCODEAmlFg,#CDDEF05)
R(1,XXR99)
CALL(#HelpProc)
T(2,@AchAuthOneTimeHelp,#HelpDesc1)
T(2,@SpcDateHelp,#HelpDesc2)
T(2,@DeductMethodHelp,#HelpDesc3)
T(2,@AmlFgHelp,#HelpDesc4)
T(2,@YesNoHelp,#HelpDesc5)

#CHAIN=A,1,S
T(4,CHAIN$)
T(2,@RimTxCode,#TXCD)

! 功能 (2: 修改)
#FuncCode=A,1,S
E(0,2)
K(MODIFYBUTTON,修改)

#FUNCIND=_,_,S
E(0,#FuncCode)
<include src="COM.icf::CheckAuth.rtn"/>


! 業務類型
#BusinessType=X,2,S
T(3,LN)

! 不顯示框線
T(F,@PerfDate,0)
T(F,@AcBookAdjDate,0)

#SendL6R28=X,1,S
E(0,@RimFuncCode,#FuncCode)
T(2,@RimBusinessType,#BusinessType)
RESET_RIM(#SendL6R28,L6R28)
S(L6R28,1,#RimFuncCode,#RimTxCode,#RimBusinessType)
R(1,L6R28)

E(0,@GraceDays,#L6R28GraceDays)

T(2,@AchAuthOneTime,#L6R28AchAuthOneTime)
#AchAuthOneTimeTmp=X,8,L
T(H,#AchAuthOneTime,#AchAuthOneTimeHelp)
T(2,@AchAuthOneTimeX,#AchAuthOneTimeTmp)

!ACH
E(0,@AchDeductFlag,#L6R28AchDeductFlag)
#AchDeductFlagTmp=X,6,L
T(H,#AchDeductFlag,#SpcDateHelp)
T(2,@AchDeductFlagX,#AchDeductFlagTmp)
E(0,@AchDeductDD1,#L6R28AchDeductDD1)
E(0,@AchDeductDD2,#L6R28AchDeductDD2)
E(0,@AchDeductDD3,#L6R28AchDeductDD3)
E(0,@AchDeductDD4,#L6R28AchDeductDD4)
E(0,@AchDeductDD5,#L6R28AchDeductDD5)
E(0,@AchSecondDeductDays,#L6R28AchSecondDeductDays)
E(0,@AchDeductMethod,#L6R28AchDeductMethod)
C(3,#AchDeductFlag,2,INVOKEJS(SHOW,p1,3,5,0),INVOKEJS(SHOW,p1,3,5,1))

!POST
E(0,@PostDeductFlag,#L6R28PostDeductFlag)
#PostDeductFlagTmp=X,6,L
T(H,#PostDeductFlag,#SpcDateHelp)
T(2,@PostDeductFlagX,#PostDeductFlagTmp)
E(0,@PostDeductDD1,#L6R28PostDeductDD1)
E(0,@PostDeductDD2,#L6R28PostDeductDD2)
E(0,@PostDeductDD3,#L6R28PostDeductDD3)
E(0,@PostDeductDD4,#L6R28PostDeductDD4)
E(0,@PostDeductDD5,#L6R28PostDeductDD5)
E(0,@PostSecondDeductDays,#L6R28PostSecondDeductDays)
E(0,@PostDeductMethod,#L6R28PostDeductMethod)
C(3,#PostDeductFlag,2,INVOKEJS(SHOW,p1,8,10,0),INVOKEJS(SHOW,p1,8,10,1))

#DeductMethodTmp=X,60,L
T(H,#AchDeductMethod,#DeductMethodHelp)
T(2,@AchDeductMethodX,#DeductMethodTmp)

E(0,@LoanDeptCustNo,#L6R28LoanDeptCustNo)
E(0,@NegDeptCustNo,#L6R28NegDeptCustNo)
E(0,@PerfBackRepayAmt,#L6R28PerfBackRepayAmt)
E(0,@PerfBackPeriodS,#L6R28PerfBackPeriodS)
E(0,@PerfBackPeriodE,#L6R28PerfBackPeriodE)
T(2,@EmpNoList,#L6R28EmpNoList)
E(0,@AcctCode310A,#L6R28AcctCode310A)
E(0,@AcctCode310B,#L6R28AcctCode310B)
E(0,@AcctCode320A,#L6R28AcctCode320A)
E(0,@AcctCode320B,#L6R28AcctCode320B)
E(0,@AcctCode330A,#L6R28AcctCode330A)
E(0,@AcctCode330B,#L6R28AcctCode330B)
E(0,@ReduceAmtLimit1,#L6R28ReduceAmtLimit1)
E(0,@ReduceAmtLimit2,#L6R28ReduceAmtLimit2)
E(0,@ReduceAmtLimit3,#L6R28ReduceAmtLimit3)
E(0,@CoreRemitLimit,#L6R28CoreRemitLimit)
E(0,@PreRepayTerms,#L6R28PreRepayTerms)
E(0,@PreRepayTermsBatch,#L6R28PreRepayTermsBatch)
E(0,@ShortPrinPercent,#L6R28ShortPrinPercent)
E(0,@ShortPrinLimit,#L6R28ShortPrinLimit)
E(0,@ShortIntPercent,#L6R28ShortIntPercent)

E(0,@AmlFg,#L6R28AmlFg)
#AmlFgTmp=X,20,L
T(H,#AmlFg,#AmlFgHelp)
T(2,@AmlFgX,#AmlFgTmp)

T(2,@AmlUrl,#L6R28AmlUrl)
T(2,@FtpUrl,#L6R28FtpUrl)
T(2,@SmsFtpUrl,#L6R28SmsFtpUrl)
E(0,@PerfDate,#L6R28PerfDate)
E(0,@AcBookAdjDate,#L6R28AcBookAdjDate)
T(2,@EbsUrl,#L6R28EbsUrl)
T(2,@IcsUrl,#L6R28IcsUrl)
T(2,@BatchFireFeeFg,#L6R28BatchFireFeeFg)
E(0,@InsuSettleDate,#L6R28InsuSettleDate)



! 違約寬限天數(營業日)
#GraceDays=N,2,I

! ACH授權提出一日一批
#AchAuthOneTime=X,1,I
HELP(#AchAuthOneTimeHelp)
@T(3,@AchAuthOneTimeX,)
V(H,#AchAuthOneTimeHelp)

#AchAuthOneTimeX=X,8,L
T(H,#AchAuthOneTime,#AchAuthOneTimeHelp)

! ACH扣款方式
#AchDeductFlag=N,1,I
HELP(#SpcDateHelp)
@T(3,@AchDeductFlagX,)
V(H,#SpcDateHelp)
C(3,#AchDeductFlag,2,INVOKEJS(SHOW,p1,3,5,0),INVOKEJS(SHOW,p1,3,5,1))

#AchDeductFlagX=X,6,L
T(H,#AchDeductFlag,#SpcDateHelp)

! ACH扣款特定日1
#AchDeductDD1=N,2,I
C(3,#AchDeductFlag,2,S,$)

! ACH扣款特定日2
#AchDeductDD2=N,2,I
C(3,#AchDeductFlag,2,S,$)

! ACH扣款特定日3
#AchDeductDD3=N,2,I
C(3,#AchDeductFlag,2,S,$)

! ACH扣款特定日4
#AchDeductDD4=N,2,I
C(3,#AchDeductFlag,2,S,$)

! ACH扣款特定日5
#AchDeductDD5=N,2,I
C(3,#AchDeductFlag,2,S,$)

! ACH特定日二扣營業日差
#AchSecondDeductDays=N,2,I
C(3,#AchDeductFlag,2,S,$)

! ACH連續日扣款方式
#AchDeductMethod=N,1,I
HELP(#DeductMethodHelp)
@T(3,@AchDeductMethodX,)
V(H,#DeductMethodHelp)

#AchDeductMethodX=X,60,L
T(H,#AchDeductMethod,#DeductMethodHelp)

! POST扣款方式
#PostDeductFlag=N,1,I
HELP(#SpcDateHelp)
@T(3,@PostDeductFlagX,)
V(H,#SpcDateHelp)
C(3,#PostDeductFlag,2,INVOKEJS(SHOW,p1,8,10,0),INVOKEJS(SHOW,p1,8,10,1))

#PostDeductFlagX=X,6,L
T(H,#PostDeductFlag,#SpcDateHelp)

! POST扣款特定日1
#PostDeductDD1=N,2,I
C(3,#PostDeductFlag,2,S,$)

! POST扣款特定日2
#PostDeductDD2=N,2,I
C(3,#PostDeductFlag,2,S,$)

! POST扣款特定日3
#PostDeductDD3=N,2,I
C(3,#PostDeductFlag,2,S,$)

! POST扣款特定日4
#PostDeductDD4=N,2,I
C(3,#PostDeductFlag,2,S,$)

! POST扣款特定日5
#PostDeductDD5=N,2,I
C(3,#PostDeductFlag,2,S,$)

! POST特定日二扣營業日差
#PostSecondDeductDays=N,2,I
C(3,#PostDeductFlag,2,S,$)

! POST連續日扣款方式
#PostDeductMethod=N,1,I
HELP(#DeductMethodHelp)
@T(3,@PostDeductMethodX,)
V(H,#DeductMethodHelp)

#PostDeductMethodX=X,60,L
T(H,#PostDeductMethod,#DeductMethodHelp)

! 放款部收款專戶戶號
#LoanDeptCustNo=A,7,I
@V(7)

! 前置協商收款專戶戶號
#NegDeptCustNo=A,7,I
@V(7)

! 業績追回之部分還款金額條件
#PerfBackRepayAmt=m,14,I

! 業績追回之起期數
#PerfBackPeriodS=N,3,I

! 業績追回之止期數
#PerfBackPeriodE=N,3,I

!業績追回通知員工代碼清單
#EmpNoList=X,150,I

! 短期擔保放款下限
#AcctCode310A=N,3,I

! 短期擔保放款上限
#AcctCode310B=N,3,I
@V(5,#AcctCode310A,999)

! 中期擔保放款下限
#AcctCode320A=N,3,I
@V(5,#AcctCode310B,999)

! 中期擔保放款上限
#AcctCode320B=N,3,I
@V(5,#AcctCode320A,999)

! 長期擔保放款下限
#AcctCode330A=N,3,I
@V(5,#AcctCode320B,999)

! 長期擔保放款上限
#AcctCode330B=N,3,I
@V(5,#AcctCode330A,999)

! 經辦減免金額限額
#ReduceAmtLimit1=N,5,I
! 課主管減免金額限額
#ReduceAmtLimit2=N,5,I
! 部主管減免金額限額
#ReduceAmtLimit3=N,5,I

!核心匯款金額上限
#CoreRemitLimit=m,14,I

! 單筆預收期數
#PreRepayTerms=N,3,I

! 批次預收期數
#PreRepayTermsBatch=N,3,I

! 回收時可短繳本金金額之百分比
#ShortPrinPercent=N,3,I
@V(5,0,50)

!限額
#ShortPrinLimit=N,5,I

! 回收時可短繳利息金額之百分比
#ShortIntPercent=N,3,I
@V(5,0,50)



!批次收取當月火險費
#BatchFireFeeFg=X,1,I
HELP(#YesNoHelp)
@V(7)
 V(H,#YesNoHelp)
!火險保費已解付新產日期
#InsuSettleDate=D,7,L

! AML檢查記號 0:系統自動檢核 1:需人工確認 2:不檢核(測試套用)
#AmlFg=N,1,I
HELP(#AmlFgHelp)
@T(3,@AmlFgX,)
V(H,#AmlFgHelp)

#AmlFgX=X,20,L
T(H,#AmlFg,#AmlFgHelp)

! AML網址
#AmlUrl=x,100,I
@V(7)

! FTP網址(撥款匯款檔)
#FtpUrl=x,100,I
@V(7)

! FTP網址(簡訊媒體檔)
#SmsFtpUrl=x,100,I
@V(7)

! 業績日期
#PerfDate=D,7,S

! 帳冊別帳務調整日期
#AcBookAdjDate=D,7,S


! EBS網址(會計資訊系統)
#EbsUrl=x,100,I
@V(7)

! ICS網址
#IcsUrl=x,100,I
@V(7)

#RPTFG=A,1,S
E(0,0)

<include src="ROM.icf::L0Rim.dec"/>
<include src="ROM.icf::L6R28.dec"/>
</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!---------- TXFORM= L6501 ----------
<sub type="FORM" name="L6501">

#SCRPRT=_,_,S
C(5,#TXFORM,L6501,$,S)

#SCRTIL=_,_,S
T(3,[L6501] 系統變數及系統值設定)

</sub>


!------ 上行電文 ------
<sub type="TIM">
#FuncCode
#BusinessType
#GraceDays
#AchAuthOneTime
#AchDeductFlag
#AchDeductDD1
#AchDeductDD2
#AchDeductDD3
#AchDeductDD4
#AchDeductDD5
#AchSecondDeductDays
#AchDeductMethod
#PostDeductFlag
#PostDeductDD1
#PostDeductDD2
#PostDeductDD3
#PostDeductDD4
#PostDeductDD5
#PostSecondDeductDays
#PostDeductMethod
#LoanDeptCustNo
#NegDeptCustNo
#PerfBackRepayAmt
#PerfBackPeriodS
#PerfBackPeriodE
#EmpNoList
#AcctCode310A
#AcctCode310B
#AcctCode320A
#AcctCode320B
#AcctCode330A
#AcctCode330B
#ReduceAmtLimit1
#ReduceAmtLimit2
#ReduceAmtLimit3
#CoreRemitLimit
#PreRepayTerms
#PreRepayTermsBatch
#ShortPrinPercent
#ShortPrinLimit
#ShortIntPercent
#BatchFireFeeFg
#AmlFg
#AmlUrl
#FtpUrl
#SmsFtpUrl
#PerfDate
#AcBookAdjDate
#EbsUrl
#IcsUrl
#END
</sub>


!------ 下行電文TOM ------
<sub type="TOM">

TXFORM=L6501

^

<include src="COM.icf::TRCTL.tom"/>
<include src="ROM.icf::L6R28.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
</sub>


!---------- 單據輸出組合 ----------
<sub type="SELECT">
<include src="PRT.icf::UPD01.sel"/>
</sub>
