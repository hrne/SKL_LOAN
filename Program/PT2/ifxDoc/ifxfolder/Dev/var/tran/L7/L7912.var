!---------- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">
!#TXCD
!T(3,L7912)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,131)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,10)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,40)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)

#button=x,100,S
K(MODIFYBUTTON,查詢)

! #button=x,100,S
! T(2,{cmd=CHAIN; ntxcd=L5101; ntxbuf=1; ntxbuf5=type})ASGN(BTN_NEW1$)
! K(MODIFYBUTTON,1,新增資料)
! K(MODIFYBUTTON,查詢)

</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="L7912" layout="cols=1;screen.width=[250,750];printer.width=[20,80];order=1">
[
["[L7912]                                 (eloan)戶號額度查詢"],
[#<->#,"#FdCustId+客戶身分證字號+/+統一編號",#CustId],
]

#FdCustId=X,2,L
T(3,*)

#CHAIN=A,1,S
T(4,CHAIN$) 

! 客戶身分證字號/統一編號
#CustId=X,10,I
@V(7)
A(ID_UNINO,1,#CustId)

#RPTFG=A,1,S
E(0,1)

! 日期
#AcDate=D,7,S
E(0,#SYSDATE)

!身分證找戶號
<include src="ROM.icf::L2R47.dec"/>
#Rim2R47CustId=X,10,S

#RimL2R47=X,1,S
C(4,#CustId,S,$)
T(2,@Rim2R47CustId,#CustId)
RESET_RIM(#RimL2R47,L2R47)
S(L2R47,1,#Rim2R47CustId)
R(1,L2R47)

#MRKEY=_,_,S
C(4,#CustId,S,$)
T(2,#L2R47CustNo)

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!------------ TXFORM = L7912 -----------
<sub type="FORM" name="L7912">
!#SCRPRT=_,_,S
!C(5,#TXFORM,L7912,$,S)

#SCRTIL=_,_,S
T(3,[L7912] eloan 戶號)



! 借款人戶號
#OCustNo=A,7,O
! 額度編號
#OFacmNo=A,3,O
! 申請號碼
#OApplNo=A,7,O
! 核准科目
#OAcctCode=X,3,O
! 核准額度
#OLineAmt=n,14,O
! 貸款期間年
#OLoanTermYy=A,2,O
! 貸款期間月
#OLoanTermMm=A,2,O
! 貸款期間日
#OLoanTermDd=A,3,O
! 動支期限
#OUtilDeadline=D,7,O
! 額度到期日
#OFacMaturityDate=D,7,O
! 指標利率代碼
#OBaseRateCode=X,2,O
! 循環動用
#ORecycleCode=X,1,O
! 循環動用期限
#ORecycleDeadline=D,7,O
! 加碼利率
#ORateIncr=n,2.4,O
! 放款餘額
#OLoanBal=n,14,O
! 核准利率
#OApproveRate=n,2.4,O
! 初貸日
#OFirstDrawdownDate=D,7,O
! 到期日
#OMaturityDate=D,7,O
! 半年內曾滯繳一期以上(0:無 1:有)
#OOverdue1MFlag=A,1,O
! 近一年內有二期以上延遲逾7日(含)繳款
#OOverdue7DFlag=A,1,O
! 循環動用
#ORecycleCode1=X,1,O
! 已動用額度餘額
#OUtilBal=n,14,O
! 核准幣別
#OCurrencyCode=X,3,O
! 火險服務
#OFireOfficer=X,6,O

#LOOP=X,1,S
E(0,1)ASGN(LOOP$)

! 擔保品代號1
#OOClCode1=A,1,O
! 擔保品代號2
#OOClCode2=A,2,O
! 擔保品編號
#OOClNo=A,7,O
</sub>

!------ 上行電文 TEXT ------
<sub type="TIM">
#CustId
#AcDate
#END
</sub>

!------ 下行電文TOM ------
<sub type="TOM">
<include src="COM.icf::TRCTL.tom"/>
<include src="ROM.icf::L2R47.tom"/>
TXFORM=L7912
#OCustNo
#OFacmNo
#OApplNo
#OAcctCode
#OLineAmt
#OLoanTermYy
#OLoanTermMm
#OLoanTermDd
#OUtilDeadline
#OFacMaturityDate
#OBaseRateCode
#ORecycleCode
#ORecycleDeadline
#ORateIncr
#OLoanBal
#OApproveRate
#OFirstDrawdownDate
#OMaturityDate
#OOverdue1MFlag
#OOverdue7DFlag
#ORecycleCode1
#OUtilBal
#OCurrencyCode
#OFireOfficer
#OOClCode1
#OOClCode2
#OOClNo
^
</sub>


!---------- 單據輸出組合 ----------


<sub type="PART" name="L7912" layout="cols=1;screen.width=[100,1000];printer.width=[20,20];">
[
["[L7912]                                 (eloan)戶號額度查詢"],
[""],
]

</sub>

<sub type="SELECT">

#RPTFG=0,QUERY.GRID
#any={detail:true, header:'L7912.part',caption:'', width:1020, rowNum:20, rowList:[20,40,60]}

^
<include src="PRT.icf::INQ01.sel" map="i=L7912;cpi=15"/>
#CustId
#OCustNo#OFacmNo#OApplNo#OAcctCode#OLineAmt#OLoanTermYy#OLoanTermMm#OLoanTermDd#OUtilDeadline#OFacMaturityDate#OBaseRateCode#ORecycleCode
#ORecycleDeadline#ORateIncr#OLoanBal#OApproveRate#OFirstDrawdownDate#OMaturityDate#OOverdue1MFlag#OOverdue7DFlag#ORecycleCode1#OUtilBal
#OCurrencyCode#OFireOfficer
%
#OOClCode1#OOClCode2#OOClNo
@^
</sub>
