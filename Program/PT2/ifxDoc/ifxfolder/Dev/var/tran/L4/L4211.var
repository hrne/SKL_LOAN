!---------- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">
</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
</sub>


!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="L4211" layout="cols=3;screen.width=[150,400,150,300];printer.width=[20,80];order=1">
[
["[L4211]                                 匯款轉帳報表                                 "],
[#<->#,"#FdFunctionCodeX+報表種類",#FunctionCode,#FunctionCodeX], 
[#<->#,"#FdAcDate+會計日期",#AcDate],
[#<->#,"#FdEntryDate+入帳日期",#EntryDate],
[#<->#,"#FdReconCode+存摺代號",#ReconCode,#ReconCodeX],
[#<->#,"#FdReportNo+報表項目",#ReportNo,#ReportNoX],
]

#FdFunctionCodeX=X,2,L
T(3,*)
#FdAcDate=X,2,L
T(3,*)
#FdEntryDate=X,2,L
T(3,*)
#FdReconCode=X,2,L
T(3,*)
#FdReportNo=X,2,L
T(3,*)

#CHAIN=A,1,S
T(4,CHAIN$)

#NTXBUF=X,20,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
!T(1,@FunctionCode,#NTXBUF,1,1)

#FunctionCodeHelp=X,30,S
T(3,0:全部;1:成功;2:人工;3:失敗)

! 作業項目
#FunctionCode=A,1,I
HELP(#FunctionCodeHelp)
@V(H,#FunctionCodeHelp)

#FunctionCodeX=X,10,L
T(H,#FunctionCode,#FunctionCodeHelp)

!0.全部：隱藏報表種類
!1.成功：隱藏入帳日期
!2.人工：隱藏入帳日期、報表種類
!3.失敗：隱藏會計日期、報表種類
#CheckHide=X,1,S
IF(#FunctionCode == 3 ,INVOKEJS(SHOW,L4211,2,2,0),INVOKEJS(SHOW,L4211,2,2,1))
IF(#FunctionCode == 1 || #FunctionCode == 2 || #FunctionCode == 0,INVOKEJS(SHOW,L4211,3,3,0),INVOKEJS(SHOW,L4211,3,3,1))
IF(#FunctionCode == 0 || #FunctionCode == 2 || #FunctionCode == 3,INVOKEJS(SHOW,L4211,5,5,0),INVOKEJS(SHOW,L4211,5,5,1))

! 會計日期
#AcDate=D,7,I
C(3,#FunctionCode,0,$,C(3,#FunctionCode,1,$,C(3,#FunctionCode,2,$,S)))
E(0,#SYSDATE)
@V(7)A(DATE,0,#AcDate)

! 入帳日 
#EntryDate=D,7,I
C(3,#FunctionCode,3,$,S)
E(0,@EntryDate,#SYSDATE)
@V(7)A(DATE,0,#EntryDate)

#ReconCodeHelp=X,100,S
T(3,A1:企金;A2:期款;A3:還本;A6:債協;A7:前置協商收款專戶; :全部)

#ReconCode=X,3,I
HELP(#ReconCodeHelp)
@
C(4,#ReconCode,$,V(H,#ReconCodeHelp))

#ReconCodeX=X,20,L
T(H,#ReconCode,#ReconCodeHelp)

#ReportNoHelp=X,100,S
T(3,1:總傳票明細表;2:入帳後撿核明細表)

#ReportNo=X,1,I
C(3,#FunctionCode,1,HELP(#ReportNoHelp),S)
@V(7)
C(4,#ReportNo,$,V(H,#ReportNoHelp))

#ReportNoX=X,20,L
T(H,#ReportNo,#ReportNoHelp)

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>


!------ 上行電文 TEXT ------
<sub type="TIM">
#FunctionCode
#AcDate
#EntryDate
#ReconCode
#ReportNo
</sub>

!------ 下行電文TOM ------
<sub type="TOM">
<include src="COM.icf::TRCTL.tom"/>
TXFORM=L4211
^
</sub>


!---------- 單據輸出組合 ----------
<sub type="SELECT">
<include src="PRT.icf::UPD01.sel"/>
</sub>
