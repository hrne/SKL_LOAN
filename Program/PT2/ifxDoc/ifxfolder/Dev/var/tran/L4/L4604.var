!---------- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">
!#TXCD
!T(3,L4604)

#SECNO=_,_,S
T(3,09)

</sub>



<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="L4604" layout="cols=1;screen.width=[250,850];printer.width=[20,80];order=1">
[
["[L4604]@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@火險保費未繳轉借支作業"],
[#<->#,"#FdInsuEndMonth+火險到期年月",#InsuEndMonth,#BTNA],
["#FdTxAmt1+正常繳款（放款系統出帳）",#TxAmt1],
["#FdTxAmt2+墊付火險費（總帳系統出帳）",#TxAmt2],
]
#BTNA=X,1,I,ui:button;value:火險保費明細查詢;enable:1;tabbable:0

#FdInsuEndMonth=X,2,L
T(3,*)
#FdTxAmt1=X,2,L
#FdTxAmt2=X,2,L

#CHAIN=A,1,S
T(4,CHAIN$) 

#FORE_MONTH=D,8,S
D(7,3,#SYSDATE,1,0)
T(1,@InsuEndMonth,#FORE_MONTH,2,5)

#BUFA=X,9,S
T(2,1+#InsuEndMonth+99+0)
#BINDA=X,1,S
BIND(#BTNA,click, {cmd=CHAIN; ntxcd=L4961; ntxbuf=#BUFA})

! 轉發日期
#InsuEndMonth=A,5,I
@A(YM,1,#InsuEndMonth)

#BUFB=X,8,S
T(2,1+#InsuEndMonth+99+0)
#BINDB=X,1,S
BIND(#BTNA,click, {cmd=CHAIN; ntxcd=L4961; ntxbuf=#BUFB})


#RcvL4r34=X,1,S	
RESET_RIM(#RcvL4r34,L4R34)
S(L4R34,1,#InsuEndMonth)
R(1,L4R34)
E(0,@TxAmt1,#L4r34TxAmt1)
E(0,@TxAmt2,#L4r34TxAmt2)


#TxAmt1=m,14,L

#TxAmt2=m,14,L


<include src="ROM.icf::L4R34.dec"/>
</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
<include src="PRT.icf::FM101.rtn"/>
![顯示註記]
#L4604PRT=A,1,S
C(5,#TXFORM,L4604,E(0,1),E(0,0))
![資料表頭(HEADER)長度]
#L4604HD=n,3,S
E(0,6)ASGN(INQHD$)
![每筆明細(OCCURS)長度]
#L4604LN=n,3,S
E(0,81)ASGN(INQLEN$)
![每張印錄單列印的筆數]
#L4604QPRT=n,2,S
E(0,30)ASGN(INQPRT$)
![畫面顯示的明細間的高度]
#L4604LOOP=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

</sub>

!------------ TXFORM = L4604 -----------
<sub type="FORM" name="L4604">

#SCRPRT=_,_,S
C(5,#TXFORM,L4604,$,S)

#OCnt=m,6,O
C(3,#OCnt,0,E(0,@L4604PRT,0),E(0,@L4604PRT,1))
#LOOP=X,1,S
E(0,1)ASGN(LOOP$)
#OOCustNo=A,7,O
#OOFacmNo=A,3,O
#OOInsuYearMonth=A,5,O
#OOTotInsuPrem=m,14,O
#OOFireInsuCovrg=m,14,O
#OOFireInsuPrem=m,14,O
#OOEthqInsuCovrg=m,14,O
#OOEthqInsuPrem=m,14,O
#OOStatusCodeX=x,10,O

</sub>
!---------- TXFORM = FM101 交易分錄----------
<sub type="FORM" name="FM101">
<include src="PRT.icf::FM101.form"/>
</sub>

!------ 上行電文 TEXT ------
<sub type="TIM">
#InsuEndMonth
</sub>

!------ 下行電文TOM ------
<sub type="TOM">
TXFORM=L4604
#OCnt
#OOCustNo
#OOFacmNo
#OOInsuYearMonth
#OOTotInsuPrem
#OOFireInsuCovrg
#OOFireInsuPrem
#OOEthqInsuCovrg
#OOEthqInsuPrem
#OOStatusCodeX
^
<include src="COM.icf::TRCTL.tom"/>
<include src="PRT.icf::FM101.tom"/>
<include src="ROM.icf::L4R34.tom"/>
</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">
#L4604PRT=1,L4604,NA,,D,15
%
#OOCustNo
#OOFacmNo
#OOInsuYearMonth
#OOFireInsuCovrg
#OOFireInsuPrem
#OOEthqInsuCovrg
#OOEthqInsuPrem
#OOTotInsuPrem
@
#OCnt
^

<include src="PRT.icf::FM01.sel"/>
<include src="PRT.icf::FMR01.sel"/>
<include src="PRT.icf::FMH01.sel"/>
<include src="PRT.icf::FMHR01.sel"/>
<include src="PRT.icf::FM101.sel" map="landscape=1;size=830:1170" />
</sub>
