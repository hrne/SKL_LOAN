!---------- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">
!#TXCD
!T(3,L4962)



</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)

#YnH=x,100,S
T(3,Y: ;N: )

</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="L4962" layout="cols=3;screen.width=[130,500,130,240];printer.width=[20,80];order=1">
[
["[L4962]@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@保險單資料檢核作業"],
["#FdFlagA+檢核表類別",#FlagA,"保費、保單未完成檢核表(1.無新保單 2.保費未入帳)"],["@@@火險到期年月",#InsuEndMonthFrom,"~",#InsuEndMonthTo],
[#<->#,"@",#FlagB,"額度無保單檢核表(1.無保單 2.已到期)"],
["@",#CommericalFlag,"險種註記明細表-",#CommericalFlagX],["@@@火險到期年月",#InsuEndMonthFrom1,"~",#InsuEndMonthTo1],
]

#FdFlagA=X,2,L

!Help
<include src="HELPRIM.icf::HELPRIM.rtn"/>

![險種註記]
#CDDEF01=x,26,S
T(3,CdCode.CommericalFlag)

#CommericalFlagHelp=x,1024,S

![催收戶況]
#CDDEF02=x,26,S
T(3,CdCode.ColStatus)

#ColStatusHelp=x,1024,S


#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#CDDEF01,#CDDEF02)
R(1,XXR99)
CALL(#HelpProc)
T(2,@CommericalFlagHelp,#HelpDesc1)
T(2,@ColStatusHelp,#HelpDesc2)

#CHAIN=A,1,S
T(4,CHAIN$) 

#FORE_MONTH=D,8,S
D(7,3,#SYSDATE,1,0)

#COLDIS=A,1,S
T(1,@InsuEndMonthFrom,#SYSDATE,2,5)
T(1,@InsuEndMonthTo,#SYSDATE,2,5)
T(1,@InsuEndMonthFrom1,#SYSDATE,2,5)
T(1,@InsuEndMonthTo1,#SYSDATE,2,5)

#FlagA=X,1,I
T(2,Y)
!HELP(Y: ;N: )
HELP(#YnH)
@V(H,#YnH)

! 火險到期年月
#InsuEndMonthFrom=A,5,I
C(5,#FlagA,Y,$,S)
T(1,@InsuEndMonthFrom,#SYSDATE,2,5)
@A(YM,1,#InsuEndMonthFrom)

#InsuEndMonthTo=A,5,I
C(5,#FlagA,Y,$,S)
T(1,@InsuEndMonthTo,#SYSDATE,2,5)
@A(YM,1,#InsuEndMonthTo)
IF(#InsuEndMonthTo<#InsuEndMonthFrom,V(P,訖年月不可小於起年月),$)

#FlagB=X,1,I
T(2,Y)
!HELP(Y: ;N: )
HELP(#YnH)
@V(H,#YnH)

#TCommericalFlagHelp=x,1024,S
T(2,N:不產生;00:全部;+#CommericalFlagHelp)


#CommericalFlag=X,2,I
T(2,01)
HELP(#TCommericalFlagHelp)
@V(H,#TCommericalFlagHelp)

#CommericalFlagX=X,30,L
C(4,#CommericalFlag,S,$)
T(H,#CommericalFlag,#TCommericalFlagHelp)

! 火險到期年月
#InsuEndMonthFrom1=A,5,I
C(5,#CommericalFlag,N,S,$)
T(1,@InsuEndMonthFrom1,#SYSDATE,2,5)
@A(YM,1,#InsuEndMonthFrom1)

#InsuEndMonthTo1=A,5,I
C(5,#CommericalFlag,N,S,$)
T(1,@InsuEndMonthTo1,#SYSDATE,2,5)
@A(YM,1,#InsuEndMonthTo1)
IF(#InsuEndMonthTo1<#InsuEndMonthFrom1,V(P,訖年月不可小於起年月),$)

#ReportA=A,1,S
C(4,#FlagA,E(0,0),E(0,1))

#ReportB=A,1,S
C(4,#FlagB,E(0,0),E(0,1))

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
#L462APRT=A,1,S
C(5,#TXFORM,L462A,E(0,1),E(0,0))
![資料表頭(HEADER)長度]
#L462AHD=n,3,S
C(5,#TXFORM,L462A,$,S)E(0,6)ASGN(INQHD$)
![每筆明細(OCCURS)長度]
#L462ALN=n,3,S
C(5,#TXFORM,L462A,$,S)E(0,128)ASGN(INQLEN$)
![每張印錄單列印的筆數]
#L462AQPRT=n,2,S
C(5,#TXFORM,L462A,$,S)E(0,30)ASGN(INQPRT$)
![畫面顯示的明細間的高度]
#L462ALOOP=n,3,S
C(5,#TXFORM,L462A,$,S)E(0,1)ASGN(LOOPHEIGHT$)

#L462BPRT=A,1,S
C(5,#TXFORM,L462B,E(0,1),E(0,0))
![資料表頭(HEADER)長度]
#L462BHD=n,3,S
C(5,#TXFORM,L462B,$,S)E(0,6)ASGN(INQHD$)
![每筆明細(OCCURS)長度]
#L462BLN=n,3,S
C(5,#TXFORM,L462B,$,S)E(0,123)ASGN(INQLEN$)
![每張印錄單列印的筆數]
#L462BQPRT=n,2,S
C(5,#TXFORM,L462B,$,S)E(0,30)ASGN(INQPRT$)
![畫面顯示的明細間的高度]
#L462BLOOP=n,3,S
C(5,#TXFORM,L462B,$,S)E(0,1)ASGN(LOOPHEIGHT$)

#L462CPRT=A,1,S
C(5,#TXFORM,L462C,E(0,1),E(0,0))
![資料表頭(HEADER)長度]
#L462CHD=n,3,S
C(5,#TXFORM,L462C,$,S)E(0,6)ASGN(INQHD$)
![每筆明細(OCCURS)長度]
#L462CLN=n,3,S
C(5,#TXFORM,L462C,$,S)E(0,186)ASGN(INQLEN$)
![每張印錄單列印的筆數]
#L462CQPRT=n,2,S
C(5,#TXFORM,L462C,$,S)E(0,30)ASGN(INQPRT$)
![畫面顯示的明細間的高度]
#L462CLOOP=n,3,S
C(5,#TXFORM,L462C,$,S)E(0,1)ASGN(LOOPHEIGHT$)

</sub>

!------------ TXFORM = L4962 -----------
<sub type="FORM" name="L462A" tota-mode="1">

#OCntA=m,6,O
C(3,#OCntA,0,E(0,@L462APRT,0),E(0,@L462APRT,1))

#L462A_LOOP=X,1,S
E(0,1)ASGN(LOOP$)
#ReportAInsuEndMonth=X,6,O
#ReportAPrevInsuNo=X,20,O
#ReportACustNo=A,7,O
#ReportAFacmNo=A,3,O
#ReportACustName=x,40,O
#ReportAClCode1=A,1,O
#ReportAClCode2=A,2,O
#ReportAClNo=A,7,O
#ReportANowInsuNo=X,20,O
#ReportAErrMsg=x,20,O
#ReportAColStatus=A,2,O
#ReportAColStatusX=X,10,O
T(H,#ReportAColStatus,#ColStatusHelp)
![防止二次單據]
E(0,@L462BPRT,0)
E(0,@L462CPRT,0)
</sub>

<sub type="FORM" name="L462B" tota-mode="1">
#OCntB=m,6,O
C(3,#OCntB,0,E(0,@L462BPRT,0),E(0,@L462BPRT,1))

#L462B_LOOP=X,1,S
E(0,1)ASGN(LOOP$)
#ReportBCustNo=A,7,O
#ReportBFacmNo=A,3,O
#ReportBCustName=x,40,O
#ReportBFirstDrDwDate=D,7,O
#ReportBClCode1=A,1,O
#ReportBClCode2=A,2,O
#ReportBClNo=A,7,O
#ReportBNowInsuNo=X,20,O
#ReportBInsuStartDate=D,7,O
#ReportBInsuEndDAte=D,7,O
#ReportBErrMsg=x,20,O
#ReportBColStatus=A,2,O
#ReportBColStatusX=X,10,O
T(H,#ReportBColStatus,#ColStatusHelp)
![防止二次單據]
E(0,@L462APRT,0)
E(0,@L462CPRT,0)
</sub>

<sub type="FORM" name="L462C" tota-mode="1">

#OCntC=m,6,O
C(3,#OCntC,0,E(0,@L462CPRT,0),E(0,@L462CPRT,1))

#L462C_LOOP=X,1,S
E(0,1)ASGN(LOOP$)
#ReportCInsuEndMonth=X,6,O
#ReportCCommericalFlagX=X,30,O
#ReportCPrevInsuNo=X,20,O
#ReportCCustNo=A,7,O
#ReportCFacmNo=A,3,O
#ReportCCustName=x,40,O
#ReportCClCode1=A,1,O
#ReportCClCode2=A,2,O
#ReportCClNo=A,7,O
#ReportCNowInsuNo=X,20,O
#ReportCRemark=X,50,O
![防止二次單據]
E(0,@L462APRT,0)
E(0,@L462BPRT,0)
</sub>

!------ 上行電文 TEXT ------
<sub type="TIM">
#InsuEndMonthFrom
#InsuEndMonthTo
#FlagA
#FlagB
#CommericalFlag
#InsuEndMonthFrom1
#InsuEndMonthTo1
#END
</sub>

!------ 下行電文TOM ------
<sub type="TOM">
<include src="COM.icf::TRCTL.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
TXFORM=L462A
#OCntA
#ReportAInsuEndMonth
#ReportAPrevInsuNo
#ReportACustNo
#ReportAFacmNo
#ReportACustName
#ReportAClCode1
#ReportAClCode2
#ReportAClNo
#ReportANowInsuNo
#ReportAErrMsg
#ReportAColStatus
^
TXFORM=L462B
#OCntB
#ReportBCustNo
#ReportBFacmNo
#ReportBCustName
#ReportBFirstDrDwDate
#ReportBClCode1
#ReportBClCode2
#ReportBClNo
#ReportBNowInsuNo
#ReportBInsuStartDate
#ReportBInsuEndDAte
#ReportBErrMsg
#ReportBColStatus
^
TXFORM=L462C
#OCntC
#ReportCInsuEndMonth
#ReportCCommericalFlagX
#ReportCPrevInsuNo
#ReportCCustNo
#ReportCFacmNo
#ReportCCustName
#ReportCClCode1
#ReportCClCode2
#ReportCClNo
#ReportCNowInsuNo
#ReportCRemark
^
</sub>
------- 單據輸出組合 ----------
<sub type="SELECT">
<include src="PRT.icf::UPD01.sel"/>
#L462APRT=1,L462A,NA,,D,15
%
#ReportAInsuEndMonth
#ReportAPrevInsuNo
#ReportACustNo
#ReportAFacmNo
#ReportAColStatusX
#ReportACustName
#ReportAClCode1
#ReportAClCode2
#ReportAClNo
#ReportANowInsuNo
#ReportAErrMsg
@
^

#L462BPRT=1,L462B,NA,,D,15
%
#ReportBCustNo
#ReportBFacmNo
#ReportBColStatusX
#ReportBCustName
#ReportBFirstDrDwDate
#ReportBClCode1
#ReportBClCode2
#ReportBClNo
#ReportBNowInsuNo
#ReportBInsuStartDate
#ReportBInsuEndDAte
#ReportBErrMsg
@
^

#L462CPRT=1,L462C,NA,,D,15
%
#ReportCInsuEndMonth
#ReportCCommericalFlagX
#ReportCPrevInsuNo
#ReportCCustNo
#ReportCFacmNo
#ReportCCustName
#ReportCClCode1
#ReportCClCode2
#ReportCClNo
#ReportCNowInsuNo
#ReportCRemark
@
^
</sub>
