!---------- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">
!#TXCD
!T(3,L5703)
</sub>


<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="L5703" layout="cols=3;screen.width=[150,850];printer.width=[20,80];order=1">
[
["[L5703]                                 債權銀行帳號登錄"],
[#<->#,"#FdFunCd+功能",#FunCdX],
[#<->#,"#FdFinCode+債權機構",#FinCode,#FinCodeX,"(債權機構代號-債權機構名稱)"],
[#<->#,"#FdRemitBank+匯款銀行",#RemitBank,#RemitBankX],
[#<->#,"#FdRemitAcct+債協匯款帳號",#RemitAcct],["#FdRemitAcct2+調解匯款帳號",#RemitAcct2],
[#<->#,"#FdRemitAcct3+更生匯款帳號",#RemitAcct3],["#FdRemitAcct4+清算匯款帳號",#RemitAcct4],
[#<->#,"#FdDataSendSection+資料傳送單位",#DataSendSection,#DataSendSectionX],
]

#FdFunCd=X,2,L
T(3,*)
#FdFinCode=X,2,L
T(3,* )
#FdRemitBank=X,2,L
T(3,* )
#FdRemitAcct=X,2,L
T(3,* )
#FdDataSendSection=X,2,L
T(3,* )
#FdRemitAcct2=X,2,L
T(3, )
#FdRemitAcct3=X,2,L
T(3, )
#FdRemitAcct4=X,2,L
T(3, )

!---------- AP TEXT AREA Variables ----------

#SetSysPar=X,1,S
E(0,1)ASGN(AGAIN$)

#FunCdHelp=x,100,S
T(3,1:新增;2:修改;3:新增;4:刪除;5:查詢)

#CHAIN=A,1,S
T(4,CHAIN$)
!新增限制需由入口交易進入
IF(#CHAIN==0,V(P,本交易為連動交易，請從交易:[L5974債權銀行帳號明細資料查詢]進入),$)

!做完交易自動更新原畫面
#AutoReFresh=A,1,S
C(3,#CHAIN,1,$,S)
E(0,1)
ASGN(CAUTO$)

#NTXBUF=X,9,S
C(3,#CHAIN,1,T(4,NTXBUF$),s)
T(1,@CHAINFUNCD,#NTXBUF,1,1)
E(0,@FunCode,#CHAINFUNCD)
T(1,@FinCode,#NTXBUF,2,8)


#CHAINFUNCD=A,1,S

![功能]
! 下拉式選單 1.新增 2.修改 3.複製 4.刪除 5.查詢
#FunCode=A,1,S
E(0,#CHAINFUNCD)
C(3,#CHAIN,1,s,$)
HELP(#FunCdHelp) 
@T(3,@FunCdX,)
V(H,#FunCdHelp)
E(0,@FUNCIND,#FunCode)

#SetSysPar1=X,1,S
IF(#FunCode ==1 || #FunCode ==3,E(0,0)ASGN(AGAIN$),$)

#FunCdX=X,4,L
C(4,#FunCode,S,$)
T(H,#FunCode,#FunCdHelp)
C(2,#FunCode,$,K(MODIFYBUTTON,新增),K(MODIFYBUTTON,修改),$,K(MODIFYBUTTON,刪除),K(MODIFYBUTTON,查詢)K(NOBUTTON,CLOSEY))


<include src="ROM.icf::L5R12.dec"/>
<include src="ROM.icf::L5R04.dec"/>

!顯示框線
#Flag=X,1,S
IF(#FunCode==1,$,T(F,@FinCode,0))
IF(#FunCode==4,T(F,@FinCode,0)T(F,@FinCodeX,0)T(F,@RemitBank,0)T(F,@RemitAcct,0)T(F,@RemitAcct2,0)T(F,@RemitAcct3,0)T(F,@RemitAcct4,0)T(F,@DataSendSection,0),$) 

#RimFinCode=X,8,S
#RimBankCode=X,8,S
#FunctionCode=X,2,S
T(2,#FunctionCode,0+#FunCode)

#RimL5r12=X,1,S
C(3,#CHAIN,1,$,s)
C(4,#FinCode,S,$)
C(3,#FunCode,1,s,$)
T(2,@RimBankCode,#FinCode)
S(L5R12,1,#RimBankCode,#FunctionCode)
R(1,L5R12)
T(2,@FinCodeX,#L5r12BankItem)

#RimL5R04A=X,1,S
C(3,#CHAIN,1,$,s)
C(4,#FinCode,S,$)
C(3,#FunCode,1,s,$)
T(2,@RimFinCode,#FinCode)
RESET_RIM(#RimL5R04,L5R04)
S(L5R04,1,#RimFinCode)
R(1,L5R04)
T(2,@FinCode,#L5r04FinCode)
T(2,@RemitBank,#L5r04RemitBank)
T(2,@RemitAcct,#L5r04RemitAcct)
T(2,@RemitAcct2,#L5r04RemitAcct2)
T(2,@RemitAcct3,#L5r04RemitAcct3)
T(2,@RemitAcct4,#L5r04RemitAcct4)
T(2,@DataSendSection,#L5r04DataSendSection)

#RimL5r12A=X,1,S
C(3,#CHAIN,1,$,s)
C(4,#FinCode,S,$)
C(3,#FunCode,1,s,$)
T(2,@RimBankCode,#RemitBank)
S(L5R12,1,#RimBankCode,#FunctionCode)
R(1,L5R12)
T(2,@RemitBankX,#L5r12BankItem)

! 債權機構
#FinCode=X,8,I
IF(#FunCode==1,$,s)
@V(7)

#RimL5r12B=X,1,S
C(3,#FunCode,1,s,$)
T(2,@RimBankCode,#RemitBank)
S(L5R12,1,#RimBankCode,#FunctionCode)
R(1,L5R12)
T(2,@RemitBankX,#L5r12BankItem)

#RimL5R04B=X,1,S
C(4,#FinCode,S,$)
C(3,#FunCode,1,s,$)
T(2,@RimFinCode,#FinCode)
RESET_RIM(#RimL5R04,L5R04)
S(L5R04,1,#RimFinCode)
R(1,L5R04)
T(2,@FinCode,#L5r04FinCode)
T(2,@RemitBank,#L5r04RemitBank)
T(2,@RemitAcct,#L5r04RemitAcct)
T(2,@RemitAcct2,#L5r04RemitAcct2)
T(2,@RemitAcct3,#L5r04RemitAcct3)
T(2,@RemitAcct4,#L5r04RemitAcct4)
T(2,@DataSendSection,#L5r04DataSendSection)


#RimL5r12B1=X,1,S
C(3,#FunCode,1,s,$)
IF(#DataSendSection!="",$,s)
T(2,@RimBankCode,#DataSendSection)
S(L5R12,1,#RimBankCode,#FunctionCode)
R(1,L5R12)
T(2,@DataSendSectionX,#L5r12BankItem)


#FinCodeX=X,2.60,I
IF(#FunCode==4,s,$)
@V(7)

!匯款銀行
#RemitBank=X,7,I
IF(#FunCode==4,s,$)
@T(3,@RemitBankX,)
V(7)

#RimL5r12D=X,1,S
IF(#RemitBank!="",$,s)
IF(#FunCode==1,IF(#RemitBank==#FinCode,s,$),$)
T(2,@RimBankCode,#RemitBank)
RESET_RIM(#RimL5r12D,L5R12)
S(L5R12,1,#RimBankCode,#FunctionCode)
R(1,L5R12)
T(2,@RemitBankX,#L5r12BankItem)

#RemitBankX=X,120,L
IF(#FunCode==1 || #FunCode==2,IF(#RemitBank==#FinCode,T(2,#FinCodeX),$),$)

! 債協匯款帳號
#RemitAcct=X,16,I
IF(#FunCode==4,s,$)
@V(7)
E(0,@RemitAcctA,#RemitAcct)
T(2,#RemitAcctA)
#RemitAcctA=A,16,S
#RemitAcct2A=A,16,S
#RemitAcct3A=A,16,S
#RemitAcct4A=A,16,S

! 調解匯款帳號
#RemitAcct2=X,16,I
IF(#FunCode==4,s,$)
@
E(0,@RemitAcct2A,#RemitAcct2)
IF(#RemitAcct2A == 0,S,T(2,#RemitAcct2A))

! 更生匯款帳號
#RemitAcct3=X,16,I
IF(#FunCode==4,s,$)
@
E(0,@RemitAcct3A,#RemitAcct3)
IF(#RemitAcct3A == 0,S,T(2,#RemitAcct3A))

! 清算匯款帳號
#RemitAcct4=X,16,I
IF(#FunCode==4,s,$)
@
E(0,@RemitAcct4A,#RemitAcct4)
IF(#RemitAcct4A == 0,S,T(2,#RemitAcct4A))


! 資料傳送單位
#DataSendSection=X,8,I
IF(#FunCode==4,s,$)
@T(3,@DataSendSectionX,)
V(7)

#RimL5r12E=X,1,S
IF(#DataSendSection!="",$,s)
IF(#FunCode==1,IF(#DataSendSection==#FinCode,s,$),$)
T(2,@RimBankCode,#DataSendSection)
RESET_RIM(#RimL5r12E,L5R12)
S(L5R12,1,#RimBankCode,#FunctionCode)
R(1,L5R12)
T(2,@DataSendSectionX,#L5r12BankItem)

#DataSendSectionX=X,120,L
IF(#FunCode==1 || #FunCode==2,IF(#DataSendSection==#FinCode,T(2,#FinCodeX),$),$)

#RPTFG=A,1,S

!參考編號
#MRKEY=_,_,S
T(2,#FinCode)

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!------------ TXFORM = L5703 -----------
<sub type="FORM" name="L5703">
</sub>

!------ 上行電文 TEXT ------
<sub type="TIM">
#FunCode
#FinCode
#FinCodeX
#RemitBank
#RemitAcct
#RemitAcct2
#RemitAcct3
#RemitAcct4
#DataSendSection
</sub>

!------ 下行電文TOM ------
<sub type="TOM">
<include src="COM.icf::TRCTL.tom"/>
TXFORM=L5703
^
! 調Rim相關 開始
<include src="ROM.icf::L5R04.tom"/>
<include src="ROM.icf::L5R12.tom"/>
! 調Rim相關 結束
</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">
<include src="PRT.icf::UPD01.sel"/>
</sub>
