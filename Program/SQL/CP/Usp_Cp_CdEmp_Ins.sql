CREATE OR REPLACE PROCEDURE "Usp_Cp_CdEmp_Ins"
(
"EmpNo" IN VARCHAR2
)
AS
BEGIN
  IF USER = 'ITXADMIN' THEN
    RETURN;
  END IF;

  EXECUTE IMMEDIATE 'TRUNCATE TABLE "CdEmp" DROP STORAGE';

  INSERT INTO "CdEmp" (
    "AgentCode",
    "EmployeeNo",
    "Fullname",
    "CenterShortName",
    "CenterCodeName",
    "CenterCode1",
    "CenterCode1Short",
    "CenterCode1Name",
    "CenterCode2",
    "CenterCode2Short",
    "CenterCode2Name",
    "CenterCodeAcc1",
    "CenterCodeAcc1Name",
    "CenterCodeAcc2",
    "CenterCodeAcc2Name",
    "CommLineCode",
    "CommLineType",
    "OrigIntroducerId",
    "IntroducerInd",
    "RegisterLevel",
    "RegisterDate",
    "CenterCode",
    "AdministratId",
    "InputDate",
    "InputUser",
    "AgStatusCode",
    "AgStatusDate",
    "TranDate",
    "TranUser",
    "ReRegisterDate",
    "DirectorId",
    "DirectorIdF",
    "IntroducerId",
    "IntroducerIdF",
    "AgLevel",
    "LastLevel",
    "LevelDate",
    "TopLevel",
    "OccpInd",
    "QuotaAmt",
    "ApplType",
    "TaxRate",
    "SocialInsuClass",
    "PromotLevelYM",
    "DirectorYM",
    "RecordDate",
    "ExRecordDate",
    "RxTrDate",
    "ExTrIdent",
    "ExTrIdent2",
    "ExTrIdent3",
    "ExTrDate",
    "RegisterBefore",
    "DirectorAfter",
    "MedicalCode",
    "ExChgDate",
    "ExDelDate",
    "ApplCode",
    "FirstRegDate",
    "AginSource",
    "AguiCenter",
    "AgentId",
    "TopId",
    "AgDegree",
    "CollectInd",
    "AgType1",
    "ContractInd",
    "ContractIndYM",
    "AgType2",
    "AgType3",
    "AgType4",
    "AginInd1",
    "AgPoInd",
    "AgDocInd",
    "NewHireType",
    "AgCurInd",
    "AgSendType",
    "AgSendNo",
    "RegisterDate2",
    "AgReturnDate",
    "AgTransferDateF",
    "AgTransferDate",
    "PromotYM",
    "PromotYMF",
    "AgPostChgDate",
    "FamiliesTax",
    "AgentCodeI",
    "AgLevelSys",
    "AgPostIn",
    "CenterCodeAcc",
    "EvalueInd",
    "EvalueInd1",
    "BatchNo",
    "EvalueYM",
    "AgTransferCode",
    "Birth",
    "Education",
    "LrInd",
    "ProceccDate",
    "QuitDate",
    "AgPost",
    "LevelNameChs",
    "LrSystemType",
    "SeniorityYY",
    "SeniorityMM",
    "SeniorityDD",
    "AglaProcessInd",
    "StatusCode",
    "AglaCancelReason",
    "ISAnnApplDate",
    "RecordDateC",
    "StopReason",
    "StopStrDate",
    "StopEndDate",
    "IFPDate",
    "EffectStrDate",
    "EffectEndDate",
    "AnnApplDate",
    "CenterCodeAccName",
    "ReHireCode",
    "RSVDAdminCode",
    "Account",
    "PRPDate",
    "Zip",
    "Address",
    "PhoneH",
    "PhoneC",
    "SalesQualInd",
    "AgsqStartDate",
    "PinYinNameIndi",
    "Email",
    "CreateDate",
    "CreateEmpNo",
    "LastUpdate",
    "LastUpdateEmpNo"
)
  SELECT
    "AgentCode",
    "EmployeeNo",
    "Fullname",
    "CenterShortName",
    "CenterCodeName",
    "CenterCode1",
    "CenterCode1Short",
    "CenterCode1Name",
    "CenterCode2",
    "CenterCode2Short",
    "CenterCode2Name",
    "CenterCodeAcc1",
    "CenterCodeAcc1Name",
    "CenterCodeAcc2",
    "CenterCodeAcc2Name",
    "CommLineCode",
    "CommLineType",
    "OrigIntroducerId",
    "IntroducerInd",
    "RegisterLevel",
    "RegisterDate",
    "CenterCode",
    "AdministratId",
    "InputDate",
    "InputUser",
    "AgStatusCode",
    "AgStatusDate",
    "TranDate",
    "TranUser",
    "ReRegisterDate",
    "DirectorId",
    "DirectorIdF",
    "IntroducerId",
    "IntroducerIdF",
    "AgLevel",
    "LastLevel",
    "LevelDate",
    "TopLevel",
    "OccpInd",
    "QuotaAmt",
    "ApplType",
    "TaxRate",
    "SocialInsuClass",
    "PromotLevelYM",
    "DirectorYM",
    "RecordDate",
    "ExRecordDate",
    "RxTrDate",
    "ExTrIdent",
    "ExTrIdent2",
    "ExTrIdent3",
    "ExTrDate",
    "RegisterBefore",
    "DirectorAfter",
    "MedicalCode",
    "ExChgDate",
    "ExDelDate",
    "ApplCode",
    "FirstRegDate",
    "AginSource",
    "AguiCenter",
    "AgentId",
    "TopId",
    "AgDegree",
    "CollectInd",
    "AgType1",
    "ContractInd",
    "ContractIndYM",
    "AgType2",
    "AgType3",
    "AgType4",
    "AginInd1",
    "AgPoInd",
    "AgDocInd",
    "NewHireType",
    "AgCurInd",
    "AgSendType",
    "AgSendNo",
    "RegisterDate2",
    "AgReturnDate",
    "AgTransferDateF",
    "AgTransferDate",
    "PromotYM",
    "PromotYMF",
    "AgPostChgDate",
    "FamiliesTax",
    "AgentCodeI",
    "AgLevelSys",
    "AgPostIn",
    "CenterCodeAcc",
    "EvalueInd",
    "EvalueInd1",
    "BatchNo",
    "EvalueYM",
    "AgTransferCode",
    "Birth",
    "Education",
    "LrInd",
    "ProceccDate",
    "QuitDate",
    "AgPost",
    "LevelNameChs",
    "LrSystemType",
    "SeniorityYY",
    "SeniorityMM",
    "SeniorityDD",
    "AglaProcessInd",
    "StatusCode",
    "AglaCancelReason",
    "ISAnnApplDate",
    "RecordDateC",
    "StopReason",
    "StopStrDate",
    "StopEndDate",
    "IFPDate",
    "EffectStrDate",
    "EffectEndDate",
    "AnnApplDate",
    "CenterCodeAccName",
    "ReHireCode",
    "RSVDAdminCode",
    "Account",
    "PRPDate",
    "Zip",
    "Address",
    "PhoneH",
    "PhoneC",
    "SalesQualInd",
    "AgsqStartDate",
    "PinYinNameIndi",
    "Email",
    "CreateDate",
    "CreateEmpNo",
    "LastUpdate",
    "LastUpdateEmpNo"
  FROM ITXADMIN."CdEmp";

  Exception 
  WHEN OTHERS THEN
  "Usp_L9_UspErrorLog_Ins"(
    'Usp_Cp_CdEmp_Ins',
    SQLCODE,
    SQLERRM,
    dbms_utility.format_error_backtrace,
    "EmpNo"
  );
END;