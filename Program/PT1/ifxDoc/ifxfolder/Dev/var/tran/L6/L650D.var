!---------- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">
!#TXCD
!T(3,L650D)
</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
K(MODIFYBUTTON,修改)
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p0" layout="cols=2;screen.width=[300,700];printer.width=[20,80];">
[
["[L650D]                                 業績計算特殊參數設定(業績追回通知設定)"],
["#FdExclude+設定選項",#ExcludeX],
["#grid#,{id:1,expand:true,loop:30,row_height:1}","　","","",
["員工代號","電子信箱","起始年月","結束年月"],
[#EmpNo1,#Email1,#WorkMonthS1,#WorkMonthE1]
],
]
#FdExclude=X,2,L

<include src="HELPRIM.icf::HELPRIM.rtn"/>
<include src="ROM.icf::L6R42.dec"/>
<include src="ROM.icf::L6R43.dec"/>
#CDDEF0001=x,20,S
T(3,CdCode.Exclude)
#ExcludeHelp=x,1024,S

#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#CDDEF0001)
R(1,XXR99)
CALL(#HelpProc)
T(2,@ExcludeHelp,#HelpDesc1)

! 設定選項
#Exclude=X,1,S
T(2,4)
#ExcludeX=X,50,L
T(H,#Exclude,#ExcludeHelp)

! 調rimL6R41
#RimFunc=A,1,S
E(0,1)
#RimL6R43=X,1,S
RESET_RIM(#RimL6R43,L6R43)
S(L6R43,1,#RimFunc)
R(1,L6R43)
##loop{times:30,i:1,k:2}
T(2,@EmpNo{i},#L6R43EmpNo{i})
T(2,@CheckEmpNo{i},#EmpNo{i})
T(2,@Email{i},#L6R43Email{i})
E(0,@WorkMonthS{i},#L6R43WorkMonthS{i})
E(0,@WorkMonthE{i},#L6R43WorkMonthE{i})
##end

! #CALLGRID=X,1,S
! ##loop{times:30,n:1,k:2}
! C(4,#EmpNo{n},INVOKEJS(SHOW,grd1_{k},0),INVOKEJS(SHOW,grd1_{k},1))
! ##end
#RimEmpNo=X,6,S
#EmpNo0=X,1,S
T(2,1)
! ##loop{times:30,i:1,j:0,rowSeq:2}
##loop{times:30,i:1}
#CheckEmpNo{i}=X,6,S
T(3, )
! #HIDE_A_ROW_{i}=@,1,S
! INVOKEJS(SHOW,grd1_{rowSeq},0)

! #SHOW_A_ROW_{i}=@,1,S
! INVOKEJS(SHOW,grd1_{rowSeq},1)

! 員工編號1~30
#EmpNo{i}=X,6,I
T(3,@CheckEmpNo{i}, )
@T(3,@Email{i},)
C(4,#EmpNo{i},S,$)
V(4,#CheckEmpNo1,#CheckEmpNo2,#CheckEmpNo3,#CheckEmpNo4,#CheckEmpNo5,#CheckEmpNo6,#CheckEmpNo7,#CheckEmpNo8,#CheckEmpNo9,#CheckEmpNo10,#CheckEmpNo11,#CheckEmpNo12,#CheckEmpNo13,#CheckEmpNo14,#CheckEmpNo15,#CheckEmpNo16,#CheckEmpNo17,#CheckEmpNo18,#CheckEmpNo19,#CheckEmpNo20,#CheckEmpNo21,#CheckEmpNo22,#CheckEmpNo23,#CheckEmpNo24,#CheckEmpNo25,#CheckEmpNo26,#CheckEmpNo27,#CheckEmpNo28,#CheckEmpNo29,#CheckEmpNo30)



#RimL6R42{i}=X,1,S
C(4,#EmpNo{i},S,$)
T(2,@RimEmpNo,#EmpNo{i})
RESET_RIM(#RimL6R42{i},L6R42)
S(L6R42,1,#RimEmpNo)
R(1,L6R42)
T(2,@Email{i},#L6R42Email)

! 電子信箱1~30
#Email{i}=x,50,L
C(4,#EmpNo{i},S,$)
! 起始年月1~30
#WorkMonthS{i}=A,5,I
C(4,#EmpNo{i},S,$)
@A(YM13,0,#WorkMonthS{i})

! 結束年月1~30
#WorkMonthE{i}=A,5,I
C(4,#EmpNo{i},S,$)
@C(3,#WorkMonthE{i},0,s,A(YM13,1,#WorkMonthE{i}))
IF(#WorkMonthS{i}>#WorkMonthE{i},V(P,止月不可小於起月),$)

#WK{i}=X,1,S
T(2,@CheckEmpNo{i},#EmpNo{i})
##end


</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!------------ TXFORM = L650D -----------
<sub type="FORM" name="L650D">
</sub>

!------ 上行電文 TEXT ------
<sub type="TIM">
##loop {times:30,i:1}
#EmpNo{i}
#WorkMonthS{i}
#WorkMonthE{i}
##end
</sub>

!------ 下行電文TOM ------
<sub type="TOM">
<include src="HELPRIM.icf::HELPRIM.tom"/>
<include src="COM.icf::TRCTL.tom"/>
<include src="ROM.icf::L6R42.tom"/>
<include src="ROM.icf::L6R43.tom"/>
TXFORM=L650D

^
</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">
</sub>
