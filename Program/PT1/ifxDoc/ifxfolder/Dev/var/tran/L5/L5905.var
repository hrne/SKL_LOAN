----- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">

!#TXCD
!T(3,L5905)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,0)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,361)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,20)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD2.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
!HIDE(#BTN1)

K(MODIFYBUTTON,查詢)

</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[150,850];printer.width=[20,20];">
[
["[L5905]                                 覆審案件明細檔查詢"],
["#FdInqFg+查詢條件",#InqFg,#InqFgX],
["#FdConditionCode+條件代碼",#ConditionCode,#ConditionCodeX],
["#FdYear+資料年月",#YearMonth],
["#FdYearS+資料年份",#YearS,"~",#YearE],
["#FdReChkMonth+覆審月份",#ReChkMonth],
["#FdCustNo+借款人戶號",#CustNo],
["#FdTraceYearMonth+追蹤年月",#TraceYearMonthS,#TraceYearMonthE]
]

#FdInqFg=X,2,L
T(3,*)
#FdYear=X,2,L
T(3,*)
#FdConditionCode=X,2,L
T(3,*)
#FdYearS=X,2,L
T(3,*)
#FdReChkMonth=X,2,L
#FdCustNo=X,2,L
#FdTraceYearMonth=X,2,L
T(3,*)

!---------- AP Button AREA ----------
![Buttom資料查詢]
!#BUF1=X,42,S

#Submit=X,4,S
K(MODIFYBUTTON,查詢)

!---------- AP TEXT AREA Variables ----------
<include src="HELPRIM.icf::HELPRIM.rtn"/>

! 條件代碼
#CDCODECondition=x,30,S
T(3,CdCode.ConditionCode)
#ConditionHelp=x,500,S
!覆審記號
#CDCODEReCheckHelp=x,25,S
T(3,CdCode.ReCheck)
#ReCheckHelp=x,1024,S
!追蹤記號
#CDCODEFollowMark=x,25,S
T(3,CdCode.FollowMark)
#FollowMarkHelp=x,1024,S
! 查詢條件
#CDCODEInqFg=x,25,S
T(3,CdCode.InqFg)
#InqFgHelp=x,1024,S

#CDCODEYesNo=x,25,S
T(3,CdCode.YesNo)
#YesNoHelp=x,1024,S

#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#CDCODECondition,#CDCODEReCheckHelp,#CDCODEFollowMark,#CDCODEInqFg,#CDCODEYesNo)
R(1,XXR99)
CALL(#HelpProc)
T(2,@ConditionHelp,#HelpDesc1)
T(2,@ReCheckHelp,#HelpDesc2)
T(2,@FollowMarkHelp,#HelpDesc3)
T(2,@InqFgHelp,#HelpDesc4)
T(2,@YesNoHelp,#HelpDesc5)
#CHAIN=A,1,S
T(4,CHAIN$)

#NTXBUF=X,4,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)

#WK=X,1,S
INVOKEJS(SHOW,p1,2,5,0)
INVOKEJS(SHOW,p1,3,3,0)
INVOKEJS(SHOW,p1,4,4,0)
INVOKEJS(SHOW,p1,7,7,0)

#DATE=D,8,S
T(4,DATE$)

#YYY=A,3,S
T(1,#DATE,2,3)
E(0,@YearS,#YYY)
E(0,@YearE,#YYY)

#MM=A,2,S
T(1,#DATE,5,2)
E(0,@ReChkMonth,#MM)

!查詢條件
#InqFg=A,1,I
HELP(#InqFgHelp)
@T(3,@InqFgX,)
V(H,#InqFgHelp)

#InqFgX=X,20,L
T(H,#InqFg,#InqFgHelp)

#WKBTN=X,1,S
SWITCH(#InqFg,1,INVOKEJS(SHOW,p1,2,3,1)INVOKEJS(SHOW,p1,4,5,0)INVOKEJS(SHOW,p1,7,7,0)INVOKEJS(SHOW,p1,6,6,1),
              2,INVOKEJS(SHOW,p1,2,3,0)INVOKEJS(SHOW,p1,4,5,1)INVOKEJS(SHOW,p1,7,7,0)INVOKEJS(SHOW,p1,6,6,1),
              3,INVOKEJS(SHOW,p1,2,6,0)INVOKEJS(SHOW,p1,7,7,1),
              4,INVOKEJS(SHOW,p1,2,7,0),)



!條件代碼
#ConditionCode=A,2,I
C(3,#InqFg,1,$,S)
HELP(#ConditionHelp)
@T(3,@ConditionCodeX,)
V(H,#ConditionHelp)

#ConditionCodeX=X,40,L
C(3,#InqFg,1,$,S)
T(H,#ConditionCode,#ConditionHelp)

!資料年月
#YearMonth=A,5,I
C(3,#InqFg,1,$,S)
T(1,#DATE,2,5)
@V(2,0)A(YM,0,#YearMonth)

!資料年份-S
#YearS=A,3,I
C(3,#InqFg,2,$,S)
@V(2,0)

#YearMonthS=A,5,S
T(2,#YearS+01)

!資料年份-E
#YearE=A,3,I
C(3,#InqFg,2,$,S)
@V(2,0)V(5,#YearS,999)

#YearMonthE=A,5,S
T(2,#YearE+12)

!覆審月份
#ReChkMonth=A,2,I
C(3,#InqFg,2,$,S)
@V(5,00,12)

!借款人戶號
#CustNo=A,7,I
C(5,#InqFg,3,S,$)
C(5,#InqFg,4,S,$)
!追蹤年月
#TraceYearMonthS=A,5,I
C(5,#InqFg,3,$,S)
@V(2,0)A(YM,0,#TraceYearMonthS)
#TraceYearMonthE=A,5,I
C(5,#InqFg,3,$,S)
@V(2,0)A(YM,0,#TraceYearMonthE)
IF(#TraceYearMonthE<#TraceYearMonthS,V(P,起月不可大於迄月),$)
#MRKEY=_,_,S
C(3,#CustNo,0,S,T(2,#CustNo))

!輸出格式     
#RPTFG1=A,1,S
C(3,#InqFg,1,$,S)
C(3,#ConditionCode,06,E(0,1),E(0,0)) 

#RPTFG=A,1,S

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!---------- TXFORM = L5905 ----------
<sub type="FORM" name="L5905">

!#SCRPRT=_,_,S
!C(5,#TXFORM,L5905,$,S)

#SCRTIL=_,_,S
T(2,[L5905] 覆審案件明細檔查詢+_+#ConditionCodeX)


!------ TOM(HEAD)   Variables (FOR OUTPUT SCREEN) ------
!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------
#LOOP=X,1,S
T(3,1)ASGN(LOOP$)

! 資料年月(TOTA)
#OOYearMonth=A,5,S

!條件代碼(TOTA)
#OOConditionCode=A,2,S
#OOConditionCodeX=X,40,L
T(H,#OOConditionCode,#ConditionHelp)

!借款人戶號(TOTA)
#OOCustNo=A,7,S

!額度號碼(TOTA)
#OOFacmNo=A,3,S

#OOCustNoX=X,11,L
T(2,#OOCustNo+-+#OOFacmNo)

!戶名(TOTA)
#OOCustName=X,100,L

!覆審記號(TOTA)  
#OOReCheckCode=X,1,S
#OOReCheckCodeX=X,6,L
C(4,#OOReCheckCode,S,T(H,#OOReCheckCode,#ReCheckHelp))


!追蹤記號(TOTA) 
#OOFollowMark=X,1,S
#OOFollowMarkX=X,6,L
C(4,#OOFollowMark,S,T(H,#OOFollowMark,#FollowMarkHelp))


! 覆審年月(TOTA)
#OOReChkYearMonth=A,5,S

!撥款日期(TOTA)
#OODrawdownDate=D,7,L

!貸放餘額(TOTA)
#OOLoanBal=m,14.2,S
#OOLoanBal1=m,14,S
E(0,#OOLoanBal)
#OOLoanBalX=X,17,L
IF(#OOLoanBal1==0,S,$)
X(#OOLoanBal1)

!評等(TOTA)
#OOEvaluation=N,2,L

!客戶別(TOTA)
#OOCustTypeItem=X,20,S

!用途別(TOTA)
#OOUsageItem=X,20,S

!地區別(TOTA)
#OOCityItem=X,20,S

!應覆審單位(TOTA)
#OOReChkUnit=X,20,S

!備註(TOTA)
#OORemark=X,120,S

#OOTraceYearMonth=A,5,S
C(4,#OOTraceYearMonth,S,$)

!指定覆審(TOTA)
#OOSpecifyFg=X,1,S
#OOSpecifyFgX=X,2,S
C(4,#OOSpecifyFg,S,T(H,#OOSpecifyFg,#YesNoHelp))
! 登錄的按鈕
#OOBUF2=X,17,S
T(2,#OOYearMonth+#OOConditionCode+#OOCustNo+#OOFacmNo)

#OOBTN2=X,4,S
BIND(grid,{cmd=CHAIN;ntxcd=L5105;text=維護;ntxbuf=#OOBUF2})

</sub>


!------ 上行電文 ------
<sub type="TIM">
#InqFg
#YearMonth
#ConditionCode
#YearMonthS
#YearMonthE         
#ReChkMonth
#CustNo    
#TraceYearMonthS    
#TraceYearMonthE        
#END
</sub>


!------ 下行電文TOM ------
<sub type="TOM">
TXFORM=L5905
#OOYearMonth             
#OOConditionCode         
#OOCustNo                
#OOFacmNo        
#OOCustName        
#OOReCheckCode           
#OOFollowMark            
#OOReChkYearMonth        
#OODrawdownDate          
#OOLoanBal               
#OOEvaluation            
#OOCustTypeItem          
#OOUsageItem             
#OOCityItem              
#OOReChkUnit             
#OORemark       
#OOTraceYearMonth  
#OOSpecifyFg
^
<include src="COM.icf::TRCTL.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
</sub>

!--------- OUTPUT畫面 --------

<sub type="PART" name="L5905" layout="cols=1;screen.width=[100,900];printer.width=[20,20];">
[
["[L5905]                                                    覆審案件明細檔查詢                                                                                                       "],
]
</sub>
!---------- 單據輸出組合 ----------
<sub type="SELECT">

#RPTFG1=1,QUERY.GRID,L5905
#any={detail:true, header:'L5905.part', caption:'', width:1000, rowNum:20, rowList:[20,40,60]}

#OOBTN2=
{width:50,search:false,formatter:'cust:bind-button:#OOBTN2',align:'center',canExport:false}

#OOYearMonth=資料年月
{width:80,align:'center'}

#OOConditionCodeX=條件代碼
{width:250,align:'left'}

#OOCustNoX=借款人戶號
{width:100,align:'center'}

#OOCustName=戶名
{width:150,align:'left'}

#OOReChkUnit=應覆審單位
{width:100,align:'left'}

#OOReCheckCodeX=覆審記號
{width:80,align:'center'}

#OOFollowMarkX=追蹤記號
{width:80,align:'center'}

#OOCustTypeItem=客戶別
{width:80,align:'left'}

#OOUsageItem=用途別
{width:80,align:'left'}

#OOCityItem=地區別
{width:80,align:'left'}

#OOReChkYearMonth=覆審年月
{width:80,align:'center'}

#OODrawdownDate=最小值-撥款日
{width:130,align:'center'}

#OOLoanBalX=加總-貸放餘額
{width:140,align:'right'}

#OORemark=備註
{width:150,align:'left'}

#OOSpecifyFgX=指定覆審
{width:130,align:'center'}

^

#RPTFG1=0,QUERY.GRID,L5905
#any={detail:true, header:'L5905.part', caption:'', width:1000, rowNum:20, rowList:[20,40,60]}

#OOBTN2=
{width:50,search:false,formatter:'cust:bind-button:#OOBTN2',align:'center',canExport:false}

#OOYearMonth=資料年月
{width:80,align:'center'}

#OOConditionCodeX=條件代碼
{width:250,align:'left'}

#OOCustNoX=借款人戶號
{width:100,align:'center'}

#OOCustName=戶名
{width:150,align:'left'}

#OOReChkUnit=應覆審單位
{width:100,align:'left'}

#OOReCheckCodeX=覆審記號
{width:80,align:'center'}

#OOReChkYearMonth=覆審年月
{width:80,align:'center'}

#OOFollowMarkX=追蹤記號
{width:80,align:'center'}

#OOTraceYearMonth=追蹤年月
{width:80,align:'center'}

#OODrawdownDate=最小值-撥款日
{width:130,align:'center'}

#OOLoanBalX=加總-貸放餘額
{width:130,align:'right'}

#OOSpecifyFgX=指定覆審
{width:80,align:'center'}

^
</sub>
