----- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">

!#TXCD
!T(3,L5983)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,0)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,52)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,25)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)

#button=x,1,S
K(MODIFYBUTTON,試算)

</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[130,370,130,370];printer.width=[20,20];order=1">
[
["[L5983]                                 結 清 試 算                                 "],
["@*@身分證字號",#CustId],
["@*@入帳日期",#EntryDate],
["@*@顯示方式",
<include src="COM.icf::RPTFG.scr"/>
],
]

!---------- AP TEXT AREA Variables ----------
<include src="HELPRIM.icf::HELPRIM.rtn"/>

#CHAIN=A,1,S
T(4,CHAIN$) 

#CustId=X,10,I
@A(ID_UNINO,0,#CustId)

#RimCustId=X,10,S
#RimCustNo=A,7,S
#RimCaseSeq=A,3,S
#RimErrorFg=X,1,S
!L5R51找出戶號及案件序號,需檢查戶況須為0正常
#SendL5r51=X,1,S
T(2,@RimCustId,#CustId)
E(0,@RimCustNo,0)
E(0,@RimCaseSeq,0)
T(2,@RimErrorFg,Y)
RESET_RIM(#SendL5r51,L5R51)
S(L5R51,1,#RimCustId,#RimCustNo,#RimCaseSeq,#RimErrorFg)
R(1,L5R51)
E(0,@CustNo,#L5r51CustNo)
E(0,@CaseSeq,#L5r51CaseSeq)

#CustNo=A,7,S
#CaseSeq=A,3,S

#EntryDate=D,7,I
C(3,#EntryDate,0,E(0,#SYSDATE),$)
@V(7)V(5,#SYSDATE,9991231)


<include src="COM.icf::RPTFG.dec"/>
<include src="ROM.icf::L5R51.dec"/>
</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>


!---------- TXFORM = L5983 ----------
<sub type="FORM" name="L5983">

!#SCRPRT=_,_,S
!C(5,#TXFORM,L5983,$,S)

#SCRTIL=_,_,S
T(3,[L5983] 貸款試算)

!------ TOM(HEAD)   Variables (FOR OUTPUT SCREEN) ------
!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------
#OCustId=X,10,L
#OCustNo=A,7,L
#OCaseSeq=A,3,L
#OPrincipalBal=m,14,L
#OAccuOverAmt=m,14,L
#ODueAmt=m,14,L
#OIntRate=N,2.4,L
#OEntryDate=D,7,L
#OIsMainFin=X,1,L
#OTempAmt=m,14,L
#ORevivAmtX=X,60,L

!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------
#LOOP=X,1,S
T(3,1)ASGN(LOOP$)

#OOFinCode=X,5,O
#OOFinItem=x,50,O
#OOApprAmt=m,14,O
#OOAccuApprAmt=m,14,O

</sub>


!------ 上行電文 ------
<sub type="TIM">
#CustId
#CustNo
#CaseSeq
#EntryDate
</sub>


!------ 下行電文TOM ------
<sub type="TOM">

TXFORM=L5983
#OCustId
#OCustNo
#OCaseSeq
#OPrincipalBal
#OAccuOverAmt
#ODueAmt
#OIntRate
#OEntryDate
#OIsMainFin
#OTempAmt
#ORevivAmtX
#OOFinCode
#OOFinItem
#OOApprAmt
#OOAccuApprAmt
^

<include src="HELPRIM.icf::HELPRIM.tom"/>
<include src="COM.icf::TRCTL.tom"/>
<include src="ROM.icf::L5R51.tom"/>
</sub>

!--------- OUTPUT畫面 --------

<sub type="PART" name="L5983" layout="cols=3;screen.width=[130,370,130,370];printer.width=[15,30,15,30];order=1;">
[
["[L5983]                                 結 清 試 算"],
[#<->#,"身分證字號",#OCustId],
["戶號",#OCustNo],["案件序號",#OCaseSeq],
["總本金餘額",#OPrincipalBal],["累溢收金額",#OAccuOverAmt],
["期款",#ODueAmt],["利率",#OIntRate],
["入帳日期",#OEntryDate],["是否為最大債權銀行",#OIsMainFin],
["暫收抵繳",#OTempAmt],["溢收抵繳",#OAccuOverAmt],
[#<->#,"應還金額",#ORevivAmtX],
]
</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">

#RPTFG=0,QUERY.GRID,L5983
#any={header:'L5983.part',caption:'[L5983] 結清試算',shrinkToFit:'false',width:1030,rowNum:12, rowList:[12,36,60]}

#OOFinCode=債權機構
{width:90,align:'center'}

#OOFinItem=機構名稱
{width:180}

#OOApprAmt=撥付金額
{width:180}

#OOAccuApprAmt=累計撥付金額
{width:180}


^

</sub>
