!---------- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">
!#TXCD
!T(3,L5901)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,0)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,40)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,40)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)

#button=x,100,S
T(2,{cmd=CHAIN; ntxcd=L5101; ntxbuf=1; ntxbuf5=type})ASGN(BTN_NEW1$)
K(MODIFYBUTTON,1,新增資料)
K(MODIFYBUTTON,查詢)

</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="L5901" layout="cols=1;screen.width=[130,870];printer.width=[20,80];order=1">
[
["[L5901]                                 資金運用概況明細資料查詢"],
[#<->#,"#FdAcdateYear+年份",#AcdateYear],
]

#FdAcdateYear=X,2,L
T(3,*)

#CHAIN=A,1,S
T(4,CHAIN$) 

#NTXBUF=X,3,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
T(1,@AcdateYear,#NTXBUF,1,3)
INVOKEJS(SHOW,p1,02,02,1)




! 年份
#AcdateYear=A,3,I
C(3,#CHAIN,0,$,s)
T(1,#SYSDATE,2,3)
@V(2,0)

#RPTFG=A,1,S

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!------------ TXFORM = L5901 -----------
<sub type="FORM" name="L5901">
#SCRTIL=_,_,S
T(3,[L5901] 資金運用概況明細資料)
#LOOP=X,1,S
E(0,1)ASGN(LOOP$)

! 日期
#OOAcDate=D,7,O
! 責任準備金
#OOResrvStndrd=m,14,O
! 可放款比率%
#OOPosbleBorPsn=m,3.2,O
! 可放款金額
#OOPosbleBorAmt=m,14,O
! 已放款金額
#OOAlrdyBorAmt=m,14,O
! 股東權益
#OOStockHoldersEqt=m,14,O
! 可運用資金
#OOAvailableFunds=m,14,O


#OOAcDateX=X,7,O
#OOResrvStndrdX=X,14,O
#OOPosbleBorPsnX=X,7,O
#OOPosbleBorAmtX=X,14,O
#OOAlrdyBorAmtX=X,14,O
#OOStockHoldersEqtX=X,14,O
#OOAvailableFundsX=X,14,O

#Convert=A,1,S
T(2,@OOAcDateX,#OOAcDate)
T(2,@OOResrvStndrdX,#OOResrvStndrd)
T(2,@OOPosbleBorPsnX,#OOPosbleBorPsn)
T(2,@OOPosbleBorAmtX,#OOPosbleBorAmt)
T(2,@OOAlrdyBorAmtX,#OOAlrdyBorAmt)
T(2,@OOStockHoldersEqtX,#OOStockHoldersEqt)
T(2,@OOAvailableFundsX,#OOAvailableFunds)

#OOBUF_EDIT=X,100,S
T(2,2+#OOAcDateX+#OOResrvStndrdX+#OOPosbleBorPsnX+#OOPosbleBorAmtX+#OOAlrdyBorAmtX+#OOStockHoldersEqtX+#OOAvailableFundsX)
#OOBUF_DELETE=X,100,S
T(2,4+#OOAcDateX+#OOResrvStndrdX+#OOPosbleBorPsnX+#OOPosbleBorAmtX+#OOAlrdyBorAmtX+#OOStockHoldersEqtX+#OOAvailableFundsX)
#OOBUF_SEARCH=X,100,S
T(2,5+#OOAcDateX+#OOResrvStndrdX+#OOPosbleBorPsnX+#OOPosbleBorAmtX+#OOAlrdyBorAmtX+#OOStockHoldersEqtX+#OOAvailableFundsX)

#OOBTN_EDIT=A,2,O
BIND(grid,{ cmd=CHAIN; ntxcd=L5101; ntxbuf=#OOBUF_EDIT})
#OOBTN_DELETE=A,2,O
BIND(grid,{ cmd=CHAIN; ntxcd=L5101; ntxbuf=#OOBUF_DELETE})
! QC 1048 查詢按鈕移除
</sub>

!------ 上行電文 TEXT ------
<sub type="TIM">
#AcdateYear
#END
</sub>

!------ 下行電文TOM ------
<sub type="TOM">
<include src="COM.icf::TRCTL.tom"/>
TXFORM=L5901

#OOAcDate
#OOResrvStndrd
#OOPosbleBorPsn
#OOPosbleBorAmt
#OOAlrdyBorAmt
#OOStockHoldersEqt
#OOAvailableFunds
^
</sub>


!---------- 單據輸出組合 ----------

<sub type="PART"  name="L5901" layout="cols=1;screen.width=[130,870];order=1;">
[
["[L5901]                                 資金運用概況明細資料查詢"],
[""],
]
</sub>

<sub type="SELECT">


#RPTFG=0,QUERY.GRID,L5901
#any={detail:true, header:'L5901.part', caption:'', width:1000, rowNum:20, rowList:[20,40,60]}

#OOBTN_EDIT=
{search:false,formatter:'cust:bind-button:修改',align:'center',canExport:false,width:35}
#OOBTN_DELETE=
{search:false,formatter:'cust:bind-button:刪除',align:'center',canExport:false,width:35}

#OOAcDate=日期
{width:65,align:'center'}
#OOResrvStndrd=責任準備金
{width:105}
#OOPosbleBorPsn=可放款比率%
{width:120}
#OOPosbleBorAmt=可放款金額
{width:105}
#OOAlrdyBorAmt=已放款金額
{width:105}
#OOStockHoldersEqt=股東權益
{width:105}
#OOAvailableFunds=可運用資金
{width:105}

^
<include src="PRT.icf::INQ04.sel" map="i=L5901;cpi=15"/>
#AcdateYear
%
#OOAcDate#OOResrvStndrd#OOPosbleBorPsn#OOPosbleBorAmt#OOAlrdyBorAmt
@^
</sub>
