!---------- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">
!#TXCD
!T(3,L5705)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,8)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,10)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,40)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)
</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="L5705" layout="cols=1;screen.width=[130,870];printer.width=[20,80];order=1">
[
["[L5705]                                 債權比例分攤(產出)"],
["#grid#,{id:1,expand:true,loop:10,row_height:1,s_cols:[150,500,350,500], p_cols:[20,25,10,100]}","","","",
 ["統一編號",""],
 [[#CustId1],[#CustName1]],
 ],
]
#CHAIN=A,1,S
T(4,CHAIN$) 

#NTXBUF=X,10,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
#WKINIT=X,1,S,
INVOKEJS(SHOW,grd1,3,11,0)

##loop{times:10,i:1}
#wkinit{i}=X,1,S
E(0,@loopcnt{i},1)
##end

#UseFuncIs1=X,1,S
K(MODIFYBUTTON,產生媒體檔)

#RimFunCd=A,1,S
#RimCustId=X,10,S
#loopcnt=N,3,S

##loop{times:10,i:1,h:0,j:2,k:3}

#CustId{i}=X,10,I
C(3,{i},1,$,C(4,#CustId{h},INVOKEJS(SHOW,grd1_{j},0),INVOKEJS(SHOW,grd1_{j},1)))
C(3,{i},1,$,C(4,#CustId{h},S,$))
INVOKEJS(SHOW,grd1_{j},1)
@A(ID_UNINO,1,#CustId{i})
C(4,#CustId{i},$,C(5,#CustId{i},#CheckCustId{i},$,V(4,#CheckCustId1,#CheckCustId2,#CheckCustId3,#CheckCustId4,#CheckCustId5,#CheckCustId6,#CheckCustId7,#CheckCustId8,#CheckCustId9,#CheckCustId10)))

!調rim檢查統編是否存在JcicZ048
#CheckCustIdRim{i}=X,1,S
T(2,@CustName{i},)
C(4,#CustId{i},s,$)
E(0,@RimFunCd,1)
T(2,@RimCustId,#CustId{i})
RESET_RIM(#CheckCustIdRim{i},L5R52)
S(L5R52,1,#RimFunCd,#RimCustId)
R(1,L5R52)
T(2,@CustName{i},#L5r52CustName)

#CustName{i}=x,100,L

#CheckCustId{i}=X,10,S
T(2,@CheckCustId{i},#CustId{i})

#loopcnt{i}=N,3,S
C(3,#loopcnt{i},1,E(0,0)E(0,@loopcnt,#loopcnt+1),$)

##end

#RPTFG=A,1,S
<include src="ROM.icf::L5R52.dec"/>
</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!------------ TXFORM = L5705 -----------
<sub type="FORM" name="L5705">
#SCRTIL=_,_,S
T(3,[L5705] 債權比例分攤-產出)

! 匯款單FileNo
#TxtSnoF=X,8,S
E(2,@SnoF,#TxtSnoF)
#SnoF=A,8,S

! 匯款單FileNo
#TxtPrtF=A,1,S
C(3,#SnoF,0,E(0,0),E(0,1))

#LOOP=X,1,S
E(0,1)ASGN(LOOP$)

</sub>

!------ 上行電文 TEXT ------
<sub type="TIM">
##loop{times:10,i:1}
#CustId{i}
##end
#loopcnt
</sub>

!------ 下行電文TOM ------
<sub type="TOM">
<include src="COM.icf::TRCTL.tom"/>
<include src="ROM.icf::L5R52.tom"/>
TXFORM=L5705
#TxtSnoF
^
</sub>

<sub type="PART" name="L5705" layout="cols=1;screen.width=[130,870];printer.width=[15,30,15,30];order=1">
[
["[L5705]                                 債權比例分攤(產出)                                                                         "],
]
</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">
#TxtPrtF=1,PDF,,,,,,,,,,,,,TxtSnoF;3,債權比例分攤產檔
^
</sub>
