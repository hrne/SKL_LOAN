!---------- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">
!#TXCD
!T(3,L5601)
</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="L5601" layout="cols=3;screen.width=[150,400,150,400];printer.width=[20,80];order=1">
[
["[L5601]                                 電催登錄"],
[#<->#,"#FdFunctionCd+功能",#FunctionCdX],
[#<->#,"#FdCaseCode+案件種類",#CaseCode,#CaseCodeX],
[#<->#,"#FdCustNo+戶號",#CustNo,"@",#CustName],
[#<->#,"#FdFacmNo+額度編號",#FacmNo],
["#FdAccCollPsn+催收人員",#AccCollPsn,#AccCollPsnX],["#FdLegalPsn+法務人員",#LegalPsn,#LegalPsnX],
["#FdPrevIntDate+繳息迄日",#PrevIntDate],["#FdLoanBal+放款餘額",#LoanBal],
["#FdNextIntDate+下次應繳日",#NextIntDate],
[#<->#,"@",#BTNA,#BTNB,#BTNC,#BTND,#BTNE,#BTNN],
["#FdTelDate+電催日期",#TelDate],["#FdTelTime+電催時間",#TelTime],
["#FdContactCode+電催對象",#ContactCode,#ContactCodeX],["#FdRecvrCode+接話人",#RecvrCode,#RecvrCodeX],
[#<->#,"#FdTelPhone+聯絡電話",#TelArea,#TelNo,#TelExt,#LiaisonName],
[#<->#,#BTNF],
["#FdResultCode+通話結果",#ResultCode,#ResultCodeX],["#FdCallDate+提醒日期",#CallDate],
[#<->#,"#FdRemark+其他記錄",#Remark],
["#FdEditDate+維護日期",#EditDate],["#FdEditTime+維護時間",#EditTime],
[#<->#,"#FdEditEmpNo+維護人員",#EditEmpNo,#EditEmpNoX],
]
!---------- AP TEXT AREA Variables ----------
#BTNA=X,1,I,ui:button;value:電催查詢;enable:1;tabbable:0
#BTNB=X,1,I,ui:button;value:面催查詢;enable:1;tabbable:0
#BTNC=X,1,I,ui:button;value:函催查詢;enable:1;tabbable:0
#BTND=X,1,I,ui:button;value:法務查詢;enable:1;tabbable:0
#BTNE=X,1,I,ui:button;value:提醒查詢;enable:1;tabbable:0
#BTNF=X,1,I,ui:button;value:顧客電話查詢;enable:1;tabbable:0
#BTNN=X,1,I,ui:button;value:提醒登錄;enable:1;tabbable:0

#CHAIN=A,1,S
T(4,CHAIN$) 
IF(#CHAIN!=1,V(P,此為連動交易，請從交易:[L5060案件處理清單]進入),$)

!做完交易自動更新原畫面
#AutoReFresh=A,1,S
C(3,#CHAIN,1,$,S)
E(0,1)
ASGN(CAUTO$)

<include src="HELPRIM.icf::HELPRIM.rtn"/>

! 1功能下拉選單
#FunctionCdRimName=x,20,S
T(3,CdCode.FunctionCd)
#FunctionCdHelp=x,1024,S

! 2案件種類下拉選單
#CaseCodeRimName=x,20,S
T(3,CdCode.CaseCode)
#CaseCodeHelp=x,1024,S

! 3電催對象下拉選單
#ContactCodeRimName=x,20,S
T(3,CdCode.ContactCode)
#ContactCodeHelp=x,1024,S

! 4接話人下拉選單
#RecvrCodeRimName=x,20,S
T(3,CdCode.RecvrCode)
#RecvrCodeHelp=x,1024,S

! 5通話結果下拉選單
#ResultCodeRimName=x,20,S
T(3,CdCode.ResultCode)
#ResultCodeHelp=x,1024,S

#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#FunctionCdRimName,#CaseCodeRimName,#ContactCodeRimName,#RecvrCodeRimName,#ResultCodeRimName)
R(1,XXR99)
CALL(#HelpProc)
T(2,@FunctionCdHelp,#HelpDesc1)
T(2,@CaseCodeHelp,#HelpDesc2)
T(2,@ContactCodeHelp,#HelpDesc3)
T(2,@RecvrCodeHelp,#HelpDesc4)
T(2,@ResultCodeHelp,#HelpDesc5)

#NTXBUF=X,33,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
T(1,@FunctionCd,#NTXBUF,1,1)
T(1,@CaseCode,#NTXBUF,2,1)
T(1,@CustNo,#NTXBUF,3,7)
T(1,@FacmNo,#NTXBUF,10,3)
T(1,@TitaTlrNo,#NTXBUF,13,6)
T(1,@TitaTxtNo,#NTXBUF,19,8)
T(1,@TitaAcDate,#NTXBUF,27,7)

INVOKEJS(SHOW,p1,02,02,1)
#PRE_EVELU=A,1,S

<include src="ROM.icf::L5R15.dec"/>
#RimCustNo=X,7,S
#RimFacmNo=X,3,S
#RimL5R15=X,1,S
T(2,@RimCustNo,#CustNo)
T(2,@RimFacmNo,#FacmNo)
RESET_RIM(#RimL5R15,L5R15)
S(L5R15,1,#RimCustNo,#RimFacmNo)
R(1,L5R15)
T(2,@CustName,#L5R15CustName)
T(2,@AccCollPsn,#L5R15AccCollPsn)
T(2,@LegalPsn,#L5R15LegalPsn)
T(2,@AccCollPsnX,#L5R15AccCollPsnX)
T(2,@LegalPsnX,#L5R15LegalPsnX)
T(2,@PrevIntDate,#L5R15PrevIntDate)
T(2,@LoanBal,#L5R15LoanBal)
T(2,@NextIntDate,#L5R15NextIntDate)
T(2,@CustUKey,#L5R15CustUKey)

#Space1=X,1,S
<include src="ROM.icf::L5R18.dec"/>
#RimCaseCode=X,1,S
! #RimCustNo=X,7,S
! #RimFacmNo=X,3,S
#RimAcDate=X,7,S
#RimTitaTlrNo=X,6,S
#RimTitaTxtNo=X,8,S
#RimL5R18=X,1,S
T(2,@RimCaseCode,#CaseCode)
! T(2,@RimCustNo,#CustNo)
! T(2,@RimFacmNo,#FacmNo)
T(2,@RimAcDate,#TitaAcDate)
T(2,@RimTitaTlrNo,#TitaTlrNo)
T(2,@RimTitaTxtNo,#TitaTxtNo)
C(3,#FunctionCd,1,S,$)
RESET_RIM(#RimL5R18,L5R18)
S(L5R18,1,#RimCaseCode,#RimCustNo,#RimFacmNo,#RimAcDate,#RimTitaTlrNo,#RimTitaTxtNo)
R(1,L5R18)
T(2,@TelDate,#L5R18TelDate)
T(2,@TelTime,#L5R18TelTime)
T(2,@ContactCode,#L5R18ContactCode)
T(2,@RecvrCode,#L5R18RecvrCode)
T(2,@TelArea,#L5R18TelArea)
T(2,@TelNo,#L5R18TelNo)
T(2,@TelExt,#L5R18TelExt)
T(2,@ResultCode,#L5R18ResultCode)
T(2,@CallDate,#L5R18CallDate)
T(2,@Remark,#L5R18ReMark)
T(2,@EditEmpNo,#L5R18EditEmpNo)
T(2,@EditDate,#L5R18EditDate)
T(2,@EditTime,#L5R18EditTime)
! 調Rim完成預先帶入
T(H,@ContactCodeX,#ContactCode,#ContactCodeHelp)
T(H,@RecvrCodeX,#RecvrCode,#RecvrCodeHelp)
T(H,@ResultCodeX,#ResultCode,#ResultCodeHelp)
#Space2=X,1,S
!C(2,#FunctionCd,s,$,$,$,s,s)
!T(4,@EditEmpNo,TLRNO$)
<include src="ROM.icf::L5R28.dec"/>
#RimEmployeeNo=X,6,S
#RimL5R28=X,1,S
T(2,@RimEmployeeNo,#EditEmpNo)
RESET_RIM(#RimL5R28,L5R28)
S(L5R28,1,#RimEmployeeNo)
R(1,L5R28)
T(2,@EditEmpNoX,#L5r28FullName)
!必輸欄位
#FdFunctionCd=X,1,L
#FdCaseCode=X,1,L
#FdCustNo=X,1,L
#FdAccCollPsn=X,1,L
#FdLegalPsn=X,1,L
#FdPrevIntDate=X,1,L
#FdLoanBal=X,1,L
#FdNextIntDate=X,1,L
#FdTelPhone=X,1,L
#FdCallDate=X,1,L
#FdRemark=X,1,L
#FdEditEmpNo=X,1,L
#FdFacmNo=X,1,L
#FdEditDate=X,1,L
#FdEditTime=X,1,L


#FdTelDate=X,1,L
C(3,#FunctionCd,1,T(3,#FdTelDate,*),$)
C(3,#FunctionCd,2,T(3,#FdTelDate,*),$)
C(3,#FunctionCd,3,T(3,#FdTelDate,*),$)
C(3,#FunctionCd,4,T(3,#FdTelDate, ),$)
C(3,#FunctionCd,5,T(3,#FdTelDate, ),$)
#FdTelTime=X,1,L
C(3,#FunctionCd,1,T(3,#FdTelTime,*),$)
C(3,#FunctionCd,2,T(3,#FdTelTime,*),$)
C(3,#FunctionCd,3,T(3,#FdTelTime,*),$)
C(3,#FunctionCd,4,T(3,#FdTelTime, ),$)
C(3,#FunctionCd,5,T(3,#FdTelTime, ),$)
#FdContactCode=X,1,L
C(3,#FunctionCd,1,T(3,#FdContactCode,*),$)
C(3,#FunctionCd,2,T(3,#FdContactCode,*),$)
C(3,#FunctionCd,3,T(3,#FdContactCode,*),$)
C(3,#FunctionCd,4,T(3,#FdContactCode, ),$)
C(3,#FunctionCd,5,T(3,#FdContactCode, ),$)
#FdRecvrCode=X,1,L
C(3,#FunctionCd,1,T(3,#FdRecvrCode,*),$)
C(3,#FunctionCd,2,T(3,#FdRecvrCode,*),$)
C(3,#FunctionCd,3,T(3,#FdRecvrCode,*),$)
C(3,#FunctionCd,4,T(3,#FdRecvrCode, ),$)
C(3,#FunctionCd,5,T(3,#FdRecvrCode, ),$)
#FdResultCode=X,1,L
C(3,#FunctionCd,1,T(3,#FdResultCode,*),$)
C(3,#FunctionCd,2,T(3,#FdResultCode,*),$)
C(3,#FunctionCd,3,T(3,#FdResultCode,*),$)
C(3,#FunctionCd,4,T(3,#FdResultCode, ),$)
C(3,#FunctionCd,5,T(3,#FdResultCode, ),$)
!end

! 登放序號
#ActSeq=X,20,S
IF (#FunctionCd==1 || #FunctionCd==2|| #FunctionCd==3,T(F,@TelDate,1)T(F,@TelTime,1)T(F,@ContactCode,1)T(F,@RecvrCode,1)T(F,@TelPhone,1)T(F,@ResultCode,1)T(F,@CallDate,1)T(F,@Remark,1),
                                                      T(F,@TelDate,0)T(F,@TelTime,0)T(F,@ContactCode,0)T(F,@RecvrCode,0)T(F,@TelPhone,0)T(F,@ResultCode,0)T(F,@CallDate,0)T(F,@Remark,0)T(F,@TelArea,0)T(F,@TelNo,0)T(F,@TelExt,0))

IF(#FunctionCd == 5 || #FunctionCd == 4,INVOKEJS(SHOW,L5601,8,8,0)INVOKEJS(SHOW,L5601,12,12,0),INVOKEJS(SHOW,L5601,8,8,1)INVOKEJS(SHOW,L5601,12,12,1))
IF(#FunctionCd==5,K(NOBUTTON,CLOSEY),$)
C(2,#FunctionCd,$,K(MODIFYBUTTON,新增),K(MODIFYBUTTON,修改),K(MODIFYBUTTON,新增),K(MODIFYBUTTON,刪除))

! 功能
#FunctionCd=A,1,S

#FunctionCdX=X,4,L
T(H,#FunctionCd,#FunctionCdHelp)
!刪除隱藏重新交易按鈕
#AGAIN=X,1,S
C(2,#FunctionCd,$,$,E(0,1),$,E(0,1))
ASGN(AGAIN$)

! 案件種類
#CaseCode=A,1,L

#CaseCodeX=X,4,L
T(H,#CaseCode,#CaseCodeHelp)

!<電催查詢>
#BUFA=X,11,S
T(2,#CaseCode+#CustNo+#FacmNo)
#BINDA=X,1,S
BIND(#BTNA,click, {cmd=CHAIN; ntxcd=L5961; ntxbuf=#BUFA})
!<面催查詢>
#BUFB=X,11,S
T(2,#CaseCode+#CustNo+#FacmNo)
#BINDB=X,1,S
BIND(#BTNB,click, {cmd=CHAIN; ntxcd=L5962; ntxbuf=#BUFB})
!<函催查詢>
#BUFC=X,11,S
T(2,#CaseCode+#CustNo+#FacmNo)
#BINDC=X,1,S
BIND(#BTNC,click, {cmd=CHAIN; ntxcd=L5963; ntxbuf=#BUFC})
!<法務查詢>
#BUFD=X,11,S
T(2,#CaseCode+#CustNo+#FacmNo)
#BINDD=X,1,S
BIND(#BTND,click, {cmd=CHAIN; ntxcd=L5964; ntxbuf=#BUFD})
!<提醒查詢>
#BUFE=X,12,S
T(2,#CaseCode+#CustNo+#FacmNo+1)
#BINDE=X,1,S
BIND(#BTNE,click, {cmd=CHAIN; ntxcd=L5965; ntxbuf=#BUFE})
! <提醒登錄>
#BUFN=X,12,S
T(2,1+#CaseCode+#CustNo+#FacmNo+1)
#BINDN=X,1,S
BIND(#BTNN,click, {cmd=CHAIN; ntxcd=L5605; ntxbuf=#BUFN})

! 戶號
#CustNo=A,7,L

! 戶名----調RIM
#CustName=X,100,L

! 額度編號
#FacmNo=A,3,L
! 催收人員
#AccCollPsn=X,8,L
#AccCollPsnX=X,40,L
! 法務人員
#LegalPsn=X,8,L
#LegalPsnX=X,40,L
! 繳息迄日
#PrevIntDate=D,7,L
! 放款餘額
#LoanBal=M,14,L
! 下次繳息日
#NextIntDate=D,7,L
! 客戶識別碼
#CustUKey=X,32,S
! ---------調RIM
! 電催日期
#TelDateX=X,8,S
T(4,#SYSCDATE)

#TelDate=D,7,I
C(2,#FunctionCd,S,$,$,$,s,s)
C(3,#FunctionCd,1,T(1,#TelDateX,2,7),$)
D(8)
@V(7)
A(DATE,0,#TelDate)

! 電催時間
#TelTimeX=X,6,S
T(4,TIME$)
#TelTime=X,4,I
C(2,#FunctionCd,S,$,$,$,s,s)
C(3,#FunctionCd,1,T(1,#TelTimeX,1,4),$)
@V(7)A(TIME,HHmm,#TelTime)

! 電催對象
#ContactCode=A,1,I
HELP(#ContactCodeHelp)
C(2,#FunctionCd,S,$,$,$,s,s)
@T(3,@ContactCodeX,)
V(H,#ContactCodeHelp)

#ContactCodeX=X,6,L
T(H,#ContactCode,#ContactCodeHelp)

! 接話人
#RecvrCode=A,1,I
C(2,#FunctionCd,S,$,$,$,s,s)
HELP(#RecvrCodeHelp)
@T(3,@RecvrCodeX,)
V(H,#RecvrCodeHelp)
#RecvrCodeX=X,4,L
T(H,#RecvrCode,#RecvrCodeHelp)

#Space=X,1,S
<include src="ROM.icf::L5R23.dec"/>
#RimCustUKey=X,32,S
#RimL5R23=X,1,S
T(2,@RimCustUKey,#CustUKey)
C(3,#FunctionCd,1,$,s)
RESET_RIM(#RimL5R23,L5R23)
S(L5R23,1,#RimCustUKey)
R(1,L5R23)
T(2,@TelArea,#L5R23TelArea)
T(2,@TelNo,#L5R23TelNo)
T(2,@TelExt,#L5R23TelExt)
T(2,@LiaisonName,#L5R23LiaisonName)
T(2,@CustId,#L5R23CustId)

! 客戶編號
#CustId=X,10,S
@C(4,#CustId,S,$)
A(ID_UNINO,1,#CustId)

!<顧客聯絡電話維護>
#BUFF=X,30,S
T(2,1+          +#CustNo)
#BINDF=X,1,S
BIND(#BTNF,click, {cmd=CHAIN; ntxcd=L1905; ntxbuf=#BUFF;ntxbuf5=type<-1:TelArea<-OOTelArea:TelNo<-OOTelNo:TelExt<-OOTelExt})

! 聯絡電話
#TelArea=X,5,I
C(2,#FunctionCd,S,$,$,$,s,s)
@C(4,#TelArea,S,V(9))

#TelNo=X,10,I
C(2,#FunctionCd,S,$,$,$,s,s)
@C(4,#TelNo,S,V(9))

#TelExt=X,5,I
C(2,#FunctionCd,S,$,$,$,s,s)
@C(4,#TelExt,S,V(9))

! 聯絡人姓名
#LiaisonName=X,100,L

! 通話結果
#ResultCode=A,1,I
C(2,#FunctionCd,S,$,$,$,s,s)
HELP(#ResultCodeHelp,cols:2)
@T(3,@ResultCodeX,)
V(H,#ResultCodeHelp)

#ResultCodeX=X,12,L
T(H,#ResultCode,#ResultCodeHelp)

#Funcd_Remark=X,1,S
IF(#ResultCode==9,T(3,@FdRemark,*),T(3,@FdRemark,))
! 提醒日期
#CallDate=D,7,I
C(2,#FunctionCd,S,$,$,$,s,s)
C(3,#FunctionCd,1,T(1,#TelDateX,2,7),$)
D(8)
@A(DATE,0,#CallDate)
! 其他記錄

! #MemoA=X,40,I
! C(2,#FunctionCd,S,$,$,s,s,s)
! #MemoB=X,40,I
! C(2,#FunctionCd,S,$,$,s,s,s)

#Remark=x,10.50,I
C(2,#FunctionCd,S,$,$,$,s,s)

@C(3,#ResultCode,9,V(7),$)

! 維護人員
#EditEmpNo=X,6,L
C(2,#FunctionCd,S,$,$,$,s,s)
T(4,@EditEmpNo,TLRNO$)
T(2,@RimEmployeeNo,#EditEmpNo)
RESET_RIM(#RimL5R28,L5R28)
S(L5R28,1,#RimEmployeeNo)
R(1,L5R28)
T(2,@EditEmpNoX,#L5r28FullName)

#EditEmpNoX=X,50,L
! 經辦
#TitaTlrNo=X,6,L
! 交易序號
#TitaTxtNo=X,8,L
! 系統日期
#TitaAcDate=D,7,L

#CDate=D,7,S
T(1,#SYSCDATE,2,7)
! 維護日期
#EditDate=D,7,L
C(2,#FunctionCd,S,T(2,#CDate),T(2,#CDate),T(2,#CDate),s,s)

! 維護時間
#EditTimeX=X,6,S
T(4,TIME$)
#EditTime=X,4,L
C(2,#FunctionCd,S,$,$,$,s,s)
T(1,#EditTimeX,1,4)
@V(7)

!參考編號
#MRKEY=_,_,S
T(2,#CustNo+#FacmNo)

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!------------ TXFORM = L5601 -----------
<sub type="FORM" name="L5601">
</sub>

!------ 上行電文 TEXT ------
<sub type="TIM">
#FunctionCd
#CustNo
#FacmNo
#CaseCode
#AccCollPsn
#LegalPsn
#PrevIntDate
#LoanBal
#TelDate
#TelTime
#ContactCode
#RecvrCode
#TelArea
#TelNo
#TelExt
#ResultCode
#CallDate
#Remark
#TitaTlrNo
#TitaTxtNo
#TitaAcDate
#END
</sub>

!------ 下行電文TOM ------
<sub type="TOM">
<include src="COM.icf::TRCTL.tom"/>
<include src="ROM.icf::L5R15.tom"/>
<include src="ROM.icf::L5R18.tom"/>
<include src="ROM.icf::L5R23.tom"/>
<include src="ROM.icf::L5R28.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
TXFORM=L5601

^
</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">
</sub>
