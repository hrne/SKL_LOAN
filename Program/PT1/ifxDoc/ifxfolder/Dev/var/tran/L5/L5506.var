!---------- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">
![一段式/二段式/三段式]
#RELCD=_,_,S
E(0,1)

#ACTFG=_,_,S
C(2,#FKEY,E(0,1),$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[150,850];printer.width=[20,80];order=1">
[
["[L5506]                                 內網報表業績維護"],
["#FdFunCodeX+功能選項",#FunCodeX],
["#FdCustNo+借款人戶號",#CustNo,"-",#FacmNo,"-",#BormNo,#BTN1],
["#FdCustName+戶名",#CustName],
["#FdIntroducer+介紹人",#Introducer,#IntroducerName],
["#FdBsOfficer+房貸專員",#BsOfficer,#BsOfficerName],
["#FdPerfAmt+業績金額",#PerfAmt],
["#FdUnitType+單位類別",#UnitType,"@(1:全部@2:單位@3:區部@4:部室@5:區部＋部室)"],
["#FdSumAmt+累計達成金額",#SumAmtSign,#SumAmt],
["#FdSumCnt+累計達成件數",#SumCntSign,#SumCnt],
["#FdUnitCode+單位代號",#UnitCode,#UnitItem],
["#FdDistCode+區部代號",#DistCode,#DistItem],
["#FdDeptCode+部室代號",#DeptCode,#DeptItem],
["#FdWorkMonth+工作月",#WorkMonth],
]


![Buttom資料查詢]
#BTN1=X,15,I,ui:button;value:業績查詢;enable:1;tabbable:0;title:L5051 業績查詢;
!#BTN2=X,15,I,ui:button;value:單位查詢;enable:1;tabbable:0;title:L5051 單位查詢;
!#BTN3=X,15,I,ui:button;value:區部查詢;enable:1;tabbable:0;title:L5051 區部查詢;
!#BTN4=X,15,I,ui:button;value:部室查詢;enable:1;tabbable:0;title:L5051 部室查詢;

#BUF1=X,100,S

#BIND1=X,1,S
BIND(#BTN1,click, {cmd=CHAIN; ntxcd=L5051; ntxbuf=#BUF1;ntxbuf5=type<-1:CustNo<-OOCustNo:FacmNo<-OOFacmNo:BormNo<-OOBormNo:CustName<-OOCustNm})
!#BIND2=X,1,S
!BIND(#BTN2,click, {cmd=CHAIN; ntxcd=L6086; ntxbuf=#BUF1;ntxbuf5=type<-1:UnitCode<-OOUnitCode:UnitItem<-OOUnitItem})
!#BIND3=X,1,S
!BIND(#BTN3,click, {cmd=CHAIN; ntxcd=L6086; ntxbuf=#BUF1;ntxbuf5=type<-1:DistCode<-OODistCode:DistItem<-OODistItem})
!#BIND4=X,1,S
!BIND(#BTN4,click, {cmd=CHAIN; ntxcd=L6086; ntxbuf=#BUF1;ntxbuf5=type<-1:DeptCode<-OODeptCode:DeptItem<-OODeptItem})


#FdFunCodeX=X,2,L
#FdCustNo=X,2,L
#FdCustName=X,2,L
#FdPieceCode=X,2,L
#FdIntroducer=X,2,L
#FdBsOfficer=X,2,L
#FdPerfAmt=X,2,L
#FdUnitType=X,2,L 
#FdSumAmt=X,2,L
#FdSumCnt=X,2,L    
#FdUnitCode=X,2,L
#FdDistCode=X,2,L
#FdDeptCode=X,2,L
#FdWorkMonth=X,2,L

#ShowHide=@,1,S
!INVOKEJS(SHOW,p1,10,12,0)
!C(2,#UnitType,$,INVOKEJS(SHOW,p1,10,12,1)
!               ,INVOKEJS(SHOW,p1,10,10,1)INVOKEJS(SHOW,p1,11,12,0)
!               ,INVOKEJS(SHOW,p1,10,10,0)INVOKEJS(SHOW,p1,11,11,1)INVOKEJS(SHOW,p1,12,12,0)
!               ,INVOKEJS(SHOW,p1,10,11,0)INVOKEJS(SHOW,p1,12,12,1)
!               ,INVOKEJS(SHOW,p1,10,10,0)INVOKEJS(SHOW,p1,11,12,1))

<include src="HELPRIM.icf::HELPRIM.rtn"/>
#CODEFuncCode1=x,20,S                  
T(3,CdCode.FuncCode1)     
             
#FuncCode1Help=x,50,S

#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#CODEFuncCode1)
R(1,XXR99)
CALL(#HelpProc)
T(2,@FuncCode1Help,#HelpDesc1)

#CHAIN=A,1,S
T(4,CHAIN$) 
IF(#CHAIN==0,V(P,本交易為連動交易，請由L5056連動進入),$)

#NTXBUF=X,21,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
T(1,@FunCode,#NTXBUF,1,1)
T(1,@LogNo,#NTXBUF,2,8)

#LogNo=A,8,S

! FuncCode1(1:新增;2:修改;4:刪除;5:查詢)
#FunCode=A,1,S

![維護記號名稱]
#FunCodeX=X,4,L
C(3,#FunCode,5,T(3,查詢),T(H,#FunCode,#FuncCode1Help))
K(MODIFYBUTTON,#FunCodeX)
C(3,#FunCode,5,K(NOBUTTON,CLOSEY),$)

!刪除隱藏重新交易按鈕
#AGAIN=X,1,S
C(3,#FunCode,1,S,$)
E(0,1)ASGN(AGAIN$)

#CheckInsert1=X,1,S
IF(#FunCode!=1,$,S)
T(F,@CustNo,0)
T(F,@FacmNo,0)
T(F,@BormNo,0)
HIDE(#BTN1)

#CheckInsert2=X,1,S
C(2,#FunCode,S,S,S,S,$,$)
T(3,@FdUnitCode,)
T(3,@FdDistCode,)
T(3,@FdDeptCode,)
T(F,@UnitType,0)
T(F,@SumAmtSign,0)
T(F,@SumAmt,0)
T(F,@SumCntSign,0)
T(F,@SumCnt,0)
T(F,@UnitCode,0)
T(F,@DistCode,0)
T(F,@DeptCode,0)
!HIDE(#BTN2)
!HIDE(#BTN3)
!HIDE(#BTN4)

<include src="ROM.icf::L5R30.dec"/>

#Rim1=X,1,S
C(3,#FunCode,1,S,$)
RESET_RIM(#Rim2,L5R45)
S(L5R45,01,#FunCode,#LogNo)
R(1,L5R45)
CALL(#ShowHide)

! 借款人戶號
#CustNo=A,7,I
C(3,#FunCode,1,$,s)

! 額度編號
#FacmNo=A,3,I
C(3,#FunCode,1,$,s)

! 撥款序號
#BormNo=A,3,I
C(3,#FunCode,1,$,s)

#MRKEY=_,_,S
T(2,#CustNo+-+#FacmNo+-+#BormNo)

#Rim2=X,1,S
C(3,#FunCode,1,$,S)
RESET_RIM(#Rim2,L5R45)
S(L5R45,01,#FunCode,#CustNo,#FacmNo,#BormNo)
R(1,L5R45)
!INVOKEJS(SHOW,p1,10,12,0)

#PerfDate=D,7,S

#WorkSeason=A,5,S

! 戶名
#CustName=X,2.50,L

#WorkMonth=A,5,S
!ALERT(#WorkMonth)

! 介紹人NM
#Introducer=X,6,L
#IntroducerName=x,50,L

!房貸專員
#BsOfficer=X,6,L
#BsOfficerName=x,50,L

!業績金額
#PerfAmt=+m,15,L

#PerfCnt=m,4.1,S
  
#UnitType=A,1,I
!INVOKEJS(SHOW,p1,10,12,0)
C(2,#FunCode,s,$,$,$,s,s)
@
V(5,1,5)
CALL(#ShowHide)

#SignHelp=x,1024,S
T(3, :空白不調整;+:增加;-:減少)

#SumAmtSign=X,1,I
C(2,#FunCode,s,$,$,$,s,s)
HELP(#SignHelp)
@
V(H,#SignHelp)

#SumAmt=m,14,I
C(2,#FunCode,s,$,$,$,s,s)
C(4,#SumAmtSign,S,$)
@
V(2,0)

#SumCntSign=X,1,I
C(2,#FunCode,s,$,$,$,s,s)
HELP(#SignHelp)
@
V(H,#SignHelp)

#SumCnt=m,4.1,I
C(2,#FunCode,s,$,$,$,s,s)
C(4,#SumCntSign,S,$)
@
V(2,0)

#Chk=X,1,S
C(4,#SumAmtSign,C(4,#SumCntSign,V(P,無調整累計達成金額及件數),$),$)

#UnitCode=X,6,L
!C(2,#FunCode,s,$,$,$,s,s)
!C(5,#FdUnitCode,*,$,S)
!@
!V(7)

#UnitItem=x,50,L

#DistCode=X,6,L
!C(2,#FunCode,s,$,$,$,s,s)
!C(5,#FdDistCode,*,$,S)
!@
!V(7)
#DistItem=x,50,L

#DeptCode=X,6,L
!C(2,#FunCode,s,$,$,$,s,s)
!C(5,#FdDeptCode,*,$,S)
!@
!V(7)
#DeptItem=x,50,L

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!------------ TXFORM = L5506 -----------
<sub type="FORM" name="L5506">
</sub>

!------ 上行電文 TEXT ------
<sub type="TIM">
#FunCode
#LogNo
#CustNo
#FacmNo
#BormNo
#PerfDate
#WorkMonth
#WorkSeason
#CustName
#Introducer
#IntroducerName
#BsOfficer
#BsOfficerName
#PerfAmt
#PerfCnt
#UnitType
#SumAmtSign
#SumAmt
#SumCntSign
#SumCnt
#UnitCode
#UnitItem
#DistCode
#DistItem
#DeptCode
#DeptItem
</sub>

!------ 下行電文TOM ------
<sub type="TOM">
<include src="COM.icf::TRCTL.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
TXFORM=L5506
^
TXFORM=L5R45
#CustNo
#FacmNo
#BormNo
#CustName
#PerfDate
#WorkMonth
#WorkSeason
#Introducer
#IntroducerName
#BsOfficer
#BsOfficerName
#PerfAmt
#PerfCnt
#UnitType
#SumAmtSign
#SumAmt
#SumCntSign
#SumCnt
#UnitCode
#UnitItem
#DistCode
#DistItem
#DeptCode
#DeptItem
^
</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">
<include src="PRT.icf::UPD01.sel"/>
</sub>

