----- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">

#TXCD
T(3,L4927)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD2.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[150,850];printer.width=[20,100];">
[
["[L4927]                                 匯款轉帳檔明細查詢"],
!["#FdFuncCode+功能",#FuncCodeX],
["#FdEntryDate+入帳日期  ",#EntryDate],
["#FdCustNo+戶號",#CustNo,#CustName],
["#FdReconCode+對帳類別",#ReconCode,#ReconCodeX],
["#FdRepayAmt+還款金額",#RepayAmt],
["#FdRemintBank+匯款銀行代碼",#RemintBank],
["#FdDscptCode+摘要代碼",#DscptCode,#DscptCodeX],
["#FdTraderInfo+交易人資料",#TraderInfo],
["#FdRepayType+還款類別",#RepayType,#RepayTypeX],
["#FdVirtualAcctNo+虛擬帳號",#VirtualAcctNo],
["#FdAmlRsp+AML回應碼",#AmlRsp,#AmlRspX],
["#FdDepAcctNo+存摺帳號",#DepAcctNo],
["#FdAcDate+會計日",#AcDate],
["#FdBatchNo+批號",#BatchNo],  
["#FdDetailSeq+明細序號",#DetailSeq],
]
!---------- AP Button AREA ----------
![Buttom資料查詢]
! #BTN_SELECT_ALL=X,15,I,ui:button;value:查詢;enable:0;tabbable:0;title:LXXXX

#FdFuncCode=X,2,L
#FdEntryDate=X,2,L
#FdCustNo=X,2,L
#FdReconCode=X,2,L
#FdRepayAmt=X,2,L
#FdRemintBank=X,2,L
#FdDscptCode=X,2,L
#FdTraderInfo=X,2,L
#FdRepayType=X,2,L
#FdVirtualAcctNo=X,2,L
#FdAmlRsp=X,2,L
#FdDepAcctNo=X,2,L
#FdAcDate=X,2,L
#FdBatchNo=X,2,L
#FdDetailSeq=X,2,L

!---------- AP TEXT AREA Variables ----------
<include src="HELPRIM.icf::HELPRIM.rtn"/>

!FuncCode2(1: 新增;2: 修改;4: 刪除;5: 查詢)
#CDCODEFuncCode2=x,20,S                  
T(3,CdCode.FuncCode)                  
                                      
#FuncCodeHelp=x,100,S        

!ReconCodeHelp
#CDCODEReconCode=x,20,S                  
T(3,CdCode.ReconCode)
#ReconCodeHelp=x,1024,S

!DscptCodeHelp
#CDCODEDscptCode=x,20,S                  
T(3,CdCode.BankRmftCode)
#DscptCodeHelp=x,1024,S

!RepayTypeHelp
#CDCODERepayType=x,20,S                  
T(3,CdCode.RepayType)
#RepayTypeHelp=x,1024,S

!AmlRspHelp
#CDCODEAmlRsp=x,30,S                  
T(3,CdCode.AmlCheckItem)
#AmlRspHelp=x,1024,S


#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#CDCODEFuncCode2,#CDCODEReconCode,#CDCODEDscptCode,#CDCODERepayType,#CDCODEAmlRsp)
R(1,XXR99)
CALL(#HelpProc)
T(2,@FuncCodeHelp,#HelpDesc1)
T(2,@ReconCodeHelp,#HelpDesc2)
T(2,@DscptCodeHelp,#HelpDesc3)
T(2,@RepayTypeHelp,#HelpDesc4)
T(2,@AmlRspHelp,#HelpDesc5)
            

#CHAIN=A,1,S
T(4,CHAIN$)
IF(#CHAIN!=1,V(P,此為連動交易，請從交易:[L4926 匯款轉帳檔查詢]進入),$)

#NTXBUF=X,20,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)

#CHAIN_FuncCode=X,1,S
T(1,#NTXBUF,1,1)

#CHAIN_AcDate=D,7,S
T(1,#NTXBUF,2,7)

#CHAIN_BatchNo=X,6,S
T(1,#NTXBUF,9,6)

#CHAIN_DetailSeq=A,6,S
T(1,#NTXBUF,15,6)

#CHAINSET=X,1,S
C(3,#CHAIN,1,$,S)
T(2,@FuncCode,#CHAIN_FuncCode)
E(0,@AcDate,#CHAIN_AcDate)
E(0,@BatchNo,#CHAIN_BatchNo)
E(0,@DetailSeq,#CHAIN_DetailSeq)

#AcDate=D,7,L
#BatchNo=X,6,L
#DetailSeq=A,6,L

! 功能 必須輸入(1: 新增;2: 修改;4: 刪除;5:查詢)
#FuncCode=A,1,S
T(F,@FuncCode,0)
C(3,#CHAIN,1,s,$)
HELP(#FuncCodeHelp)
@V(H,#FuncCodeHelp)
E(0,@FUNCIND,#FuncCode)

#FuncCodeX=X,12,L
T(H,#FuncCode,#FuncCodeHelp)
C(2,#FuncCode,$,K(MODIFYBUTTON,新增),K(MODIFYBUTTON,修改),$,K(MODIFYBUTTON,刪除),K(NOBUTTON,CLOSEY))

#FUNCIND=_,_,S
E(0,#FuncCode)
<include src="COM.icf::CheckAuth.rtn"/>


!本營業日
#DATE=D,8,S
T(4,CDATE$)


#SendL4R33=X,1,S
C(3,#FuncCode,1,s,$)
E(0,@AcDate,#CHAIN_AcDate)
T(2,@BatchNo,#CHAIN_BatchNo)
E(0,@DetailSeq,#CHAIN_DetailSeq)
RESET_RIM(#SendL4R33,L4R33)
S(L4R33,1,#AcDate,#BatchNo,#DetailSeq)
R(1,L4R33)
E(0,@CustNo,#L4R33CustNo)
T(2,@RepayType,#L4R33RepayType)
E(0,@RepayAmt,#L4R33RepayAmt)
T(2,@DepAcctNo,#L4R33DepAcctNo)
E(0,@EntryDate,#L4R33EntryDate)
T(2,@DscptCode,#L4R33DscptCode)
T(2,@VirtualAcctNo,#L4R33VirtualAcctNo)
E(0,@WithdrawAmt,#L4R33WithdrawAmt)
E(0,@DepositAmt,#L4R33DepositAmt)
E(0,@Balance,#L4R33Balance)
T(2,@RemintBank,#L4R33RemintBank)
T(2,@TraderInfo,#L4R33TraderInfo)
T(2,@AmlRsp,#L4R33AmlRsp)
T(2,@ReconCode,#L4R33ReconCode)
T(2,@TitaTlrNo,#L4R33TitaTlrNo)
T(2,@TitaTxtNo,#L4R33TitaTxtNo)
T(2,@CustName,#L4R33CustName)
T(H,#RepayTypeX,#RepayType,#RepayTypeHelp)
T(H,#DscptCodeX,#DscptCode,#DscptCodeHelp)
T(H,#AmlRspX,#AmlRsp,#AmlRspHelp)
T(H,#ReconCodeX,#ReconCode,#ReconCodeHelp)

!入帳日期
#EntryDate=D,7,L

!戶號
#CustNo=A,7,L
!戶名
#CustName=x,100,L

!對帳類別
#ReconCode=X,3,L
#ReconCodeX=X,20,L
T(H,#ReconCode,#ReconCodeHelp)

!還款金額
#RepayAmt=m,14,L

!匯款銀行代碼
#RemintBank=X,7,L

!摘要代碼
#DscptCode=X,4,L
#DscptCodeX=X,20,L
T(H,#DscptCode,#DscptCodeHelp)

!交易人資料
#TraderInfo=X,20,L

!還款類別
#RepayType=X,2,L
#RepayTypeX=X,20,L
T(H,#RepayType,#RepayTypeHelp)

!虛擬帳號
#VirtualAcctNo=X,17,L

!AML回應碼
#AmlRsp=X,1,L
#AmlRspX=X,30,L
T(H,#AmlRsp,#AmlRspHelp)

!存摺帳號
#DepAcctNo=X,14,L

!提款
#WithdrawAmt=m,14,L
!存款
#DepositAmt=m,14,L
!結餘
#Balance=m,14,L
!經辦
#TitaTlrNo=X,6,L
!交易序號
#TitaTxtNo=X,8,L


#RPTFG=A,1,S
E(0,0)

#AGAIN=X,1,S
IF(#FuncCode==2 || #FuncCode==4,$,S)
E(0,1)ASGN(AGAIN$)

!參考編號
#MRKEY=_,_,S
T(2,#AcDate+#BatchNo+#DetailSeq)

<include src="ROM.icf::L0Rim.dec"/>
<include src="ROM.icf::L4R33.dec"/>
</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!---------- TXFORM = L4927 ----------
<sub type="FORM" name="L4927">

#SCRPRT=_,_,S
C(5,#TXFORM,L4927,$,S)

#SCRTIL=_,_,S
T(3,[L4927]  匯款轉帳檔明細查詢)

</sub>


!------ 上行電文 ------
<sub type="TIM">
#FuncCode
#AcDate
#BatchNo
#DetailSeq
#CustNo
#RepayType
#RepayAmt
#DepAcctNo
#EntryDate
#DscptCode
#VirtualAcctNo
#WithdrawAmt
#DepositAmt
#Balance
#RemintBank
#TraderInfo
#AmlRsp
#ReconCode
#TitaTlrNo
#TitaTxtNo

#END
</sub>


!------ 下行電文TOM ------
<sub type="TOM">
TXFORM=L4927^
<include src="COM.icf::TRCTL.tom"/>
<include src="ROM.icf::L4R33.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>

</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">
<include src="PRT.icf::UPD01.sel"/>
</sub>

