!---------- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">
!#TXCD
!T(3,L4970)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,20)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,171)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,40)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

#button=x,1,S
K(MODIFYBUTTON,查詢)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="L4970" layout="cols=1;screen.width=[150,850];printer.width=[20,80];order=1">
[
["[L4970]@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@暫收款可抵繳火險查詢"],
[#<->#,"#FdInsuStartDate+保險起日區間",#StartDate," ~",#EndDate],
]

#FdInsuStartDate=X,2,L
T(3,*)

! Help
<include src="HELPRIM.icf::HELPRIM.rtn"/>

#CHAIN=A,1,S
T(4,CHAIN$) 

! 下個月
#NEXT_MONTH=D,8,S
D(7,2,#SYSDATE,1,0)

! 前個月
#FORE_MONTH=D,8,S
D(7,3,#SYSDATE,1,0)


!本交易限05,06,07,09,11,99
#RepayCodeHelp=x,100,S
T(3,05:法院扣薪;06:理賠金;09:其他;11:大額匯款手工增入入帳;99:全部)

#StatusCodeHelp=x,50,S
T(3,0:正常;1:借支;2:催收;3:呆帳;4:結案)

#COLDIS=A,1,S

#NTXBUF=X,9,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
T(1,@InsuYearMonth,#NTXBUF,2,5)
T(1,@InsuYearMonthEnd,#NTXBUF,2,5)


! 保險起日
#StartDate=A,7,I
! C(3,#CHAIN,0,$,s)
! @
! V(7)A(DATE,0,#StartDate)
! 保險迄日
#CHECKMSG=X,20,S
T(2,需輸入日期)

#EndDate=A,7,I
! E(0,#SYSDATE)
! @V(7)A(DATE,0,#EndDate)
@
IF(#EndDate==0,V(P,#CHECKMSG),$)

#RPTFG=A,1,S

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!------------ TXFORM = L4970 -----------
<sub type="FORM" name="L4970">
#SCRTIL=_,_,S
T(3,[L4970] 暫收款可抵繳火險查詢)

#OtotalCnt=m,6,L

#OtotalAmt=m,14,L

#LOOP=X,1,S
E(0,1)ASGN(LOOP$)

! 請款年月                           
#OOInsuYearMonth=A,5,O
! 保單號碼
#OOPrevInsuNo=X,16,O
#OONowInsuNo=X,16,O

!保險起日
#OOInsuStartDate=A,8,O
!新保單號碼
#OOInsuEndDate=A,8,O

! 戶號
#OOCustNo=A,11,O
! 額度
! #OOFacmNo=A,3,O

! #OOCustNoA=X,11,O
! T(2,#OOCustNo+-+#OOFacmNo)
! 戶名
#OOCustName=x,100,O
! 總保費
#OOTotalInsuAmt=m,14,O
! 繳款方式
#OORepayCode=A,2,O
#OORepayCodeX=X,8,O
T(3,)T(H,#OORepayCode,#RepayCodeHelp)

! 處理代碼
#OOStatusCode=A,1,O
#OOStatusCodeX=X,8,O
T(3,0:正常;1:借支;2:催收;3:呆帳;4:結案)
! T(3,)T(H,#OOStatusCode,#StatusCodeHelp)

! #OORenewCode=A,1,O
! #OORenewCodeX=X,6,O
! 會計日期
! #OOAcDate=D,7,O

#OOTotInsuPrem=m,14,O
! #OOInsuReceiptDate=D,7,S

#OOTavBal=m,14,O

</sub>

!------ 上行電文 TEXT ------
<sub type="TIM">
#StartDate
#EndDate
#END
</sub>

!------ 下行電文TOM ------
<sub type="TOM">
<include src="COM.icf::TRCTL.tom"/>
TXFORM=L4970
#OtotalCnt
#OtotalAmt
#OOInsuYearMonth
#OOPrevInsuNo
#OONowInsuNo
#OOCustNo
#OOTotalInsuAmt
#OORepayCode
#OOStatusCode
#OOTavBal
^
<include src="HELPRIM.icf::HELPRIM.tom"/>
</sub>


!---------- 單據輸出組合 ----------
<sub type="PART" prompt='{{#SCRTIL}} world' name="L4970" layout="cols=3;screen.width=[130,370,130,370];order=1;">
[
["[L4970]@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@暫收款可抵繳火險查詢"],
["@合計筆數",#OtotalCnt,"筆"],["@@@合計金額",#OtotalAmt],
]
</sub>

<sub type="PART" prompt='{{#SCRTIL}} world' name="L4970A" layout="cols=3;screen.width=[130,370,130,370];order=1;">

</sub>
<sub type="SELECT">

#RPTFG=0,QUERY.GRID,L4970
#any={detail:true, header:'L4970.part', caption:'', width:1020, rowNum:20, rowList:[20,40,60]}
                        
#OOInsuYearMonth=火險到期年月
{width:125,align:'center'}
#OOPrevInsuNo=原保單號碼
{width:125,align:'center'}
#OONowInsuNo=新保單號碼
{width:125,align:'center'}

#OOInsuStartDate=保險起日
{width:85,align:'center'}

#OOInsuEndDate=保險迄日
{width:85,align:'center'}


#OOCustNo=戶號 額度
{width:85,align:'center'}
#OOCustName=戶名
{width:85}
#OOTotInsuPrem=總保費
{width:85}
#OORepayCode=繳款方式
{width:85}

!#OOStatusCode


#OOTavBal=暫收可抵繳金額
{width:85,align:'center'}


^

#RPTFG=1,QUERY.GRID,L4970A
#any={detail:false, header:'L4970A.part', caption:'', width:1020, rowNum:20, rowList:[20,40,60]}

^
<include src="PRT.icf::INQ04.sel" map="i=L4970;cpi=15"/>
#SearchFlag
#InsuYearMonth
%
#OtotalCnt
#OtotalAmt
#OOInsuYearMonth
#OOPrevInsuNo
#OONowInsuNo
#OOInsuStartDate
#OOInsuEndDate
#OOCustNo
#OOCustName
#OOTotInsuPrem
#OORepayCode
#OOStatusCode
#OOTavBal

@^
</sub>
