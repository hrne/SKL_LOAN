!---------- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">

!#TXCD
!T(3,XW111)

![一段式/二段式/三段式]
#RELCD=_,_,S
C(2,#FKEY,$,s,s,s,$,$,s,s,$,$)
E(0,2)

#ACTFG=_,_,S
C(2,#FKEY,$,s,s,s,$,$,s,s,$,$)
E(0,1)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
T(2,@RimTxCode,#TXCD)
E(0,@RimFKey,#FKEY)

</sub>

!=====================================================================
!#FKEY>0時，重新執行
!=====================================================================
<sub type="PREDC" name="PreDC">
!#PDC=X,1,S
!C(3,#FKEY,0,NOP,T(R,#MRKEY,#REFNO))
!C(3,#FKEY,3,NO_RUN(#CIFKEY,#PREFG,#KINDCD,#REFNO),$)
!C(3,#FKEY,7,NO_RUN(#CIFKEY,#PREFG,#KINDCD,#REFNO),s)

!<include src="COM.icf::ActFg-RUN.pre"/>
!<include src="COM.icf::TITLE-RUN.pre"/>
!<include src="TITF.icf::RPRUN.dec"/>
#WkPercent=X,3,S
T(3,%)

#WkMonthX=X,5,S
T(3, 個月)

#WkUnitX=X,7,S
T(3, 個單位)

!先隱藏欄位 FLAG 0=隱藏 1=顯示
#Hide2Flag=A,1,O
IF(#FKEY==0,E(0,0),$)

#Hide3Flag=A,1,O
IF(#FKEY==0,E(0,0),$)

#Hide4Flag=A,1,O
IF(#FKEY==0,E(0,0),$)

#Hide5Flag=A,1,O
IF(#FKEY==0,E(0,0),$)

#Hide6Flag=A,1,O
IF(#FKEY==0,E(0,0),$)

#Hide7Flag=A,1,S
IF(#FKEY==0,E(0,0),$)

#HIDE8FG=A,1,S
IF(#FKEY==0,E(0,0),$)

#HIDE9FG=A,1,S
IF(#FKEY==0,E(0,0),$)

#ExpandFlag=A,1,S
IF(#FKEY==0,E(0,0),$)

#P2SH=A,2,S
E(0,8)

!利率
#P2S=A,2,S
E(0,9)

#P2E=A,2,S
E(0,#P2S+4)

!階梯式利率
#P3T=A,2,S
E(0,#P2E+1)

#P3S=A,2,S
E(0,#P2E+2)

#P3E=A,2,S
E(0,#P3S)
!金額日期
#P4S=A,2,S
E(0,#P3E+2)

#P4E=A,2,S
E(0,#P4S+6)
!代碼類
#P5S=A,2,S
E(0,#P4E+2)

#P5E=A,2,S
E(0,#P5S+5)
!扣款帳號
#P6S=A,2,S
E(0,#P5E+2)

#P6E=A,2,S
E(0,#P6S+9)
!專員
#P7S=A,2,S
E(0,#P6E+2)

#P7E=A,2,S
E(0,#P7S+4)

!違約金
#P8S=A,2,S
E(0,#P7E+2)

#P8E=A,2,S
E(0,#P8S+1)

!其他
#P9S=A,2,S
E(0,#P8E+2)
#P9S1=A,2,S
E(0,#P8E+1)

#P9E=A,2,S
E(0,#P9S+4)

!按鈕顏色
#Klight=@,1,S
C(3,#Hide2Flag,1,K(LIGHT,#BTNHIDEP2,TXTRED,0),K(LIGHT,#BTNHIDEP2,TXTRED,-1))
C(3,#Hide3Flag,1,K(LIGHT,#BTNHIDEP3,TXTRED,0),K(LIGHT,#BTNHIDEP3,TXTRED,-1))
C(3,#Hide4Flag,1,K(LIGHT,#BTNHIDEP4,TXTRED,0),K(LIGHT,#BTNHIDEP4,TXTRED,-1))
C(3,#Hide5Flag,1,K(LIGHT,#BTNHIDEP5,TXTRED,0),K(LIGHT,#BTNHIDEP5,TXTRED,-1))
C(3,#Hide6Flag,1,K(LIGHT,#BTNHIDEP6,TXTRED,0),K(LIGHT,#BTNHIDEP6,TXTRED,-1))
C(3,#Hide7Flag,1,K(LIGHT,#BTNHIDEP7,TXTRED,0),K(LIGHT,#BTNHIDEP7,TXTRED,-1))
C(3,#HIDE8FG,1,K(LIGHT,#BTNHIDEP8,TXTRED,0),K(LIGHT,#BTNHIDEP8,TXTRED,-1))
C(3,#HIDE9FG,1,K(LIGHT,#BTNHIDEP9,TXTRED,0),K(LIGHT,#BTNHIDEP9,TXTRED,-1))
CALL(#CALLGRID)

!控制階梯式利率
#CALLGRID=@,1,S
##loop{times:10,n:1,k:2}
! IF({n}==1,$,IF(#StepMonthS{n}==0,INVOKEJS(SHOW,grd1_{k},0),INVOKEJS(SHOW,grd1_{k},1)))
IF({n}==1,s,IF(#StepMonthE{n}==0,INVOKEJS(SHOW,grd4_{n},0),INVOKEJS(SHOW,grd4_{n},1)))
##end
!--- P2 利率
#HideP2=@,1,S
C(3,#ExpandFlag,1,CALL(#Expand),$)
C(3,#Hide2Flag,1,E(0,@Hide2Flag,0),E(0,@Hide2Flag,1))
INVOKEJS(SHOW,p2,#Hide2Flag)
C(3,#Hide2Flag,1,K(LIGHT,#BTNHIDEP2,TXTRED,0),K(LIGHT,#BTNHIDEP2,TXTRED,-1))
C(3,#Hide2Flag,1,$,s)
C(3,#Hide3Flag,1,CALL(#HideP3),$)
C(3,#Hide4Flag,1,CALL(#HideP4),$)
C(3,#Hide5Flag,1,CALL(#HideP5),$)
C(3,#Hide6Flag,1,CALL(#HideP6),$)
C(3,#Hide7Flag,1,CALL(#HideP7),$)
C(3,#HIDE8FG,1,CALL(#HideP8),$)
C(3,#HIDE9FG,1,CALL(#HIDEP9),$)
CALL(#Klight)

!--- P3 金額、日期
#HideP3=@,1,S
C(3,#ExpandFlag,1,CALL(#Expand),$)
C(3,#Hide3Flag,1,E(0,@Hide3Flag,0),E(0,@Hide3Flag,1))
INVOKEJS(SHOW,p3,#Hide3Flag)
C(3,#Hide3Flag,1,K(LIGHT,#BTNHIDEP3,TXTRED,0),K(LIGHT,#BTNHIDEP3,TXTRED,-1))
C(3,#Hide3Flag,1,$,s)
C(3,#Hide2Flag,1,CALL(#HideP2),$)
C(3,#Hide4Flag,1,CALL(#HideP4),$)
C(3,#Hide5Flag,1,CALL(#HideP5),$)
C(3,#Hide6Flag,1,CALL(#HideP6),$)
C(3,#Hide7Flag,1,CALL(#HideP7),$)
C(3,#HIDE8FG,1,CALL(#HideP8),$)
C(3,#HIDE9FG,1,CALL(#HIDEP9),$)
CALL(#Klight)

!--- P9 階梯式利率
#HIDEP9=@,1,S
C(3,#ExpandFlag,1,CALL(#Expand),$)
C(3,#HIDE9FG,1,E(0,@HIDE9FG,0),E(0,@HIDE9FG,1))
INVOKEJS(SHOW,p4,#HIDE9FG)
C(3,#HIDE9FG,1,K(LIGHT,#BTNHIDEP4,TXTRED,0),K(LIGHT,#BTNHIDEP4,TXTRED,-1))
C(3,#HIDE9FG,1,$,s)
C(3,#Hide2Flag,1,CALL(#HideP2),$)
C(3,#Hide3Flag,1,CALL(#HideP3),$)
C(3,#Hide4Flag,1,CALL(#HideP4),$)
C(3,#Hide5Flag,1,CALL(#HideP5),$)
C(3,#Hide6Flag,1,CALL(#HideP6),$)
C(3,#Hide7Flag,1,CALL(#HideP7),$)
C(3,#HIDE8FG,1,CALL(#HideP8),$)
CALL(#Klight)
CALL(#showgrd1)

!--- P4 代碼類
#HideP4=@,1,S
C(3,#ExpandFlag,1,CALL(#Expand),$)
C(3,#Hide4Flag,1,E(0,@Hide4Flag,0),E(0,@Hide4Flag,1))
INVOKEJS(SHOW,p5,#Hide4Flag)
C(3,#Hide4Flag,1,K(LIGHT,#BTNHIDEP4,TXTRED,0),K(LIGHT,#BTNHIDEP4,TXTRED,-1))
C(3,#Hide4Flag,1,$,s)
C(3,#Hide2Flag,1,CALL(#HideP2),$)
C(3,#Hide3Flag,1,CALL(#HideP3),$)
C(3,#Hide5Flag,1,CALL(#HideP5),$)
C(3,#Hide6Flag,1,CALL(#HideP6),$)
C(3,#Hide7Flag,1,CALL(#HideP7),$)
C(3,#HIDE8FG,1,CALL(#HideP8),$)
C(3,#HIDE9FG,1,CALL(#HIDEP9),$)
CALL(#Klight)

!--- P5 扣款帳號
#HideP5=@,1,S
C(3,#ExpandFlag,1,CALL(#Expand),$)
C(3,#Hide5Flag,1,E(0,@Hide5Flag,0),E(0,@Hide5Flag,1))
INVOKEJS(SHOW,p6,#Hide5Flag)
C(3,#Hide5Flag,1,K(LIGHT,#BTNHIDEP5,TXTRED,0),K(LIGHT,#BTNHIDEP5,TXTRED,-1))
C(3,#Hide5Flag,1,$,s)
C(3,#Hide2Flag,1,CALL(#HideP2),$)
C(3,#Hide3Flag,1,CALL(#HideP3),$)
C(3,#Hide4Flag,1,CALL(#HideP4),$)
C(3,#Hide6Flag,1,CALL(#HideP6),$)
C(3,#Hide7Flag,1,CALL(#HideP7),$)
C(3,#HIDE8FG,1,CALL(#HideP8),$)
C(3,#HIDE9FG,1,CALL(#HIDEP9),$)
CALL(#Klight)

!--- P6 專員
#HideP6=@,1,S
C(3,#ExpandFlag,1,CALL(#Expand),$)
C(3,#Hide6Flag,1,E(0,@Hide6Flag,0),E(0,@Hide6Flag,1))
INVOKEJS(SHOW,p7,#Hide6Flag)
C(3,#Hide6Flag,1,K(LIGHT,#BTNHIDEP6,TXTRED,0),K(LIGHT,#BTNHIDEP6,TXTRED,-1))
C(3,#Hide6Flag,1,$,s)
C(3,#Hide2Flag,1,CALL(#HideP2),$)
C(3,#Hide3Flag,1,CALL(#HideP3),$)
C(3,#Hide4Flag,1,CALL(#HideP4),$)
C(3,#Hide5Flag,1,CALL(#HideP5),$)
C(3,#Hide7Flag,1,CALL(#HideP7),$)
C(3,#HIDE8FG,1,CALL(#HideP8),$)
C(3,#HIDE9FG,1,CALL(#HIDEP9),$)
CALL(#Klight)


!--- P7 清償金類型
#HideP7=@,1,S
C(3,#ExpandFlag,1,CALL(#Expand),$)
C(3,#Hide7Flag,1,E(0,@Hide7Flag,0),E(0,@Hide7Flag,1))
INVOKEJS(SHOW,p8,#Hide7Flag)
C(3,#Hide7Flag,1,K(LIGHT,#BTNHIDEP7,TXTRED,0),K(LIGHT,#BTNHIDEP7,TXTRED,-1))
C(3,#Hide7Flag,1,$,s)
C(3,#Hide2Flag,1,CALL(#HideP2),$)
C(3,#Hide3Flag,1,CALL(#HideP3),$)
C(3,#Hide4Flag,1,CALL(#HideP4),$)
C(3,#Hide5Flag,1,CALL(#HideP5),$)
C(3,#Hide6Flag,1,CALL(#HideP6),$)
C(3,#HIDE8FG,1,CALL(#HideP8),$)
C(3,#HIDE9FG,1,CALL(#HIDEP9),$)
CALL(#Klight)


#HideP7A=@,1,S 
C(3,#Hide7Flag,1,E(0,@Hide7Flag,0),E(0,@Hide7Flag,1))
INVOKEJS(SHOW,p1,#P7S,#P7E,#Hide7Flag)

!--- P8 其他
#HideP8=@,1,S
C(3,#ExpandFlag,1,CALL(#Expand),$)
C(3,#HIDE8FG,1,E(0,@HIDE8FG,0),E(0,@HIDE8FG,1))
INVOKEJS(SHOW,p9,#HIDE8FG)
C(3,#HIDE8FG,1,K(LIGHT,#BTNHIDEP8,TXTRED,0),K(LIGHT,#BTNHIDEP8,TXTRED,-1))
C(3,#HIDE8FG,1,$,s)
C(3,#Hide2Flag,1,CALL(#HideP2),$)
C(3,#Hide3Flag,1,CALL(#HideP3),$)
C(3,#Hide4Flag,1,CALL(#HideP4),$)
C(3,#Hide5Flag,1,CALL(#HideP5),$)
C(3,#Hide6Flag,1,CALL(#HideP6),$)
C(3,#Hide7Flag,1,CALL(#HideP7),$)
C(3,#HIDE9FG,1,CALL(#HIDEP9),$)
CALL(#Klight)



!--- 展開
#Expand=@,1,S
C(3,#ExpandFlag,1,E(0,@ExpandFlag,0),E(0,@ExpandFlag,1))
INVOKEJS(SHOW,p2,#ExpandFlag)
INVOKEJS(SHOW,p3,#ExpandFlag)
INVOKEJS(SHOW,p4,#ExpandFlag)
INVOKEJS(SHOW,p5,#ExpandFlag)
INVOKEJS(SHOW,p6,#ExpandFlag)
INVOKEJS(SHOW,p7,#ExpandFlag)
INVOKEJS(SHOW,p8,#ExpandFlag)
INVOKEJS(SHOW,p9,#ExpandFlag)
C(3,#ExpandFlag,1,K(LIGHT,#BTNExpand,TXTRED,0),K(LIGHT,#BTNExpand,TXTRED,-1))
C(3,#ExpandFlag,1,$,s)
E(0,@Hide2Flag,0)
E(0,@Hide3Flag,0)
E(0,@Hide4Flag,0)
E(0,@Hide5Flag,0)
E(0,@Hide6Flag,0)
E(0,@Hide7Flag,0)
E(0,@HIDE8FG,0)
E(0,@HIDE9FG,0)
CALL(#Klight)
CALL(#endcheck)
CALL(#showgrd1)


#endcheck=@,1,S
IF(#StepMonthE1==0,INVOKEJS(SHOW,grd4,0)INVOKEJS(SHOW,p1,#P3T,#P3T,0),$)

!--- 全部關閉
#CloseAll=@,1,S
INVOKEJS(SHOW,p1,#P2SH,#P9E,0)
C(3,#ExpandFlag,1,CALL(#Expand),$)
C(3,#Hide2Flag,1,CALL(#HideP2),$)
C(3,#Hide3Flag,1,CALL(#HideP3),$)
C(3,#Hide4Flag,1,CALL(#HideP4),$)
C(3,#Hide5Flag,1,CALL(#HideP5),$)
C(3,#Hide6Flag,1,CALL(#HideP6),$)
C(3,#Hide7Flag,1,CALL(#HideP7),$)
C(3,#HIDE8FG,1,CALL(#HideP8),$)
C(3,#HIDE9FG,1,CALL(#HIDEP9),$)



#showgrd1=@,1,S
INVOKEJS(SHOW,grd4,1)
##loop{times:10,n:1}
C(3,{n},1,INVOKEJS(SHOW,grd4_{n},1),IF(#StepMonthS{n}==0,INVOKEJS(SHOW,grd4_{n},0),INVOKEJS(SHOW,grd4_{n},1)))
##end

#ActFgHelp=x,20,S
T(3,1:登錄;2:放行)

#InvokeAll=X,1,S
C(3,#FKEY,0,INVOKEJS(SHOW,p1,1)
            INVOKEJS(SHOW,p2,0)
            INVOKEJS(SHOW,p3,0)
            INVOKEJS(SHOW,p4,0)
            INVOKEJS(SHOW,p5,0)
            INVOKEJS(SHOW,p6,0)
            INVOKEJS(SHOW,p7,0)
            INVOKEJS(SHOW,p8,0)
            INVOKEJS(SHOW,p9,0),$)
C(3,#FKEY,2,INVOKEJS(SHOW,p1,1)
            INVOKEJS(SHOW,p2,1)
            INVOKEJS(SHOW,p3,1)
            INVOKEJS(SHOW,p4,1)
            INVOKEJS(SHOW,p5,1)
            INVOKEJS(SHOW,p6,1)
            INVOKEJS(SHOW,p7,1)
            INVOKEJS(SHOW,p8,1)
            INVOKEJS(SHOW,p9,1),$)
C(3,#FKEY,2,T(H,@ACTFGX,#ACTFG,#ActFgHelp),$)

<include src="COM.icf::TITLE-RUN.pre"/>
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=3;screen.width=[200,800];printer.width=[15,35,15,35];order=1">
[
["[L2153]                                 核准額度登錄"],
[#<->#,"#FdActFg+登放記號",#ACTFGX],
[#<->#,"#FdCustId+統一編號",#CustId,"@",#BTN1,#CustIdX],
[#<->#,"#FdApplNo+申請號碼",#ApplNo,"@@@",#BTN2],
[#<->#,"#FdCustNo+借戶戶號",#CustNo],
[#<->#,"@@@@@@額度編號",#FacmNo],
[#<->#,"#FdCreditSysNo+案件編號",#CreditSysNo],
[#<->#,"@@@",#BTNHIDEP2,"@",#BTNHIDEP3,"@",#BTNHIDEP9,"@",#BTNHIDEP4,"@",#BTNHIDEP5,"@",#BTNHIDEP6,"@",#BTNHIDEP7,"@",#BTNHIDEP8,"@",#BTNExpand],
]
!---------- AP Button AREA ----------
![Buttom資料查詢]
#BTN1=X,15,I,ui:button;value:顧客資料查詢;enable:1;tabbable:0;title:L1001 顧客明細資料查詢;
#BTN2=X,15,I,ui:button;value:申請案件查詢;enable:0;tabbable:0;title:L2010 申請案件明細資料查詢;
!#BTN3=X,15,I,ui:button;value:行庫資料查詢;enable:1;tabbable:0;title: L6071 行庫資料查詢;
#BTN11=X,15,I,ui:button;value:員工資料查詢;enable:1;tabbable:0;title:L6088 員工資料檔查詢;
#BTN12=X,15,I,ui:button;value:員工資料查詢;enable:1;tabbable:0;title:L6088 員工資料檔查詢;
#BTN13=X,15,I,ui:button;value:員工資料查詢;enable:1;tabbable:0;title:L6088 員工資料檔查詢;
#BTN14=X,15,I,ui:button;value:員工資料查詢;enable:1;tabbable:0;title:L6088 員工資料檔查詢;
! #BTN15=X,15,I,ui:button;value:員工資料查詢;enable:1;tabbable:0;title:L6088 員工資料檔查詢;
#BTN16=X,15,I,ui:button;value:員工資料查詢;enable:1;tabbable:0;title:L6088 員工資料檔查詢;
#BTN17=X,15,I,ui:button;value:員工資料查詢;enable:1;tabbable:0;title:L6088 員工資料檔查詢;
#BTN19=X,15,I,ui:button;value:員工資料查詢;enable:1;tabbable:0;title:L6088 員工資料檔查詢;
#BTN20=X,15,I,ui:button;value:員工資料查詢;enable:1;tabbable:0;title:L6088 員工資料檔查詢;
#BTN18=X,15,I,ui:button;value:協辦人員等級查詢;enable:1;tabbable:0;title:L5022 協辦人員等級明細資料查詢 ;

#BIND11A=X,1,S
BIND(#BTN11,click, {cmd=CHAIN; ntxcd=L6088; ntxbuf=#BUF11A;ntxbuf5=type<-1:Introducer<-OOEmployeeNo})
#BIND12A=X,1,S
BIND(#BTN12,click, {cmd=CHAIN; ntxcd=L6088; ntxbuf=#BUF12A;ntxbuf5=type<-1:FireOfficer<-OOEmployeeNo})
#BIND13A=X,1,S
BIND(#BTN13,click, {cmd=CHAIN; ntxcd=L6088; ntxbuf=#BUF13A;ntxbuf5=type<-1:Estimate<-OOEmployeeNo})
#BIND14A=X,1,S
BIND(#BTN14,click, {cmd=CHAIN; ntxcd=L6088; ntxbuf=#BUF14A;ntxbuf5=type<-1:CreditOfficer<-OOEmployeeNo})
#BIND16A=X,1,S
BIND(#BTN16,click, {cmd=CHAIN; ntxcd=L6088; ntxbuf=#BUF16A;ntxbuf5=type<-1:BusinessOfficer<-OOEmployeeNo})
#BIND17A=X,1,S
BIND(#BTN17,click, {cmd=CHAIN; ntxcd=L6088; ntxbuf=#BUF17A;ntxbuf5=type<-1:Supervisor<-OOEmployeeNo})
#BIND18A=X,1,S
BIND(#BTN18,click, {cmd=CHAIN; ntxcd=L5022; ntxbuf=#BUF18A;ntxbuf5=type<-1:Coorgnizer<-OOEmpNo:CoorgnizerX<-OOFullname})
#BIND19A=X,1,S
BIND(#BTN19,click, {cmd=CHAIN; ntxcd=L6088; ntxbuf=#BUF19A;ntxbuf5=type<-1:InvestigateOfficer<-OOEmployeeNo})
#BIND20A=X,1,S
BIND(#BTN20,click, {cmd=CHAIN; ntxcd=L6088; ntxbuf=#BUF20A;ntxbuf5=type<-1:EstimateReview<-OOEmployeeNo})

#BUF1=X,42,S
ENABLE(#BTN1)ENABLE(#BTN2)

#BTNHIDEP2=X,15,I,ui:button;value:    利率    ;enable:1;tabbable:0
#BTNHIDEP9=X,15,I,ui:button;value: 階梯式利率 ;enable:1;tabbable:0
#BTNHIDEP3=X,15,I,ui:button;value: 金額、日期 ;enable:1;tabbable:0
#BTNHIDEP4=X,15,I,ui:button;value:   代碼類   ;enable:1;tabbable:0
#BTNHIDEP5=X,15,I,ui:button;value:  扣款帳號  ;enable:1;tabbable:0
#BTNHIDEP6=X,15,I,ui:button;value:    專員    ;enable:1;tabbable:0
#BTNHIDEP7=X,15,I,ui:button;value: 清償金類型 ;enable:1;tabbable:0
#BTNHIDEP8=X,15,I,ui:button;value:    其他    ;enable:1;tabbable:0
#BTNExpand=X,15,I,ui:button;value:   展開     ;enable:1;tabbable:0

!---------- AP TEXT AREA Variables ----------

#SetSysPar=X,1,S
E(0,1)ASGN(AGAIN$)

#FdGrcd=X,2,L
T(2,*)
#FdEsGcd=X,2,L
T(2,*)

#init=X,1,S
HIDE(#Wait)
T(F,@ProdNo,0)
T(F,@BaseRateCode,0)

! Help
<include src="HELPRIM.icf::HELPRIM.rtn"/>
!CustTypeCode
#CDDEF01=x,20,S
T(3,CdCode.CustTypeCode)

#CustTypeCodeHelp=x,1024,S

!RuleCode
#CDDEF02=x,20,S
T(3,CdCode.RuleCode)

#RuleCodeHelp=x,1024,S

!FacmAdvanceCloseCode
!#CDDEF03=x,28,S
!T(3,CdCode.FacmAdvanceCloseCode)
!
!#FacmAdvanceCloseCodeHelp=x,1024,S


!FacmBreachCode
#CDDEF03=x,28,S
T(3,CdCode.FacmBreachCode)

#FacmBreachCodeHelp=x,1024,S

!BreachGetCode
#CDDEF04=x,28,S
T(3,CdCode.BreachGetCode)

#BreachGetCodeHelp=x,1024,S

!YesNo YesNo
#CDDEF05=x,20,S
T(3,CdCode.YesNo)

#YesNoHelp=x,1024,S

!AchAuthCode 
!#CDDEF07=x,20,S
!T(3,CdCode.AchAuthCode)
!
!#AchAuthCodeHelp=x,1024,S

!CurrPrecision幣別小數位
#CDDEF06=x,26,S
T(3,CdCode.CurrPrecision)

#CurrPrecisionHelp=x,1024,S

!Sex 性別
#CDDEF07=x,20,S
T(3,CdCode.Sex)

#SexHelp=x,1024,S

!RelationCode 與借款人關係
#CDDEF08=x,20,S
T(3,CdCode.RelationCode)

#RelationCodeHelp=x,1024,S

!PostCode 郵局存款別
#CDDEF09=x,20,S
T(3,CdCode.PostCode)

#PostCodeHelp=x,1024,S

!RepayCode 繳款方式
#CDDEF10=x,20,S
T(3,CdCode.RepayCode)

#RepayCodeHelp=x,1024,S

!RateAdjNoticeCode 利率調整通知
#CDDEF11=x,25,S
T(3,CdCode.RateAdjNoticeCode)

#RateAdjNoticeCodeHelp=x,1024,S

!DepartmentCode 案件隸屬單位
#CDDEF12=x,25,S
T(3,CdCode.DepartmentCode)

#DepartmentCodeHelp=x,1024,S

!UsageCode 資金用途別
#CDDEF13=x,25,S
T(3,CdCode.UsageCode)

#UsageCodeHelp=x,1024,S

!FacmRecycleCode 循環動用
#CDDEF14=x,25,S
T(3,CdCode.FacmRecycleCode)

#FacmRecycleCodeHelp=x,1024,S

!ExtraRepayCode 攤還額異動碼
#CDDEF15=x,25,S
T(3,CdCode.ExtraRepayCode)

#ExtraRepayCodeHelp=x,1024,S

!FreqBase 週期基準
#CDDEF16=x,25,S
T(3,CdCode.FreqBase)

#FreqBaseHelp=x,1024,S

!FacmAmortizedCode 攤還方式
#CDDEF17=x,25,S
T(3,CdCode.FacmAmortizedCode)

#FacmAmortizedCodeHelp=x,1024,S

!FacmAcctCode 核准科目
#CDDEF18=x,25,S
T(3,CdCode.FacmAcctCode)

#FacmAcctCodeHelp=x,1024,S

!FacmRateCode 利率區分
#CDDEF19=x,25,S
T(3,CdCode.FacmRateCode)
 
#FacmRateCodeHelp=x,1024,S

!BaseRate0 指標利率代碼
#CDDEF20=x,25,S
T(3,CdCode.BaseRate0)

#BaseRate0Help=x,1024,S

!ProdIntCalcCode 計息方式
#CDDEF21=x,25,S
T(3,CdCode.ProdIntCalcCode)

#ProdIntCalcCodeHelp=x,1024,S

!RateType 利率種類
#CDDEF22=x,25,S
T(3,CdCode.RateType)

#RateTypeHelp=x,1024,S 

!BankCd 銀行代碼
#CDDEF23=x,25,S
T(3,CdCode.BankCd)

#BankCdHelp=x,1024,S 

!ApprovedLevel 核決層級
#CDDEF24=x,25,S
T(3,CdCode.ApprovedLevel)

#ApprovedLevelHelp=x,1024,S 

![週期基準0]
#CDDEF25=x,30,S
T(3,CdCode.FreqBase2)

#FreqBase2Help=x,1024,S

![綠色支出類別]
#CDDEF26=x,30,S
T(3,CdCode.GrKind)

#GrKindHelp=x,1024,S

![永續績效連結授信類別]
#CDDEF27=x,30,S
T(3,CdCode.EsGKind)

#EsGKindHelp=x,1024,S

#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#CDDEF01,#CDDEF02,#CDDEF03,#CDDEF04,#CDDEF05,#CDDEF06,#CDDEF07,#CDDEF08,#CDDEF09,#CDDEF10)
R(1,XXR99)
CALL(#HelpProc)
T(2,@CustTypeCodeHelp,#HelpDesc1)
T(2,@RuleCodeHelp,#HelpDesc2)
T(2,@FacmBreachCodeHelp,#HelpDesc3)
T(2,@BreachGetCodeHelp,#HelpDesc4)
T(2,@YesNoHelp,#HelpDesc5)
T(2,@CurrPrecisionHelp,#HelpDesc6)
T(2,@SexHelp,#HelpDesc7)
T(2,@RelationCodeHelp,#HelpDesc8)
T(2,@PostCodeHelp,#HelpDesc9)
T(2,@RepayCodeHelp,#HelpDesc10)

#HelpRim2=X,1,S
RESET_RIM(#HelpRim2,XXR99)
S(XXR99,01,#CDDEF11,#CDDEF12,#CDDEF13,#CDDEF14,#CDDEF15,#CDDEF16,#CDDEF17,#CDDEF18,#CDDEF19,#CDDEF20)
R(1,XXR99)
CALL(#HelpProc)
T(2,@RateAdjNoticeCodeHelp,#HelpDesc1)
T(2,@DepartmentCodeHelp,#HelpDesc2)
T(2,@UsageCodeHelp,#HelpDesc3)
T(2,@FacmRecycleCodeHelp,#HelpDesc4)
T(2,@ExtraRepayCodeHelp,#HelpDesc5)
T(2,@FreqBaseHelp,#HelpDesc6)
T(2,@FacmAmortizedCodeHelp,#HelpDesc7)
T(2,@FacmAcctCodeHelp,#HelpDesc8)
T(2,@FacmRateCodeHelp,#HelpDesc9)
T(2,@BaseRate0Help,#HelpDesc10)

#HelpRim3=X,1,S
RESET_RIM(#HelpRim3,XXR99)
S(XXR99,01,#CDDEF21,#CDDEF22,#CDDEF23,#CDDEF24,#CDDEF25,#CDDEF26,#CDDEF27)
R(1,XXR99)
CALL(#HelpProc)
T(2,@ProdIntCalcCodeHelp,#HelpDesc1)
T(2,@RateTypeHelp,#HelpDesc2)
T(2,@BankCdHelp,#HelpDesc3)
T(2,@ApprovedLevelHelp,#HelpDesc4)
T(2,@FreqBase2Help,#HelpDesc5)
T(2,@GrKindHelp,#HelpDesc6)
T(2,@EsGKindHelp,#HelpDesc7)

#BankCdHelp2=x,1024,S
T(2,700:郵局;+#BankCdHelp)


#CHAIN=A,1,S
T(4,CHAIN$)
C(3,#FKEY,0,IF(#CHAIN!=1,V(P,此為連動交易，請從交易:[L2010申請案件明細資料查詢]進入),$),$)
C(3,#CHAIN,1,HIDE(#BTN1,#BTN2)T(F,@CustId,0)T(F,@ApplNo,0),T(F,@CustId,1)T(F,@ApplNo,1))

#NTXBUF=X,18,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)

#WkStar=X,2,S
T(3,*)
#BusinessOfficerItem=X,20,L
C(4,#BusinessOfficerItem,T(3,房貸專員),$)

![登放記號]
#FdActFg=X,2,L

#ACTFG=_,_,S

#ACTFGX=X,8,L
T(H,#ACTFG,#ActFgHelp)
!K(MODIFYBUTTON,核准)

#WkFdP1=X,1,S
C(3,#FKEY,0,$,s)
T(3,@FdCustId,*)
T(3,@FdApplNo,*)

#BUF1A=X,100,S

#BIND1A=X,1,S
BIND(#BTN1,click, {cmd=CHAIN; ntxcd=L1001; ntxbuf=#BUF1A;ntxbuf5=type<-1:CustId<-OOCustId})

![統一編號]
!必須輸入
#FdCustId=X,2,L
C(3,#CHAIN,1,T(3, ),$)

#CustId=X,10,I
CALL(#CloseAll)
C(3,#FKEY,0,$,s)
C(3,#CHAIN,1,T(1,#NTXBUF,2,10),$)
C(3,#CHAIN,1,s,$)
@V(7)
SHOW(#BTN2)ENABLE(#BTN2)

#BUF1B=X,100,S
T(2,0000000+#CustId)

#BIND1B=X,1,S
BIND(#BTN1,click, {cmd=CHAIN; ntxcd=L1001; ntxbuf=#BUF1B;ntxbuf5=type<-1:CustId<-OOCustId})

#CheckCustId=X,1,S
A(ID_UNINO,0,#CustId)

#SendL2r07=X,1,S
C(3,#FKEY,0,$,s)
T(2,@RimCustId,#CustId)
E(0,@RimCustNo,0)
RESET_RIM(#SendL2r07,L2R07)
S(L2R07,1,#RimTxCode,#RimCustId,#RimCustNo)
R(1,L2R07)

#TimCustNo=A,7,S
C(4,#CustId,$,E(0,#L2r07CustNo))
T(2,@RmkCustNo,#TimCustNo)
<include src="COM.icf::CustRmk.rtn"/>

#SendL6r28=X,1,S
E(0,@RimFuncCode,5)
T(2,@RimBusinessType,LN)
RESET_RIM(#SendL6r28,L6R28)
S(L6R28,1,#RimFuncCode,#RimTxCode,#RimBusinessType)
R(1,L6R28)

#CustIdX=X,100,L
C(3,#FKEY,0,$,s)
T(2,#L2r07CustName)
E(0,@CustNo,#L2r07CustNo)

#WkStatus=A,1,S
E(0,0)

#WkApplNo=A,7,S
E(0,0)

#BUF2=X,18,S
T(2,#WkApplNo+#CustId+#WkStatus)

#BIND2=X,1,S
BIND(#BTN2,click, {cmd=CHAIN; ntxcd=L2010; ntxbuf=#BUF2;ntxbuf5=type<-1:ApplNo<-OOApplNo})

![申請號碼]
!必須輸入
#FdApplNo=X,2,L
C(3,#CHAIN,1,T(3, ),$)

#ApplNo=A,7,I
CALL(#CloseAll)
C(3,#FKEY,0,$,s)
C(3,#CHAIN,1,CALL(#HideP2),$)
C(3,#CHAIN,1,T(1,#NTXBUF,12,7),$)
C(3,#CHAIN,1,s,$)
@V(2,0)

#SendL2r02=X,1,S
IF(#FKEY==0 || #FKEY==7,$,s)
E(0,@RimFuncCode,6)
T(2,@RimCustId,#CustId)
E(0,@RimApplNo,#ApplNo)
RESET_RIM(#SendL2r02,L2R02)
S(L2R02,1,#RimFuncCode,#RimTxCode,#RimFKey,#RimApplNo,#RimCustId)
R(1,L2R02)

#RcvL2r02=X,1,S
IF(#FKEY==0,$,s)
T(2,@CreditSysNo,#L2r02CreditSysNo)
T(2,@ProdNo,#L2r02ProdNo)
T(2,@CreditOfficer,#L2r02CreditOfficer)
E(0,@AcctCode,#L2r02AcctCode)
T(H,@AcctCodeX,#AcctCode,#FacmAcctCodeHelp)
T(2,@CurrencyCode,#L2r02CurrencyCode)
T(H,@Precision,#CurrencyCode,#CurrPrecisionHelp)
E(0,@DepartmentCode,#L2r02DepartmentCode)
T(H,@DepartmentCodeX,#DepartmentCode,#DepartmentCodeHelp)
E(0,@TwApplAmt,#L2r02ApplAmt)
E(0,@UsApplAmt,#L2r02ApplAmt)
T(2,@Estimate,#L2r02Estimate)
T(2,@BusinessOfficer,#L2r02LoanOfficer)
T(2,@Introducer,#L2r02Introducer)
T(2,@FireOfficer,#L2r02Introducer)
T(2,@Supervisor,#L2r02Supervisor)
T(2,@Coorgnizer,#L2r02Coorgnizer)
T(2,@GroupId,#L2r02GroupId)
C(4,#L2r07CustTypeCode,$,T(2,@CustTypeCode,#L2r07CustTypeCode))
C(4,#L2r02GroupId,$,T(2,@CustTypeCode,06))
E(0,@ExtraRepayCode,1)

#RcvL2r08A=X,1,S
C(4,#Introducer,S,$)
T(2,@RimEmployeeNo,#Introducer)
T(3,@RimErrorSkip,Y)
RESET_RIM(#RcvL2r08A,L2R08)
S(L2R08,1,#RimTxCode,#RimEmployeeNo,#RimErrorSkip)
R(1,L2R08)
T(2,@IntroducerX,#L2r08FullName)
T(2,@District,#L2r08CenterCode1)
T(2,@DistrictX,#L2r08CenterCode1Name)

#RcvL2r08B=X,1,S  
C(4,#FireOfficer,S,$)
T(2,@RimEmployeeNo,#FireOfficer)
T(3,@RimErrorSkip,Y)
RESET_RIM(#RcvL2r08B,L2R08)
S(L2R08,1,#RimTxCode,#RimEmployeeNo,#RimErrorSkip)
R(1,L2R08)
T(2,@FireOfficerX,#L2r08FullName)

#RcvL2r08C=X,1,S	
C(4,#Estimate,S,$)
T(2,@RimEmployeeNo,#Estimate)
T(3,@RimErrorSkip,Y)
RESET_RIM(#RcvL2r08C,L2R08)
S(L2R08,1,#RimTxCode,#RimEmployeeNo,#RimErrorSkip)
R(1,L2R08)
T(2,@EstimateX,#L2r08FullName)

#RcvL2r08D=X,1,S	
C(4,#CreditOfficer,S,$)
T(2,@RimEmployeeNo,#CreditOfficer)
T(3,@RimErrorSkip,Y)
RESET_RIM(#RcvL2r08D,L2R08)
S(L2R08,1,#RimTxCode,#RimEmployeeNo,#RimErrorSkip)
R(1,L2R08)
T(2,@CreditOfficerX,#L2r08FullName)

#RcvL2r08F=X,1,S
C(4,#BusinessOfficer,S,$)
T(2,@RimEmployeeNo,#BusinessOfficer)
T(3,@RimErrorSkip,Y)
RESET_RIM(#RcvL2r08F,L2R08)
S(L2R08,1,#RimTxCode,#RimEmployeeNo,#RimErrorSkip)
R(1,L2R08)
T(2,@BusinessOfficerX,#L2r08FullName)

#RcvL2r08G=X,1,S
C(4,#Supervisor,S,$)
T(2,@RimEmployeeNo,#Supervisor)
T(3,@RimErrorSkip,Y)
RESET_RIM(#RcvL2r08G,L2R08)
S(L2R08,1,#RimTxCode,#RimEmployeeNo,#RimErrorSkip)
R(1,L2R08)
T(2,@SupervisorX,#L2r08FullName)

#RcvL2r13H=X,1,S
C(4,#Coorgnizer,S,$)
T(2,@RimEmployeeNo,#Coorgnizer)
E(0,@RimFunCd,5)
RESET_RIM(#RcvL2r13H,L2R13)
S(L2R13,1,#RimFunCd,#RimEmployeeNo)
R(1,L2R13)
T(2,@CoorgnizerX,#L2r13FullName)

![借戶戶號]
!自動顯示不必輸入
#FdCustNo=X,2,L

#CustNo=A,7,L
T(2,@LockCustNo,#CustNo)
! <include src="COM.icf::LockControl.rtn"/>

![額度編號]
!不必輸入,系統自動編號
#FacmNo=A,3,L
C(3,#FKEY,0,E(0,0),$)

![徵審系統案號]
#FdCreditSysNo=X,2,L

#CreditSysNo=A,7,I
CALL(#CloseAll)

#RimCreditSysNo=A,7,S
!如相同戶號+案件編號為同一筆時自動顯示第一筆
#L2r50=X,1,S
C(3,#FKEY,7,S,$)
C(3,#CreditSysNo,0,S,$)
E(0,@RimCustNo,#CustNo)
E(0,@RimCreditSysNo,#CreditSysNo)
E(0,@RimApplNo,#ApplNo)
S(L2R50,1,#RimCustNo,#RimCreditSysNo,#RimApplNo)
R(1,L2R50)

#RcvL2r50=X,1,S
C(3,#FKEY,7,S,$)
C(5,#L2r50Exist,Y,$,S)
E(0,@RateIncr,#L2r50RateIncr)
E(0,@RateCode,#L2r50RateCode)
E(0,@FirstRateAdjFreq,#L2r50FirstRateAdjFreq)
E(0,@RateAdjFreq,#L2r50RateAdjFreq)
E(0,@TwApplAmt,#L2r50LineAmt)
E(0,@UsApplAmt,#L2r50LineAmt)
E(0,@AcctCode,#L2r50AcctCode)
E(0,@LoanTermYy,#L2r50LoanTermYy)
E(0,@LoanTermMm,#L2r50LoanTermMm)
E(0,@LoanTermDd,#L2r50LoanTermDd)
E(0,@AmortizedCode,#L2r50AmortizedCode)
E(0,@FreqBase,#L2r50FreqBase)
E(0,@PayIntFreq,#L2r50PayIntFreq)
E(0,@RepayFreq,#L2r50RepayFreq)
E(0,@UtilDeadline,#L2r50UtilDeadline)
E(0,@GracePeriod,#L2r50GracePeriod)
E(0,@ExtraRepayCode,#L2r50ExtraRepayCode)
E(0,@IntCalcCode,#L2r50IntCalcCode)
E(0,@RuleCode,#L2r50RuleCode)
E(0,@RecycleCode,#L2r50RecycleCode)
E(0,@RecycleDeadline,#L2r50RecycleDeadline)
E(0,@UsageCode,#L2r50UsageCode)
E(0,@CompensateFlag,#L2r50CompensateFlag)
E(0,@IrrevocableFlag,#L2r50IrrevocableFlag)
E(0,@RateAdjNoticeCode,#L2r50RateAdjNoticeCode)
T(2,@Introducer,#L2r50Introducer)
T(2,@FireOfficer,#L2r50FireOfficer)
T(2,@Estimate,#L2r50Estimate)
T(2,@CreditOfficer,#L2r50CreditOfficer)
T(2,@BusinessOfficer,#L2r50BusinessOfficer)
T(2,@Supervisor,#L2r50Supervisor)
T(2,@Coorgnizer,#L2r50Coorgnizer)
E(0,@CreditScore,#L2r50CreditScore)
E(0,@GuaranteeDate,#L2r50GuaranteeDate)



!---- P2 利率

#INVK2=X,1,S
ENABLE(#BTNHIDEP2)
C(3,#Hide2Flag,0,CALL(#HideP2),$)
!利率
#BINDP2=X,1,S
BIND(#BTNHIDEP2,click, {cmd=CALLSEND;DOCODE=HideP2})
!階梯式利率
#BINDP9=X,1,S
BIND(#BTNHIDEP9,click, {cmd=CALLSEND;DOCODE=HIDEP9})
!金額日期
#BINDP3=X,1,S
BIND(#BTNHIDEP3,click, {cmd=CALLSEND;DOCODE=HideP3})
!代碼類
#BINDP4=X,1,S
BIND(#BTNHIDEP4,click, {cmd=CALLSEND;DOCODE=HideP4})
!扣款帳號
#BINDP5=X,1,S
BIND(#BTNHIDEP5,click, {cmd=CALLSEND;DOCODE=HideP5})
!專員
#BINDP6=X,1,S
BIND(#BTNHIDEP6,click, {cmd=CALLSEND;DOCODE=HideP6})
!清償違約金
#BINDP7=X,1,S
BIND(#BTNHIDEP7,click, {cmd=CALLSEND;DOCODE=HideP7})
!其他
#BINDP8=X,1,S
BIND(#BTNHIDEP8,click, {cmd=CALLSEND;DOCODE=HideP8})
!展開
#BINDExpand=X,1,S
BIND(#BTNExpand,click, {cmd=CALLSEND;DOCODE=Expand})


#WkFdP2=X,1,S
T(3,@FdProdNo, )
T(3,@FdBaseRateCode, )
T(3,@FdBaseRate, )
T(3,@FdProdRate, )
T(2,@FdRateIncr,#WkStar)
T(3,@FdApproveRate, )
T(2,@FdRateCode,#WkStar)
T(2,@FirstRateAdjFreqX,#WkMonthX)
T(2,@RateAdjFreqX,#WkMonthX)
T(2,@FdCreditOfficer,#WkStar)
T(2,@FdApprovedLevel,#WkStar)
T(2,@FdIntCalcCode,#WkStar)

#SendL2r01=X,1,S
E(0,@RimFuncCode,5)
T(2,@RimProdNo,#L2r02ProdNo)
! RESET_RIM(#SendL2r01,L2R01)
S(L2R01,1,#RimFuncCode,#RimTxCode,#RimProdNo)
R(1,L2R01)
! #RcvL2r01A=X,1,S
C(3,#FKEY,7,S,$)
T(2,@ProdNo,#L2r01ProdNo)
T(2,@ProdNoX,#L2r01ProdName)
C(3,#L2r01AmortizedCode,9,SHOW(#AmortizedCode,#FreqBase)
                         ,HIDE(#AmortizedCode,#FreqBase)
                          E(0,@AmortizedCode,#L2r01AmortizedCode)
                          T(H,@AmortizedCodeX,#AmortizedCode,#FacmAmortizedCodeHelp))
C(3,#L2r01FreqBase,9,$,E(0,@FreqBase,#L2r01FreqBase)
                           T(H,@FreqBaseX,#FreqBase,#FreqBaseHelp))
T(H,@PayIntFreqX,#FreqBase,#FreqBase2Help)
T(H,@RepayFreqX,#FreqBase,#FreqBase2Help)
C(3,#L2r01PayIntFreq,99,SHOW(#PayIntFreq,#PayIntFreqX)
                        HIDE(#LbPayIntFreq)
                       ,HIDE(#PayIntFreq,#PayIntFreqX)
                        SHOW(#LbPayIntFreq)
                        E(0,@PayIntFreq,#L2r01PayIntFreq)
                        X(@LbPayIntFreq,#PayIntFreq)
                        T(B,@LbPayIntFreq,#LbPayIntFreq+#PayIntFreqX))
C(3,#L2r01RepayFreq,99,SHOW(#RepayFreq,#RepayFreqX)HIDE(#LbRepayFreq)
                      ,HIDE(#RepayFreq,#RepayFreqX)SHOW(#LbRepayFreq)
                       E(0,@RepayFreq,#L2r01RepayFreq)
                       X(@LbRepayFreq,#RepayFreq)
                       T(B,@LbRepayFreq,#LbRepayFreq+#RepayFreqX))
T(2,@BaseRateCode,#L2r01BaseRateCode)
HIDE(#LbFirstRateAdjFreq)
HIDE(#LbRateAdjFreq)
C(3,#L2r01ExtraRepayCode,9,SHOW(#ExtraRepayCode)
                          ,HIDE(#ExtraRepayCode)
                           E(0,@ExtraRepayCode,#L2r01ExtraRepayCode))
C(3,#L2r01RecycleCode,9,SHOW(#RecycleCode)
                       ,HIDE(#RecycleCode)
                        E(0,@RecycleCode,#L2r01RecycleCode)
                        C(2,#RecycleCode,T(3,@RecycleCodeX,非循環動用),T(3,@RecycleCodeX,循環動用),S))
C(3,#L2r01GracePeriod,999,SHOW(#GracePeriod,#GracePeriodX)
                          HIDE(#LbGracePeriod)
                         ,E(0,@GracePeriod,#L2r01GracePeriod)
                          HIDE(#GracePeriod,#GracePeriodX)
                          SHOW(#LbGracePeriod)
                          X(@LbGracePeriod,#GracePeriod)
                          T(B,@LbGracePeriod,#LbGracePeriod+#WkMonthX))
E(0,@RateCode,#L2r01RateCode)
T(H,@RateCodeX,#RateCode,#FacmRateCodeHelp)
T(2,@BreachFlag,#L2r01BreachFlag)
C(3,#L2r01BreachCode,999,$,E(0,@BreachCode,#L2r01BreachCode))
C(3,#L2r01BreachCode,999,$,E(0,@BreachGetCode,#L2r01BreachGetCode))
T(2,@Breach,#L2r01Breach)
! T(2,@Breach1,#L2r01Breach)
##loop{times:10,n:1}
E(0,@StepMonthS{n},#L2r01StepRateMonths{n})
E(0,@StepMonthE{n},#L2r01StepRateMonthE{n})
E(0,@StepRateType{n},#L2r01StepRateType{n})
E(0,@StepRateIncr{n},#L2r01StepRateIncr{n})
T(3,@StepRatePer{n},%)
T(3,@StepX{n},-)
##end

![商品代碼]
!自動顯示不必輸入
#FdProdNo=X,2,L

#ProdNo=X,5,L

#ProdNoX=X,60,L

![指標利率代碼]
!依商品資料自動顯示不必輸入
#FdBaseRateCode=X,2,L

#BaseRateCode=A,2,L
C(3,#BaseRateCode,99,SHOW(#ApproveRate)HIDE(#RateIncr)T(F,@RateIncr,0)T(3,@RateIncrX, )
                    ,HIDE(#ApproveRate)SHOW(#RateIncr)T(F,@RateIncr,1)T(3,@RateIncrX,%))

#BaseRateCodeX=X,30,L
T(H,#BaseRateCode,#BaseRate0Help)

#EffectDate=D,7,S
E(0,#SYSCDATE)

#SendL2r06=X,1,S
T(2,@RimCurrencyCode,#L2r02CurrencyCode)
T(2,@RimBaseRateCode,#BaseRateCode)
E(0,@RimEffectDate,#EffectDate)
E(0,@RimEffectTime,0)
RESET_RIM(#SendL2r06,L2R06)
S(L2R06,1,#RimTxCode,#RimCurrencyCode,#RimBaseRateCode,#RimEffectDate,#RimEffectTime)
R(1,L2R06)

![指標利率]
#FdBaseRate=X,2,L

#BaseRate=n,2.4,S
E(0,#L2r06Rate)

#BaseRateX=X,12,L
X(#BaseRate)
T(B,#BaseRateX+#WkPercent)

![商品利率]
!依商品資料自動顯示不必輸入
#FdProdRate=X,2,L

#ProdRate=n,2.4,S
E(0,#BaseRate+#L2r01ProdIncr)
C(3,#BaseRateCode,99,S,$)
E(0,@ApproveRate,#BaseRate+#L2r01ProdIncr)

#ProdRateX=X,12,L
X(#ProdRate)
T(B,#ProdRateX+#WkPercent)
X(@ApproveRateX,#ApproveRate)
C(3,#BaseRateCode,99,T(3,@ApproveRateX,%),T(B,@ApproveRateX,#ApproveRateX+#WkPercent))

![利率加減碼]
!必須輸入
#FdRateIncr=X,2,L
C(3,#BaseRateCode,99,S,$)

#RateIncr=+n,2.4,I
C(3,#Hide2Flag,0,CALL(#HideP2),$)
C(3,#BaseRateCode,99,S,$)
C(3,#RateIncr,0,E(0,#L2r01ProdIncr),$)

#bri=+n,2.4,S
C(3,#BaseRateCode,99,S,$)
E(0,#BaseRate+#RateIncr)
@V(5,#L2r01LowLimitRate,99)

#RateIncrX=X,12,L
C(3,#BaseRateCode,99,$,s)
X(@RateIncrX,#RateIncr)
T(B,@RateIncrX,#RateIncrX+#WkPercent)


![核准利率]
!自動顯示不必輸入
!核准利率 = 指標利率 + 利率加減碼
#FdApproveRate=X,2,L

#ApproveRate=n,2.4,I
C(3,#Hide2Flag,0,CALL(#HideP2),$)
C(3,#BaseRateCode,99,$,E(0,#BaseRate+#RateIncr))
C(3,#BaseRateCode,99,$,s)
@V(2,0)

#ApproveRateX=X,12,L
C(3,#BaseRateCode,99,s,$)
X(@ApproveRateX,#ApproveRate)
T(B,@ApproveRateX,#ApproveRateX+#WkPercent)


#bri99=+n,2.4,S
C(3,#BaseRateCode,99,$,S)
E(0,#ApproveRate)
@V(5,#L2r01LowLimitRate,99)

![利率區分]
!商品不限制時,才須輸入,否則自動顯示不必輸入
#FdRateCode=X,2,L

#RateCode=A,1,I
C(3,#Hide2Flag,0,CALL(#HideP2),$)
HELP(#FacmRateCodeHelp)
@V(H,#FacmRateCodeHelp)

#RateCodeX=X,10,L
T(H,#RateCode,#FacmRateCodeHelp)
C(3,#RateCode,3,T(3,@FdFirstRateAdjFreq,*)T(3,@FdRateAdjFreq,*),T(3,@FdFirstRateAdjFreq,)T(3,@FdRateAdjFreq,))

![首次利率調整週期]
!商品不限制時,才須輸入,否則自動顯示不必輸入
!利率區分為定期機動時,方需輸入此欄
#FdFirstRateAdjFreq=X,2,L

#FirstRateAdjFreq=N,2,I
C(3,#RateCode,3,$,S)
C(3,#Hide2Flag,0,CALL(#HideP2),$)
@V(2,0)

#LbFirstRateAdjFreq=X,7,L
X(#FirstRateAdjFreq)
T(B,#LbFirstRateAdjFreq+#WkMonthX)

#FirstRateAdjFreqX=X,5,L

![利率調整週期]
!商品不限制時,才須輸入,否則自動顯示不必輸入
!利率區分為定期機動時,方需輸入此欄
#FdRateAdjFreq=X,2,L

#RateAdjFreq=N,2,I
C(3,#RateCode,3,$,S)
C(3,#Hide2Flag,0,CALL(#HideP2),$)
@V(2,0)

#LbRateAdjFreq=X,7,L
X(#RateAdjFreq)
T(B,#LbRateAdjFreq+#WkMonthX)

#RateAdjFreqX=X,5,L

!---- P3 金額日期
#INVK3=X,1,S
ENABLE(#BTNHIDEP3)
C(3,#Hide3Flag,0,CALL(#HideP3),$)


#WkFdP3=X,1,S
T(3,@FdCurrencyCode, )
T(2,@FdApplAmt,#WkStar)
T(2,@FdAcctCode,#WkStar)
T(2,@FdApproveDate,#WkStar)
T(2,@FdLoanTerm,#WkStar)
T(2,@FdAmortizedCode,#WkStar)
T(2,@FdFreqBase,#WkStar)
T(2,@FdPayIntFreq,#WkStar)
T(2,@FdRepayFreq,#WkStar)
T(2,@FdUtilDeadline,#WkStar)
T(2,@FdAcctFee, )
T(2,@FdHandlingFee, )
T(F,@PayIntFreqX,0)
T(F,@RepayFreqX,0)
T(2,@GracePeriodX,#WkMonthX)
T(F,@GracePeriodX,0)
C(3,#L2r01AmortizedCode,9,$,T(3,@FdAmortizedCode, ))
C(3,#L2r01FreqBase,9,$,T(3,@FdFreqBase, ))
C(3,#L2r01PayIntFreq,99,$,T(3,@FdPayIntFreq, ))
C(3,#L2r01RepayFreq,99,$,T(3,@FdRepayFreq, ))
C(3,#L2r01GracePeriod,999,$,T(3,@FdGracePeriod, ))

![核准幣別]
!自動顯示不必輸入
#FdCurrencyCode=X,2,L

#CurrencyCode=X,3,L

!#CurrencyCodeX=X,10,L

#Precision=N,1,S
T(H,#CurrencyCode,#CurrPrecisionHelp)
C(3,#Precision,0,SHOW(#TwApplAmt,#TwAcctFee,#TwHandlingFee)
                 HIDE(#UsApplAmt,#UsAcctFee,#UsHandlingFee)
                ,HIDE(#TwApplAmt,#TwAcctFee,#TwHandlingFee)
                 SHOW(#UsApplAmt,#UsAcctFee,#UsHandlingFee))

![核准額度]
#FdApplAmt=X,2,L

#TwApplAmt=m,14,I
C(3,#Precision,0,$,S)
@V(2,0)
I(0,#CurrencyCode,CURR,CURDEF,ENAME,PRECISION)

#UsApplAmt=m,14.2,I
C(3,#Precision,0,S,$)
@V(2,0)
I(0,#CurrencyCode,CURR,CURDEF,ENAME,PRECISION)

#TimApplAmt=m,14.2,S
C(3,#Precision,0,E(0,#TwApplAmt),E(0,#UsApplAmt))

#SendL2r04=X,1,S
T(2,@RimProdNo,#ProdNo)
E(0,@RimLoanAmt,#TimApplAmt)
S(L2R04,1,#RimTxCode,#RimProdNo,#RimLoanAmt)
R(1,L2R04)

#TMP3=X,1,S
E(0,@TwAcctFee,#L2r04AcctFee)
E(0,@UsAcctFee,#L2r04AcctFee)
C(3,#DepartmentCode,1,$,s)
E(0,@TwHandlingFee,#L2r04HandlingFee)
E(0,@UsHandlingFee,#L2r04HandlingFee)

![核准科目]
!自動顯示不必輸入
#FdAcctCode=X,2,L

#AcctCode=A,3,I
HELP(#FacmAcctCodeHelp)
@V(H,#FacmAcctCodeHelp)

#AcctCodeX=X,20,L
T(H,#AcctCode,#FacmAcctCodeHelp)

![准駁日期]
!自動顯示必須輸入
#FdApproveDate=X,2,L

#ApproveDate=D,7,I
C(3,#ApproveDate,0,E(0,#SYSCDATE),$)
@A(DATE,0,#ApproveDate)V(7)

![貸款期間]
!必須輸入
#FdLoanTerm=X,2,L

#LoanTermYy=A,2,I
@C(3,#AcctCode,310,V(5,#L6R28AcctCode310A,#L6R28AcctCode310B),$)
C(3,#AcctCode,320,V(5,#L6R28AcctCode320A,#L6R28AcctCode320B),$)
C(3,#AcctCode,330,V(5,#L6R28AcctCode330A,#L6R28AcctCode330B),$)
C(3,#AcctCode,340,V(5,#L6R28AcctCode330A,#L6R28AcctCode330B),$)

#LoanTermMm=A,2,I
IF(#AcctCode==310 && #LoanTermYy==#L6R28AcctCode310B,S,$)
IF(#AcctCode==320 && #LoanTermYy==#L6R28AcctCode320B,S,$)
@V(5,0,11)

#LoanTermDd=A,3,I
IF(#AcctCode==310 && #LoanTermYy==#L6R28AcctCode310B,S,$)
IF(#AcctCode==320 && #LoanTermYy==#L6R28AcctCode320B,S,$)
IF(#AcctCode==330 && #LoanTermYy==#L6R28AcctCode330B,S,$)
IF(#AcctCode==340,S,$)
C(3,#LoanTermYy,0,$,s)
C(3,#LoanTermMm,0,$,s)
@
IF(#AcctCode==320 && #LoanTermYy==#L6R28AcctCode320A,C(3,#LoanTermMm,0,V(2,0),$),$)
IF(#AcctCode==330 && #LoanTermYy==#L6R28AcctCode320B,C(3,#LoanTermMm,0,V(2,0),$),$)
V(2,0)
V(5,0,366)


!計算寬限總月數上限 
!先算出相差幾月
#checkLoanYyMm=N,3,S
E(0,0)
E(0,#LoanTermYy*12)
E(0,#checkLoanYyMm+#LoanTermMm)
#DateS=D,8,S
E(0,00010101)
#checkLoanDate=D,8,S
E(0,00010101)
D(7,2,#checkLoanDate,#checkLoanYyMm,#LoanTermDd)
D(7,1,#DateS,#checkLoanDate)

#GracePeriodYy=N,4,S
T(1,#checkLoanDate,1,4)
#GracePeriodMm=N,2,S
T(1,#checkLoanDate,5,2)
#GracePeriodDd=N,2,S
T(1,#checkLoanDate,7,2)
#GracePeriodTM=N,3,S
E(0,#GracePeriodYy*12)
E(0,#GracePeriodTM+#GracePeriodMm)
C(3,#GracePeriodDd,0,$,E(0,#GracePeriodTM+1))

! #checkloandate=D,7,S
! E(0,#LoanTermYy*10000)
! E(0,#checkloandate+#LoanTermMm*100)
! E(0,061111)
! ALERT("#checkloandate",#checkloandate)
! D(7,1,#checkloandate,0,#LoanTermDd)
! ALERT("#checkloandate",#checkloandate)

! #acctcode320=X,1,S
! C(3,#AcctCode,320,$,S)
! ALERT("#checkloandate320",#checkloandate)
! IF(#checkloandate>70000,V(P,中期擔保放款不可超過7年),$)


! #acctcode330=X,1,S
! C(3,#AcctCode,330,$,S)
! ALERT("#checkloandate330",#checkloandate)
! IF(#checkloandate>300000,V(P,長期擔保放款不可超過30年),$)


![攤還方式]
!當商品不限制時,才須輸入,否則自動顯示不必輸入
!1.按月繳息 2.到期取息  3.本息平均法  4.本金平均法
#FdAmortizedCode=X,2,L

#AmortizedCode=A,1,I
HELP(#FacmAmortizedCodeHelp)
@V(H,#FacmAmortizedCodeHelp)
! C(3,#AcctCode,330,V(2,1),$)
! C(3,#AcctCode,340,V(2,1),$)
C(3,#AmortizedCode,2,E(0,@IntCalcCode,1),$)
!利率為0,攤還方式不可為本息平均法
!C(3,#ApproveRate,0,V(2,3),$)

#AmortizedCodeX=X,12,L
T(H,#AmortizedCode,#FacmAmortizedCodeHelp)

![週期基準]
!1:日 2:月 3:週
!當商品不限制時,才須輸入,否則自動顯示不必輸入
!短期可輸入1或2或3,中長期只可輸入2或3
#FdFreqBase=X,2,L

#FreqBase=A,1,I
C(3,#AmortizedCode,2,E(0,2),$)
C(3,#AmortizedCode,2,s,$)
C(3,#FreqBase,0,E(0,2),$)
HELP(#FreqBaseHelp)
@V(H,#FreqBaseHelp)
C(3,#AcctCode,310,V(1,1,2,3,),V(1,2,3))
C(3,#AmortizedCode,1,V(1,1,2,3),$)
C(3,#AmortizedCode,3,V(1,2,3),$)
C(3,#AmortizedCode,4,V(1,2,3),$)

#FreqBaseX=X,8,L
T(H,#FreqBase,#FreqBaseHelp)
T(H,@PayIntFreqX,#FreqBase,#FreqBase2Help)

![繳息週期]
#FdPayIntFreq=X,2,L

#PayIntFreq=N,2,I
C(3,#L2r01CharCode,2,E(0,1),$)
C(3,#L2r01CharCode,2,s,$)
!到期取息者是到期還本繳息，因此沒有繳息週期
C(3,#AmortizedCode,2,S,$)     
!週期基準為週者，繳息週期固定為雙週
C(3,#FreqBase,3,E(0,2),$)
C(3,#FreqBase,3,s,$)  
C(3,#PayIntFreq,0,E(0,1),$)
@V(2,0)

#LbPayIntFreq=X,9,L
X(#PayIntFreq)
T(B,#LbPayIntFreq+#PayIntFreqX)

#PayIntFreqX=X,7,L

!計算期數
#checkTerm=n,5,S
E(0,#LoanTermYy*12)
E(0,#checkTerm+#LoanTermMm)
C(3,#LoanTermDd,0,$,E(0,#checkTerm+1))
C(3,#PayIntFreq,0,$,E(0,#checkTerm/#PayIntFreq))
C(3,#AmortizedCode,1,$,E(0,999))

#checkTermX=X,5,S
E(0,#checkTerm)

#TermMsg=X,20,S
T(2,不可大於期數+#checkTermX)


![還本週期]
!當商品不限制時,才須輸入,否則自動顯示不必輸入
!到期繳息還本,繳息週期固定為00不必輸入,其他繳息週期不可為零
!以防養老固定為 01,不必輸入
!00: 按期繳息到期還本或到期繳息還本
#FdRepayFreq=X,2,L

#RepayFreq=N,2,I
C(5,#L2r01CharCode,2,S,$)
!按月繳息者是到期還本，因此沒有還本週期
C(3,#AmortizedCode,1,S,$)  
!週期基準為週者，繳息週期固定為雙週
C(3,#FreqBase,3,E(0,2),$)
C(3,#FreqBase,3,s,$)
!到期取息者是到期還本繳息，因此沒有還本週期                
C(3,#AmortizedCode,2,S,$)     
!攤還方式為本息平均法時，還本週期須等於繳息週期               
IF(#AmortizedCode==3,E(0,#PayIntFreq),$)     
IF(#AmortizedCode==3,s,$)
!繳息週期不等於１時，還本週期須等於繳息週期
IF(#FreqBase==2 && #PayIntFreq > 1,E(0,#PayIntFreq),$)   
IF(#FreqBase==2 && #PayIntFreq > 1,s,$)
!繳息週期不等於１時，還本週期須等於繳息週期
IF(#FreqBase==3 && #PayIntFreq > 2,E(0,#PayIntFreq),$)   
IF(#FreqBase==3 && #PayIntFreq > 2,s,$)
SHOW(#RepayFreq)
C(3,#RepayFreq,0,E(0,1),$)
@V(2,0)V(5,#PayIntFreq,99)

#LbRepayFreq=X,9,L
X(#RepayFreq)
T(B,#LbRepayFreq+#RepayFreqX)

#RepayFreqX=X,7,L
C(3,#RepayFreq,0,T(3,無)HIDE(#RepayFreq)T(3,@FdRepayFreq, ),
                 T(2,#RepayFreqX)T(3,@FdRepayFreq,*)SHOW(#RepayFreq))
C(3,#RepayFreq,0,$,T(H,@RepayFreqX,#FreqBase,#FreqBase2Help))


![動支期限]
!必須輸入,動支期限須大於准駁日期
#FdUtilDeadline=X,2,L

#UtilDeadline=D,7,I
D(8)
@V(7)A(DATE,0,#UtilDeadline)
IF(#UtilDeadline<=#ApproveDate,V(P,動支期限需大於准駁日期),$)

#WkMm=N,4,S
E(0,#LoanTermYy*12+#LoanTermMm)


![寬限總月數]
!當商品不限制時,才須輸入,否則自動顯示不必輸入
!攤還方式為本息或本金平均時，才可輸入
!寬限總月數不可超過上限
#FdGracePeriod=X,2,L

#GracePeriod=N,3,I
C(3,#L2r01GracePeriod,999,$,s)
SHOW(#GracePeriod)
C(3,#L2r01CharCode,2,S,$)
IF(#AmortizedCode==3 || #AmortizedCode==4,$,S)
C(3,#GracePeriodTM,0,S,$)
@IF(#GracePeriod>=#GracePeriodTM,V(P,需小於貸款期間),$)

#LbGracePeriod=X,9,L
X(#GracePeriod)
T(B,#LbGracePeriod+#WkMonthX)
C(3,#GracePeriod,0,T(3,無),$)

#GracePeriodX=X,5,L
C(3,#GracePeriod,0,T(3,無)HIDE(#GracePeriod),T(2,#WkMonthX)SHOW(#GracePeriod))

![案件隸屬單位]
!可不輸入
#FdDepartmentCode=X,2,L

#DepartmentCode=A,1,I
HELP(#DepartmentCodeHelp)
@V(H,#DepartmentCodeHelp)

#DepartmentCodeX=X,10,L
T(H,#DepartmentCode,#DepartmentCodeHelp)
C(3,#DepartmentCode,0,T(F,@BreachFlag,0)T(F,@ProdBreachFlag,0),T(F,@BreachFlag,1)T(F,@ProdBreachFlag,1))

!依[案件隸屬單位]:企金時顯示[企金人員],餘為[房貸專員]
#checkDepartmentCode=X,1,S
C(3,#DepartmentCode,0,T(3,@BusinessOfficerItem,房貸專員),T(3,@BusinessOfficerItem,企金人員))

![帳管費]
!依商品資料自動顯示,可修改
!交易中[帳管費]在第一期繳款時收取，金額可修改。
#FdAcctFee=X,2,L

#TwAcctFee=m,14,I
C(3,#Hide3Flag,0,CALL(#HideP3),$)
C(3,#Precision,0,$,S)
@I(0,#CurrencyCode,CURR,CURDEF,ENAME,PRECISION)

#UsAcctFee=m,14.2,I
C(3,#Hide3Flag,0,CALL(#HideP3),$)
C(3,#Precision,0,S,$)
@I(0,#CurrencyCode,CURR,CURDEF,ENAME,PRECISION)

#TimAcctFee=m,14.2,S
C(3,#Precision,0,E(0,#TwAcctFee),E(0,#UsAcctFee))



!手續費 企金才可輸入
#FdHandlingFee=X,2,L

#TwHandlingFee=m,14,I
C(3,#DepartmentCode,1,$,S)
C(3,#Hide3Flag,0,CALL(#HideP3),$)
C(3,#Precision,0,$,S)
@I(0,#CurrencyCode,CURR,CURDEF,ENAME,PRECISION)

#UsHandlingFee=m,14.2,I
C(3,#DepartmentCode,1,$,S)
C(3,#Hide3Flag,0,CALL(#HideP3),$)
C(3,#Precision,0,S,$)
@I(0,#CurrencyCode,CURR,CURDEF,ENAME,PRECISION)

#TimHandlingFee=m,14.2,S
C(3,#DepartmentCode,1,$,S)
C(3,#Precision,0,E(0,#TwHandlingFee),E(0,#UsHandlingFee))
!---- P9 階梯式利率

#INVK9=X,1,S
ENABLE(#BTNHIDEP9)
C(3,#HIDE9FG,0,CALL(#HIDEP9),$)


##loop{times:9,n:2,m:4}
#HIDESTEPALL{n}=X,1,S
SHOW(#StepRateType{n})
T(F,@StepMonthS{n},1)
T(F,@StepRateType{n},1)
T(F,@StepRateIncr{n},1)
IF(#StepMonthS{n}==0,INVOKEJS(SHOW,grd1_{m},0)HIDE(#StepMonthS{n},#StepX{n},#StepMonthE{n},#StepRateType{n},#StepRateTypeX{n},#StepRateIncr{n},#StepRatePer{n}),$)
##end


#INITP9=X,1,S
##loop{times:10,n:1}
T(3,@StepRateTypeX{n}, )
T(H,@StepRateTypeX{n},#StepRateType{n},#RateTypeHelp)
##end

#StepMonthS1=N,3,I
C(3,#HIDE9FG,0,CALL(#HIDEP9),$)
@
C(3,#StepMonthS1,0,S,$)
IF(#StepMonthS1!=1,V(P,僅可輸入0，空白及1),$)

#StepMonthE1=N,3,I
C(3,#StepMonthS1,0,S,$)
C(3,#HIDE9FG,0,CALL(#HIDEP9),$)
@
C(3,#StepMonthS1,0,S,$)
V(6,0,#StepMonthS1)
IF(#StepMonthE1>#checkTerm,V(P,#TermMsg),$)


#Month1=X,3,S
E(0,#StepMonthE1+1)
T(2,#Month1)

#StepRateType1=X,1,I
C(3,#StepMonthE1,0,S,$)
C(3,#HIDE9FG,0,CALL(#HIDEP9),$)
C(3,#BaseRateCode,99,E(0,1),$)
HELP(#RateTypeHelp)
@
C(3,#BaseRateCode,99,V(1,1),V(1,1,2))



#StepRateTypeX1=X,10,L
C(4,#StepRateType1,S,$)
T(H,#StepRateType1,#RateTypeHelp)

#StepRateIncr1=+n,2.4,I
C(3,#HIDE9FG,0,CALL(#HIDEP9),$)
C(3,#StepMonthE1,0,S,$)
@
IF(#StepMonthE1==0,INVOKEJS(SHOW,grd4_2,0),INVOKEJS(SHOW,grd4_2,1))

#StepRatePer1=X,2,L
#StepX1=X,1,L

##loop{times:9,n:2,m:1,k:3}

#TEXT_ON_P9{n}=X,1,S
IF(#StepMonthS{m} > 0,SHOW(#StepMonthS{n},#StepX{n},#StepMonthE{n},#StepRateType{n},#StepRateTypeX{n},#StepRateIncr{n},#StepRatePer{n}),$)
T(F,@StepMonthS{n},1)
T(F,@StepRateType{n},1)
T(F,@StepRateIncr{n},1)

#TEXT_OFF_P9{n}=X,1,S
IF(#StepMonthS{n} > 0,SHOW(#StepMonthS{n},#StepX{n},#StepMonthE{n},#StepRateType{n}),#StepRateTypeX{n},#StepRateIncr{n},#StepRatePer{n},$)

#test{n}=X,20,S
T(B,僅可輸入0，空白及+#Month{m})

#StepMonthS{n}=N,3,I
IF({m}==1,$,C(3,#StepMonthS{m},0,S,$))
C(3,#StepMonthE{m},0,S,$)
C(3,#HIDE9FG,0,CALL(#HIDEP9),$)
IF(#StepMonthE{m}==#checkTerm,S,$)
E(0,#StepMonthE{m}+1)
SHOW(#StepMonthS{n},#StepX{n},#StepMonthE{n},#StepRateType{n},#StepRateTypeX{n},#StepRateIncr{n},#StepRatePer{n})
@
C(3,#StepMonthS{n},0,E(0,@StepMonthE{m},#checkTerm)E(0,@Month{m},0)T(2,@test{n},僅可輸入0或空白),$)
C(3,#StepMonthS{n},0,S,$)
C(3,#StepMonthE{m},0,S,IF(#StepMonthS{n}!=#Month{m},V(P,#test{n}),$))

#StepMonthE{n}=N,3,I
C(3,#StepMonthS{n},0,S,$)
C(3,#HIDE9FG,0,CALL(#HIDEP9),$)
SHOW(#StepMonthS{n},#StepX{n},#StepMonthE{n},#StepRateType{n},#StepRateTypeX{n},#StepRateIncr{n},#StepRatePer{n})
@IF({n}==1,$,V(6,0,#StepMonthS{n}))
IF(#StepMonthE{n}>#checkTerm,V(P,#TermMsg),$)

#Month{n}=X,3,S
E(0,#StepMonthE{n}+1)

#StepX{n}=X,1,L

#StepRateType{n}=X,1,I
C(3,#StepMonthE{n},0,S,$)
C(3,#HIDE9FG,0,CALL(#HIDEP9),$)
HELP(#RateTypeHelp)
@V(H,#RateTypeHelp)

#StepRateTypeX{n}=X,10,L
C(4,#StepRateType{n},S,$)
T(H,#StepRateType{n},#RateTypeHelp)

#StepRateIncr{n}=+n,2.4,I
C(3,#HIDE9FG,0,CALL(#HIDEP9),$)
C(3,#StepMonthE{n},0,S,$)
@

#StepRatePer{n}=X,2,L
#HIDESTEP{n}=X,1,S
IF(#StepMonthS{n}==0,HIDE(#StepMonthS{n},#StepX{n},#StepMonthE{n},#StepRateType{n},#StepRateTypeX{n},#StepRateIncr{n},#StepRatePer{n}),$)
IF({n}==1,S,IF(#StepMonthS{n}==0,INVOKEJS(SHOW,grd4_{k},0),INVOKEJS(SHOW,grd4_{k},1)))
  
##end





!---- P4 代碼類
#INVK4=X,1,S
ENABLE(#BTNHIDEP4)
C(3,#Hide4Flag,0,CALL(#HideP4),$)


#FDP4=X,1,S
T(2,@FdIntCalcCode,#WkStar)
T(2,@FdCustTypeCode,#WkStar)
T(2,@FdRuleCode,#WkStar)
T(2,@FdRecycleCode,#WkStar)
T(2,@FdRecycleDeadline,#WkStar)
T(2,@FdUsageCode,#WkStar)
T(2,@FdDepartmentCode, )
T(3,@FdIncomeTaxFlag, )
T(2,@FdCompensateFlag,#WkStar)
T(2,@FdIrrevocableFlag,#WkStar)
T(2,@FdRateAdjNoticeCode,#WkStar)
T(3,@RecycleDeadlineX, 前)
C(3,#L2r01ExtraRepayCode,9,$,T(3,@FdExtraRepayCode, )T(3,@FdRecycleDeadline, ))
C(3,#L2r01RecycleCode,9,$,T(3,@FdRecycleCode, ))
T(H,@IncomeTaxFlagX,#IncomeTaxFlag,#YesNoHelp) 


![攤還額異動碼]
!商品不限制時,才須輸入,否則自動顯示不必輸入
!以防養老固定為 0,不必輸入
#FdExtraRepayCode=X,2,L

#ExtraRepayCode=A,1,I
C(3,#ExtraRepayCode,0,E(0,0),$)
HELP(#ExtraRepayCodeHelp)
@V(H,#ExtraRepayCodeHelp)

#ExtraRepayCodeX=X,6,L
T(H,#ExtraRepayCode,#ExtraRepayCodeHelp)

!計息方式
#FdIntCalcCode=X,2,L

#IntCalcCode=X,1,I
C(3,#AmortizedCode,2,s,$)
C(3,#AcctCode,310,E(0,1),E(0,2))
C(3,#AcctCode,310,s,$)
HELP(#ProdIntCalcCodeHelp)
@V(H,#ProdIntCalcCodeHelp)

#IntCalcCodeX=X,8,L
T(H,#IntCalcCode,#ProdIntCalcCodeHelp)




![客戶別]
!必須輸入
#FdCustTypeCode=X,2,L

#CustTypeCode=X,2,I
C(4,#CustTypeCode,T(3,00),$)
HELP(#CustTypeCodeHelp)
@V(H,#CustTypeCodeHelp)
C(3,#CustTypeCode,1,E(0,@RuleCode,00)T(F,@RuleCode,0)T(3,@FdRuleCode,),T(F,@RuleCode,1)T(3,@FdRuleCode,*))

#CustTypeCodeX=X,20,L
T(H,#CustTypeCode,#CustTypeCodeHelp)


![規定管制代碼]
#FdRuleCode=X,2,L

#RuleCode=A,2,I
C(3,#CustTypeCode,1,s,$)
HELP(#RuleCodeHelp)
@V(H,#RuleCodeHelp)

#RuleCodeX=X,30,L
T(H,#RuleCode,#RuleCodeHelp)

![循環動用]
!當商品不限制時,才須輸入,否則自動顯示不必輸入
!以防養老固定為 0,不必輸入
#FdRecycleCode=X,2,L

#RecycleCode=A,1,I
C(3,#L2r01CharCode,2,E(0,0),$)
C(3,#L2r01CharCode,2,s,$)
HELP(#FacmRecycleCodeHelp)
@V(H,#FacmRecycleCodeHelp)

#RecycleCodeX=X,10,L
T(H,#RecycleCode,#FacmRecycleCodeHelp)

![循環動用期限]
!當循環動用時才須輸入,否則不必輸入
#FdRecycleDeadline=X,2,L
C(3,#RecycleCode,0,HIDE(#RecycleDeadline)T(3, )
                  ,SHOW(#RecycleDeadline)T(2,#WkStar))
C(3,#RecycleCode,0,T(3,@RecycleDeadlineX,無),T(3,@RecycleDeadlineX, 前))
                 

#RecycleDeadline=D,7,I
C(3,#RecycleCode,1,$,S)
D(8)
@V(7)A(DATE,0,#RecycleDeadline)
IF(#RecycleDeadline<=#ApproveDate,V(P,循環動用期限需大於准駁日期),$)
! V(4,010101,#ApproveDate)

#RecycleDeadlineX=X,3,L

![資金用途別]
!必須輸入
#FdUsageCode=X,2,L

#UsageCode=A,2,I
HELP(#UsageCodeHelp)
@V(H,#UsageCodeHelp)

#UsageCodeX=X,20,L
T(H,#UsageCode,#UsageCodeHelp)


![代繳所得稅]
!代繳所得稅只能為零
#FdIncomeTaxFlag=X,2,L

#IncomeTaxFlag=X,1,S
T(3,N)

#IncomeTaxFlagX=X,6,L
T(H,#IncomeTaxFlag,#YesNoHelp)

![代償碼]
!必須輸入
#FdCompensateFlag=X,2,L

#CompensateFlag=X,1,I
HELP(#YesNoHelp)
@V(H,#YesNoHelp)

#CompensateFlagX=X,8,L
T(H,#CompensateFlag,#YesNoHelp)

![不可撤銷]
#FdIrrevocableFlag=X,2,L

#IrrevocableFlag=X,1,I
HELP(#YesNoHelp)
@V(H,#YesNoHelp)

#IrrevocableFlagX=X,8,L
T(H,#IrrevocableFlag,#YesNoHelp)

![利率調整通知]
!必須輸入 1: 電子郵件  2: 書面通知 3: 簡訊通知
#FdRateAdjNoticeCode=X,2,L

#RateAdjNoticeCode=A,1,I
C(3,#Hide4Flag,0,CALL(#HideP4),$)
HELP(#RateAdjNoticeCodeHelp)
@V(H,#RateAdjNoticeCodeHelp)

#RateAdjNoticeCodeX=X,10,L
T(H,#RateAdjNoticeCode,#RateAdjNoticeCodeHelp)

!---- P5 扣款帳號
#INVK5=X,1,S
ENABLE(#BTNHIDEP5)
C(3,#Hide5Flag,0,CALL(#HideP5),$)
!HIDE(#BTN3)


#WkFdP5=X,1,S
T(2,@FdRepayCode,#WkStar)
T(3,@FdRepayBank, )
T(3,@FdRepayAcctNo, )
T(3,@FdPostCode, )
T(2,@FdRelationCode,)
T(3,@FdRelationName, )
T(3,@FdRelationId, )
T(3,@FdRelationBirthday, )
T(3,@FdRelationGender, )

![繳款方式]
!必須輸入
#FdRepayCode=X,2,L

#RepayCode=A,2,I
C(3,#Hide5Flag,0,CALL(#HideP5),$)
C(5,#L2r01CharCode,2,E(0,2),$)
C(5,#L2r01CharCode,2,s,$)
HELP(#RepayCodeHelp)
@V(H,#RepayCodeHelp)

#RepayCodeX=X,16,L
T(H,#RepayCode,#RepayCodeHelp)

#WkFDP5A=X,1,S
C(3,#RepayCode,2,
    T(2,@FdRepayBank,*)
    T(2,@FdRepayAcctNo,*)
   ,T(3,@FdRepayBank, )
    T(3,@FdRepayAcctNo, ))


![扣款銀行]
!繳款方式為銀行扣款時，須輸入扣款銀行,其他則不必輸入
!改用財金的銀行代碼(數字7位的前3碼),下拉式選單只顯示有啟用的銀行代碼。
#FdRepayBank=X,2,L

#RepayBank=X,3,I
C(3,#RepayCode,2,$,S)
C(3,#Hide5Flag,0,CALL(#HideP5),$)
HELP(#BankCdHelp2)
@V(H,#BankCdHelp2)
V(2,0)
#RimRepayBank=X,3,S
#SendL2r53=X,1,S
C(3,#RepayCode,2,$,S)
T(2,@RimCustNo,#CustNo)
T(2,@RimRepayBank,#RepayBank)
RESET_RIM(#SendL2r53,L2R53)
S(L2R53,1,#RimCustNo,#RimRepayBank)
R(1,L2R53)

#RepayBankX=X,30,L
C(3,#RepayCode,2,$,S)
T(H,#RepayBank,#BankCdHelp2)
! T(2,#L2r09BankItem)

#WkFDP5B=X,1,S
C(3,#RepayBank,700,T(2,@FdPostCode,#WkStar),T(3,@FdPostCode, ))

![扣款帳號]
!繳款方式為銀行扣款時，須輸入扣款帳號,其他則不必輸入
#FdRepayAcctNo=X,2,L

#RepayAcctNo=A,14,I
! ALERT(#L2r53Help1)
C(3,#RepayCode,2,C(4,#L2r53Help1,$,HELP(#L2r53Help1)),S)
C(3,#Hide5Flag,0,CALL(#HideP5),$)
@V(2,0)

![郵局存款別]
!扣款銀行為郵局時必須輸入,其他則不必輸入
#FdPostCode=X,2,L

#PostCode=X,1,I
C(3,#RepayCode,2,$,S)
C(3,#RepayBank,700,$,S)
C(3,#Hide5Flag,0,CALL(#HideP5),$)
HELP(#PostCodeHelp)
@V(H,#PostCodeHelp)

#PostCodeX=X,4,L
C(3,#RepayBank,700,$,S)
T(H,#PostCode,#PostCodeHelp)

#RimPostDepCode=X,1,S
#RimAcctNo=X,14,S
#RimBankNo=A,3,S
#AcctCheckFlag=A,1,S

! 檢查該帳號是否授權 郵局檢查
! 4R22
#SendL4R22A=X,1,S
C(3,#RepayCode,2,$,S)
E(0,@RimCustNo,#CustNo)
E(0,@RimAcctNo,#RepayAcctNo)
E(0,@RimBankNo,#RepayBank)
C(5,#RepayBank,700,T(2,@RimPostDepCode,#PostCode),$)
RESET_RIM(#SendL4R22A,L4R22)
S(L4R22,1,#RimCustNo,#RimAcctNo,#RimBankNo,#RimPostDepCode)
R(1,L4R22)

#SetValue=A,1,S
C(3,#RepayCode,02,$,S)
E(0,@AcctCheckFlag,#L4r22CheckCode)
C(3,#AcctCheckFlag,1,
T(2,@RelationCode,#L4r22RelationCode)
T(2,@RelationName,#L4r22RelAcctName)
T(2,@RelationId,#L4r22RelationId)
E(0,@RelationBirthday,#L4r22RelAcctBirthday)
T(2,@RelationGender,#L4r22RelAcctGender),
T(3,@RelationCode,00)
T(3,@RelationName,)
T(3,@RelationId,)
E(0,@RelationBirthday,0)
T(3,@RelationGender,))

!未授權
#AcctCheckFlagwaring=X,1,S
C(3,#RepayCode,2,$,S)
C(3,#AcctCheckFlag,8,S,$)
C(3,#AcctCheckFlag,1,$,C(3,#AcctCheckFlag,0,$,V(P,此帳號未授權)))

![與借款人關係]
#FdRelationCode=X,2,L

#RelationCode=X,2,I
C(3,#Hide5Flag,0,CALL(#HideP5),$)
C(3,#RepayCode,2,$,S)
HELP(#RelationCodeHelp)
@V(H,#RelationCodeHelp)

#RelationCodeX=X,4,L
C(4,#RelationCode,S,$)
T(H,#RelationCode,#RelationCodeHelp)

#WkFdP5C=X,1,S
C(5,#RelationCode,00,
    T(3,@FdRelationName, )
    T(3,@FdRelationId, )
    T(3,@FdRelationBirthday, )
    T(3,@FdRelationGender, )
   ,T(2,@FdRelationName,)
    T(2,@FdRelationId,)
    T(2,@FdRelationBirthday,)
    T(2,@FdRelationGender,))

![帳戶戶名]
#FdRelationName=X,2,L

#RelationName=c,100,I
C(3,#Hide5Flag,0,CALL(#HideP5),$)
C(5,#RelationCode,00,S,$)
C(4,#RelationCode,S,$)
@V(7)

![身份證字號]
#FdRelationId=X,2,L

#RelationId=X,10,I
C(3,#Hide5Flag,0,CALL(#HideP5),$)
C(5,#RelationCode,00,S,$)
C(4,#RelationCode,S,$)
@V(7)A(ID,0,#RelationId)
V(4,#CustId)


![出生日期]
#FdRelationBirthday=X,2,L

#RelationBirthday=D,7,I
C(3,#Hide5Flag,0,CALL(#HideP5),$)
C(5,#RelationCode,00,S,$)
C(4,#RelationCode,S,$)
D(8)
@V(7)A(DATE,0,#RelationBirthday)

![性別]
#FdRelationGender=X,2,L

#RelationGender=X,1,I
C(3,#Hide5Flag,0,CALL(#HideP5),$)
C(5,#RelationCode,00,S,$)
C(4,#RelationCode,S,$)
HELP(#SexHelp)
@V(H,#SexHelp)

#RelationGenderX=X,2,L
C(5,#RelationCode,00,S,$)
C(4,#RelationCode,S,$)
T(H,#RelationGender,#SexHelp)


!---- P6 專員
#INVK6=X,1,S
ENABLE(#BTNHIDEP6)
C(3,#Hide6Flag,0,CALL(#HideP6),$)


#WkFdP6=X,1,S
T(3,@FdIntroducer, )
T(3,@FdDistrict, )
T(3,@FdFireOfficer, )
T(3,@FdEstimate, )
T(2,@FdCreditOfficer,#WkStar)
! T(3,@FdLoanOfficer, )
T(3,@FdBusinessOfficer, )
T(3,@FdSupervisor, )
T(3,@FdInvestigateOfficer, )
T(3,@FdEstimateReview, )

#BUF11A=X,7,S
T(3,      Y)


![介紹人]
!可不輸入
#FdIntroducer=X,2,L

#Introducer=X,6,I

#BUF11B=X,7,S
T(2,#Introducer)

#BIND11B=X,1,S
BIND(#BTN11,click, {cmd=CHAIN; ntxcd=L6088; ntxbuf=#BUF11B;ntxbuf5=type<-1:Introducer<-OOEmployeeNo})

#SendL2r08A=X,1,S
C(4,#Introducer,S,$)
T(2,@RimEmployeeNo,#Introducer)
IF(#L2r02Introducer==#Introducer,T(3,@RimErrorSkip,Y),T(3,@RimErrorSkip,))
S(L2R08,1,#RimTxCode,#RimEmployeeNo,#RimErrorSkip)
R(1,L2R08)
T(2,@IntroducerX,#L2r08FullName)
T(2,@District,#L2r08CenterCode1)
T(2,@DistrictX,#L2r08CenterCode1Name)

#IntroducerX=X,20,L
C(4,#Introducer,S,$)

![區部]
!可不輸入
#FdDistrict=X,2,L

#District=X,6,L
C(4,#Introducer,S,$)

#DistrictX=X,20,L
C(4,#Introducer,S,$)

#BUF12A=X,7,S
T(3,      Y)


![火險服務]
!可不輸入
#FdFireOfficer=X,2,L

#FireOfficer=X,6,I

#BUF12B=X,7,S
T(2,#FireOfficer)

#BIND12B=X,1,S
BIND(#BTN12,click, {cmd=CHAIN; ntxcd=L6088; ntxbuf=#BUF12B;ntxbuf5=type<-1:FireOfficer<-OOEmployeeNo})

#SendL2r08B=X,1,S
C(4,#FireOfficer,S,$)
T(2,@RimEmployeeNo,#FireOfficer)
IF(#L2r02Introducer==#FireOfficer,T(3,@RimErrorSkip,Y),T(3,@RimErrorSkip,))
S(L2R08,1,#RimTxCode,#RimEmployeeNo,#RimErrorSkip)
R(1,L2R08)
T(2,@FireOfficerX,#L2r08FullName)

#FireOfficerX=X,20,L
C(4,#FireOfficer,S,$)

#BUF13A=X,7,S
T(3,      Y)


![估價]
!可不輸入
#FdEstimate=X,2,L

#Estimate=X,6,I

#BUF13B=X,7,S
T(2,#Estimate)

#BIND13B=X,1,S
BIND(#BTN13,click, {cmd=CHAIN; ntxcd=L6088; ntxbuf=#BUF13B;ntxbuf5=type<-1:Estimate<-OOEmployeeNo})

#SendL2r08C=X,1,S
C(4,#Estimate,S,$)
T(2,@RimEmployeeNo,#Estimate)
IF(#L2r02Estimate==#Estimate,T(3,@RimErrorSkip,Y),T(3,@RimErrorSkip,))
S(L2R08,1,#RimTxCode,#RimEmployeeNo,#RimErrorSkip)
R(1,L2R08)
T(2,@EstimateX,#L2r08FullName)

#EstimateX=X,20,L
C(4,#Estimate,S,$)

#BUF14A=X,7,S
T(3,      Y)


![授信]
!可不輸入
#FdCreditOfficer=X,2,L

#CreditOfficer=X,6,I
@V(7)

#BUF14B=X,7,S
T(2,#CreditOfficer)

#BIND14B=X,1,S
BIND(#BTN14,click, {cmd=CHAIN; ntxcd=L6088; ntxbuf=#BUF14B;ntxbuf5=type<-1:CreditOfficer<-OOEmployeeNo})

#SendL2r08D=X,1,S
C(4,#CreditOfficer,S,$)
T(2,@RimEmployeeNo,#CreditOfficer)
IF(#L2r02CreditOfficer==#CreditOfficer,T(3,@RimErrorSkip,Y),T(3,@RimErrorSkip,))
S(L2R08,1,#RimTxCode,#RimEmployeeNo,#RimErrorSkip)
R(1,L2R08)
T(2,@CreditOfficerX,#L2r08FullName)

#CreditOfficerX=X,20,L
C(4,#CreditOfficer,S,$)


#BUF16A=X,7,S
T(3,      Y)


![房貸專員]
!可不輸入
#FdBusinessOfficer=X,2,L

#BusinessOfficer=X,6,I

#BUF16B=X,7,S
T(2,#BusinessOfficer)

#BIND16B=X,1,S
BIND(#BTN16,click, {cmd=CHAIN; ntxcd=L6088; ntxbuf=#BUF16B;ntxbuf5=type<-1:BusinessOfficer<-OOEmployeeNo})

#SendL2r08F=X,1,S
C(4,#BusinessOfficer,S,$)
T(2,@RimEmployeeNo,#BusinessOfficer)
IF(#L2r02LoanOfficer==#BusinessOfficer,T(3,@RimErrorSkip,Y),T(3,@RimErrorSkip,))
S(L2R08,1,#RimTxCode,#RimEmployeeNo,#RimErrorSkip)
R(1,L2R08)
T(2,@BusinessOfficerX,#L2r08FullName)

#BusinessOfficerX=X,20,L
C(4,#BusinessOfficer,S,$)

#BUF17A=X,7,S
T(3,      Y)


!核准層級
#FdApprovedLevel=X,2,L

#ApprovedLevel=X,1,I
HELP(#ApprovedLevelHelp)
@V(H,#ApprovedLevelHelp)

#ApprovedLevelX=X,20,L
C(4,#ApprovedLevel,S,$)
T(H,#ApprovedLevel,#ApprovedLevelHelp)
C(3,#ApprovedLevel,9,T(F,@Supervisor,0)T(3,@FdSupervisor,),T(F,@Supervisor,1)T(3,@FdSupervisor,*))



![核決主管]
!可不輸入
#FdSupervisor=X,2,L

#Supervisor=X,6,I
C(3,#Hide6Flag,0,CALL(#HideP6),$)
C(3,#ApprovedLevel,9,S,$)
@V(7)

#BUF17B=X,7,S
T(2,#Supervisor)

#BIND17B=X,1,S
BIND(#BTN17,click, {cmd=CHAIN; ntxcd=L6088; ntxbuf=#BUF17B;ntxbuf5=type<-1:Supervisor<-OOEmployeeNo})

#SendL2r08G=X,1,S
C(4,#Supervisor,S,$)
T(2,@RimEmployeeNo,#Supervisor)
IF(#L2r02Supervisor==#Supervisor,T(3,@RimErrorSkip,Y),T(3,@RimErrorSkip,))
S(L2R08,1,#RimTxCode,#RimEmployeeNo,#RimErrorSkip)
R(1,L2R08)
T(2,@SupervisorX,#L2r08FullName)

#SupervisorX=X,20,L
C(4,#Supervisor,S,$)

#BUF18A=X,7,S
T(3,      Y)

#BUF19A=X,7,S
T(3,      Y)

![徵信]
#FdInvestigateOfficer=X,2,L

#InvestigateOfficer=X,6,I
C(3,#Hide6Flag,0,CALL(#HideP6),$)

#InvestigateOfficerLb=X,6,L

#BUF19B=X,7,S
T(2,#InvestigateOfficer)

#BIND19B=X,1,S
BIND(#BTN19,click, {cmd=CHAIN; ntxcd=L6088; ntxbuf=#BUF19B;ntxbuf5=type<-1:InvestigateOfficer<-OOEmployeeNo})

#SendL2r08H=X,1,S
C(4,#InvestigateOfficer,S,$)
T(2,@RimEmployeeNo,#InvestigateOfficer)
S(L2R08,1,#RimTxCode,#RimEmployeeNo,#RimErrorSkip)
R(1,L2R08)
T(2,@InvestigateOfficerX,#L2r08FullName)

#InvestigateOfficerX=X,20,L
C(4,#InvestigateOfficer,S,$)

#BUF20A=X,7,S
T(3,      Y)


![估價覆核]
#FdEstimateReview=X,2,L

#EstimateReview=X,6,I
C(3,#Hide6Flag,0,CALL(#HideP6),$)

#EstimateReviewLb=X,6,L

#BUF20B=X,7,S
T(2,#EstimateReview)

#BIND20B=X,1,S
BIND(#BTN20,click, {cmd=CHAIN; ntxcd=L6088; ntxbuf=#BUF20B;ntxbuf5=type<-1:EstimateReview<-OOEmployeeNo})

#SendL2r08I=X,1,S
C(4,#EstimateReview,S,$)
T(2,@RimEmployeeNo,#EstimateReview)
S(L2R08,1,#RimTxCode,#RimEmployeeNo,#RimErrorSkip)
R(1,L2R08)
T(2,@EstimateReviewX,#L2r08FullName)

#EstimateReviewX=X,20,L
C(4,#EstimateReview,S,$)

#BUF21A=X,7,S
T(3,      Y)


![協辦人]
!可不輸入
#FdCoorgnizer=X,2,L

#Coorgnizer=X,6,I
C(3,#Hide6Flag,0,CALL(#HideP6),$)

#BUF18B=X,7,S
T(2,#Coorgnizer+Y)

#BIND18B=X,1,S
BIND(#BTN18,click, {cmd=CHAIN; ntxcd=L5022; ntxbuf=#BUF18B;ntxbuf5=type<-1:Coorgnizer<-OOEmpNo:CoorgnizerX<-OOFullname})

#SendL2r13B=X,1,S
C(4,#Coorgnizer,S,$)
T(2,@RimEmployeeNo,#Coorgnizer)
E(0,@RimFunCd,1)
S(L2R13,1,#RimFunCd,#RimEmployeeNo)
R(1,L2R13)
T(2,@CoorgnizerX,#L2r13FullName)

#CoorgnizerX=X,20,L
C(4,#Coorgnizer,S,$)

!--- P7 清償金類型
!#BTNHIDEP7=X,15,I,ui:button;value: 清償金類型 ;enable:1;tabbable:1

#INVK7=X,1,S
ENABLE(#BTNHIDEP7)
C(3,#Hide7Flag,0,CALL(#HideP7),$)

!是否限制清償
#FdBreachFlag=X,2,L

#BreachFlag=X,1,I
C(3,#Hide7Flag,0,CALL(#HideP7),$)
C(3,#DepartmentCode,0,s,$)
HELP(#YesNoHelp)
@V(H,#YesNoHelp)

#BreachFlagX=X,10,L
T(H,#BreachFlag,#YesNoHelp)

![違約適用方式]
#FDBreachCode=X,2,L
IF(#L2r01BreachFlag=="N",
   C(5,#BreachFlag,N,HIDE(#BreachCode,#BreachGetCode,#DecreaseFlag)
                          ,SHOW(#BreachCode,#BreachGetCode,#DecreaseFlag)),$)

#BreachCode=A,3,L
C(5,#L2r01BreachFlag,Y,$,s)
C(5,#BreachFlag,Y,$,s)
C(3,#Hide7Flag,0,CALL(#HideP7),$)

#BreachCodeX=X,40,L
T(H,#BreachCode,#FacmBreachCodeHelp)
C(5,#BreachFlag,N,T(3,無),$)

![違約金收取方式]
#FDBreachGetCode=X,2,L

#BreachGetCode=A,1,L
C(5,#L2r01BreachFlag,Y,$,s)
C(3,#L2r01BreachCode,999,$,s)
C(5,#BreachFlag,N,S,$)
C(3,#Hide7Flag,0,CALL(#HideP7),$)
HELP(#BreachGetCodeHelp)
! @V(H,#BreachGetCodeHelp)

#BreachGetCodeX=X,16,L
T(H,#BreachGetCode,#BreachGetCodeHelp)
C(5,#BreachFlag,N,T(3,無),$)
C(3,#BreachGetCode,0,T(3,無),$)

![是否每月按比例減少]
#FdDecreaseFlag=X,2,L

#DecreaseFlag=X,1,L
T(3,Y)
C(5,#L2r01BreachFlag,Y,$,s)
C(3,#L2r01BreachCode,999,$,s)
C(5,#BreachFlag,N,S,$)
HELP(#YesNoHelp)
! @V(H,#YesNoHelp)

#DecreaseFlagX=X,2,L
T(H,#DecreaseFlag,#YesNoHelp)
C(4,#DecreaseFlag,T(3,無),$)

![限制清償期限]
#FdProhibityear=X,2,L

#Prohibityear=A,2,L
C(3,#Hide7Flag,0,CALL(#HideP7),$)
IF(#L2r01BreachCode==999,$,S)

#ProhibityearX=X,9,L
!違約適用方式是否按商品設定
#FdProdBreachFlag=X,2,L
![是否限制清償]與商品設定不同時N否則Y
![是否限制清償]與商品設定相同時且[是否限制清償]為Y時[清償說明]放商品設定值,否則不需輸入
#ProdBreachFlag=X,1,I
C(3,#Hide7Flag,0,CALL(#HideP7),$)
C(5,#BreachFlag,#L2r01BreachFlag,T(3,Y),T(3,N))
C(3,#DepartmentCode,0,s,$)
C(5,#BreachFlag,#L2r01BreachFlag,C(5,#BreachFlag,Y,C(4,#Breach,T(2,@Breach,#L2r01Breach),$),T(F,@ProdBreachFlag,0)),T(F,@ProdBreachFlag,0))
C(5,#BreachFlag,#L2r01BreachFlag,C(5,#BreachFlag,Y,C(4,#Breach,T(2,@Breach,#L2r01Breach),$),s),s)
HELP(#YesNoHelp)
@V(H,#YesNoHelp)


#ProdBreachFlagX=X,10,L
C(4,#ProdBreachFlag,S,$)
T(H,#ProdBreachFlag,#YesNoHelp)

! #Breach1=x,200,L

#Breach=x,4.50,I
C(3,#Hide7Flag,0,CALL(#HideP7),$)
! IF(#ProdBreachFlag=="Y"||#ProdBreachFlag=="",T(F,@Breach,0),T(F,@Breach,1))
IF(#BreachFlag=="N",S,$)
IF(#ProdBreachFlag=="Y",T(2,@Breach,#L2r01Breach),$)
C(5,#ProdBreachFlag,Y,s,$)
C(4,#ProdBreachFlag,s,$)


#Wait=X,1,I 
C(3,#DepartmentCode,0,$,S)
C(3,#Hide7Flag,0,CALL(#HideP7),$)
@T(3,)

!--- P8 其他
#INVK8=X,1,S
ENABLE(#BTNHIDEP8) 
C(3,#HIDE8FG,0,CALL(#HideP8),$) 


#WkFdP8=X,1,S
T(3,@FdGroupId, )
T(2,@FdCreditScore, )
T(2,@FdGuaranteeDate,#WkStar)

![團體戶]
!自動顯示不必輸入
#FdGroupId=X,2,L

#GroupId=X,10,L
C(3,#HIDE8FG,0,CALL(#HideP8),$)

#RcvL2r07B=X,1,S
C(4,#GroupId,S,$)
T(2,@RimCustId,#GroupId)
E(0,@RimCustNo,0)
! RESET_RIM(#RcvL2r07B,L2R07)
S(L2R07,1,#RimTxCode,#RimCustId,#RimCustNo)
R(1,L2R07)
T(2,@GroupIdX,#L2r07CustName)

#GroupIdX=X,100,L

![信用評分]
#FdCreditScore=X,2,L

#CreditScore=A,3,I
C(3,#HIDE8FG,0,CALL(#HideP8),$)


![對保日期]
#FdGuaranteeDate=X,2,L

#GuaranteeDate=D,7,I
C(3,#HIDE8FG,0,CALL(#HideP8),$)
D(8)
@V(7)A(DATE,0,#GuaranteeDate)

![合約編號]
!中租件必須輸入中租合約編號,其他則不必輸入
!中租合約編號已存在,不可重複輸入
! #FdContractNo=X,2,L

! #ContractNo=X,10,I
! C(3,#HIDE8FG,0,CALL(#HideP8),$)



#Grcd=X,1,I
HELP(#YesNoHelp)
@
!C(4,#Grcd,S,$)
V(H,#YesNoHelp)

#FdGrKind=X,2,L
C(5,#Grcd,Y,T(2,*),T(2, ))

#HideGrKind=X,1,L
C(5,#Grcd,Y,T(F,#GrKind,1),T(F,#GrKind,0))

#GrKind=X,1,I
C(4,#Grcd,S,$)
C(5,#Grcd,N,S,$)
HELP(#GrKindHelp)
@
V(H,#GrKindHelp)

#GrKindX=X,60,L
C(4,#GrKind,S,$)
T(H,#GrKind,#GrKindHelp)

#EsGcd=X,1,I
HELP(#YesNoHelp)
@
!C(4,#EsGcd,S,$)
V(H,#YesNoHelp)
C(5,#EsGcd,Y,T(2,#FdEsGcnl,*)T(F,#EsGcnl,1),T(2,#FdEsGcnl, )T(F,#EsGcnl,0))

#FdEsGKind=X,2,L
C(5,#EsGcd,Y,T(2,*),T(2, ))

#HideEsGKind=X,1,L
C(5,#EsGcd,Y,T(F,#EsGKind,1),T(F,#EsGKind,0))

#EsGKind=X,1,I
C(4,#EsGcd,S,$)
C(5,#EsGcd,N,S,$)
HELP(#EsGKindHelp)
@
V(H,#EsGKindHelp)

#EsGKindX=X,60,L
C(4,#EsGKind,S,$)
T(H,#EsGKind,#EsGKindHelp)

#FdEsGcnl=X,2,L

#EsGcnl=X,1,I
C(5,#EsGcd,N,T(2,N),$)
C(5,#EsGcd,N,s,$)
HELP(#YesNoHelp)
@
!C(4,#EsGcnl,S,$)
V(H,#YesNoHelp)

!購地貸款相關 - 規定管制代碼#RuleCode=08購地貸款(央行管制)才需要填寫
#FdPreStarBuildingYM=X,2,L
#FdStarBuildingYM=X,2,L
#HidePreStarBuildingYM=X,1,L
C(3,#RuleCode,08,T(F,#PreStarBuildingYM,1),T(F,#PreStarBuildingYM,0))
#HideStarBuildingYM=X,1,L
C(3,#RuleCode,08,T(F,#StarBuildingYM,1),T(F,#StarBuildingYM,0))
!約定動工年月
#PreStarBuildingYM=A,5,I
IF(#RuleCode==08,$,s)
@A(YM,0,#PreStarBuildingYM)
!實際興建年月
#StarBuildingYM=A,5,I
IF(#RuleCode==08,$,s)
@A(YM,0,#StarBuildingYM)


#MRKEY=_,_,S
T(2,#CustNo+-+#FacmNo)

![SWIFT幣別三碼]
#CURNM=_,_,S
T(2,#CurrencyCode)

![交易金額]
#TXAMT=_,_,S
E(0,#TimApplAmt)
!---- Expand 展開

#INVKExpand=X,1,S
ENABLE(#BTNExpand)
E(0,@ExpandFlag,0)
C(3,#ExpandFlag,0,CALL(#Expand),$)



<include src="ROM.icf::L0Rim.dec"/>
<include src="ROM.icf::L2Rim.dec"/>
<include src="ROM.icf::L2R01.dec"/>
<include src="ROM.icf::L2R02.dec"/>
<include src="ROM.icf::L2R04.dec"/>
<include src="ROM.icf::L2R06.dec"/>
<include src="ROM.icf::L2R07.dec"/>
<include src="ROM.icf::L2R08.dec"/>
<include src="ROM.icf::L2R09.dec"/>
<include src="ROM.icf::L2R11.dec"/>
<include src="ROM.icf::L2R50.dec"/>
<include src="ROM.icf::L2R53.dec"/>
<include src="ROM.icf::L2R13.dec"/>
<include src="ROM.icf::L4R22.dec"/>
<include src="ROM.icf::L6R28.dec"/>
</sub>

<sub type="DC" name="p2" layout="cols=2;screen.width=[200,300,200,300];printer.width=[15,30];order=1;">
[
["<font color=red>@利率"],
[#<->#,"#FdProdNo+商品代碼",#ProdNo,#ProdNoX],
["#FdBaseRateCode+指標利率代碼",#BaseRateCode,#BaseRateCodeX],
["#FdBaseRate+指標利率",#BaseRateX],
["#FdProdRate+商品利率",#ProdRateX],
["#FdRateIncr+加碼利率",#RateIncr,#RateIncrX],
["#FdApproveRate+核准利率",#ApproveRate,#ApproveRateX],
["#FdRateCode+利率區分",#RateCode,#RateCodeX],
["#FdFirstRateAdjFreq+首次利率調整週期",#FirstRateAdjFreq,#LbFirstRateAdjFreq,#FirstRateAdjFreqX],
["#FdRateAdjFreq+利率調整週期",#RateAdjFreq,#LbRateAdjFreq,#RateAdjFreqX],
]
</sub>

<sub type="DC" name="p3" layout="cols=2;screen.width=[200,300,200,300];printer.width=[15,30];order=1;">
[
["<font color=red>@金額、日期"],
["#FdCurrencyCode+核准幣別",#CurrencyCode],
["#FdApplAmt+核准額度",#TwApplAmt,#UsApplAmt],
["#FdAcctCode+核准科目",#AcctCode,#AcctCodeX],
["#FdApproveDate+准駁日期",#ApproveDate],
["#FdLoanTerm+貸款期間",#LoanTermYy,"@年@",#LoanTermMm,"@月@",#LoanTermDd,"@日"],
["#FdAmortizedCode+攤還方式",#AmortizedCode,#AmortizedCodeX],
["#FdFreqBase+週期基準",#FreqBase,#FreqBaseX],
["#FdPayIntFreq+繳息週期",#PayIntFreq,#LbPayIntFreq,#PayIntFreqX],
["#FdRepayFreq+還本週期",#RepayFreq,#LbRepayFreq,#RepayFreqX],
["#FdUtilDeadline+動支期限",#UtilDeadline,"@前"],
["#FdGracePeriod+寬限總月數",#GracePeriod,#LbGracePeriod,#GracePeriodX],
[#<->#,"#FdDepartmentCode+案件隸屬單位",#DepartmentCode,#DepartmentCodeX],
["#FdAcctFee+帳管費",#TwAcctFee,#UsAcctFee],
["#FdHandlingFee+手續費",#TwHandlingFee,#UsHandlingFee],
]
</sub>

<sub type="DC" name="p4" layout="cols=2;screen.width=[250,300,200,300];printer.width=[15,30];order=1;">
[
["<font color=red>@階梯式利率　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　 "],
["#grid#,{id:4,expand:true,loop:10,row_height:1,s_cols:[170,150,150], p_cols:[20,20,20]}","","",
["@@@@@月數@@@@@","@@@@@利率種類@@@@@","@@@@@利率@@@@@"],
[[#StepMonthS1,#StepX1,#StepMonthE1],[#StepRateType1,#StepRateTypeX1],[#StepRateIncr1,#StepRatePer1],],
],
]
</sub>



<sub type="DC" name="p5" layout="cols=2;screen.width=[200,300,200,300];printer.width=[15,30];order=1;">
[
["<font color=red>@代碼類"],
["#FdExtraRepayCode+攤還額異動碼",#ExtraRepayCode,#ExtraRepayCodeX],
["#FdIntCalcCode+計息方式",#IntCalcCode,#IntCalcCodeX],
["#FdCustTypeCode+客戶別",#CustTypeCode,#CustTypeCodeX],
["#FdRuleCode+規定管制代碼",#RuleCode,#RuleCodeX],
["#FdRecycleCode+循環動用",#RecycleCode,#RecycleCodeX],
["#FdRecycleDeadline+循環動用期限",#RecycleDeadline,#RecycleDeadlineX],
["#FdUsageCode+資金用途別",#UsageCode,#UsageCodeX],
["#FdIncomeTaxFlag+代繳所得稅",#IncomeTaxFlagX],
["#FdCompensateFlag+代償碼",#CompensateFlag,#CompensateFlagX],
["#FdIrrevocableFlag+不可撤銷",#IrrevocableFlag,#IrrevocableFlagX],
["#FdRateAdjNoticeCode+利率調整通知",#RateAdjNoticeCode,#RateAdjNoticeCodeX],
]
</sub>

<sub type="DC" name="p6" layout="cols=2;screen.width=[200,300,200,300];printer.width=[15,30];order=1;">
[
["<font color=red>@扣款帳號"],
["#FdRepayCode+繳款方式",#RepayCode,#RepayCodeX],
["#FdRepayBank+扣款銀行",#RepayBank,#RepayBankX],
["#FdRepayAcctNo+扣款帳號",#RepayAcctNo],
["#FdPostCode+郵局存款別",#PostCode,#PostCodeX],
[#<->#,"#FdRelationCode+與借款人關係",#RelationCode,#RelationCodeX],
[#<->#,"#FdRelationName+帳戶戶名",#RelationName],
[#<->#,"#FdRelationId+身份證字號",#RelationId],
[#<->#,"#FdRelationBirthday+出生日期",#RelationBirthday],
[#<->#,"#FdRelationGender+性別",#RelationGender,#RelationGenderX],
]
</sub>

<sub type="DC" name="p7" layout="cols=2;screen.width=[200,300,250,250];printer.width=[15,30];order=1;">
[
["<font color=red>@專員"],
["#FdIntroducer+介紹人",#Introducer,#BTN11,#IntroducerX],
["#FdDistrict+@區部",#District,#DistrictX],
["#FdFireOfficer+火險服務",#FireOfficer,#BTN12,#FireOfficerX],
["#FdEstimate+@估價人員",#Estimate,#BTN13,#EstimateX],
["#FdCreditOfficer+授信人員",#CreditOfficer,#BTN14,#CreditOfficerX],
["#FdBusinessOfficer+#BusinessOfficerItem",#BusinessOfficer,#BTN16,#BusinessOfficerX],
["#FdApprovedLevel+核准層級",#ApprovedLevel,#ApprovedLevelX],
["#FdSupervisor+@核決主管",#Supervisor,#BTN17,#SupervisorX],
["#FdInvestigateOfficer+徵信人員",#InvestigateOfficer,#BTN19,#InvestigateOfficerLb,#InvestigateOfficerX],
["#FdEstimateReview+@估價覆核人員",#EstimateReview,#BTN20,#EstimateReviewLb,#EstimateReviewX],
["#FdCoorgnizer+協辦人",#Coorgnizer,#BTN18,#CoorgnizerX],
]
</sub>

<sub type="DC" name="p8" layout="cols=2;screen.width=[300,300,200,300];printer.width=[15,30];order=1;">
[
["<font color=red>@清償金類型　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　 　　　　　　　　"],
[#<->#,"#FdBreachFlag+是否限制清償",#BreachFlag,#BreachFlagX],
[#<->#,"#FdProdBreachFlag+違約適用方式是否按商品設定",#ProdBreachFlag,#ProdBreachFlagX],
[#<->#,"@",#Breach,#Wait],
]
</sub>

<sub type="DC" name="p9" layout="cols=2;screen.width=[400,200,200,500];printer.width=[15,30];order=1;">
[
["<font color=red>@其他　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　 　　　　　　　　　　　　　　　"],
[#<->#,"#FdGroupId+團體戶統編",#GroupId,#GroupIdX],
[#<->#,"#FdCreditScore+信用評分",#CreditScore],
[#<->#,"#FdGuaranteeDate+對保日期",#GuaranteeDate],
["#FdGrcd+綠色授信註記",#Grcd],["#FdGrKind+綠色支出類別",#GrKind,#GrKindX],
["#FdEsGcd+永續績效連結授信註記",#EsGcd],["#FdEsGKind+永續績效連結授信類別",#EsGKind,#EsGKindX],
[#<->#,"#FdEsGcnl+永續績效連結授信約定條件全部未達成通報",#EsGcnl],
["#FdPreStarBuildingYM+約定動工年月",#PreStarBuildingYM],["#FdStarBuildingYM+實際興建年月",#StarBuildingYM],
]
</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>


!---------- TXFORM = L2153 ----------
<sub type="FORM" name="L2153">

#SCRPRT=_,_,S
C(5,#TXFORM,L2153,$,S)

#SCRTIL=_,_,S
T(3,[L2153] 核准額度登錄)

#OCustNo=A,7,S
C(3,#CustNo,0,E(0,@CustNo,#OCustNo)K(LIGHT,#CustNo,TXTRED,0,1),$)

#OFacmNo=A,3,S
E(0,@FacmNo,#OFacmNo)
K(LIGHT,#FacmNo,TXTRED,0,1)

</sub>

!------ 上行電文 TEXT ------
<sub type="TIM">
#CustId
#ApplNo
#CustNo
#FacmNo
#CreditSysNo
#ProdNo
#BaseRateCode
#RateIncr
#ApproveRate
#RateCode
#FirstRateAdjFreq
#RateAdjFreq
#CurrencyCode
#TimApplAmt
#AcctCode
#ApproveDate
#LoanTermYy
#LoanTermMm
#LoanTermDd
#AmortizedCode
#FreqBase
#PayIntFreq
#RepayFreq
#UtilDeadline
#GracePeriod
#TimAcctFee
#TimHandlingFee
#ExtraRepayCode
#IntCalcCode
#CustTypeCode
#RuleCode
#RecycleCode
#RecycleDeadline
#UsageCode
#DepartmentCode
#IncomeTaxFlag
#CompensateFlag
#IrrevocableFlag
#RateAdjNoticeCode
#RepayCode
#RepayBank
#RepayAcctNo
#PostCode
#Introducer
#District
#FireOfficer
#Estimate
#CreditOfficer
#BusinessOfficer
#ApprovedLevel
#Supervisor
#InvestigateOfficer
#EstimateReview
#Coorgnizer
#GroupId
#CreditScore
#GuaranteeDate
#RelationCode
#RelationName
#RelationId
#RelationBirthday
#RelationGender
##loop{times:10,n:1}
#StepMonthS{n}
#StepMonthE{n}
#StepRateType{n}
#StepRateIncr{n}
##end
#ProdBreachFlag
#Breach
#END
#BreachFlag
#TwApplAmt
#UsApplAmt
#TwAcctFee
#UsAcctFee
#TwHandlingFee
#UsHandlingFee
#Grcd
#GrKind
#EsGcd
#EsGKind
#EsGcnl
#PreStarBuildingYM
#StarBuildingYM
</sub>


!------ 下行電文TOM ------
<sub type="TOM">
TXFORM=L2153
#OCustNo#OFacmNo
^

<include src="COM.icf::TRCTL.tom"/>
<include src="COM.icf::LockControl.tom"/>
<include src="ROM.icf::L2R01.tom"/>
<include src="ROM.icf::L2R02.tom"/>
<include src="ROM.icf::L2R04.tom"/>
<include src="ROM.icf::L2R06.tom"/>
<include src="ROM.icf::L2R07.tom"/>
<include src="ROM.icf::L2R08.tom"/>
<include src="ROM.icf::L2R09.tom"/>
<include src="ROM.icf::L2R11.tom"/>
<include src="ROM.icf::L2R13.tom"/>
<include src="ROM.icf::L2R50.tom"/>
<include src="ROM.icf::L2R53.tom"/>
<include src="ROM.icf::L4R22.tom"/>
<include src="ROM.icf::L6R28.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
</sub>


!---------- 單據輸出組合 ----------
<sub type="SELECT">
<include src="PRT.icf::UPD01.sel"/>
<include src="PRT.icf::UPDH01.sel"/>
<include src="PRT.icf::FM01.sel"/>
<include src="PRT.icf::FMR01.sel"/>
<include src="PRT.icf::FMH01.sel"/>
<include src="PRT.icf::FMHR01.sel"/>
</sub>
