----- BASIC LABEL Variables ----------
<sub type="SYS">
#Submit=A,1,S
K(MODIFYBUTTON,查詢)
</sub>

<sub type="SYS" name="label">

!#TXCD
!T(3,L2917)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,0)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,93)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,20)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)


</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)



</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[130,1100];printer.width=[20,20];">
[
["[L2917]                                 刪除擔保品建物下土地資料（轉換資料）"],
["#FdCustNo+戶號",#CustNo,#CustName],
]
!---------- AP Button AREA ----------
![Buttom資料查詢]

#FdCustNo=X,2,L
T(3,*)

!---------- AP TEXT AREA Variables ----------
<include src="HELPRIM.icf::HELPRIM.rtn"/>

#CHAIN=A,1,S
T(4,CHAIN$)

#NTXBUF=X,200,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)


! [戶號]
#CustNo=A,7,I
C(3,#CHAIN,1,s,$)
@V(2,0)


#RimL1r09=X,1,S
E(0,@RimFunCd,1)
T(2,@RimCustId,)
T(3,#CustName,)
E(0,@RimCustNo,#CustNo)
RESET_RIM(#RimL1r09,L1R09)
S(L1R09,1,#RimFunCd,#RimCustId,#RimCustNo)
R(1,L1R09)
T(2,@CustName,#L1r09CustName)

#CustName=X,100,L




#RPTFG=A,1,S
E(0,0)

<include src="ROM.icf::L2Rim.dec"/>
<include src="ROM.icf::L1R09.dec"/>
</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>


!---------- TXFORM = L2917 ----------
<sub type="FORM" name="L2917">

!#SCRPRT=_,_,S
!C(5,#TXFORM,L2917,$,S)

#SCRTIL=_,_,S
T(3,[L2917] 刪除擔保品建物下土地資料（轉換資料）)


!------ TOM(HEAD)   Variables (FOR OUTPUT SCREEN) ------

!戶號
#OCustNo=A,6,L
E(0,#CustNo)
!戶名
#OCustName=x,60,L
T(2,#CustName)
!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------
#LOOP=X,1,S
T(3,1)ASGN(LOOP$)

!擔保品代號1
#OOClCode1=A,1,S
!擔保品代號2
#OOClCode2=A,2,S
!擔保品編號
#OOClNo=A,7,S
!擔保品代號1+擔保品代號2+擔保品編號
#OOCl=X,12,L
T(2,#OOClCode1+-+#OOClCode2+-+#OOClNo)
!建物門牌
#OOBdLocation=x,60,L
!土地序號
#OOClLandSeq=A,3,S
!土地坐落
#OOLandLocation=x,60,L

#FunCd=A,1,S
E(0,4)


#secret-no=x,1000,S
T(6A,#FunCd+#OOClCode1+#OOClCode2+#OOClNo+#OOClLandSeq)


#batch-detail=x,100000,S
#batch-print=A,1,S
!#batch-rows 總筆數
#batch-rows=X,2,S
!#batch-rows-selected 勾選之筆數
#batch-rows-selected=X,2,S
!#batch-rows-ok  傳送成功筆數
#batch-rows-ok=X,2,S
!#batch-rows-error 傳送失敗筆數
#batch-rows-error=X,2,S
!#batch-row-txtno 該列傳送序號
#batch-row-txtno=X,18,O
!#batch-row-status 該列傳送狀態
#batch-row-status=X,50,S

!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------

</sub>


!------ 上行電文 ------
<sub type="TIM">
#CustNo
</sub>


!------ 下行電文TOM ------
<sub type="TOM">
TXFORM=L2917
#OOClCode1
#OOClCode2
#OOClNo
#OOBdLocation
#OOClLandSeq
#OOLandLocation
^
<include src="COM.icf::TRCTL.tom"/>
<include src="ROM.icf::L1R09.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
</sub>

<sub type="PART" name="L2917" layout="cols=1;screen.width=[130,870];printer.width=[15,30]">
[
["[L2917]                                 刪除擔保品建物下土地資料（轉換資料）"],
["戶號",#OCustNo,#OCustName],
]
</sub>
!---------- 單據輸出組合 ----------
<sub type="SELECT">

#batch-print=1,L2917.PFNX,NA,,,,,,1169:827
^
#RPTFG=0,QUERY.GRID,L2917
#any={detail:true, header:'L2917.part', caption:'[L2917]刪除擔保品建物下土地資料', width:1000, rowNum:20, rowList:[20,40,60],
ifxBatch:{
	name:'刪除',
	type:'5',
	rim:'L2416',
	txtno:'#secret-no',
	pfnx:"L2917.PFNX",
	col_captions:["擔保品","土地序號","處理結果"],
	col_names:["#OOCl","#OOClLandSeq","#batch-row-status"]
	}
}

#secret-no
#batch-row-status

#OOCl=擔保品號碼
{width:100,align:'center'}
#OOBdLocation=建物門牌
{width:300}
#OOClLandSeq=土地序號
{width:80,align:'center'}
#OOLandLocation=土地坐落
{width:300}

^
</sub>
