----- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">

!#TXCD
!T(3,L2010)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,0)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,47)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,20)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
K(MODIFYBUTTON,查詢)

! #FirstIn=A,1,S
! HIDE(#BTN1)
! E(0,1)
! T(3,@FdRptFg,*)

#BTNADDBUF=X,18,S
T(2,1+#CustId+0000000)

!L2111 案件申請登錄
#BtnAddA=x,100,S
T(2,{cmd=CHAIN; ntxcd=L2111; ntxbuf=#BTNADDBUF; ntxbuf5=type})
ASGN(BTN_NEW1$)
K(MODIFYBUTTON,1,新增)
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[200,1000];printer.width=[20,20];">
[
["[L2010]                                 申請案件明細資料查詢"],
["#FdMain+查詢條件","@(統一編號、申請號碼查詢起號、團體戶統編，需擇一輸入)"],
["#FdCustId+統一編號",#CustId,#CustIdX],
["#FdApplNo+申請號碼查詢起號",#ApplNo],
["#FdGroupId+團體戶統編",#GroupId,#GroupIdX],
["#FdProcessCode+處理情形",#ProcessCode,#ProcessCodeX],
]
!---------- AP Button AREA ----------
![Buttom資料查詢]
! #BTN1=X,15,I,ui:button;value:新增案件申請;enable:1;tabbable:0;title:L2111 案件申請登錄

#FdMain=X,2,L
T(3,*)

!---------- AP TEXT AREA Variables ----------
<include src="HELPRIM.icf::HELPRIM.rtn"/>
#CHAIN=A,1,S
T(4,CHAIN$)

#NTXBUF=X,18,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)

#NTXBUF5=X,10,S
C(3,#CHAIN,1,T(4,NTXBUF5$),S)
C(4,#NTXBUF5,E(0,@RPTFG2,1),E(0,@RPTFG2,2))


#RimTxCode=X,5,S
T(2,#TXCD)

#RimCustId=X,10,S

#RimCustNo=A,7,S

#RimCurrencyCode=X,3,S

#RimRateCode=X,2,S

#RimEffectDate=9,7,S

#RimEffectTime=9,4,S

![統一編號]
!申請號碼查詢起號或統一編號擇一輸入
#FdCustId=X,2,L

#CDDEF01=x,26,S
T(3,CdCode.ApplProcessCode)

#ProcessCodeHelp=x,1024,S

#CDDEF02=x,26,S
T(3,CdCode.CurrPrecision)

#CurrPrecisionHelp=x,1024,S

!FacmAcctCode 核准科目
#CDDEF03=x,25,S
T(3,CdCode.FacmAcctCode)

#FacmAcctCodeHelp=x,1024,S

#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#CDDEF01,#CDDEF02,#CDDEF03)
R(1,XXR99)
CALL(#HelpProc)
T(2,@ProcessCodeHelp,#HelpDesc1)
T(2,@CurrPrecisionHelp,#HelpDesc2)
T(2,@FacmAcctCodeHelp,#HelpDesc3)

#CustId=X,10,I
C(3,#CHAIN,1,T(1,#NTXBUF,8,10),$)
C(4,#CustId,$,s)
! C(3,#FirstIn,1,S,$)
!INVOKEJS(SHOW,p1,1,2,1)

#WKBTN1=X,1,S
C(3,#CHAIN,1,S,$)
! C(3,#FirstIn,1,S,$)
!C(4,#CustId,INVOKEJS(SHOW,p1,1,1,0),INVOKEJS(SHOW,p1,2,2,0))

#BUF1=X,18,S
!C(4,#CustId,HIDE(#BTN1),SHOW(#BTN1))
T(2,@BTNADDBUF,1+#CustId+0000000)

!L2111 案件申請登錄
#BtnAddB=x,100,S
T(2,{cmd=CHAIN; ntxcd=L2111; ntxbuf=#BTNADDBUF; ntxbuf5=type})
ASGN(BTN_NEW1$)
K(MODIFYBUTTON,1,新增)

#CustIdCheck=X,1,S
@
T(3,#CustIdX,)
A(ID_UNINO,0,#CustId)

!#BIND1=X,1,S
!BIND(#BTN1,click, {cmd=CHAIN; ntxcd=L2111; ntxbuf=#BUF1})

#CustNo=A,7,S

#SendL2r07=X,1,S
C(4,#CustId,S,$)
T(2,@RimCustId,#CustId)
E(0,@RimCustNo,#CustNo)
RESET_RIM(#SEND_L2R07,L2R07)
S(L2R07,1,#RimTxCode,#RimCustId,#RimCustNo)
R(1,L2R07)

#CustIdX=X,100,L
C(4,#CustId,S,$)
T(2,#L2r07CustName)

![申請號碼查詢起號]
#FdApplNo=X,2,L

#WkDate=D,7,S
E(0,#SYSDATE)

#SysYy=A,2,S
T(1,#WkDate,2,2)

#ApplNo=A,7,I
C(4,#CustId,$,S)
T(3,#GroupId,)
T(3,#GroupIdX,)
C(3,#CHAIN,1,T(1,#NTXBUF,1,7),$)
IF(#CustId ==  "" && #ApplNo == 0,$,s)

#FdGroupId=X,2,L
IF(#CustId ==  "" && #ApplNo == 0,T(3,*),T(3, ))

#GroupId=X,10,I
IF(#CustId ==  "" && #ApplNo == 0,$,S)
@V(7)
T(3,#GroupIdX,)
A(ID_UNINO,0,#GroupId)

#RcvL2r07B=X,1,S
C(4,#GroupId,S,$)
T(2,@RimCustId,#GroupId)
E(0,@RimCustNo,0)
RESET_RIM(#RcvL2r07B,L2R07)
S(L2R07,1,#RimTxCode,#RimCustId,#RimCustNo)
R(1,L2R07)
T(2,@GroupIdX,#L2r07CustName)

#GroupIdX=X,100,L

![處理情形]
#FdProcessCode=X,2,L
T(3,*)

#ProcessCodeHelpX=X,2048,S
T(2,#ProcessCodeHelp+;9:全部)

#ProcessCode=X,1,I
C(3,#CHAIN,1,T(1,#NTXBUF,18,1),$)
C(4,#ProcessCode,$,s)
HELP(#ProcessCodeHelpX)
E(0,9)
! C(3,#FirstIn,1,s,$)
@V(H,#ProcessCodeHelpX)

#ProcessCodeX=X,10,L
T(H,#ProcessCode,#ProcessCodeHelpX)
! C(3,#FirstIn,1,E(0,@CHAIN,1),$)
! E(0,@FirstIn,0)

#FdRptFg=X,2,L
T(3,*)

#RPTFG=A,1,S
E(0,0)

#RPTFG2=A,1,S
C(3,#RPTFG,0,$,S)
C(4,#NTXBUF5,T(3,1),T(3,2))

#CHAINXMT=X,1,S
C(3,#CHAIN,1,E(0,@CHAIN,0)XMT(),$)


#Return=A,1,S
E(0,0)

![折返KEY]
#ReturnText=X,17,S

<include src="ROM.icf::L2R07.dec"/>
</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>


!---------- TXFORM = L2010 ----------
<sub type="FORM" name="L2010">

!#SCRPRT=_,_,S
!C(5,#TXFORM,L2010,$,S)

#SCRTIL=_,_,S
T(3,[L2010] 申請案件明細資料)

#OApplNo=A,7,L
E(0,#ApplNo)

#OCustId=X,10,L
T(2,#CustId)

#OCustIdX=X,100,L
T(2,#CustIdX)

#OProcessCode=A,1,S
E(0,#ProcessCode)

#OProcessCodeX=X,10,L
T(2,#ProcessCodeX)

!修改
#Func2=A,1,S
E(0,2)

!複製
#Func3=A,1,S
E(0,3)

!刪除
#Func4=A,1,S
E(0,4)

!查1
#Func5=A,1,S
E(0,5)

!准
#Func6=A,1,S
E(0,6)

!駁
#Func7=A,1,S
E(0,7)

!查2
#Func8=A,1,S
E(0,5)
!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------
#LOOP=X,1,S
T(3,1)ASGN(LOOP$)

#OOApplNo=A,7,O

#OOCustId=X,10,S

#OOApplDate=D,7,O

#OOCurrencyCode=X,3,O

#Precision=N,1,S
T(H,#OOCurrencyCode,#CurrPrecisionHelp)

#OOApplAmt=m,14.2,L

#OOApplAmtX=X,21,S
X(#OOApplAmt)

#OOProcessCode=A,1,S

#OOProcessCodeX=X,10,O
T(H,#OOProcessCode,#ProcessCodeHelp)
!T(A,#OOProcessCode,L2DEF,ProcessCodeDef,ProcessCode,ProcessCodeX)

#OOAcctCode=A,3,S

#OOAcctCodeX=X,20,O
C(3,#OOAcctCode,0,S,$)
T(H,#OOAcctCode,#FacmAcctCodeHelp)
! T(A,#OOAcctCode,L2DEF,FacmAcctCodeDef,FacmAcctCode,FacmAcctCodeX)

#OOGroupId=X,10,L

!修改
#OOBUF2=X,18,S
T(2,#Func2+#OOCustId+#OOApplNo)

#OOBTN2=X,1,S
BIND(grid,{ cmd=CHAIN; ntxcd=L2111; ntxbuf=#OOBUF2})

!複製
#OOBUF3=X,18,S
T(2,#Func3+#OOCustId+#OOApplNo)

#OOBTN3=X,1,S
BIND(grid,{ cmd=CHAIN; ntxcd=L2111; ntxbuf=#OOBUF3})

!刪除,已作過准駁處理之案件不可刪除
#OOBUF4=X,18,S
T(2,#Func4+#OOCustId+#OOApplNo)

#OOBTN4=X,1,S
C(3,#OOProcessCode,0,BIND(grid,{ cmd=CHAIN; ntxcd=L2111; ntxbuf=#OOBUF4}),BIND(grid,cancel))

!案件查詢
#OOBUF5=X,18,S
T(2,#Func5+#OOCustId+#OOApplNo)

#OOBTN5=X,1,S
BIND(grid,{ cmd=CHAIN; ntxcd=L2111; ntxbuf=#OOBUF5})

!准
#OOBUF6=X,18,S
T(2,#Func6+#OOCustId+#OOApplNo)

#OOBTN6=X,1,S
C(3,#OOProcessCode,0,BIND(grid,{ cmd=CHAIN; ntxcd=L2153; ntxbuf=#OOBUF6}),BIND(grid,cancel))

!駁
#OOBUF7=X,8,S
T(2,#Func7+#OOApplNo)

#OOBTN7=X,1,S
C(3,#OOProcessCode,0,BIND(grid,{ cmd=CHAIN; ntxcd=L2151; ntxbuf=#OOBUF7}),BIND(grid,cancel))

!准駁查詢
#OOBUF8=X,8,S
T(2,#Func8+#OOApplNo)

#OOBTN8=X,1,S
BIND(grid,{ cmd=CHAIN; ntxcd=L2151; ntxbuf=#OOBUF8})
</sub>


!------ 上行電文 ------
<sub type="TIM">

#ApplNo#CustId#GroupId#ProcessCode#Return#END#ReturnText

</sub>


!------ 下行電文TOM ------
<sub type="TOM">

TXFORM=L2010
#OOApplNo
#OOCustId
#OOApplDate
#OOCurrencyCode
#OOApplAmt
#OOProcessCode
#OOAcctCode
#OOGroupId
^
<include src="COM.icf::TRCTL.tom"/>
<include src="ROM.icf::L2R07.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
</sub>

<sub type="PART" name="L2010" layout="cols=1;screen.width=[150,850];printer.width=[15,30,15,30];order=1">
[
["[L2010]                                 申請案件明細資料查詢"],
[""],
!["@統一編號",#OCustId,#OCustIdX],
!["@申請號碼查詢起號",#OApplNo],
!["@處理情形",#OProcessCodeX],
]
</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">

#RPTFG2=1,QUERY.GRID,L2010
#any={detail:true, header:'L2010.part', caption:'', width:1100, rowNum:20, rowList:[20,40,60]}
#OOBTN2=修改
{width:50,search:false,formatter:'cust:bind-button:修改;L2111 案件申請登錄',align:'center',canExport:false}

#OOBTN3=複製
{width:50,search:false,formatter:'cust:bind-button:複製;L2111 案件申請登錄',align:'center',canExport:false}

#OOBTN4=刪除
{width:50,search:false,formatter:'cust:bind-button:刪除;L2111 案件申請登錄',align:'center',canExport:false}

#OOBTN5=案件查詢
{width:80,search:false,formatter:'cust:bind-button:案件查詢;L2111 案件申請登錄',align:'center',canExport:false}

#OOBTN6=核准
{width:50,search:false,formatter:'cust:bind-button:核准;L2153 核准額度登錄',align:'center',canExport:false}

#OOBTN7=駁回
{width:50,search:false,formatter:'cust:bind-button:駁回;L2151 駁回額度登錄',align:'center',canExport:false}

#OOBTN8=准駁查詢
{width:80,search:false,formatter:'cust:bind-button:准駁查詢;L2151 駁回額度登錄',align:'center',canExport:false}

#OOApplNo=申請號碼
{width:80,align:'center'}

#OOApplDate=申請日期
{width:80,align:'center'}

#OOCurrencyCode=幣別
{width:50,align:'center'}

#OOApplAmtX=申請金額
{width:120,align:'right'}

#OOProcessCodeX=處理</br>情形
{width:60,align:'center'}

#OOAcctCodeX=業務科目
{width:100,align:'center'}

#OOGroupId=團體戶</br>統編
{width:80,align:'center'}
^
#RPTFG2=2,QUERY.GRID,L2010
#any={detail:true, header:'L2010.part', caption:'', width:1100, rowNum:20, rowList:[20,40,60]}

#OOApplNo=申請號碼
{width:80,align:'center'}

#OOApplDate=申請日期
{width:80,align:'center'}

#OOCurrencyCode=幣別
{width:50,align:'center'}

#OOApplAmtX=申請金額
{width:120,align:'right'}

#OOProcessCodeX=處理</br>情形
{width:60,align:'center'}

#OOAcctCodeX=業務科目
{width:100,align:'center'}

#OOGroupId=團體戶</br>統編
{width:80,align:'center'}
^

<include src="PRT.icf::INQ01.sel" map="i=L2010;cpi=15"/>
#OApplNo#OCustId#OCustIdX#OProcessCodeX
%
#OOApplNo#OOApplDate#OOCurrencyCode#OOApplAmtX#OOProcessCodeX#OOAcctCodeX
@^
</sub>
