----- BASIC LABEL Variables ----------
<sub type="SYS">
#KeyInq=X,1,S
K(MODIFYBUTTON,查詢)
</sub>

<sub type="SYS" name="label">

!#TXCD
!T(3,L2049)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,0)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,187)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,20)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)

</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[130,870];printer.width=[20,20];">
[
["[L2049]                                 擔保品關聯設定明細資料查詢"],
["#FdClCode1+擔保品號碼",#ClCode1,"@-@",#ClCode2,"@-@",#ClNo],
["#FdCustId+借款人統編",#CustId],
["#FdCustNo+借戶戶號",#CustNo],
["#FdFacmNo+額度號碼",#FacmNo],
["#FdClMainType+擔保品大類",#ClMainType,#ClMainTypeX],
["#FdClTypeCode+擔保品類別",#ClTypeCode,#ClTypeCodeX],
["#FdApplNo+核准號碼",#ApplNo],
["#FdSettingStat+設定狀態",#SettingStat,#SettingStatX],
["#FdClStat+擔保品狀態",#ClStat,#ClStatX],
]

#FdClCode1=X,2,L
#FdCustId=X,2,L
#FdCustNo=X,2,L
#FdClMainType=X,2,L
#FdClTypeCode=X,2,L
#FdFacmNo=X,2,L
#FdApplNo=X,2,L
#FdSettingStat=X,2,L
#FdClStat=X,2,L

!---------- AP Button AREA ----------
<include src="HELPRIM.icf::HELPRIM.rtn"/>

! [擔保品編號-代號1]
#CDDEF01=x,20,S
T(3,CdCode.ClCode1)

#ClCode1Help=x,1024,S

#CDDEF02=x,20,S
T(3,CdCode.ClMainType)

#ClMainTypeHelp=X,1024,S

#CDDEF03=x,30,S
T(3,CdCode.SettingStatCode)

#OSettingStatHelp=X,1024,S

#CDDEF04=x,20,S
T(3,CdCode.ClStatCode)

#ClStatHelp=X,1024,S 

#CDDEF05=x,20,S
T(3,CdCode.ClCode21)

#ClCode21Help=x,1024,S

#CDDEF06=x,20,S
T(3,CdCode.ClCode22)

#ClCode22Help=x,1024,S

#CDDEF07=x,20,S
T(3,CdCode.ClCode23)

#ClCode23Help=x,1024,S

#CDDEF08=x,20,S
T(3,CdCode.ClCode24)

#ClCode24Help=x,1024,S

#CDDEF09=x,20,S
T(3,CdCode.ClCode25)

#ClCode25Help=x,1024,S

#CDDEF10=x,20,S
T(3,CdCode.ClCode29)

#ClCode29Help=x,1024,S

#CDDEF11=x,20,S
T(3,CdCode.ClTypeCode1)

#ClTypeCode1Help=X,1024,S

#CDDEF12=x,20,S
T(3,CdCode.ClTypeCode2)

#ClTypeCode2Help=X,1024,S

#CDDEF13=x,20,S
T(3,CdCode.ClTypeCode3)

#ClTypeCode3Help=X,1024,S

#CDDEF14=x,20,S
T(3,CdCode.ClTypeCode4)

#ClTypeCode4Help=X,1024,S

#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#CDDEF01,#CDDEF02,#CDDEF03,#CDDEF04,#CDDEF05,#CDDEF06,#CDDEF07,#CDDEF08,#CDDEF09,#CDDEF10)
R(1,XXR99)
CALL(#HelpProc)
T(2,@ClCode1Help,#HelpDesc1) 
T(2,@ClMainTypeHelp, :查詢全部;+#HelpDesc2)
T(2,@OSettingStatHelp,#HelpDesc3)
T(2,@ClStatHelp, :查詢全部;+#HelpDesc4)
T(2,@ClCode21Help,#HelpDesc5) 
T(2,@ClCode22Help,#HelpDesc6) 
T(2,@ClCode23Help,#HelpDesc7) 
T(2,@ClCode24Help,#HelpDesc8) 
T(2,@ClCode25Help,#HelpDesc9) 
T(2,@ClCode29Help,#HelpDesc10) 

#HelpRim2=X,1,S
RESET_RIM(#HelpRim2,XXR99)
S(XXR99,01,#CDDEF11,#CDDEF12,#CDDEF13,#CDDEF14)
R(1,XXR99)
CALL(#HelpProc) 
T(2,@ClTypeCode1Help,#HelpDesc1) 
T(2,@ClTypeCode2Help,#HelpDesc2) 
T(2,@ClTypeCode3Help,#HelpDesc3) 
T(2,@ClTypeCode4Help,#HelpDesc4) 

#SettingStatHelp=X,1024,S
T(2, :查詢全部;0:未設定;+#OSettingStatHelp)


![Buttom資料查詢]
#BUF1=X,42,S
!---------- AP TEXT AREA Variables ----------
#CHAIN=A,1,S
T(4,CHAIN$)


!擔保品代號1
#ClCode1=X,1,I
T(F,#ClMainType,1)
HELP(#ClCode1Help)
@C(4,#ClCode1,S,$)
V(H,#ClCode1Help)
IF(#ClCode1 > 0,T(F,#ClMainType,0),T(F,#ClMainType,1))
IF(#ClCode1 > 0,$,s)
SWITCH(#ClCode1,1,E(0,@ClMainType,1),
                2,E(0,@ClMainType,1),
                3,E(0,@ClMainType,3),
                4,E(0,@ClMainType,3),
                5,E(0,@ClMainType,4),
                9,E(0,@ClMainType,2),
                ,E(0,@ClMainType,)))
               
!擔保品代號2
#ClCode2Help=x,1024,S
SWITCH(#ClCode1,1,T(2,#ClCode21Help),
                2,T(2,#ClCode22Help),
                3,T(2,#ClCode23Help),
                4,T(2,#ClCode24Help),
                5,T(2,#ClCode25Help),
                9,T(2,#ClCode29Help))


#ClCode2=A,2,I
SWITCH(#ClCode1,1,HELP(#ClCode2Help),
                2,HELP(#ClCode2Help),
                3,E(0,1)HELP(#ClCode2Help),
                4,E(0,1)HELP(#ClCode2Help),
                5,E(0,1)HELP(#ClCode2Help),
                9,HELP(#ClCode2Help))
@C(3,#ClCode2,0,S,$)
V(H,#ClCode2Help)

!擔保品號碼
#ClNo=A,7,I
@C(3,#ClNo,0,S,$)

!借款人統編
#CustId=X,10,I
@C(4,#CustId,S,$)
A(ID_UNINO,1,#CustId)

!借戶戶號
#CustNo=A,7,I
@C(3,#CustNo,0,S,$)

!額度號碼

#FacmNo=A,3,I
C(3,#CustNo,0,S,$)
@C(3,#FacmNo,0,S,$)

!擔保品大類
#ClMainType=X,1,I
IF(#ClCode1 > 0,s,$)
HELP(#ClMainTypeHelp)
E(0,1)
@C(4,#ClMainType,S,$)
V(H,#ClMainTypeHelp)

#ClMainTypeX=X,10,L
T(H,#ClMainType,#ClMainTypeHelp)

!擔保品類別

#CDDEFClTypeCode=x,20,S

#ClTypeCodeHelpRim=X,1,S
C(4,#CDDEFClTypeCode,S,$)
RESET_RIM(#ClTypeCodeHelpRim,XXR99)
S(XXR99,01,#CDDEFClTypeCode)
R(1,XXR99)
CALL(#HelpProc)
T(2,@ClTypeCodeHelp,#HelpDesc1)

#ClTypeCodeHelp=X,1024,S
SWITCH(#ClMainType,1,T(2,#ClTypeCode1Help),
                   2,T(2,#ClTypeCode2Help),
                   3,T(2,#ClTypeCode3Help),
                   4,T(2,#ClTypeCode4Help))

#ClTypeCode=X,3,I
C(4,#ClMainType,S,$)
HELP(#ClTypeCodeHelp)
@C(4,#ClTypeCode,S,$)
V(H,#ClTypeCodeHelp)

#ClTypeCodeX=X,100,L
C(3,#ClMainType,S,$)
T(H,#ClTypeCode,#ClTypeCodeHelp)


!身分證找戶號
<include src="ROM.icf::L2R47.dec"/>
#Rim2R47CustId=X,10,S

#RimL2R47=X,1,S
T(2,@Rim2R47CustId,#CustId)
RESET_RIM(#RimL2R47,L2R47)
C(4,#CustId,s,$)
S(L2R47,1,#Rim2R47CustId)
R(1,L2R47)


!戶號有輸入，塞戶號
#CCusNo=A,7,S
IF(#CustNo==0,T(2,#L2R47CustNo),T(2,#CustNo))

!如都沒輸入清空跳過
#MRKEY=_,_,S
IF(#CustId=="" && #CustNo==0,S,$)
C(3,#FacmNo,0,T(2,#CCusNo),T(2,#CCusNo+-+#FacmNo))


!核准號碼
#ApplNo=A,7,I
@C(3,#ApplNo,0,S,$)

!設定狀態
#SettingStat=X,1,I
HELP(#SettingStatHelp)
@V(H,#SettingStatHelp)


#SettingStatX=X,10,L
T(H,#SettingStat,#SettingStatHelp)

!擔保品狀態

#ClStat=X,1,I
HELP(#ClStatHelp)
@V(H,#ClStatHelp)


#ClStatX=X,10,L
T(H,#ClStat,#ClStatHelp)

#RPTFG=A,1,S
</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>


!---------- TXFORM = L2049 ----------
<sub type="FORM" name="L2049">

!#SCRPRT=_,_,S
!C(5,#TXFORM,L2049,$,S)

#SCRTIL=_,_,S
T(3,[L2049] 擔保品關聯設定明細資料)

!額
#FUNC5=A,1,S
E(0,5)

!------ TOM(HEAD)   Variables (FOR OUTPUT SCREEN) ------
!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------
#LOOP=X,1,S
T(3,1)ASGN(LOOP$)

#OOCustNo=A,7,L

#OOCustId=X,10,L

#OOCustName=X,100,L

#OOFacmNo=A,3,L

#OOApproveNo=A,7,L

#OOLineAmt=m,14,L

#OOClCode1=A,1,S
#OOClCode2=A,2,S
#OOClNo=A,7,S

#OOClTypeCode=X,3,L

#OOCl=X,12,L
T(2,#OOClCode1+-+#OOClCode2+-+#OOClNo)

#OOSettingSeq=A,1,L

#OOSettingDate=D,7,L

#OOSettingAmt=m,14,L

#OOSettingStat=X,4,S

#OOSettingStatX=X,4,L
C(4,#OOSettingStat,S,$)
T(H,#OOSettingStat,#OSettingStatHelp)

#OOClaimDate=D,7,L

!額
#OOBUF5=X,18,S
T(2,5+#OOCustNo+#OOFacmNo)

#OOBTN5=X,1,S
BIND(grid,{ cmd=CHAIN; ntxcd=L2154; ntxbuf=#OOBUF5})

!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------

</sub>

!------ 上行電文 ------
<sub type="TIM">
#ClCode1
#ClCode2
#ClNo
#CustId
#CustNo
#ClMainType
#ClTypeCode
#FacmNo
#ApplNo
#SettingStat
#ClStat
#END
</sub>


!------ 下行電文TOM ------
<sub type="TOM">
TXFORM=L2049

#OOCustNo
#OOCustId
#OOCustName
#OOFacmNo
#OOApproveNo
#OOLineAmt
#OOClCode1
#OOClCode2
#OOClNo
#OOClTypeCode
#OOSettingSeq
#OOSettingDate
#OOSettingAmt
#OOSettingStat
#OOClaimDate

^

<include src="COM.icf::TRCTL.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
<include src="ROM.icf::L2R47.tom"/>

</sub>

<sub type="PART" name="L2049" layout="cols=1;screen.width=[130,870];printer.width=[15,30]">
[
["[L2049]                                 擔保品關聯設定明細資料查詢"],
[""],
]
</sub>
!---------- 單據輸出組合 ----------
<sub type="SELECT">

#RPTFG=0,QUERY.GRID,L2049
#any={detail:true, header:'L2049.part', caption:'', width:1000, rowNum:20, rowList:[20,40,60]}

#OOBTN5=額度
{width:50,search:false,formatter:'cust:bind-button:額度',align:'center',canExport:false}

#OOCustNo=借戶戶號
{width:100,align:'center'}

#OOCustId=借款人統編
{width:100,align:'center'}

#OOCustName=戶名
{width:80,align:'center'}

#OOFacmNo=額度號碼
{width:80,align:'center'}

#OOApproveNo=核准號碼
{width:80,align:'center'}

#OOLineAmt=核准額度
{width:120,align:'center'}

#OOCl=擔保品編號
{width:100,align:'center'}

#OOClTypeCode=擔保品類別
{width:100,align:'center'}

#OOSettingSeq=設定順位
{width:80,align:'center'}

#OOSettingDate=設定日期
{width:80,align:'center'}

#OOSettingAmt=設定金額
{width:120,align:'center'}

#OOSettingStatX=設定狀態
{width:80,align:'center'}

#OOClaimDate=擔保債權確定日
{width:120,align:'center'}


^

<include src="PRT.icf::INQ01.sel" map="i=L2049;cpi=15"/>


</sub>
