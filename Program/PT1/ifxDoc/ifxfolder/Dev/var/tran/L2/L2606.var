----- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">

!#TXCD
!T(3,L2606)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,57)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,0)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,20)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
T(2,@RimTxCode,#TXCD)

</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[150,1000];printer.width=[20,20];">
[
["[L2606]                                 帳管費維護"],
["#FdFunCd+功能",#FunCdX],
["#FdCustNo+借戶戶號",#CustNo,#BTN1,#CustName],
["#FdFacmNo+額度編號",#FacmNo],
["#FdOpenAcDate+起帳日期",#OpenAcDate],
["#FdCurrencyInd+幣別",#CurrencyCode],
["#FdAcctFee+帳管費",#TwAcctFee,#UsAcctFee],
["#FdRvNo+銷帳編號",#RvNo],
["#FdSlipNote+備註",#SlipNote],
["#FdAcctDate+會計日期",#AcDate],
["#FdTlrNo+經辦",#TlrNo,#EmpName],
["#FdTxtNo+交易序號",#TxtNo],
["#FdCreateDate+作業日期",#CreateDate],
["#FdCreateTime+作業時間",#CreateTime],

]
!---------- AP Button AREA ----------   
![Buttom資料查詢]

#BTN1=X,15,I,ui:button;value:顧客資料查詢;enable:1;tabbable:0

! 永遠為必輸欄位
#FdFunCd=X,2,L
T(3,*)
#FdCustNo=X,2,L
T(3,*)
#FdFacmNo=X,2,L
T(3,*)
#FdRvNo=X,2,L
#FdOpenAcDate=X,2,L
T(3,*)
! 必輸欄位
#FdCurrencyInd=X,2,L
#FdAcctFee=X,2,L
#FdSlipNote=X,2,L
#FdAcctDate=X,2,L
#FdTxtNo=X,2,L
#FdTlrNo=X,2,L
#FdCreateDate=X,2,L
#FdCreateTime=X,2,L

!---------- AP TEXT AREA Variables ----------
! Help
<include src="HELPRIM.icf::HELPRIM.rtn"/>
!調RIM
<include src="ROM.icf::L2Rim.dec"/>
<include src="ROM.icf::L1R01.dec"/>
<include src="ROM.icf::L2R05.dec"/>
<include src="ROM.icf::L0Rim.dec"/>

#SetSysPar=X,1,S
E(0,1)ASGN(AGAIN$)

#CDDEF0001=x,26,S
T(3,CdCode.CurrPrecision)

#CurrPrecisionHelp=x,1024,S

#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#CDDEF0001)
R(1,XXR99)
CALL(#HelpProc)
T(2,@CurrPrecisionHelp,#HelpDesc1)


#FunCdHelp=x,60,S
T(3,1:新增;2:修改;4:刪除;5:查詢)

#CHAIN=A,1,S
T(4,CHAIN$)
T(3,@CurrencyCode,TWD)
C(3,#CHAIN,1,$,V(P,此為連動交易，請從交易:[帳管費明細資料查詢]進入))

#init=X,1,S
HIDE(#UsAcctFee)

#NTXBUF=X,40,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
T(1,@FunCd,#NTXBUF,1,1)
E(0,@FUNCIND,#FunCd)
C(3,#FunCd,1,E(0,@CHAIN,0),$)
C(3,#FunCd,1,s,$)
T(1,@CustNo,#NTXBUF,2,7)
T(1,@FacmNo,#NTXBUF,9,3)
T(1,@RvNo,#NTXBUF,12,15)

![功能] 
!下拉式選單 1.新增  2.修改  4.刪除  5.查詢 
#FunCd=A,1,S

#SetSysPar1=X,1,S
C(3,#FunCd,1,E(0,0)ASGN(AGAIN$),$)

#FunCdX=X,6,L
C(4,#FunCd,S,$)
T(H,#FunCd,#FunCdHelp)
C(2,#FunCd,$,K(MODIFYBUTTON,新增),K(MODIFYBUTTON,修改),K(MODIFYBUTTON,新增),K(MODIFYBUTTON,刪除),K(MODIFYBUTTON,查詢)K(NOBUTTON,CLOSEY),$)

#ShowFd=X,1,S
C(2,#FunCd,T(3, ),T(3,*),T(3,),T(3,*),T(3, ),T(3, ))
T(2,@FdFunCd,#ShowFd)     
T(2,@FdCustNo,#ShowFd)
T(2,@FdFacmNo,#ShowFd)
T(2,@FdOpenAcDate,#ShowFd)


#WKSPC=X,2,S

#WKSTAR=X,2,S
C(2,#FunCd,S,T(3,*),T(3,*),S,T(3, ),T(3, ))

#WKSTAR2=X,2,S
C(3,#FunCd,2,T(3,*),T(3, ))

#WKFDNAME=X,1,S
T(2,@FdCurrencyInd,#WKSPC)
T(2,@FdAcctFee,#WKSTAR)
T(2,@FdAcctDate,#WKSPC)
T(2,@FdTxtNo,#WKSPC)
T(2,@FdTlrNo,#WKSPC)
T(2,@FdCreateDate,#WKSPC)
T(2,@FdCreateTime,#WKSPC)

#WKTF=X,1,S
IF (#FunCd==4 || #FunCd==5,T(F,#FacmNo,0)T(F,#OpenAcDate,0)
                           T(F,#CurrencyCode,0)T(F,#TwAcctFee,0)
                           T(F,#UsAcctFee,0)T(F,#AcDate,0)T(F,#TxtNo,0)T(F,#TlrNo,0)T(F,#CreateDate,0)T(F,#CustNo,0)T(F,#SlipNote,0)HIDE(#BTN1),$)
IF (#FunCd==2 ,HIDE(#BTN1)T(F,#CustNo,0)T(F,#FacmNo,0)T(F,#OpenAcDate,0),$)

#BUF1=X,18,S

#BIND1=X,1,S
BIND(#BTN1,click, {cmd=CHAIN; ntxcd=L1001; ntxbuf=#BUF1;ntxbuf5=type<-1:CustNo<-OOCustNo:CustName<-OOCustName})

![借戶戶號]
!必須輸入
#CustNo=A,7,I
C(3,#CHAIN,1,s,$)
@V(2,0)

#TimCustNo=A,7,S
C(3,#CustNo,0,$,E(0,#CustNo))
T(2,@RmkCustNo,#TimCustNo)
<include src="COM.icf::CustRmk.rtn"/>

!調RIML1R01取CustName
#RimL1r01=X,1,S
E(0,@RimFunCd,5)
E(0,@RimCustNo,#CustNo)
RESET_RIM(#RimL1r01,L1R01)
S(L1R01,1,#RimCustId,#RimFunCd,#RimCustNo)
R(1,L1R01)
T(2,@CustName,#L1r01CustName)

#CustName=X,100,L

!額度編號 
!必須輸入
#FacmNo=A,3,I
C(3,#CHAIN,1,s,$)
@V(2,0)

!檢查額度是否可用
#SendL2r05=X,1,S
IF(#FKEY==0 || #FKEY==7,$,s)
E(0,@RimFuncCode,5)
E(0,@RimCustNo,#CustNo)
E(0,@RimFacmNo,#FacmNo)
E(0,@RimApplNo,0)
E(0,@RimCaseNo,0)
S(L2R05,1,#RimFuncCode,#RimTxCode,#RimFKey,#RimCustNo,#RimFacmNo,#RimApplNo,#RimCaseNo)
R(1,L2R05)

#MRKEY=_,_,S
T(2,#TimCustNo+-+#FacmNo)

#RvNo=X,15,L

#RimAcctCode=X,3,S
#RimRvNo=X,15,S
!查詢會計銷帳檔
#RimL2R59=X,1,S
E(0,@RimFunCd,#FunCd)
T(2,@RimAcctCode,F10)
E(0,@RimCustNo,#CustNo)
E(0,@RimFacmNo,#FacmNo)
T(2,@RimRvNo,#RvNo)
S(L2R59,1,#RimFunCd,#RimAcctCode,#RimCustNo,#RimFacmNo,#RimRvNo)
R(1,L2R59)
E(0,@OpenAcDate,#L2r59OpenAcDate)
T(2,@CurrencyCode,#L2r59CurCode)
E(0,@TwAcctFee,#L2r59AcctFee)
E(0,@UsAcctFee,#L2r59AcctFee)
E(0,@TimAcctFee,#L2r59AcctFee)
T(2,@SlipNote,#L2r59SlipNote)
E(0,@AcDate,#L2r59AcDate)
T(2,@TlrNo,#L2r59TlrNo)
T(2,@TxtNo,#L2r59TxtNo)
E(0,@CreateDate,#L2r59CreateDate)
T(2,@CreateTime,#L2r59CreateTime)


![起帳日期] 預設會計日
!必須輸入
#SYSAcDate=D,7,S
E(0,#SYSDATE)

#OpenAcDate=D,7,I
C(3,#CHAIN,1,s,$)
C(3,#OpenAcDate,0,E(0,#SYSAcDate),$)
@A(DATE,0,#OpenAcDate)
V(7)



<include src="ROM.icf::L2R08.dec"/>
<include src="ROM.icf::L2R59.dec"/>
#SendL2r08B=X,1,S
C(3,#FunCd,1,s,$)
C(4,#TlrNo,s,$)
T(2,@RimEmployeeNo,#TlrNo)
T(3,@RimErrorSkip,Y)
S(L2R08,1,#RimTxCode,#RimEmployeeNo,#RimErrorSkip)
R(1,L2R08)
T(2,@EmpName,#L2r08FullName)

![幣別]
#CurrencyCode=X,3,L
C(3,#FunCd,1,s,$)
T(3,TWD)

#PRECISION=N,1,S
T(H,#CurrencyCode,#CurrPrecisionHelp)
C(3,#PRECISION,0,SHOW(#TwAcctFee)HIDE(#UsAcctFee),HIDE(#TwAcctFee)SHOW(#UsAcctFee))

![帳管費]
!新增、修改時必輸輸入,其他自動顯示不必輸入
#TwAcctFee=m,14,I
C(3,#PRECISION,0,$,s)
C(3,#FunCd,4,s,$)
C(3,#FunCd,5,s,$)
@V(2,0)

#UsAcctFee=m,14.2,I
C(3,#PRECISION,0,s,$)
C(3,#FunCd,4,s,$)
C(3,#FunCd,5,s,$)
@V(2,0)

#TimAcctFee=m,14.2,S
C(3,#PRECISION,0,E(0,#TwAcctFee),E(0,#UsAcctFee))

#SlipNote=X,60,I
C(3,#FunCd,4,s,$)
C(3,#FunCd,5,s,$)

![會計日期] 
!自動顯示不需輸入
#AcDate=D,7,L

![交易序號]
#TxtNo=A,8,L

![經辦編號]
#TlrNo=X,6,L


#EmpName=X,10,L


![作業日期]
#CreateDate=D,7,L

![作業時間]
#CreateTime=X,10,L


#RPTFG=X,1,S
E(0,0)


</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>


!---------- TXFORM = L2606 ----------
<sub type="FORM" name="L2606">

!#SCRPRT=_,_,S
!C(5,#TXFORM,L2606,$,S)

#SCRTIL=_,_,S
T(3,[L2606] 帳管費維護)



!------ TOM(HEAD)   Variables (FOR OUTPUT SCREEN) ------
#OCreateDate=D,7,S
C(3,#FunCd,4,S,$)
C(3,#FunCd,5,S,$)
E(0,@CreateDate,#OCreateDate)

#OAcDate=D,7,S
C(3,#FunCd,4,S,$)
C(3,#FunCd,5,S,$)
E(0,@AcDate,#OAcDate)


#OTitaTxtNo=A,8,S
C(3,#FunCd,4,S,$)
C(3,#FunCd,5,S,$)
E(0,@TxtNo,#OTitaTxtNo)



#OTlrNo=X,6,S
C(3,#FunCd,4,S,$)
C(3,#FunCd,5,S,$)
T(2,@TlrNo,#OTlrNo)

#OEmpName=X,10,S
C(3,#FunCd,4,S,$)
C(3,#FunCd,5,S,$)
T(2,@EmpName,#OEmpName)


#OCreateTime=X,10,S

#OTIME1=X,2,S
T(1,#OCreateTime,1,2)

#OTIME2=X,2,S
T(1,#OCreateTime,3,2)

#OTIME3=X,2,S
T(1,#OCreateTime,5,2)

#OCreateTimeX=X,10,S
C(3,#FunCd,4,S,$)
C(3,#FunCd,5,S,$)
T(2,#OTIME1+:+#OTIME2+:+#OTIME3)
T(2,@CreateTime,#OCreateTimeX)

#ORvNo=X,15,S
C(3,#FunCd,4,S,$)
C(3,#FunCd,5,S,$)
T(2,@RvNo,#ORvNo)



!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------

!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------

</sub>


!------ 上行電文 ------
<sub type="TIM">
#FunCd
#CustNo
#FacmNo
#OpenAcDate
#RvNo
#CurrencyCode
#TimAcctFee
#SlipNote
#AcDate
#TxtNo
#TlrNo
#CreateDate
#CreateTime
#END
#TwAcctFee#UsAcctFee
</sub>

!------ 下行電文TOM ------
<sub type="TOM">
TXFORM=L2606
#ORvNo
#OAcDate
#OTitaTxtNo
#OTlrNo
#OEmpName
#OCreateDate
#OCreateTime
^

<include src="COM.icf::TRCTL.tom"/>
<include src="ROM.icf::L2R59.tom"/>
<include src="ROM.icf::L1R01.tom"/>
<include src="ROM.icf::L2R05.tom"/>
<include src="ROM.icf::L2R08.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
</sub>


!---------- 單據輸出組合 ----------
<sub type="SELECT">

</sub>
