----- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">

#TXCD
T(3,L8921)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,0)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,255)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,20)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD2.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)

</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[150,850];printer.width=[20,20];">
[
["[L8921]                                 疑似洗錢樣態檢核查詢"],
["#FdAcDate+入帳日期",#AcDateStart,"~",#AcDateEnd],
["#FdFactor+交易樣態",#Factor,#FactorX],
]
!---------- AP Button AREA ----------
![Buttom資料查詢]
!#BUF1=X,42,S

#FdFactor1TotLimit=X,2,L
T(3, )
#FdFactor2Count=X,2,L
T(3, )
#FdFactor2AmtStart=X,2,L
T(3, )
#FdFactor3TotLimit=X,2,L
T(3, )
#FdAcDate=X,2,L
T(3,*)
#FdFactor=X,2,L
T(3,*)

#FdRPTFG=X,2,L

!---------- AP TEXT AREA Variables ----------
<include src="HELPRIM.icf::HELPRIM.rtn"/>

#CHAIN=A,1,S
T(4,CHAIN$)

#NTXBUF=X,32,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)

! 功能 (5: 查詢)
#FuncCode=A,1,S
E(0,5)
K(MODIFYBUTTON,查詢)

! 業務類型
#BusinessType=X,2,S
T(3,LN)


!本營業日
#DATE=D,8,S
T(4,DATE$)

#CDATE=D,8,S
T(4,CDATE$)

#LDATE1=D,8,S
C(3,#CHAIN,1,$,s)
T(1,@LDATE1,#NTXBUF,1,7)
E(0,@AcDateStart,#LDATE1)

#LDATE=D,8,S
T(4,LBSDY$)
C(3,#CHAIN,1,$,s)
T(1,@LDATE,#NTXBUF,8,7)
E(0,@AcDateEnd,#LDATE)


! 交易樣態(Factor)
#FactorHelpRim=X,1,S
RESET_RIM(#FactorHelpRim,XXR99)
S(XXR99,01,CdCode.Factor)
R(1,XXR99)
CALL(#HelpProc)
T(2,@FactorHelp,0:全部;+#HelpDesc1)
#FactorHelp=x,1024,S


!入帳日期起止
#AcDateStart=D,7,I
C(3,#CHAIN,0,E(0,#DATE),s)
D(8)	
@V(7)A(4,0,#AcDateStart)V(5,0010101,#CDATE)

#AcDateEnd=D,7,I
C(3,#CHAIN,0,E(0,#DATE),s)
D(8)
@V(7)A(4,0,#AcDateEnd)V(5,#AcDateStart,#CDATE)

!交易樣態
#Factor=A,1,I
C(3,#CHAIN,1,s,$)
HELP(#FactorHelp)
@T(3,@FactorX,)
@V(H,#FactorHelp)

#FactorX=X,6,L
T(H,#Factor,#FactorHelp)

#RPTFG=A,1,S
E(0,0)


<include src="ROM.icf::L0Rim.dec"/>
<include src="ROM.icf::L8R49.dec"/>
!<include src="COM.icf::RPTFG.dec"/>

#TXMT=A,1,S
C(3,#CHAIN,0,$,E(0,@CHAIN,0)XMT())

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!---------- TXFORM = L8921 ----------
<sub type="FORM" name="L8921">

!#SCRPRT=_,_,S
!C(5,#TXFORM,L8921,$,S)

#SCRTIL=_,_,S
T(3,[L8921] 疑似洗錢樣態檢核查詢)

!------ TOM(HEAD)   Variables (FOR OUTPUT SCREEN) ------
!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------
#LOOP=X,1,S
T(3,1)ASGN(LOOP$)

!戶號(TOTA)
#OOCustNo=A,7,S

!額度號碼(TOTA)
!#OOFacmNo=A,3,S

!撥款序號(TOTA)
!#OOBormNo=A,3,S

#OOCustNoX=X,7,L
T(2,#OOCustNo)

!產製日期
#OOCreateDate=X,9,L

!來源
#OORepayItem=X,10,L

!戶名(TOTA)
#OOCustName=x,200,L

!匯款摘要
#OODscptCode=X,20,L


!入帳日期(TOTA)
#OOEntryDate=D,7,L

!交易金額(TOTA)
#OOTxAmt=m,14.2,S
#OOTxAmt1=m,14,S
E(0,#OOTxAmt)
#OOTxAmtX=X,17,L
IF(#OOTxAmt1==0,S,$)
X(#OOTxAmt1)

!累計金額(TOTA)
#OOTotalAmt=m,14.2,S
#OOTotalAmt1=m,14,S
E(0,#OOTotalAmt)
#OOTotalAmtX=X,17,L
IF(#OOTotalAmt1==0,S,$)
X(#OOTotalAmt1)

!累計筆數
#OOTotalCnt=N,3,L

!交易樣態(TOTA)
#OOFactor=N,2,L

!統計期間起日
#OOStartEntryDate=D,7,L

!統計期間迄日
#OOEndEntryDate=D,7,L
!E(0,#OOEntryDate)

</sub>


!------ 上行電文 ------
<sub type="TIM">
#AcDateStart
#AcDateEnd
#Factor
#END
</sub>


!------ 下行電文TOM ------
<sub type="TOM">
TXFORM=L8921
#OOCustNo
#OORepayItem
#OODscptCode
#OOTxAmt
#OOTotalAmt
#OOTotalCnt
#OOStartEntryDate
#OOCustName
#OOFactor
#OOCreateDate
#OOEntryDate
#OOEndEntryDate
^
<include src="COM.icf::TRCTL.tom"/>
<include src="ROM.icf::L8R49.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>

</sub>

!--------- OUTPUT畫面 --------
<sub type="PART" name="L8921" layout="cols=1;screen.width=[100,900];printer.width=[20,20];">
[
["[L8921]                                 疑似洗錢樣態檢核查詢                                                                          "],
]
</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">

#RPTFG=0,QUERY.GRID,L8921
#any={detail:true, header:'L8921.part', caption:'', width:1000, rowNum:20, rowList:[20,40,60]}

#OOCreateDate=產製日期
{width:80,align:'center'}

#OOFactor=交易樣態
{width:70,align:'center'}

#OOEntryDate=入帳日期
{width:80,align:'center'}

#OOCustNoX=戶號
{width:80,align:'center'}

#OOCustName=戶名
{width:300,align:'left'}

#OORepayItem=來源
{width:50,align:'center'}

#OODscptCode=匯款摘要
{width:70,align:'center'}

#OOTxAmtX=交易金額
{width:150,align:'right'}

#OOTotalAmtX=累計金額
{width:150,align:'right'}

#OOTotalCnt=累計筆數
{width:70,align:'center'}

#OOStartEntryDate=統計期間</br>起日
{width:80,align:'center'}

#OOEndEntryDate=統計期間</br>迄日
{width:80,align:'center'}

^
</sub>
