!---------- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">
#TXCD
T(3,L8501)
</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="L8501" layout="cols=1;screen.width=[200,800];printer.width=[20,80];">
[
["[L8501]                           JCIC報送人員維護"],
["#FdJcicKind+報送種類",#JcicKind,#JcicKindX],
["#FdJcicEmpName+放款審查聯絡人",#JcicEmpName],
["#FdJcicEmpTel+放款聯絡電話",#JcicEmpTel," （區碼－電話號碼＃分機）"],
["#FdJcicZDep+債協聯絡人部門",#JcicZDep],
["#FdJcicZName+債協聯絡人姓名",#JcicZName],
["#FdJcicZTel+債協聯絡人電話",#JcicZTel," （區碼－電話號碼＃分機）"],
["#FdJcicMU1Dep+MU1聯絡人部門",#JcicMU1Dep],
["#FdJcicMU1Name+MU1聯絡人姓名",#JcicMU1Name],
["#FdJcicMU1Tel+MU1聯絡人電話",#JcicMU1Tel," （區碼－電話號碼＃分機）"],
]

!---------- AP TEXT AREA Variables ----------
<include src="HELPRIM.icf::HELPRIM.rtn"/>

#FdJcicKind=X,2,L
T(3,*)
#FdJcicEmpName=X,2,L
T(3,*)
#FdJcicEmpTel=X,2,L
T(3,*)
#FdJcicZDep=X,2,L
T(3,*)
#FdJcicZName=X,2,L
T(3,*)
#FdJcicZTel=X,2,L
T(3,*)
#FdJcicMU1Dep=X,2,L
T(3,*)
#FdJcicMU1Name=X,2,L
T(3,*)
#FdJcicMU1Tel=X,2,L
T(3,*)


#CHAIN=A,1,S
T(4,CHAIN$)
T(2,@RimTxCode,#TXCD)

! 功能 (2: 修改)
#FuncCode=A,1,S
E(0,2)
K(MODIFYBUTTON,修改)

!月報環境也可執行=>E(0,5)
#FUNCIND=_,_,S
E(0,5)
<include src="COM.icf::CheckAuth.rtn"/>


! 業務類型
#BusinessType=X,2,S
T(3,LN)

#JcicKindHelp=x,100,S
T(3,1:放款;2:債協;3:MU1)

#JcicKind=A,1,I
HELP(#JcicKindHelp)
@
T(3,@JcicKindX,)
V(H,#JcicKindHelp)

#JcicKindX=X,4,L
T(H,#JcicKind,#JcicKindHelp)


#SendL6R28=X,1,S
E(0,@RimFuncCode,#FuncCode)
T(2,@RimBusinessType,#BusinessType)
RESET_RIM(#SendL6R28,L6R28)
S(L6R28,1,#RimFuncCode,#RimTxCode,#RimBusinessType)
R(1,L6R28)
T(2,@JcicEmpName,#L6R28JcicEmpName)
T(2,@JcicEmpTel,#L6R28JcicEmpTel)
T(2,@JcicZDep,#L6R28JcicZDep)
T(2,@JcicZName,#L6R28JcicZName)
T(2,@JcicZTel,#L6R28JcicZTel)
T(2,@JcicMU1Dep,#L6R28JcicMU1Dep)
T(2,@JcicMU1Name,#L6R28JcicMU1Name)
T(2,@JcicMU1Tel,#L6R28JcicMU1Tel)


!顯示框線
#WKTF=X,1,S
IF(#JcicKind==1,T(F,@JcicZDep,0)T(F,@JcicZName,0)T(F,@JcicZTel,0)T(F,@JcicMU1Dep,0)T(F,@JcicMU1Name,0)T(F,@JcicMU1Tel,0),$)
IF(#JcicKind==2,T(F,@JcicEmpName,0)T(F,@JcicEmpTel,0)T(F,@JcicMU1Dep,0)T(F,@JcicMU1Name,0)T(F,@JcicMU1Tel,0),$)
IF(#JcicKind==3,T(F,@JcicEmpName,0)T(F,@JcicEmpTel,0)T(F,@JcicZTel,0)T(F,@JcicMU1Dep,0)T(F,@JcicMU1Name,0)T(F,@JcicMU1Tel,0),$)

!放款
#JcicEmpName=x,8,I
IF(#JcicKind==1,$,s)
@V(7)

#JcicEmpTel=x,16,I
IF(#JcicKind==1,$,s)
@V(7)

!債協
#JcicZDep=x,6,I
IF(#JcicKind==2,$,s)
@V(7)

#JcicZName=x,8,I
IF(#JcicKind==2,$,s)
@V(7)

#JcicZTel=x,16,I
IF(#JcicKind==2,$,s)
@V(7)

!MU1
#JcicMU1Dep=x,6,I
IF(#JcicKind==3,$,s)
@V(7)

#JcicMU1Name=x,8,I
IF(#JcicKind==3,$,s)
@V(7)

#JcicMU1Tel=x,16,I
IF(#JcicKind==3,$,s)
@V(7)


#RPTFG=A,1,S
E(0,0)


! [調Rim相關]
! 定義Rom欄位名稱、型態、長度
<include src="ROM.icf::L0Rim.dec"/>
<include src="ROM.icf::L6R28.dec"/>



</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!------------ TXFORM = L8501 -----------
<sub type="FORM" name="L8501">

#SCRPRT=_,_,S
C(5,#TXFORM,L8501,$,S)

#SCRTIL=_,_,S
T(3,[L8501] JCIC放款報送人員維護)

</sub>

!------ 上行電文 TEXT ------
<sub type="TIM">
#FuncCode
#BusinessType
#JcicEmpName
#JcicEmpTel
#JcicZDep
#JcicZName
#JcicZTel
#JcicMU1Dep
#JcicMU1Name
#JcicMU1Tel
#JcicKind
#END
</sub>

!------ 下行電文TOM ------
<sub type="TOM">

TXFORM=L8501

^
<include src="COM.icf::TRCTL.tom"/>
<include src="ROM.icf::L6R28.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">
<include src="PRT.icf::UPD01.sel"/>
</sub>
