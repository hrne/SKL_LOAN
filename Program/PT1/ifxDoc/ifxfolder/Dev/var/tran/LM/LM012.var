----- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">

!#TXCD
!T(3,LM012)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,0)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,75)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,20)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)

#BUF2=X,11,S
T(2,1+          )

#ORGFG=_,_,S
E(0,0)

</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[120,850];printer.width=[20,20];">
[
["[LM012]                                 放款利率分佈表"],
["@利率下限上限",#RateMinimum," - ",#RateMaximum],
["@利率區間",#RateRange],
["@年月",#DataYear,"@年",#DataMonth,"@月"],
]
!---------- AP Button AREA ----------
![Buttom資料查詢]
!#BTN1=X,15,I,ui:button;value:瀏覽;enable:0;tabbable:0
!#BTN2=X,15,I,ui:button;value:瀏覽;enable:0;tabbable:0
!#BTN3=X,15,I,ui:button;value:瀏覽;enable:0;tabbable:0
!ENABLE(#BTN1)ENABLE(#BTN2)ENABLE(#BTN3)
!---------- AP TEXT AREA Variables ----------

! Help
<include src="HELPRIM.icf::HELPRIM.rtn"/>

#RPTFG=A,1,S
E(0,0)

![利率下限]-檢核不得為0
#RateMinimum=n,2.3,I
E(0,1)
@V(2,0)

![利率上限]-檢核不得為0
#RateMaximum=n,2.3,I
E(0,99.000)
@V(2,0)

!暫存欄位-計算上下限差異
#DiffMaxMin=n,5.3,S
E(0,#RateMaximum-#RateMinimum)
E(0,#DiffMaxMin*1000)

!javascript取餘數時會先改為二進制,當小數時會出錯,故乘1000使其變為整數,再取餘數
#TmpRateRange=n,5.3,S
E(0,0)

![利率區間]-檢核 "利率區間不得為0,且(利率上限-利率下限)須為利率區間的倍數"
#RateRange=n,2.3,I
E(0,0.25)
@V(2,0)
E(0,@TmpRateRange,#RateRange*1000)
IF(#DiffMaxMin%#TmpRateRange==0,$,V(P,利率區間不得為0，且（利率上限－利率下限）須為利率區間的倍數))
!錯誤提示的字串內不得有 , ( ) - 等符號,故改為全型


!日曆日
#DATE=D,8,S
T(4,DATE$)

#DATEYear=A,3,S
T(1,#DATE,2,3)

![年月]
#DataYear=A,3,I
T(1,#DATE,2,3)
@V(5,0,#DATEYear)

#DataMonth=A,2,I
T(1,#DATE,5,2)
@V(5,1,12)


#RETURN=A,1,S
E(0,0)

![折返KEY]
#RTNTXT=X,9,S

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!---------- TXFORM = LM012 ----------
<sub type="FORM" name="LM012">

!#SCRPRT=_,_,S
!C(5,#TXFORM,LM012,$,S)

#SCRTIL=_,_,S
T(3,[LM012] 放款利率分佈表)

!------ TOM(HEAD)   Variables (FOR OUTPUT SCREEN) ------

!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------

#LOOP=X,1,S
T(3,1)ASGN(LOOP$)

</sub>


!------ 上行電文 ------
<sub type="TIM">
#RateMinimum
#RateMaximum
#RateRange
#DataYear
#DataMonth
#RETURN
#END
#RTNTXT
</sub>


!------ 下行電文TOM ------
<sub type="TOM">

TXFORM=LM012
^

<include src="HELPRIM.icf::HELPRIM.tom"/>
<include src="COM.icf::TRCTL.tom"/>
</sub>
!--------- OUTPUT畫面 --------
<sub type="PART" name="LM012" layout="cols=3;screen.width=[250,250,100,250];printer.width=[20,20,20,20];order=1">
[
["[LM012]                                 放款利率分佈表                                                                            "],
]
</sub>


!---------- 單據輸出組合 ----------
<sub type="SELECT">
<include src="PRT.icf::UPD01.sel"/>
</sub>
