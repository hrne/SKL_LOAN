!---------- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">

#RunModeH=x,100,S
T(3,1:Direct CALL;2:Background CALL;3:Background CALL by apControl)
!T(3,1:Direct CALL;2:Background CALL;3:Background CALL by apControl;4:BatchJob)



</sub>

<sub type="DC" name="BFHEAD">
</sub>

<sub type="DC" name="p1" layout="cols=2;screen.width=[120,250,120,400];printer.width=[15,30,15,45];order=1;">
[
["[LC899] 手動執行批次程式"],
[#<->#,"執行模式",#RunMode,#RunModeX],
[#<->#,"執行程式",#Prgm,#PrgmX],
![#<->#,"執行程式或JobId",#Prgm,"多個JOB請用;分隔"],
[#<->#,"參數",#Parm,"@TitaVo.get('Parm')"],
]

!---------- AP Button AREA ----------

#FUNCIND=_,_,S
E(0,1)

#CHAIN=A,1,S
T(4,CHAIN$)
C(2,#CHAIN,$,T(F,@FunCode,0))

#NTXBUF=X,6,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
T(1,@FunCode,#NTXBUF,1,1)
T(1,@TranNo,#NTXBUF,2,5)
T(2,@FKEY,7)


!---------- AP TEXT AREA Variables ----------
<include src="HELPRIM.icf::HELPRIM.rtn"/>

! ExePgm批次程式代號
#ExePgmCode=x,20,S
T(3,CdCode.ExePgm)
#ExePgmCodeHelp=x,1024,S

#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#ExePgmCode)
R(1,XXR99)
CALL(#HelpProc)
T(2,@ExePgmCodeHelp,#HelpDesc1)


#RunMode=A,1,I
HELP(#RunModeH)
@T(3,@RunModeX,)
V(H,#RunModeH)

#RunModeX=x,100,L
T(H,#RunMode,#RunModeH)

#Prgm=x,20,I
IF(#RunMode==2,HELP(#ExePgmCodeHelp),$)
@
IF(#RunMode==2,T(3,@PrgmX,),$)
V(7)

#PrgmX=x,100,L
IF(#RunMode==2,T(H,#Prgm,#ExePgmCodeHelp),T(2, ))


#Parm=x,40,I



</sub>


!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!------ 上行電文TIM：BASIC LABEL + AP TEXT AREA + AP TEXT ------
<sub type="TIM">
#RunMode#Prgm#Parm
#END
</sub>

!------ 下行電文TOM ------
<sub type="TOM">
<include src="COM.icf::TRCTL.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
TXFORM=LC899^

</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">
<include src="PRT.icf::UPD01.sel"/>
<include src="PRT.icf::UPDH01.sel"/>
<include src="PRT.icf::FMR01.sel"/>
<include src="PRT.icf::FMH01.sel"/>
<include src="PRT.icf::FMHR01.sel"/>
<include src="PRT.icf::FM01.sel"/>
<include src="PRT.icf::FMR01.sel"/>
<include src="PRT.icf::FMH01.sel"/>
<include src="PRT.icf::FMHR01.sel"/>
</sub>
