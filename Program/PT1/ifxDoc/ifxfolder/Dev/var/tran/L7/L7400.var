!----- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,27)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,75)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,20)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)

</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[200,800];printer.width=[20,20];">
[
["[L7400]                                 總帳傳票資料傳輸"],
["#R1+@會計日期",#AcDate],
["#R2+@傳票批號",#BatchNo],
["#R3+@傳票資料上傳序號",#MediaSeq],
]

! 2021-07-28 智偉增加
!#FUNCIND=_,_,S
!E(0,5)
!<include src="COM.icf::CheckAuth.rtn"/>

! 必輸欄位
##loop{times:3,i:1}
#R{i}=X,1,L
INVOKEJS(SHOW,#R{i},0)
K(LIGHT,#R{i},TXTRED,0)
##end

! 永遠為必輸欄位
#ALWAYS_HIGHLIGHT=@,1,S
T(3,@R1,*)
T(3,@R2,*)
T(3,@R3,*)

!---------- AP TEXT AREA Variables ----------
#CHAIN=A,1,S
T(4,CHAIN$)

#NTXBUF=X,12,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
T(1,@AcDate,#NTXBUF,1,7)
T(1,@BatchNo,#NTXBUF,8,2)
T(1,@MediaSeq,#NTXBUF,10,3)

#INIT=X,1,S
CALL(#ALWAYS_HIGHLIGHT)

#DT1=D,8,S
T(4,DATE$)

#DT2=D,7,S
T(1,#DT1,2,7)

!會計日期
#AcDate=D,7,I
C(4,#AcDate,T(2,#DT2),$)

@V(7)
! V(5,0,#DT2)
A(DATE,0,#AcDate)


!傳票批號
#BatchNo=A,2,I
@V(2,0)


!傳票資料上傳序號
#MediaSeq=A,3,I
@V(2,0)

#RPTFG=A,1,S
E(0,0)

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>


!---------- TXFORM = L7400 ----------
<sub type="FORM" name="L7400">

#SCRTIL=_,_,S
T(3,[L7400] 總帳傳票資料傳輸)

!------ TOM(HEAD)   Variables (FOR OUTPUT SCREEN) ------
#SendStatus=X,1,L
IF(#SendStatus=="S",E(0,@RPTFG,0),$)
IF(#SendStatus=="F",E(0,@RPTFG,1),$)

!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------
#LOOP=X,1,S
T(3,1)ASGN(LOOP$)
#GroupId=x,20,L
#JournalName=x,20,L
#JeLineNum=x,10,L
#ErrorCode=x,10,L
#ErrorMessage=x,200,L

</sub>


!------ 上行電文 ------
<sub type="TIM">
#AcDate
#BatchNo
#MediaSeq
</sub>


!------ 下行電文TOM ------
<sub type="TOM">
TXFORM=L7400
#SendStatus
#GroupId
#JournalName
#JeLineNum
#ErrorCode
#ErrorMessage
^
<include src="COM.icf::TRCTL.tom"/>
</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">
<include src="PRT.icf::UPD01.sel"/>

#RPTFG=1,QUERY.GRID,L7400
#any={detail:true, header:'L7400.part', caption:'總帳系統回覆資料錯誤', width:1100, rowNum:10, rowList:[20,40,60]}

#GroupId=GroupId
{width:150,align:'left'}

#JournalName=JournalName
{width:150,align:'left'}

#JeLineNum=JeLineNum
{width:100,align:'right'}

#ErrorCode=ErrorCode
{width:100,align:'left'}

#ErrorMessage=ErrorMessage
{width:200,align:'left'}
^

</sub>
