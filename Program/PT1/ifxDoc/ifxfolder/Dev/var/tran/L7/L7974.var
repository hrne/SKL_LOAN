----- BASIC LABEL Variables ----------
<sub type="SYS">
#Submit=A,1,S
K(MODIFYBUTTON,查詢)
</sub>

<sub type="SYS" name="label">

!#TXCD
!T(3,L7974)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,54)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,57)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,20)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)

</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[120,980];printer.width=[20,20];">
[
["[L7974]                                 總帳傳票資料明細"],
["#FdACCDATE+會計日期",#AccDateStart],
["#FdGroupId+ETL批號",#GroupId],
["#FdSendStatus+上傳狀態",#SendStatus,#SendStatusX],
]
!---------- AP Button AREA ----------
![Buttom資料查詢]

#BUF1=X,42,S

#FdACCDATE=X,2,L
#FdGroupId=X,2,L
#FdSendStatus=X,2,L

! Help

#TypeCodeHelp=x,100,S
T(3,0:上傳成功;1:未上傳;2:上傳失敗;9:全部)


!---------- AP TEXT AREA Variables ----------
! Help
<include src="HELPRIM.icf::HELPRIM.rtn"/>


#CHAIN=A,1,S
T(4,CHAIN$)


#NTXBUF=X,100,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
T(1,@AccDateStart,#NTXBUF,1,7)
T(1,@GroupId,#NTXBUF,8,11)
T(1,@SendStatus,#NTXBUF,19,1)

!會計日期
#AccDateStart=D,7,I
@A(DATE,0,#AccDateStart)
V(7)

#GroupId=X,11,I

#SendStatus=A,1,I
HELP(#TypeCodeHelp)
@
V(H,#TypeCodeHelp)

#SendStatusX=X,8,L
T(H,@SendStatusX,#SendStatus,#TypeCodeHelp)

#RPTFG=A,1,S

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>


!---------- TXFORM = L7974 ----------
<sub type="FORM" name="L7974">

!#SCRPRT=_,_,S
!C(5,#TXFORM,L7974,$,S)

#SCRTIL=_,_,S
T(3,[L7974] 總帳傳票資料明細)


!------ TOM(HEAD)   Variables (FOR OUTPUT SCREEN) ------
!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------
#LOOP=X,1,S
T(3,1)ASGN(LOOP$)

!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------

#OOAcBookCode=X,3,O      

#OOAcSubBookCode=X,3,O

#OOMediaSlipNo=X,12,O    

#OOSeq=A,5,O         

#OOAcDate=D,8,O     

#OOBatchNo=A,2,O    

#OOMediaSeq=A,3,O   

#OOAcNoCode=X,11,O  

#OOAcSubCode=X,5,O  

#OODeptCode=X,6,O 

#OODbCr=X,1,O 

#OOTxAmt=m,14.2,O    

#OOSlipRmk=X,80,O   

#OOReceiveCode=X,15,O    

#OOCostMonth=X,2,O  

#OOIfrs17Group=X,9,O   

#OOLatestFlag=X,1,O   

#OOTransferFlag=X,1,O     

#OOLastUpdate=X,20,O 

#OOLastUpdateEmpNo=X,6,O 

#OOErrorCode=X,3,O  

#OOErrorMsg=X,2000,O    

#OOSendStatusX=X,8,O

</sub>


!------ 上行電文 ------
<sub type="TIM">
#AccDateStart
#GroupId
#SendStatus
#END
</sub>


!------ 下行電文TOM ------
<sub type="TOM">
TXFORM=L7974
#OOAcBookCode
#OOMediaSlipNo
#OOSeq
#OOAcDate
#OOBatchNo
#OOMediaSeq
#OOAcNoCode
#OOAcSubCode
#OODeptCode
#OOAcSubBookCode
#OODbCr
#OOTxAmt
#OOSlipRmk
#OOReceiveCode 
#OOCostMonth
#OOIfrs17Group  
#OOLatestFlag  
#OOTransferFlag    
#OOLastUpdate  
#OOLastUpdateEmpNo
#OOErrorCode
#OOErrorMsg     
#OOSendStatusX

^
<include src="COM.icf::TRCTL.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">

#RPTFG=0,QUERY.GRID,L7974
#any={detail:true, header:'L7974.part', caption:'', width:1000, rowNum:20, rowList:[20,40,60]}

#OOMediaSlipNo=傳票號碼
{width:100,align:'center'} 

#OOSeq=序號 
{width:100,align:'center'}

#OOAcSubBookCode=區隔帳冊	
{width:100,align:'center'}

#OOAcNoCode=科目代號 
{width:100,align:'center'}

#OOAcSubCode=子目代號 
{width:100,align:'center'}

#OOTxAmt=金額 
{width:100,align:'center'}

#OOSendStatusX=上傳狀態 
{width:100,align:'center'}

#OOErrorMsg=失敗訊息 
{width:100,align:'center'}

#OOSlipRmk=傳票摘要
{width:100,align:'center'}

#OOAcBookCode=帳冊別
{width:100,align:'center'}

#OOAcDate=傳票日期
{width:100,align:'center'}

#OOBatchNo=傳票批號
{width:100,align:'center'}

#OOMediaSeq=上傳核心序號
{width:100,align:'center'}

#OODeptCode=部門代號
{width:100,align:'center'}

#OODbCr=借貸別
{width:100,align:'center'}

#OOReceiveCode=會計科目銷帳碼 
{width:100,align:'center'}

#OOCostMonth=成本月份
{width:100,align:'center'}

#OOIfrs17Group=IFRS17群組  
{width:100,align:'center'}

#OOLatestFlag=是否為最新  
{width:100,align:'center'}

#OOTransferFlag=是否已傳輸    
{width:100,align:'center'}

#OOLastUpdate=最後更新日期時間  
{width:100,align:'center'}

#OOLastUpdateEmpNo=最後更新人員
{width:100,align:'center'}

#OOErrorCode=回應錯誤代碼
{width:100,align:'center'}

^

<include src="PRT.icf::INQ01.sel" map="i=L7974;cpi=15"/>


<include src="PRT.icf::INQ01.sel"/>
</sub>
