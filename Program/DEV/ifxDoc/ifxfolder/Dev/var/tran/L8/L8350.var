----- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">

!#TXCD
!T(3,L8350)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,0)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度-Occ回來後去切的長度]
#INQLEN=n,3,S
E(0,150)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,20)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)

#button=x,100,S
K(MODIFYBUTTON,新增)

</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[200,750];printer.width=[20,20];">
[
["[L8350]                                 MU1人員名冊報送"],
["#FdFuncd+功能",#FuncdX],
["#FdHeadOfficeCode+總行代號",#HeadOfficeCode,#HeadOfficeCodeX],["#FdBranchCode+分行代號",#BranchCode,#BranchCodeX],
["#FdDataDate+資料日期",#DataDate],
["#FdEmpId+員工代號",#EmpId,#EmpName],
["#FdEmailAccount+E+-+mail信箱",#EmailAccount],
["#FdTitle+職稱",#Title],["#FdQryUserId+使用者代碼",#QryUserId],
["#FdAuthQryType+授權查詢方式",#AuthQryType,#AuthQryTypeX],
["#grid#,{id:1,expand:true,loop:1,row_height:1}","","","",
["#FdAuthItemQuery+授權辦理事項+#FdAuthItemQuery1+#FdAuthItemQuery1","審核",#AuthItemQuery,"覆核",#AuthItemReview,"其他",#AuthItemOther],
! [[#Paper1],[#Msg1],[#EMail1],[#Notice1]],
],
["#FdAuthStartDay+授權起日",#AuthStartDay],["#FdAuthEndDay+授權迄日",#AuthEndDay],
["#FdAuthMgrIdS+起日授權主管代號",#AuthMgrIdS,#AuthMgrNameS],
["#FdAuthMgrIdE+迄日授權主管代號",#AuthMgrIdE,#AuthMgrNameE],
["#FdOutJcicTxtDate+轉JCIC文字檔日期",#OutJcicTxtDate],
]
#FdFuncd=X,2,L
T(3, )
#FdHeadOfficeCode=X,2,L
T(3, )
#FdBranchCode=X,2,L
T(3,*)  
#FdDataDate=X,2,L
T(3,*)
#FdEmpName=X,2,L
#FdEmpId=X,2,L
T(3,*)
#FdEmailAccount=X,2,L
T(3,*)
#FdTitle=X,2,L
#FdQryUserId=X,2,L
T(3,*)
#FdAuthQryType=X,2,L
T(3,*)
#FdAuthItemQuery=X,2,L
#FdAuthItemQuery1=X,1,L
#FdAuthStartDay=X,2,L
T(3,*)
#FdAuthEndDay=X,2,L
#FdAuthMgrNameS=X,2,L
#FdAuthMgrIdE=X,2,L
#FdOutJcicTxtDate=X,2,L
#FdAuthMgrIdS=X,2,L
!---------- AP Button AREA ----------
<include src="HELPRIM.icf::HELPRIM.rtn"/>
<include src="ROM.icf::L8R56.dec"/>
<include src="ROM.icf::L5R28.dec"/>
#CDCODEAuthQryCode=x,20,S
T(3,CdCode.AuthQryType)

#AuthQryCodeHelp=x,2024,S

#CDDEF0002=x,20,S
T(3,CdCode.FuncCode)

#FuncCodeHelp=x,1024,S 

#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#CDCODEAuthQryCode,#CDDEF0002)
R(1,XXR99)
CALL(#HelpProc)
T(2,@AuthQryCodeHelp,#HelpDesc1)
T(2,@FuncCodeHelp,#HelpDesc2)
!---------- AP TEXT AREA Variables ----------
#CHAIN=A,1,S
T(4,CHAIN$)
#NTXBUF=X,50,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
T(1,@FunCd,#NTXBUF,1,1)
C(3,#FunCd,1,S,$)
T(1,@HeadOfficeCode,#NTXBUF,2,3)
T(1,@BranchCode,#NTXBUF,5,4)
T(1,@DataDate,#NTXBUF,9,7)
T(1,@EmpId,#NTXBUF,16,6)

#RimL8R56=X,1,S

#RimHeadOfficeCode=X,3,S
#RimBranchCode=X,4,S
#RimDataDate=X,7,S
#RimEmpId=X,6,S
C(3,#FunCd,1,S,$)
T(2,@RimHeadOfficeCode,#HeadOfficeCode)
T(2,@RimBranchCode,#BranchCode)
T(2,@RimDataDate,#DataDate)
T(2,@RimEmpId,#EmpId)
RESET_RIM(#RimL8R56,L8R56)
S(L8R56,1,#RimHeadOfficeCode,#RimBranchCode,#RimDataDate,#RimEmpId)
R(1,L8R56)
T(2,@EmpName,#L8R56EmpName)
T(2,@Title,#L8R56Title)
T(2,@AuthQryType,#L8R56AuthQryType)
T(2,@QryUserId,#L8R56QryUserId)
T(2,@AuthItemQuery,#L8R56AuthItemQuery)
T(2,@AuthItemReview,#L8R56AuthItemReview)
T(2,@AuthItemOther,#L8R56AuthItemOther)
E(0,@AuthStartDay,#L8R56AuthStartDay)
T(2,@AuthMgrIdS,#L8R56AuthMgrIdS)
T(2,@AuthMgrNameS,#L8R56AuthMgrNameS)
E(0,@AuthEndDay,#L8R56AuthEndDay)
T(2,@AuthMgrIdE,#L8R56AuthMgrIdE)
T(2,@AuthMgrNameE,#L8R56AuthMgrNameE)
T(2,@EmailAccount,#L8R56EmailAccount)
E(0,@OutJcicTxtDate,#L8R56OutJcictxtDate)
T(F,@BranchCode,0)T(F,@DataDate,0)T(F,@EmpId,0)
T(2,@FdBranchCode, )T(2,@FdDataDate, )T(2,@FdEmpId, )

#FunCd=A,1,S

#FuncdX=X,4,L
T(H,#FunCd,#FuncCodeHelp)
C(2,#FunCd,$,K(MODIFYBUTTON,新增),K(MODIFYBUTTON,修改),K(MODIFYBUTTON,新增),K(MODIFYBUTTON,刪除),K(MODIFYBUTTON,查詢)K(NOBUTTON,CLOSEY))

!總行代號
#HeadOfficeCode=X,3,L
T(2,458)
#HeadOfficeCodeX=X,20,L

!分行代號
#BranchCode=X,4,I
C(3,#FunCd,1,$,s)
@V(NL)
V(7)
#BranchCodeX=X,20,L

!資料日期
#DataDate=D,7,I
C(3,#FunCd,1,$,s)
@V(7)
A(DATE,0,#DataDate)
!員工代號
#EmpId=X,6,I
C(3,#FunCd,1,$,s)
@V(7)V(NL)

#RimL5R28=X,1,S
#RimEmployeeNo=X,6,S
T(2,@RimEmployeeNo,#EmpId)
RESET_RIM(#RimL5R28,L5R28)
S(L5R28,1,#RimEmployeeNo)
R(1,L5R28)
T(2,@EmpName,#L5r28FullName)

!員工姓名
#EmpName=X,42,L

!E-mail信箱
#EmailAccount=x,50,I
@V(7)A(M,0,#EmailAccount)
!職稱
#Title=X,50,I

!使用者代碼
#QryUserId=X,8,I
@V(7)V(NL)
!授權查詢方式
#AuthQryType=X,1,I
HELP(#AuthQryCodeHelp)
@V(H,#AuthQryCodeHelp)
#AuthQryTypeX=X,20,L
T(H,#AuthQryType,#AuthQryCodeHelp)

!授權辦理事項
#AuthItemQuery=X,1,I,ui:checkbox;value:;

#AuthItemReview=X,1,I,ui:checkbox;value:;

#AuthItemOther=X,1,I,ui:checkbox;value:;
@C(4,#AuthItemQuery,C(4,#AuthItemReview,C(4,#AuthItemOther,V(P,審核、覆核、其他，至少需勾選一項),$),$),$)
!授權起日
#AuthStartDay=D,7,I
@V(7)
A(DATE,0,#AuthStartDay)


!授權迄日
#AuthEndDay=D,7,I
@C(4,#AuthEndDay,$,A(DATE,0,#AuthEndDay))
C(4,#AuthEndDay,$,IF(#AuthEndDay>#AuthStartDay,$,V(P,迄日需大於起日)))

!起日授權主管中文代號
#AuthMgrIdS=X,6,I

!起日授權主管中文姓名
#AuthMgrNameS=X,42,L
C(4,#AuthMgrIdS,S,$)
T(2,@RimEmployeeNo,#AuthMgrIdS)
RESET_RIM(#RimL5R28,L5R28)
S(L5R28,1,#RimEmployeeNo)
R(1,L5R28)
T(2,@AuthMgrNameS,#L5r28FullName)

!迄日授權主管中文代號
#AuthMgrIdE=X,6,I

!迄日授權主管中文姓名
#AuthMgrNameE=X,42,L
C(4,#AuthMgrIdE,S,$)
T(2,@RimEmployeeNo,#AuthMgrIdE)
RESET_RIM(#RimL5R28,L5R28)
S(L5R28,1,#RimEmployeeNo)
R(1,L5R28)
T(2,@AuthMgrNameE,#L5r28FullName)

!轉JCIC文字檔日期
#OutJcicTxtDate=D,7,L

#RPTFG=A,1,S
</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!------------ TXFORM = L8350 -----------
<sub type="FORM" name="L8350">

</sub>

!------ 上行電文 TEXT ------
<sub type="TIM">
#FunCd
#HeadOfficeCode
#BranchCode
#DataDate
#EmpId
#EmailAccount
#Title
#QryUserId
#AuthQryType
#AuthItemQuery
#AuthItemReview
#AuthItemOther
#AuthStartDay
#AuthEndDay
#AuthMgrIdS
#AuthMgrIdE
#OutJcicTxtDate
</sub>

!------ 下行電文TOM ------
<sub type="TOM">
<include src="HELPRIM.icf::HELPRIM.tom"/>
<include src="COM.icf::TRCTL.tom"/>
<include src="ROM.icf::L8R56.tom"/>
<include src="ROM.icf::L5R28.tom"/>
TXFORM=L8350
^
</sub>

!---------- 單據輸出組合 ----------
<sub type="PART" prompt='{{#SCRTIL}} world' name="L8350" layout="cols=1;screen.width=[130,870];order=1;">
[
["[L8350]                                 MU1人員名冊報送"],
["@員工編號",#EmpId]
["@資料日期",#DataDate],
]
</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">

<include src="PRT.icf::INQ04.sel"/>
</sub>