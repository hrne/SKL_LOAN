----- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">

!#TXCD
!T(3,L3943)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,329)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,35)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,0)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,0)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,1)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
K(MODIFYBUTTON,查詢)
T(3,@FdChequeAcct,*)
T(3,@FdChequeNo,*)
T(3,@FdRptFg,*)

</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[130,870];printer.width=[20,20];">
[
["[L3943]                                 支票內容查詢"],
["#FdChequeAcct+支票帳號",#ChequeAcct],
["#FdChequeNo+支票號碼",#ChequeNo],
["#FdRptFg+顯示方式",
<include src="COM.icf::RPTFG.scr"/>
],
]
!---------- AP Button AREA ----------
![Buttom資料查詢]

!---------- AP TEXT AREA Variables ----------
! Help
<include src="HELPRIM.icf::HELPRIM.rtn"/>
!交換區號
#CDDEF01=x,26,S
T(3,CdCode.AreaCode)

#AreaCodeHelp=x,1024,S

!本埠外埠
#CDDEF02=x,26,S
T(3,CdCode.OutsideCode)

#OutsideCodeHelp=x,1024,S

!ProcessCode 處理代碼
#CDDEF03=x,30,S
T(3,CdCode.ChequeProcessCode)

#ProcessCodeHelp=x,1024,S

!幣別小數位
#CDDEF04=x,26,S
T(3,CdCode.CurrPrecision)

#CurrPrecisionHelp=x,1024,S

!票據狀況碼
#CDDEF05=x,26,S
T(3,CdCode.ChequeStatusCode)

#StatusCodeHelp=x,1024,S

!支票用途
#CDDEF06=x,26,S
T(3,CdCode.ChequeUsageCode)

#UsageCodeHelp=x,1024,S

!服務中心別
#CDDEF07=x,26,S
T(3,CdCode.ServiceCenter)

#ServiceCenterHelp=x,1024,S

!ChequeStatusCode
#CDDEF08=x,30,S
T(3,CdCode.ChequeStatusCode)

#ChequeStatusCodeHelp=x,1024,S

#RepayTypeHelpRim=X,1,S
RESET_RIM(#RepayTypeHelpRim,XXR99)
S(XXR99,01,#CDDEF01,#CDDEF02,#CDDEF03,#CDDEF04,#CDDEF05,#CDDEF06,#CDDEF07,#CDDEF08)
R(1,XXR99)
CALL(#HelpProc) 
T(2,@AreaCodeHelp,#HelpDesc1)
T(2,@OutsideCodeHelp,#HelpDesc2)
T(2,@ProcessCodeHelp,#HelpDesc3)
T(2,@CurrPrecisionHelp,#HelpDesc4)
T(2,@StatusCodeHelp,#HelpDesc5)
T(2,@UsageCodeHelp,#HelpDesc6)
T(2,@ServiceCenterHelp,#HelpDesc7)
T(2,@ChequeStatusCodeHelp,#HelpDesc8)

#YNHelp=x,20,S
T(3,Y:是;N:否)

#CHAIN=A,1,S
T(4,CHAIN$)

#NTXBUF=X,16,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)

![支票帳號]
!必須輸入
#FdChequeAcct=X,2,L
T(3,*)

#ChequeAcct=A,9,I
C(3,#CHAIN,1,T(1,#NTXBUF,1,9),$)
C(3,#CHAIN,1,s,$)
@V(2,0)

![支票號碼]
!必須輸入
#FdChequeNo=X,2,L
T(3,*)

#ChequeNo=A,7,I
C(3,#CHAIN,1,T(1,#NTXBUF,10,7),$)
C(3,#CHAIN,1,s,$)
@V(2,0)

#FdRptFg=X,2,L
T(3,*)

<include src="COM.icf::RPTFG.dec"/>

#CHAINXMT=X,1,S
C(3,#CHAIN,1,E(0,@CHAIN,0)XMT(),$)

#FdOCustNo=X,2,L
#FdOChequeName=X,2,L
#FdOChequeAcct=X,2,L
#FdOReceiveDate=X,2,L
#FdOChequeNo=X,2,L
#FdOAcDate=X,2,L
#FdOChequeDate=X,2,L
#FdOEntryDate=X,2,L
#FdOChequeAmtX=X,2,L
#FdOOutsideCodeX=X,2,L
#FdOBankItem=X,2,L
#FdOAreaCodeX=X,2,L
#FdOBranchItem=X,2,L
#FdOBktwFlagX=X,2,L
#FdOTsibFlagX=X,2,L
#FdOStatusCodeX=X,2,L
#FdOMediaFlagX=X,2,L
#FdOUsageCodeX=X,2,L
#FdOServiceCenterX=X,2,L
#FdOCreditorId=X,2,L
#FdOCreditorBankItem=X,2,L
#FdOKinbr=X,2,L

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>


!---------- TXFORM = L3943 ----------
<sub type="FORM" name="L3943">

!#SCRPRT=_,_,S
!C(5,#TXFORM,L3943,$,S)

#SCRTIL=_,_,S
T(3,[L3943] 支票內容)

!------ TOM(HEAD)   Variables (FOR OUTPUT SCREEN) ------
!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------
![借款人戶號]
#OCustNo=A,7,L

#OCustNoX=X,100,L

![發票人姓名]
#OChequeName=X,60,L

![支票帳號]
#OChequeAcct=A,9,L

![收票日]
#OReceiveDate=D,7,L

![支票號碼]
#OChequeNo=A,7,L

![會計日期]
#OAcDate=D,7,L

![支票到期日]
#OChequeDate=D,7,L

![入帳日]
#OEntryDate=D,7,L

![支票銀行]
#OBankItem=X,20,L

![交換區號]
#OAreaCode=A,2,S

#OAreaCodeX=X,10,L
T(3,)T(H,#OAreaCode,#AreaCodeHelp)

![本埠外埠]
#OOutsideCode=A,1,S

#OOutsideCodeX=X,4,L
T(3,)T(H,#OOutsideCode,#OutsideCodeHelp)

![支票分行]
#OBranchItem=X,20,L

![處理代碼]
#OProcessCode=A,1,S

#OProcessCodeX=X,6,L
T(3,)T(H,#OProcessCode,#ProcessCodeHelp)

#OCurrencyCode=X,3,S

#Precision=N,1,S
E(0,0)T(H,#OCurrencyCode,#CurrPrecisionHelp)

![支票金額]
#OChequeAmt=m,14.2,S

#OChequeAmtX=X,22,L
CALL2(#ADJUSTDOT,#Precision,#OChequeAmt,#OChequeAmtX)

![票據狀況碼]
#OStatusCode=A,1,S

#OStatusCodeX=X,10,L
T(3,)T(H,#OStatusCode,#StatusCodeHelp)

![是否為台支]
#OBktwFlag=X,1,S

#OBktwFlagX=X,2,L
T(3,)T(H,#OBktwFlag,#YNHelp)

![是否為台新]
#OTsibFlag=X,1,S

#OTsibFlagX=X,2,L
T(3,)T(H,#OTsibFlag,#YNHelp)

![入媒體檔]
#OMediaFlag=X,1,S

#OMediaFlagX=X,2,L
T(3,)T(H,#OMediaFlag,#YNHelp)

![支票用途]
#OUsageCode=A,2,S

#OUsageCodeX=X,16,L
T(3,)T(H,#OUsageCode,#UsageCodeHelp)

![服務中心別]
#OServiceCenter=X,1,S

#OServiceCenterX=X,10,L
T(3,)T(H,#OServiceCenter,#ServiceCenterHelp)

![統一編號]
#OCreditorId=X,10,L

![債權機構]
#OCreditorBankItem=X,20,L

! ![對方業務科目]
! #OOtherAcctCode=A,3,S

! #OOtherAcctCodeX=X,20,L
! T(A,#OOtherAcctCode,L2DEF,FacmAcctCodeDef,FacmAcctCode,FacmAcctCodeX)

! ![收據號碼]
! #OReceiptNo=X,5,L

![交易序號]
#ORelNo=X,18,L

!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------
#LOOP=X,1,S
T(3,1)ASGN(LOOP$)


#OOFacmNo=A,3,O

#OORvAmt=m,14.2,S

#OORvAmtX=X,22,L
CALL2(#ADJUSTDOT,#Precision,#OORvAmt,#OORvAmtX)
P(R,#OORvAmtX)

#OORvBal=m,14.2,S

#OORvBalX=X,22,L
CALL2(#ADJUSTDOT,#Precision,#OORvBal,#OORvBalX)
P(R,#OORvBalX)




</sub>


!------ 上行電文 ------
<sub type="TIM">

#ChequeAcct#ChequeNo

</sub>


!------ 下行電文TOM ------
<sub type="TOM">

TXFORM=L3943
#OCustNo#OCustNoX#OChequeName
#OChequeAcct#OReceiveDate#OChequeNo#OAcDate#OChequeDate
#OEntryDate#OBankItem#OBranchItem#OAreaCode#OOutsideCode
#OProcessCode#OStatusCode
#OCurrencyCode#OChequeAmt
#OBktwFlag#OTsibFlag#OMediaFlag#OUsageCode#OServiceCenter
#OCreditorId#OCreditorBankItem
#ORelNo
#OOFacmNo
#OORvAmt
#OORvBal
^

<include src="COM.icf::TRCTL.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
</sub>

<sub type="PART" name="L3943" layout="cols=3;screen.width=[130,370,130,370];printer.width=[15,30,15,30];order=1;">
[
["[L3943]                                 支票內容查詢"],
[#<->#,"#FdOCustNo+借款人戶號",#OCustNo,#OCustNoX],
[#<->#,"#FdOChequeName+發票人姓名",#OChequeName],
["#FdOChequeAcct+支票帳號",#OChequeAcct],
["#FdOReceiveDate+收票日",#OReceiveDate],
["#FdOChequeNo+支票號碼",#OChequeNo],
["#FdOAcDate+會計日期",#OAcDate],
["#FdOChequeDate+支票到期日",#OChequeDate],       
["#FdOEntryDate+入帳日",#OEntryDate],
["#FdOChequeAmtX+支票金額",#OChequeAmtX],
["#FdOOutsideCodeX+本埠外埠",#OOutsideCodeX],
["#FdOBankItem+支票銀行",#OBankItem],
["#FdOAreaCodeX+交換區號",#OAreaCodeX],
["#FdOBranchItem+支票分行",#OBranchItem], 
["#FdOBktwFlagX+是否為台支",#OBktwFlagX], 
["#FdOTsibFlagX+是否為台新",#OTsibFlagX],
["#FdOStatusCodeX+票據狀況碼",#OStatusCodeX],
["#FdOMediaFlagX+入媒體檔",#OMediaFlagX],
["#FdOUsageCodeX+支票用途",#OUsageCodeX],
["#FdOServiceCenterX+服務中心別",#OServiceCenterX], 
["#FdOCreditorId+統一編號",#OCreditorId],
["#FdOCreditorBankItem+債權機構",#OCreditorBankItem],
["@","@"],
["#FdOKinbr+交易序號",#ORelNo],
["@","@"],
]

</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">



#RPTFG=0,QUERY.GRID,L3943
#any={detail:true, header:'L3943.PART', caption:'', width:1010, rowNum:20, rowList:[20,40,60]}

#OOFacmNo=額度編號
{width:100,align:'center'}


#OORvAmtX=銷帳金額
{width:170}

#OORvBalX=未銷餘額
{width:170}

^
<include src="PRT.icf::INQ01.sel" map="i=L3943"/>

#OCustNo#OCustNoX
#OChequeName
#OChequeAcct#OReceiveDate
#OChequeNo#OAcDate
#OChequeDate#OEntryDate
#OChequeAmtX#OOutsideCodeX
#OBankItem#OAreaCodeX
#OBranchItem#OBktwFlagX
#OStatusCodeX#OTsibFlagX
#OUsageCodeX#OMediaFlagX
#OServiceCenterX#OCreditorId
#OCreditorBankItem
#ORelNo
^
</sub>
