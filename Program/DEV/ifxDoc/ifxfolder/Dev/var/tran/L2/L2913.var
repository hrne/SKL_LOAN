----- BASIC LABEL Variables ----------
<sub type="SYS">
#Submit=A,1,S
K(MODIFYBUTTON,查詢)
</sub>

<sub type="SYS" name="label">

!#TXCD
!T(3,L2913)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,27)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,75)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,20)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
! 權限檢查
<include src="COM.icf::BFHEAD2.dec"/>
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[130,1100];printer.width=[20,20];">
[
["[L2913]                                 股票擔保品資料查詢"],
["#FdClCode1+擔保品代號1",#ClCode1,#ClCode1X],
["#FdClCode2+擔保品代號2",#ClCode2,#ClCode2X],
["#FdClNo+擔保品號碼",#ClNo],
]

#FdClCode1=X,2,L
T(3,*)
#FdClCode2=X,2,L
#FdClNo=X,2,L
T(3,*)

!---------- AP Button AREA ----------
![Buttom資料查詢]
#BUF1=X,42,S
!---------- AP TEXT AREA Variables ----------
<include src="HELPRIM.icf::HELPRIM.rtn"/>

!ClTypeCode 擔保品類別
#CDDEF01=x,20,S
T(3,CdCode.ClTypeCode3)

#ClTypeCodeHelp=x,1024,S

!ListingType 掛牌別
#CDDEF02=x,30,S
T(3,CdCode.ListingType)

#ListingTypeHelp=x,1024,S

!StockType 股票種類
#CDDEF03=x,30,S
T(3,CdCode.StockType)

#StockTypeHelp=x,1024,S

!SettingStat 設定狀態
#CDDEF04=x,30,S
T(3,CdCode.SettingStatCode)

#SettingStatHelp=x,1024,S

!ClStat擔保品狀態
#CDDEF05=x,30,S
T(3,CdCode.ClStatCode)

#ClStatHelp=x,1024,S

!SyndCode 聯貸案類型
#CDDEF06=x,30,S
T(3,CdCode.SyndCode)

#SyndCodeHelp=x,1024,S

!ClStatus 擔保品狀況碼
#CDDEF07=x,30,S
T(3,CdCode.ClStatus)

#ClStatusHelp=x,1024,S

!JobTitle
#CDDEF08=x,20,S
T(3,CdCode.JobTitle)

#JobTitleHelp=x,1024,S

!Position
#CDDEF09=x,20,S
T(3,CdCode.Position)

#PositionHelp=x,1024,S

!EvaStandard
#CDDEF10=x,20,S
T(3,CdCode.EvaStandard)

#EvaStandardHelp=x,1024,S

#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#CDDEF01,#CDDEF02,#CDDEF03,#CDDEF04,#CDDEF05,#CDDEF06,#CDDEF07,#CDDEF08,#CDDEF09,#CDDEF10)
R(1,XXR99)
CALL(#HelpProc)
T(2,@ClTypeCodeHelp,#HelpDesc1)
T(2,@ListingTypeHelp,#HelpDesc2)
T(2,@StockTypeHelp,#HelpDesc3)
T(2,@SettingStatHelp,#HelpDesc4)
T(2,@ClStatHelp,#HelpDesc5)
T(2,@SyndCodeHelp,#HelpDesc6)
T(2,@ClStatusHelp,#HelpDesc7)
T(2,@JobTitleHelp,#HelpDesc8)
T(2,@PositionHelp,#HelpDesc9)
T(2,@EvaStandardHelp,#HelpDesc10)

!StockCode
#CDDEF0011=x,20,S
T(3,CdCode.StockCode)

#StockCodeHelp=x,1024,S 

#Help2Rim=X,1,S
RESET_RIM(#Help2Rim,XXR99)
S(XXR99,01,#CDDEF0011)
R(1,XXR99)
CALL(#HelpProc)
T(2,@StockCodeHelp,#HelpDesc1)

#YNHelp=x,20,S
T(3,Y:是;N:否)

#ClCode1Help=x,50,S
T(3,3:股票;4:其他有價證券)

#CHAIN=A,1,S
T(4,CHAIN$)

#NTXBUF=X,10,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
T(1,@ClCode1,#NTXBUF,1,1)
T(1,@ClCode2,#NTXBUF,2,2)
T(1,@ClNo,#NTXBUF,4,7)

!擔保品別1
#ClCode1=A,1,I
C(3,#CHAIN,1,s,$)
HELP(#ClCode1Help) 
@V(H,#ClCode1Help)

#ClCode1X=X,12,L
C(4,#ClCode1,S,$)
T(H,#ClCode1,#ClCode1Help)

!擔保品別2
#ClCode2=A,2,L
E(0,01)

#COLIND=A,3,S
T(2,#ClCode1+#ClCode2)

#ClCode2X=X,13,L
C(3,#ClCode1,3,T(3,股票),T(3,其他有價證券))

!擔保品號碼
#ClNo=A,7,I
C(3,#CHAIN,1,s,$)
@V(2,0)

#RimClCode1=A,1,S
#RimClCode2=A,2,S
#RimClNo=A,7,S

<include src="ROM.icf::L2R17.dec"/>
!RIM取原擔保品編號
#RimL2r17=X,1,S
E(0,@RimClCode1,#ClCode1)
E(0,@RimClCode2,#ClCode2)
E(0,@RimClNo,#ClNo)
RESET_RIM(#RimL2r17,L2R17)
S(L2R17,1,#RimClCode1,#RimClCode2,#RimClNo)
R(1,L2R17)
E(0,@OGdRid1,#L2r17GdrId1)
E(0,@OGdRid2,#L2r17GdrId2)
E(0,@OGdRnum,#L2r17GdrNum)

#RPTFG=A,1,S

#QuickXMT=A,1,S
C(3,#CHAIN,1,$,s)
XMT()

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>


!---------- TXFORM = L2913 ----------
<sub type="FORM" name="L2913">

!#SCRPRT=_,_,S
!C(5,#TXFORM,L2913,$,S)

#SCRTIL=_,_,S
T(3,[L2913] 股票擔保品資料)

!------ TOM(HEAD)   Variables (FOR OUTPUT SCREEN) ------
!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------

!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------

!擔保品編號
#OClCode1=A,1,L
T(2,#ClCode1)
#OClCode2=A,2,L
T(2,#ClCode2)
#OClNo=A,7,L
T(2,#ClNo)

![原擔保品編號]

#OGdRid1=A,1,L
#OGdRid2=A,2,L
#OGdRnum=A,7,L

#OGdALL=X,12,L
C(3,#OGdRid1,0,S,$)
T(2,#OGdRid1+-+#OGdRid2+-+#OGdRnum)

!地區別
#OCityCode=X,2,L

#OCityCodeX=X,20,L

!擔保品類別
#OClTypeCode=X,3,L

#OClTypeCodeX=X,40,L
T(3,)T(H,#OClTypeCode,#ClTypeCodeHelp)

!股票代號
#OStockCode=X,10,L
#OStockCodeX=X,20,L

!掛牌別
#OListingType=X,10,L
#OListingTypeX=X,10,L
T(3,)T(H,#OListingType,#ListingTypeHelp)

!股票種類
#OStockType=X,10,L
#OStockTypeX=X,10,L
T(3,)
T(H,#OStockType,#StockTypeHelp)

!發行公司統一編號
#OCompanyId=X,10,L
!資料年度
#ODataYear=A,3,L
!發行股數
#OIssuedShares=m,14,L
!非上市(櫃)每股淨值
#ONetWorth=m,14,L
!每股單價鑑估標準
#OEvaStandard=X,12,L
#OEvaStandardX=X,30,L
T(H,#OEvaStandard,#EvaStandardHelp)
!每股面額
#OParValue=m,14,L
!一個月平均價
#OMonthlyAvg=m,14,L
!前日收盤價
#OYdClosingPrice=m,14,L
!三個月平均價
#OThreeMonthAvg=m,14,L
!鑑定單價
#OEvaUnitPrice=m,14,L
!股票持有人統編
#OOwnerId=X,10,L
!股票持有人姓名
#OOwnerName=c,100,L
!公司內部人職稱
#OInsiderJobTitle=X,10,L
#OInsiderJobTitleX=X,30,L
T(H,#OInsiderJobTitle,#JobTitleHelp)
!公司內部人身分註記
#OInsiderPosition=X,10,L
#OInsiderPositionX=X,20,L
T(H,#OInsiderPosition,#PositionHelp)
!法定關係人統編
#OLegalPersonId=X,10,L
!貸放成數
#OLoanToValue=n,3.2,L
!擔保維持率
#OClMtr=n,3.2,L
!通知追繳維持率
#ONoticeMtr=n,3.2,L
!實行職權維持率
#OImplementMtr=n,3.2,L
!質權設定書號
#OPledgeNo=X,14,L
!計算維持率
#OComputeMTR=X,1,L
!設定狀態
#OSettingStat=A,1,S
#OSettingStatX=x,4,L
T(3,)T(H,#OSettingStat,#SettingStatHelp)

!擔保品狀態
#OClStat=A,1,S
#OClStatX=x,10,L
T(3,)T(H,#OClStat,#ClStatHelp)

!股票設解(質)日期
#OSettingDate=D,7,L
!設質股數餘額
#OSettingBalance=m,14,L
!鑑估日期
#OEvaDate=D,7,L
!鑑估值
#OEvaAmt=m,14,L
!擔保債權確定日期
#OMtgDate=D,7,L
!保管條號碼
#OCustodyNo=X,5,L
!聯貸案
#OSynd=X,1,L

#OSyndX=X,20,L
T(3,)T(H,#OSynd,#YNHelp)

!聯貸案類型
#OSyndCode=X,1,L

#OSyndCodeX=X,20,L
T(3,)T(H,#OSyndCode,#SyndCodeHelp)

!處分價格
#ODispPrice=m,14,L
!處分日期
#ODispDate=D,7,L
!擔保品狀況碼
#OClStatus=A,1,L

#OClStatusX=X,20,L
T(3,)T(H,#OClStatus,#ClStatusHelp)

</sub>


!------ 上行電文 ------
<sub type="TIM">
#ClCode1
#ClCode2
#ClNo
#END
</sub>


!------ 下行電文TOM ------
<sub type="TOM">
TXFORM=L2913
#OCityCode
#OCityCodeX
#OClTypeCode
#OStockCode
#OStockCodeX
#OListingType
#OStockType
#OCompanyId
#ODataYear
#OIssuedShares
#ONetWorth
#OEvaStandard
#OParValue
#OMonthlyAvg
#OYdClosingPrice
#OThreeMonthAvg
#OEvaUnitPrice
#OOwnerId
#OOwnerName
#OInsiderJobTitle
#OInsiderPosition
#OLegalPersonId
#OLoanToValue
#OClMtr
#ONoticeMtr
#OImplementMtr
#OPledgeNo
#OComputeMTR
#OSettingStat
#OClStat
#OSettingDate
#OSettingBalance
#OEvaDate
#OEvaAmt
#OMtgDate
#OCustodyNo
#OSynd
#OSyndCode
#ODispPrice
#ODispDate
#OClStatus
^
<include src="COM.icf::TRCTL.tom"/>
<include src="ROM.icf::L2R17.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
</sub>

<sub type="PART" name="L2913" layout="cols=3;screen.width=[130,370,130,370];printer.width=[15,30,15,30];order=1">
[
["[L2913]                                 股票擔保品資料查詢"],
["擔保品編號",#OClCode1,"-",#OClCode2,"-",#OClNo],["原擔保品編號",#OGdALL],
[#<->#,"地區別",#OCityCode,#OCityCodeX],
["擔保品類別",#OClTypeCode,#OClTypeCodeX],
[#<->#,"股票代號",#OStockCode,#OStockCodeX],
[#<->#,"<font color=red>@價格","@"],
["掛牌別",#OListingType,#OListingTypeX],["股票種類",#OStockType,#OStockTypeX],
["發行公司統一編號",#OCompanyId],["資料年度",#ODataYear],
["發行股數",#OIssuedShares],["非上市(櫃)每股淨值",#ONetWorth],
["每股單價鑑估標準",#OEvaStandard,#OEvaStandardX],["每股面額",#OParValue],
["一個月平均價",#OMonthlyAvg],["前日收盤價",#OYdClosingPrice],
["三個月平均價",#OThreeMonthAvg],["鑑定單價",#OEvaUnitPrice],
["股票持有人統編",#OOwnerId],["股票持有人姓名",#OOwnerName],
["公司內部人職稱",#OInsiderJobTitle,#OInsiderJobTitleX],["公司內部人身分註記",#OInsiderPosition,#OInsiderPositionX],
["法定關係人統編",#OLegalPersonId],["貸放成數",#OLoanToValue,"%"],
["擔保維持率",#OClMtr,"%"],["通知追繳維持率",#ONoticeMtr,"%"],
["實行職權維持率",#OImplementMtr,"%"],["質權設定書號",#OPledgeNo],
[#<->#,"計算維持率",#OComputeMTR],
[#<->#,"<font color=red>@質權","@"],
["設定狀態",#OSettingStatX],["擔保品狀態",#OClStatX],
["股票設(解)質日期",#OSettingDate],["設質股數餘額",#OSettingBalance],
["鑑估日期",#OEvaDate],["鑑估值",#OEvaAmt],
["擔保債權確定日期",#OMtgDate],["保管條號碼",#OCustodyNo],
["聯貸案",#OSynd,#OSyndX],["聯貸案類型",#OSyndCode,#OSyndCodeX],
["處分價格",#ODispPrice],["處分日期",#ODispDate],
[#<->#,"擔保品狀況碼",#OClStatus,#OClStatusX],
]
</sub>
!---------- 單據輸出組合 ----------
<sub type="SELECT">


#RPTFG=0,QUERY.GRID,L2913
#any={detail:false, header:'L2913.part', caption:'', width:1000, rowNum:20, rowList:[20,40,60]}

^
<include src="PRT.icf::INQ01.sel" map="i=L2913;cpi=15"/>

<include src="PRT.icf::INQ01.sel"/>
</sub>
