----- BASIC LABEL Variables ----------
<sub type="SYS">
#KeyInq=X,1,S
K(MODIFYBUTTON,查詢)
</sub>

<sub type="SYS" name="label">

!#TXCD
!T(3,L2001)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,0)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,80)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,20)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)

#FirstIn=A,1,S
E(0,0)

#BTNADDBUF=X,6,S
T(2,1+#ProdNo)

!L2101 商品參數維護
#BtnAddA=x,100,S
T(2,{cmd=CHAIN; ntxcd=L2101; ntxbuf=#BTNADDBUF; ntxbuf5=type})
ASGN(BTN_NEW1$)
K(MODIFYBUTTON,1,新增)

</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[180,820];printer.width=[20,20];">
[
["[L2001]                                 商品參數明細資料查詢"],
["#FdProdNo+商品代碼",#ProdNo],
["#FdProdStatus+商品狀態",#ProdStatus,#ProdStatusX],
["#FdEnterpriseFg+企金可使用記號",#EnterpriseFg,#EnterpriseFgX],
]
!---------- AP Button AREA ----------
![Buttom資料查詢]
! #BTN1=X,15,I,ui:button;value:新增商品參數;enable:1;tabbable:0;title:L2101 商品參數維護
!---------- AP TEXT AREA Variables ----------
! Help
<include src="HELPRIM.icf::HELPRIM.rtn"/>
!StatusCode
#CDDEF00001=x,30,S
T(3,CdCode.StatusCode)

#StatusCodeHelpRim=X,1,S
RESET_RIM(#StatusCodeHelpRim,XXR99)
S(XXR99,01,#CDDEF00001)
R(1,XXR99)
CALL(#HelpProc)
T(2,@StatusCodeHelp,#HelpDesc1)

#StatusCodeHelp=x,1024,S

#ProdStatusHelp=x,1024,S
T(3,0:全部;1:已生效;2:待生效;3:已失效)

#EnterpriseFgHelp=x,1024,S
T(3,:空白為查全部;Y:是)

#FdProdNo=X,2,L
#FdProdStatus=X,2,L
T(3,*)
#FdEnterpriseFg=X,2,L

#CHAIN=A,1,S
T(4,CHAIN$) 


#NTXBUF=X,7,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)

#NTXBUF5=X,10,S
C(3,#CHAIN,1,T(4,NTXBUF5$),S)
C(4,#NTXBUF5,E(0,@RPTFG2,1),E(0,@RPTFG2,2))



![商品代碼]

#ProdNo=X,5,I
C(3,#CHAIN,1,T(1,#NTXBUF,1,5),$)
C(3,#CHAIN,1,s,$)
C(3,#FirstIn,1,E(0,@CHAIN,1),$)
C(3,#FirstIn,1,S,$)
!HELP(AB001:;AB002:;AB003:;AB004:;AB005:)

#BUF1=X,10,S
!C(4,#ProdNo,HIDE(#BTN1),SHOW(#BTN1))
T(2,@BTNADDBUF,1+#ProdNo)
E(0,@FirstIn,0)

!L2101 商品參數維護
#BtnAddB=x,100,S
T(2,{cmd=CHAIN; ntxcd=L2101; ntxbuf=#BTNADDBUF; ntxbuf5=type})
ASGN(BTN_NEW1$)
K(MODIFYBUTTON,1,新增)


!商品狀態
#ProdStatus=A,1,I
C(3,#CHAIN,1,T(1,#NTXBUF,6,1),$)
C(3,#CHAIN,1,s,$)
HELP(#ProdStatusHelp)
@
V(H,#ProdStatusHelp)

#ProdStatusX=X,10,L
T(H,#ProdStatus,#ProdStatusHelp)

!企金可使用記號
#EnterpriseFg=X,1,I
C(3,#CHAIN,1,T(1,#NTXBUF,7,1),$)
C(3,#CHAIN,1,s,$)
HELP(#EnterpriseFgHelp)
@
V(H,#EnterpriseFgHelp)

#EnterpriseFgX=X,20,L
T(3,)T(H,#EnterpriseFg,#EnterpriseFgHelp)

!#BIND1=X,1,S
!BIND(#BTN1,click, {cmd=CHAIN; ntxcd=L2101; ntxbuf=#BUF1})

#RPTFG=A,1,S
E(0,0)

#RPTFG2=A,1,S
C(3,#RPTFG,0,$,S)
C(4,#NTXBUF5,T(3,1),T(3,2))

#CHAINXMT=X,1,S
C(3,#CHAIN,1,E(0,@CHAIN,0)XMT(),$)

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>


!---------- TXFORM = L2001 ----------
<sub type="FORM" name="L2001">

!#SCRPRT=_,_,S
!C(5,#TXFORM,L2001,$,S)

#SCRTIL=_,_,S
T(3,[L2001] 商品參數明細資料)

!------ TOM(HEAD)   Variables (FOR OUTPUT SCREEN) ------
!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------
#OProdNo=X,5,L
T(2,#ProdNo)

!修改
#FUNC2=A,1,S
E(0,2)

!複製
#FUNC3=X,6,S
T(3,3)

!刪除
#FUNC4=A,1,S
E(0,4)

!查詢
#FUNC5=A,1,S
E(0,5)



#WkSysDate=D,7,S
E(0,#SYSDATE)

!日曆日
#wkSYSCDATE=D,7,S
E(0,#SYSCDATE)
!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------
#LOOP=X,1,S
T(3,1)ASGN(LOOP$)

#OOProdNo=X,5,O

#OOStartDate=D,7,O


!檢查生效日期是否生效 1為生效 0為未生效
#checkeffdate=A,1,S
E(0,0)
IF(#OOStartDate <= #wkSYSCDATE,E(0,1),E(0,0))
C(3,#checkeffdate,1,T(3,@OOStatusCodeX,已生效),T(3,@OOStatusCodeX,待生效))


#OOEndDate=D,7,O
C(3,#OOEndDate,0,S,$)
C(3,#OOEndDate,9991231,S,$)
IF(#OOEndDate < #wkSYSCDATE,T(3,@OOStatusCodeX,已失效),$)

#OOStatusCode=A,1,S
!0啟用時判斷是否生效
#OOStatusCodeX=X,6,O
! C(3,#OOStatusCode,1,$,s)
! T(H,#OOStatusCode,#StatusCodeHelp)
! C(3,#OOStatusCode,0,$,s)

! C(2,#OOStatusCode,T(3,啟用),T(3,停用),T(3, ))

#OOProdName=X,60,O

!修改
#OOBUF2=X,10,S
T(2,#FUNC2+#OOProdNo)

#OOBTN2=X,1,S
BIND(grid,{ cmd=CHAIN; ntxcd=L2101; ntxbuf=#OOBUF2})

!複製
#OOBUF3=X,71,S
T(2,#FUNC3+#OOProdNo+#OOProdName)

#OOBTN3=X,1,S
BIND(grid,{ cmd=CHAIN; ntxcd=L2101; ntxbuf=#OOBUF3})

!刪除
#OOBUF4=X,10,S
T(2,#FUNC4+#OOProdNo)

#OOBTN4=X,1,S
IF(#OOStartDate <= #wkSYSCDATE,BIND(grid,cancel),BIND(grid,{ cmd=CHAIN; ntxcd=L2101; ntxbuf=#OOBUF4}))

!查詢
#OOBUF5=X,10,S
T(2,#FUNC5+#OOProdNo)

#OOBTN5=X,1,S
BIND(grid,{ cmd=CHAIN; ntxcd=L2101; ntxbuf=#OOBUF5})

</sub>


!------ 上行電文 ------
<sub type="TIM">

#ProdNo#ProdStatus#EnterpriseFg#END

</sub>


!------ 下行電文TOM ------
<sub type="TOM">

TXFORM=L2001
#OOProdNo#OOStartDate#OOEndDate#OOStatusCode#OOProdName
^

<include src="COM.icf::TRCTL.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
</sub>
<sub type="PART" name="L2001" layout="cols=1;screen.width=[130,870];printer.width=[15,30,15,30];">
[
["[L2001]                                 商品參數明細資料查詢                                                                            "],
! ["@商品代碼",#OProdNo],
]
</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">

#RPTFG2=1,QUERY.GRID,L2001
#any={detail:true, header:'L2001.part', caption:'', width:1010, rowNum:20, rowList:[20,40,60]}

#OOBTN2=修改
{width:50,search:false,formatter:'cust:bind-button:修改;L2101 商品參數維護',align:'center',canExport:false}

#OOBTN3=複製
{width:50,search:false,formatter:'cust:bind-button:複製;L2101 商品參數維護',align:'center',canExport:false}

#OOBTN4=刪除
{width:50,search:false,formatter:'cust:bind-button:刪除;L2101 商品參數維護',align:'center',canExport:false}

#OOBTN5=查詢
{width:50,search:false,formatter:'cust:bind-button:查詢;L2101 商品參數維護',align:'center',canExport:false}

#OOProdNo=商品代碼
{width:100,align:'center'}

#OOStartDate=生效日期 
{width:80,align:'center'}

#OOEndDate=截止日期 
{width:75,align:'center'}

#OOStatusCodeX=商品狀態 
{width:75,align:'center'}

#OOProdName=商品名稱  
{width:400,align:'left'}

^

#RPTFG2=2,QUERY.GRID,L2001
#any={detail:true, header:'L2001.part', caption:'', width:1010, rowNum:20, rowList:[20,40,60]}

#OOProdNo=商品代碼
{width:100,align:'center'}

#OOStartDate=生效日期 
{width:80,align:'center'}

#OOEndDate=截止日期 
{width:75,align:'center'}

#OOStatusCodeX=商品狀態 
{width:75,align:'center'}

#OOProdName=商品名稱  
{width:400,align:'left'}

^
<include src="PRT.icf::INQ01.sel" map="i=L2001;cpi=15"/>
#OProdNo
%
#OOProdNo#OOStartDate#OOEndDate#OOStatusCodeX#OOProdName
@^
</sub>
