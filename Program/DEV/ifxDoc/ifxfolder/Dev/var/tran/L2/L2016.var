----- BASIC LABEL Variables ----------
<sub type="SYS">
#KeyInq=X,1,S
K(MODIFYBUTTON,查詢)
</sub>

<sub type="SYS" name="label">

!#TXCD
!T(3,L2016)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,0)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,159)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,20)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)


</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[150,850];printer.width=[20,20];">
[
["[L2016]                                 核准號碼明細資料查詢"],
["#FdMain+查詢條件","@(核准號碼區間、戶號、戶名，需擇一輸入)"],
["#FdApplNo1+核准號碼區間",#ApplNo1,"-",#ApplNo2],
["#FdCustNo+戶號",#CustNo],
["#FdCustName+戶名",#CustName],
["#FdColSetCode+設定擔保品記號",#ColSetCode,#ColSetCodeX],
]
#FdMain=X,2,L
T(3,*)
T(3,@FdColSetCode,*)
T(3,@FdRptFg,*)
!---------- AP Button AREA ----------
![Buttom資料查詢]

!---------- AP TEXT AREA Variables ----------
<include src="HELPRIM.icf::HELPRIM.rtn"/>

#CDDEF01=x,26,S
T(3,CdCode.Currency)

#CurrencyHelp=x,1024,S

#CDDEF02=x,26,S
T(3,CdCode.CurrPrecision)

#CurrPrecisionHelp=x,1024,S

#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#CDDEF01,#CDDEF02)
R(1,XXR99)
CALL(#HelpProc)
T(2,@CurrencyHelp,#HelpDesc1)
T(2,@CurrPrecisionHelp,#HelpDesc2)

#ColSetCodeHelp=X,50,S
T(3,0:查詢全部;1:查詢未設定;2:查詢已設定)

#CHAIN=A,1,S
T(4,CHAIN$)

#NTXBUF=X,15,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)

#NTXBUF5=X,10,S
C(3,#CHAIN,1,T(4,NTXBUF5$),S)
C(4,#NTXBUF5,E(0,@RPTFG2,1),E(0,@RPTFG2,2))


![核准號碼查詢起號]
#FdApplNo1=X,2,L

#ApplNo1=A,7,I
C(3,#CHAIN,1,T(1,#NTXBUF,1,7),$)
C(3,#CHAIN,1,s,$)

!核准號碼查詢止號
#ApplNo2=A,7,I
C(3,#CHAIN,1,T(1,#NTXBUF,8,7),$)
C(3,#CHAIN,1,s,$)
C(3,#ApplNo1,0,S,E(0,#ApplNo1))
@V(5,#ApplNo1,9999999)

!戶號
#FdCustNo=X,2,L

#CustNo=A,7,I
C(3,#ApplNo1,0,$,S)
C(3,#CHAIN,1,s,$)

!戶名
#FdCustName=X,2,L
C(3,#ApplNo1,0,T(3,*),S)
C(3,#CustNo,0,T(3,*),S)

#CustName=X,100,I
C(3,#ApplNo1,0,$,S)
C(3,#CustNo,0,$,S)
C(3,#CHAIN,1,s,$)
!@V(7)
@C(3,#ApplNo1,0,C(3,#ApplNo2,0,C(3,#CustNo,0,C(4,#CustName,V(P,核准號碼區間、戶號、戶名，需擇一輸入),$),$),$),$)

![設定擔保品記號]
#FdColSetCode=X,2,L
T(3,*)

#ColSetCode=A,1,I
C(3,#CHAIN,1,T(1,#NTXBUF,15,1),$)
C(3,#CHAIN,1,s,$)
HELP(#ColSetCodeHelp)
E(0,0)
@V(H,#ColSetCodeHelp)

#ColSetCodeX=X,10,L
T(H,#ColSetCode,#ColSetCodeHelp)


#FdRptFg=X,2,L
T(3,*)

#MRKEY=_,_,S
T(2,#CustNo)

#RPTFG=A,1,S

#RPTFG2=A,1,S
C(3,#RPTFG,0,$,S)
C(4,#NTXBUF5,T(3,1),T(3,2))

#Return=A,1,S
E(0,0)
C(3,#CHAIN,1,E(0,@CHAIN,0),$)

![折返KEY]
#ReturnText=X,17,S

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>


!---------- TXFORM = L2016 ----------
<sub type="FORM" name="L2016">

!#SCRPRT=_,_,S
!C(5,#TXFORM,L2016,$,S)

#SCRTIL=_,_,S
T(3,[L2016] 核准號碼明細資料)

#OApplNo=A,7,L
E(0,#ApplNo1)

#OColSetCode=A,1,S
E(0,#ColSetCode)

#OColSetCodeX=X,10,L
T(2,#ColSetCodeX)

!修改
#Func2=A,1,S
E(0,2)

!刪除
#Func4=A,1,S
E(0,4)

!查詢
#Func5=A,1,S
E(0,5)

!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------
#LOOP=X,1,S
T(3,1)ASGN(LOOP$)

#OOApplNo=A,7,O

#OOCustNo=A,7,O

#OOFacmNo=A,3,O

#OOCurrencyCode=X,3,O

#OOCurrencyCodeX=X,10,S
T(H,#OOCurrencyCode,#CurrencyHelp)

#Precision=N,1,S
T(H,#OOCurrencyCode,#CurrPrecisionHelp)

#OOLineAmt=m,14.2,S

#OOLineAmtX=X,22,O
CALL2(#ADJUSTDOT,#Precision,#OOLineAmt,#OOLineAmtX)
P(R,#OOLineAmtX)

#OOUtilAmt=m,14.2,S

#OOColSetFlag=X,1,S

#OOColSetFlagX=X,6,O
C(5,#OOColSetFlag,Y,T(3,已設定),T(3,未設定))

#OOCustName=X,100,O

#OOLoanFg=X,1,S

!修改
#OOBUF2=X,11,S
T(2,#Func2+#OOCustNo+#OOFacmNo)

#OOBTN2=X,1,S
BIND(grid,{ cmd=CHAIN; ntxcd=L2154; ntxbuf=#OOBUF2})

!刪除
!額度已撥款須[DISABLE]
#OOBUF4=X,11,S
T(2,#Func4+#OOCustNo+#OOFacmNo)

#OOBTN4=X,1,S
BIND(grid,{ cmd=CHAIN; ntxcd=L2154; ntxbuf=#OOBUF4})
C(5,#OOLoanFg,N,BIND(grid,cancel),$)
!C(3,#OOUtilAmt,0,BIND(grid,{ cmd=CHAIN; ntxcd=L2154; ntxbuf=#OOBUF4}),BIND(grid,cancel))

!查詢
#OOBUF5=X,18,S
T(2,#Func5+#OOCustNo+#OOFacmNo)




#OOBTN5=X,1,S
BIND(grid,{ cmd=CHAIN; ntxcd=L2154; ntxbuf=#OOBUF5})

</sub>


!------ 上行電文 ------
<sub type="TIM">

#ApplNo1#ApplNo2#CustNo#CustName#ColSetCode#Return#END#ReturnText

</sub>


!------ 下行電文TOM ------
<sub type="TOM">

TXFORM=L2016
#OOApplNo#OOCustNo#OOFacmNo#OOCurrencyCode
#OOLineAmt#OOUtilAmt#OOColSetFlag#OOCustName#OOLoanFg
^
<include src="COM.icf::TRCTL.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
</sub>

<sub type="PART" name="L2016" layout="cols=1;screen.width=[130,870];printer.width=[15,30,15,30];order=1">
[
["[L2016]                                 核准號碼明細資料查詢"],
[""],
!["@核准號碼查詢起號",#OApplNo],
!["@設定擔保品記號",#OColSetCodeX],
]
</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">

#RPTFG2=1,QUERY.GRID,L2016
#any={detail:true, header:'L2016.part', caption:'', width:1010, rowNum:20, rowList:[20,40,60]}
#OOBTN2=修改
{width:50,search:false,formatter:'cust:bind-button:修改;L2154 額度資料維護',align:'center',canExport:false}

#OOBTN4=刪除
{width:50,search:false,formatter:'cust:bind-button:刪除;L2154 額度資料維護',align:'center',canExport:false}

#OOBTN5=查詢
{width:50,search:false,formatter:'cust:bind-button:查詢;L2154 額度資料維護',align:'center',canExport:false}

#OOApplNo=核准號碼
{width:80,align:'center'}

#OOCustNo=戶號
{width:80,align:'center'}

#OOFacmNo=額度編號
{width:80,align:'center'}

#OOCurrencyCode=幣別
{width:50,align:'center'}

#OOLineAmtX=核准額度
{width:170,align:'right'}

#OOColSetFlagX=設定擔保品
{width:100,align:'center'}

#OOCustName=戶名
{width:350,align:'left'}

^

#RPTFG2=2,QUERY.GRID,L2016
#any={detail:true, header:'L2016.part', caption:'', width:1010, rowNum:20, rowList:[20,40,60]}

#OOApplNo=核准號碼
{width:80,align:'center'}

#OOCustNo=戶號
{width:80,align:'center'}

#OOFacmNo=額度編號
{width:80,align:'center'}

#OOCurrencyCode=幣別
{width:50,align:'center'}

#OOLineAmtX=核准額度
{width:170,align:'center'}

#OOColSetFlagX=設定擔保品
{width:100,align:'center'}

#OOCustName=戶名
{width:350,align:'left'}

^
<include src="PRT.icf::INQ01.sel" map="i=L2016;cpi=15"/>
#OApplNo#OColSetCode#OColSetCodeX
%
#OOApplNo#OOCustNo#OOFacmNo#OOCurrencyCode#OOLineAmt#OOColSetFlagX#OOCustName
@^
</sub>
