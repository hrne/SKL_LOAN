 ----- BASIC LABEL Variables ----------
<sub type="SYS">
#Submit=A,1,S
K(MODIFYBUTTON,查詢)K(NOBUTTON,CLOSEY)
</sub>

<sub type="SYS" name="label">

!#TXCD
!T(3,L2915)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,27)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,75)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,20)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
! 權限檢查
<include src="COM.icf::BFHEAD2.dec"/>
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[230,1300];printer.width=[20,20];">
[
["[L2915]                                 不動產建物資料查詢"],
["#FdClCode1+擔保品代號1",#ClCode1,#ClCode1X],
["#FdClCode2+擔保品代號2",#ClCode2,#ClCode2X],
["#FdClNo+擔保品號碼",#ClNo],
["#FdGdRid+原擔保品編號",#GdALL],
["@",#BTN_1,"@",#BTN_2,"@",#BTN_3,"@",#BTN_4,"@",#BTN_5,"@",#BTN_6,"@",#BTNExpand],
["#FdBdLocation+建物門牌",#BdLocation],
["#FdBdMainUseCode+建物主要用途",#BdMainUseCode,#BdMainUseCodeX],
["#FdBdMtrlCode+建物主要建材",#BdMtrlCode,#BdMtrlCodeX],
["#FdBdTypeCode+建物類別",#BdTypeCode,#BdTypeCodeX],
["#FdTotalFloor+總樓層",#TotalFloor,"層"],
["#FdFloorNo+擔保品所在樓層",#FloorNo,"層"],
["#FdFloorArea+擔保品所在樓層面積",#FloorArea,"坪"],
["#FdEvaUnitPrice+鑑價單價",#EvaUnitPrice,"元／坪"],
["#FdRoofStructureCode+屋頂結構",#RoofStructureCode,#RoofStructureCodeX],
["#FdBdDate+建築完成日期",#BdDate],
["#FdBdSubUsageCode+附屬建物用途",#BdSubUsageCode,#BdSubUsageCodeX],
["#FdBdSubArea+附屬建物面積",#BdSubArea,"坪"],
["#FdSellerId+賣方統編",#SellerId],
["#FdSellerName+賣方姓名",#SellerName],
["#FdContractPrice+買賣契約價格",#ContractPrice],
["#FdContractDate+買賣契約日期",#ContractDate],
["#FdBdUsageCode+建物使用別",#BdUsageCode,#BdUsageCodeX],
["#FdParkingTypeCode+停車位型式",#ParkingTypeCode,#ParkingTypeCodeX],
["#FdPARKING_AREA+停車位面積",#ParkingArea],
["#FdHouseTaxNo+房屋稅籍號碼",#HouseTaxNo],
["#FdHouseBuyDate+房屋取得日期",#HouseBuyDate],
["#FdClStatus+押品狀況碼",#ClStatus,#ClStatusX],
["#grid#,{id:1,expand:true,loop:10,row_height:1,s_cols:[], p_cols:[]}","@@@@@@公設建號","公共設施登記面積",#OOPUBBUILDAREA,"坪",
["建號","登記面積(坪)","所有權人統編","所有權人姓名"],
[[[#PublicBdNoA1],["-"],[#PublicBdNoB1]],[#PublicArea1],[#PublicOwnerId1],[#PublicOwnerName1]]],
["#grid#,{id:0,expand:true,loop:5,row_height:1,s_cols:[200,100,100,200], p_cols:[20,20,20]}","#FdPP+停車位型式","","",
["停車位型式","停車位數量","停車位面積"],
[[#ParkingTypeCodeXA1],#ParkingQtyA1,#ParkingAreaA1]
],
["#grid#,{id:2,expand:true,loop:100,row_height:1,s_cols:[100,90,210,140,190,140,140,140], p_cols:[20,20,30,40,20,30,30,30]}","#FdPP+車位資料","","",
["車位編號","車位數","停車位類別","權利範圍","登記面積(坪)","建號","地號","價格(元)"],
[#ParkingNo1,#ParkingQty1,[#ParkingTypeCode1,#ParkingTypeCodeX1],[#ParkingOwnerPart1,"/",#ParkingOwnerTotal1],#ParkingArea1,[#ParkingBdNoA1,"-",#ParkingBdNoB1],[#ParkingLandNoA1,"-",#ParkingLandNoB1],#ParkingAmount1]
],

["#grid#,{id:3,expand:true,loop:10,row_height:1,s_cols:[], p_cols:[]}","@@@@@@建物所有權人","","",
["統編","姓名","與授信戶關係","持份比率"],
[[#OwnerId1],[#OwnerName1],[[#OwnerRelCode1],[#OwnerNameOwnerRelCodeX1]],[[#OwnerPart1],["/"],[#OwnerTotal1]]]],
["#grid#,{id:4,expand:true,loop:10,row_height:1,s_cols:[], p_cols:[]}","@@@@@@建物修改原因","","",
["原因","建立者","建立日期"],
[[[#Reason1],[#ReasonX1],[#OtherReason1]],[#CreateEmpNo1],[#CreateDate1]]],
]


#FdClCode1=X,2,L
T(3,)
#FdClCode2=X,2,L
T(3,)
#FdClNo=X,2,L
T(3,)
#FdBdLocation=X,2,L
#FdBdMainUseCode=X,2,L
#FdBdMtrlCode=X,2,L
#FdBdTypeCode=X,2,L
#FdTotalFloor=X,2,L
#FdFloorNo=X,2,L
#FdFloorArea=X,2,L
#FdEvaUnitPrice=X,2,L
#FdRoofStructureCode=X,2,L
#FdBdDate=X,2,L
#FdBdSubUsageCode=X,2,L
#FdBdSubArea=X,2,L
#FdSellerId=X,2,L
#FdSellerName=X,2,L
#FdContractPrice=X,2,L
#FdContractDate=X,2,L
#FdBdUsageCode=X,2,L
#FdParkingTypeCode=X,2,L
#FdPARKING_AREA=X,2,L
#FdHouseTaxNo=X,2,L
#FdHouseBuyDate=X,2,L
#FdClStatus=X,2,L

!---------- AP Button AREA ----------
![Buttom資料查詢]
#BUF1=X,42,S
#BTN_1=X,4,I,ui:button;value:建物門牌;enable:1;tabbable:0
#BTN_2=X,4,I,ui:button;value:建物資料;enable:1;tabbable:0
#BTN_3=X,4,I,ui:button;value:公設建號;enable:1;tabbable:0
#BTN_4=X,4,I,ui:button;value:車位資料;enable:1;tabbable:0
#BTN_5=X,4,I,ui:button;value:建物所有權人;enable:1;tabbable:0
#BTN_6=X,4,I,ui:button;value:建物修改原因;enable:1;tabbable:0

#BIND_1=X,1,S
BIND(#BTN_1,click, {cmd=CALLSEND;DOCODE=SHOW_1})

#BIND_2=X,1,S
BIND(#BTN_2,click, {cmd=CALLSEND;DOCODE=SHOW_2})

#BIND_3=X,1,S
BIND(#BTN_3,click, {cmd=CALLSEND;DOCODE=SHOW_3})

#BIND_4=X,1,S
BIND(#BTN_4,click, {cmd=CALLSEND;DOCODE=SHOW_4})

#BIND_5=X,1,S
BIND(#BTN_5,click, {cmd=CALLSEND;DOCODE=SHOW_5})

#BIND_6=X,1,S
BIND(#BTN_6,click, {cmd=CALLSEND;DOCODE=SHOW_6})

#PAGE_FG=A,1,S
E(0,0)

#SHOW_1=@,1,S
IF(#PAGE_FG==1,E(0,@PAGE_FG,0),E(0,@PAGE_FG,1))
CALL(#RESET_PAGES)

#SHOW_2=@,1,S
IF(#PAGE_FG==2,E(0,@PAGE_FG,0),E(0,@PAGE_FG,2))
CALL(#RESET_PAGES)

#SHOW_3=@,1,S
IF(#PAGE_FG==3,E(0,@PAGE_FG,0),E(0,@PAGE_FG,3))
CALL(#RESET_PAGES)

#SHOW_4=@,1,S
IF(#PAGE_FG==4,E(0,@PAGE_FG,0),E(0,@PAGE_FG,4))
CALL(#RESET_PAGES)

#SHOW_5=@,1,S
IF(#PAGE_FG==5,E(0,@PAGE_FG,0),E(0,@PAGE_FG,5))
CALL(#RESET_PAGES)

#SHOW_6=@,1,S
IF(#PAGE_FG==6,E(0,@PAGE_FG,0),E(0,@PAGE_FG,6))
CALL(#RESET_PAGES)

#Expand=@,1,S
IF(#PAGE_FG==7,E(0,@PAGE_FG,0),E(0,@PAGE_FG,7))
CALL(#RESET_PAGES)

!控制按鈕變色
#KLIGHT=@,1,S
C(3,#PAGE_FG,1,K(LIGHT,#BTN_1,TXTRED,0),K(LIGHT,#BTN_1,TXTRED,-1))
C(3,#PAGE_FG,2,K(LIGHT,#BTN_2,TXTRED,0),K(LIGHT,#BTN_2,TXTRED,-1))
C(3,#PAGE_FG,3,K(LIGHT,#BTN_3,TXTRED,0),K(LIGHT,#BTN_3,TXTRED,-1))
C(3,#PAGE_FG,4,K(LIGHT,#BTN_4,TXTRED,0),K(LIGHT,#BTN_4,TXTRED,-1))
C(3,#PAGE_FG,5,K(LIGHT,#BTN_5,TXTRED,0),K(LIGHT,#BTN_5,TXTRED,-1))
C(3,#PAGE_FG,6,K(LIGHT,#BTN_6,TXTRED,0),K(LIGHT,#BTN_6,TXTRED,-1))
C(3,#PAGE_FG,7,K(LIGHT,#BTNExpand,TXTRED,0),K(LIGHT,#BTNExpand,TXTRED,-1))

#RESET_PAGES=@,1,S
INVOKEJS(SHOW,p1,6,32,0)
INVOKEJS(SHOW,grd0,0)
INVOKEJS(SHOW,grd1,0)
INVOKEJS(SHOW,grd2,0)
INVOKEJS(SHOW,grd3,0)
INVOKEJS(SHOW,grd4,0)
CALL(#KLIGHT)
SWITCH(#PAGE_FG,1,INVOKEJS(SHOW,p1,6,6,1),
                2,INVOKEJS(SHOW,p1,7,27,1),
                3,INVOKEJS(SHOW,p1,28,28,1)INVOKEJS(SHOW,grd1,1),
                4,INVOKEJS(SHOW,p1,29,30,1)INVOKEJS(SHOW,grd0,1)INVOKEJS(SHOW,grd2,1),
                5,INVOKEJS(SHOW,p1,31,31,1)INVOKEJS(SHOW,grd3,1),
                6,INVOKEJS(SHOW,p1,32,32,1)INVOKEJS(SHOW,grd4,1),
                7,INVOKEJS(SHOW,p1,6,32,1)INVOKEJS(SHOW,grd0,1)INVOKEJS(SHOW,grd1,1)INVOKEJS(SHOW,grd2,1)INVOKEJS(SHOW,grd3,1)INVOKEJS(SHOW,grd4,1),
                $)
!---------- AP TEXT AREA Variables ----------

<include src="HELPRIM.icf::HELPRIM.rtn"/>

!ClCode1 擔保品代號1
#ClCode1Help=x,20,S
T(3,1:房地;2:土地)

#YNHelp=x,20,S
T(3,Y:是;N:否)
              

!ClCode2 擔保品代號2
#CDDEF01=x,20,S
T(3,CdCode.ClCode21)

#ClCode21Help=x,1024,S

!ClCode2 擔保品代號2
#CDDEF02=x,30,S
T(3,CdCode.ClCode22)

#ClCode22Help=x,1024,S

!BdMainUseCode 建物主要用途
#CDDEF03=x,30,S
T(3,CdCode.BdMainUseCode)

#BdMainUseCodeHelp=x,1024,S

!BdMtrlCode 建物主要建材
#CDDEF04=x,30,S
T(3,CdCode.BdMtrlCode)

#BdMtrlCodeHelp=x,1024,S

!BdTypeCode 建物類別
#CDDEF05=x,30,S
T(3,CdCode.BdTypeCode)

#BdTypeCodeHelp=x,1024,S

!RoofStructureCode 屋頂結構
#CDDEF06=x,30,S
T(3,CdCode.RoofStructure)

#RoofStructureHelp=x,1024,S

!BdSubUsageCode 附屬建物用途
#CDDEF07=x,30,S
T(3,CdCode.BdSubUsageCode)

#BdSubUsageCodeHelp=x,1024,S

!BdSubUsageCode 建物使用別
#CDDEF08=x,30,S
T(3,CdCode.BdUsageCode)

#BdUsageCodeHelp=x,1024,S

!ParkingTypeCode 停車位型式
#CDDEF09=x,30,S
T(3,CdCode.ParkingTypeCode)

#ParkingTypeCodeHelp=x,1024,S

!Reason
#CDDEF10=x,20,S
T(3,CdCode.ModifyReason)

#ReasonHelp=x,1024,S

!OwnerRelCode
#CDDEF11=x,20,S
T(3,CdGuarantor)

#OwnerRelCodeHelp=x,3000,S

!ClStatus 擔保品狀況碼
#CDDEF12=x,30,S
T(3,CdCode.ClStatus)

#ClStatusHelp=x,1024,S

#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#CDDEF01,#CDDEF02,#CDDEF03,#CDDEF04,#CDDEF05,#CDDEF06,#CDDEF07,#CDDEF08,#CDDEF09,#CDDEF10)
R(1,XXR99)
CALL(#HelpProc)
T(2,@ClCode21Help,#HelpDesc1)
T(2,@ClCode22Help,#HelpDesc2)
T(2,@BdMainUseCodeHelp,#HelpDesc3)
T(2,@BdMtrlCodeHelp,#HelpDesc4)
T(2,@BdTypeCodeHelp,#HelpDesc5)
T(2,@RoofStructureHelp,#HelpDesc6)
T(2,@BdSubUsageCodeHelp,#HelpDesc7)
T(2,@BdUsageCodeHelp,#HelpDesc8)
T(2,@ParkingTypeCodeHelp,#HelpDesc9)
T(2,@ReasonHelp,#HelpDesc10)

#HelpRim2=X,1,S
RESET_RIM(#HelpRim2,XXR99)
S(XXR99,01,#CDDEF11,#CDDEF12)
R(1,XXR99)
CALL(#HelpProc)
T(2,@OwnerRelCodeHelp,#HelpDesc1)
T(2,@ClStatusHelp,#HelpDesc2)

#CHAIN=A,1,S
T(4,CHAIN$)
IF(#CHAIN!=1,V(P,此為連動交易，請從交易:[L2911不動產擔保品資料查詢]進入),$)
CALL(#Init)


#NTXBUF=X,12,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
T(1,@ClCode1,#NTXBUF,1,1)
T(1,@ClCode2,#NTXBUF,2,2)
T(1,@ClNo,#NTXBUF,4,7)

#Init=@,1,S
!K(NOBUTTON,CLOSE)
IF(#PAGE_FG==1,$,CALL(#SHOW_1))
CALL(#RESET_PAGES)
##loop{times:10,i:1}
CALL(#HIDE_PE_ROW_{i})
CALL(#HIDE_PP_ROW_{i})
CALL(#HIDE_OWNER_ROW_{i})
HIDE(#OtherReason1)
##end

#LbCONTROL_FG=A,1,S
E(0,1)

! [代號1]
#ClCode1=A,1,L
C(3,#CHAIN,1,s,$)
HELP(#ClCode1Help) 
@V(H,#ClCode1Help)
 

#ClCode1X=X,4,L
T(3,)T(H,#ClCode1,#ClCode1Help)

#ClCode2Help=x,1024,S
IF (#ClCode1==1,T(2,#ClCode21Help),
IF (#ClCode1==2,T(2,#ClCode22Help),))


! [代號2]
#ClCode2=A,2,L
C(3,#CHAIN,1,s,$)
HELP(#ClCode2Help,cols:3) 
@V(H,#ClCode2Help) 

#COLIND=A,3,S
T(2,#ClCode1+#ClCode2)

#ClCode2X=X,13,L
T(3,)T(H,#ClCode2,#ClCode2Help)

![擔保品編號]
#ClNo=A,7,L
C(3,#CHAIN,1,s,$)
@V(2,0)

<include src="ROM.icf::L2R17.dec"/>
!RIM取原擔保品編號
#RimL2r17=X,1,S
E(0,@RimClCode1,#ClCode1)
E(0,@RimClCode2,#ClCode2)
E(0,@RimClNo,#ClNo)
RESET_RIM(#RimL2r17,L2R17)
S(L2R17,1,#RimClCode1,#RimClCode2,#RimClNo)
R(1,L2R17)
E(0,@GdRid1,#L2r17GdrId1)
E(0,@GdRid2,#L2r17GdrId2)
E(0,@GdRnum,#L2r17GdrNum)
E(0,@Lgtseq,#L2r17LgtSeq)

![原擔保品編號]
#FdGdRid=X,2,L

#GdRid1=A,1,L
#GdRid2=A,2,L
#GdRnum=A,7,L
#Lgtseq=A,2,L

#GdALL=X,15,L
C(3,#GdRid1,0,S,$)
T(2,#GdRid1+-+#GdRid2+-+#GdRnum+-+#Lgtseq)


!調RIM參數
#RimClCode1=A,1,S
#RimClCode2=A,2,S
#RimClNo=A,7,S
#RimFunCd=A,1,S

<include src="ROM.icf::L2R27.dec"/>
!RIM取擔保主檔
#RimL2r27A=X,1,S
E(0,@RimClCode1,#ClCode1)
E(0,@RimClCode2,#ClCode2)
E(0,@RimClNo,#ClNo)
E(0,@RimFunCd,5)
RESET_RIM(#RimL2r27A,L2R27)
S(L2R27,1,#RimClCode1,#RimClCode2,#RimClNo,#RimFunCd)
R(1,L2R27)

#checkL2r27A=X,1,S
##loop{times:5,i:1}
E(0,@ParkingTypeCodeA{i},#L2r27ParkingTypeCodeA{i})
E(0,@ParkingQtyA{i},#L2r27ParkingQtyA{i})
E(0,@ParkingAreaA{i},#L2r27ParkingAreaA{i})
##end

!RIM取擔保品別
#RimL2915=X,1,S
E(0,@RimClCode1,#ClCode1)
E(0,@RimClCode2,#ClCode2)
E(0,@RimClNo,#ClNo)
RESET_RIM(#RimL2915,L2915)
S(L2915,1,#RimClCode1,#RimClCode2,#RimClNo)
R(1,L2915)

! 調RIM取資料
#checkL2915=X,1,S

! [建物門牌]
#BdLocation=x,150,L

! [建物主要用途]
#BdMainUseCode=A,2,L
IF(#PAGE_FG==2,$,CALL(#SHOW_2))

#BdMainUseCodeX=X,15,L
T(3,)T(H,#BdMainUseCode,#BdMainUseCodeHelp)

! [建物主要建材]
#BdMtrlCode=A,2,L

#BdMtrlCodeX=X,13,L
T(3,)T(H,#BdMtrlCode,#BdMtrlCodeHelp)

! [建物類別]
#BdTypeCode=A,2,L

#BdTypeCodeX=X,10,L
T(3,)T(H,#BdTypeCode,#BdTypeCodeHelp)

! [總樓層]
#TotalFloor=X,3,L

! [擔保品所在樓層]
#FloorNo=X,7,L

! [擔保品所在樓層面積]
#FloorArea=m,5.2,L

! [鑑價單價／坪]
#EvaUnitPrice=m,14.2,L

! [屋頂結構]
#RoofStructureCode=X,2,L

#RoofStructureCodeX=X,10,L
T(3,)T(H,#RoofStructureCode,#RoofStructureHelp)

! [建築完成日期]
#BdDate=D,7,L

! [附屬建物用途]
#BdSubUsageCode=X,2,L

#BdSubUsageCodeX=X,4,L
T(3,)T(H,#BdSubUsageCode,#BdSubUsageCodeHelp)

! [附屬建物面積]
#BdSubArea=m,5.2,L

! [賣方統編]
#SellerId=X,10,L

! [賣方姓名]
#SellerName=c,100,L

! [買賣契約價格]
#ContractPrice=m,14,L

! [買賣契約日期]
#ContractDate=D,7,L

! [建物使用別]
#BdUsageCode=A,1,L

#BdUsageCodeX=X,15,L
T(3,)T(H,#BdUsageCode,#BdUsageCodeHelp)

! [停車位型式]
#ParkingTypeCode=A,1,L

#ParkingTypeCodeX=X,13,L
T(3,)T(H,#ParkingTypeCode,#ParkingTypeCodeHelp)

#ParkingArea=m,9.2,L

! [獨立產權車位註記]
#ParkingProperty=X,1,L

#ParkingPropertyX=X,2,L
T(3,)T(H,#ParkingProperty,#YNHelp)

! [房屋稅籍號碼]
#HouseTaxNo=X,12,L

! [房屋取得日期]
#HouseBuyDate=D,7,L
IF(#PAGE_FG==2,$,CALL(#SHOW_2))

!押品狀況碼
#ClStatus=X,1,L

#ClStatusX=X,20,L
T(3,)T(H,#ClStatus,#ClStatusHelp)


!公設建號登記面積
#OOPUBBUILDAREA=m,14.2,L
E(0,#PublicArea1+#PublicArea2+#PublicArea3+#PublicArea4+#PublicArea5+#PublicArea6+#PublicArea7+#PublicArea8+#PublicArea9+#PublicArea10)

#PublicBdNoA0=X,1,S
T(3,X)

#TEMP_PublicBdNoA=A,5,S
#TEMP_PublicBdNoB=A,3,S
#TEMP_Area=m,14.2,S

##loop{times:10,i:1,j:0,rowSeq:3}

#HIDE_PE_ROW_{i}=@,1,S
INVOKEJS(SHOW,grd1_{rowSeq},0)

#SHOW_PE_ROW_{i}=@,1,S
INVOKEJS(SHOW,grd1_{rowSeq},1)

! [公設建號-建號]
#PublicBdNoA{i}=X,5,L
IF(#PAGE_FG==3,$,CALL(#SHOW_3))
C(3,#PublicBdNoA{i},0,CALL(#HIDE_PE_ROW_{i}),CALL(#SHOW_PE_ROW_{i}))
E(0,@TEMP_PublicBdNoA,#PublicBdNoA{i})T(2,#TEMP_PublicBdNoA)

#PublicBdNoB{i}=X,3,L
E(0,@TEMP_PublicBdNoB,#PublicBdNoB{i})T(2,#TEMP_PublicBdNoB)

! [公設建號-登記面積(坪)]
#PublicArea{i}=m,14.2,L
E(0,@TEMP_Area,#PublicArea{i})X(#TEMP_Area)


! [公設建號-所有權人統編]
#PublicOwnerId{i}=X,10,L


! [公設建號-所有權人姓名]
#PublicOwnerName{i}=c,100,L


##end

#FdPP=X,2,L

!獨立產權車位登記面積
#OOTIPARKINGAREA=m,14.2,L
E(0,#ParkingArea1+#ParkingArea2+#ParkingArea3+#ParkingArea4+#ParkingArea5+#ParkingArea6+#ParkingArea7+#ParkingArea8+#ParkingArea9+#ParkingArea10)

#ParkingBdNoA0=X,1,S
T(3,X)
#TEMP_ParkingBdNoA=A,5,S
#TEMP_ParkingBdNoB=A,3,S
#TEMP_ParkingArea=m,14,S
#TEMP_ParkingAmt=m,14,S

#ParkingNo0=x,20,S
T(3,A)



##loop{times:5,i:1}

#ParkingTypeCodeA{i}=A,1,L
!E(0,{i})

#ParkingTypeCodeXA{i}=X,13,L
T(H,#ParkingTypeCodeA{i},#ParkingTypeCodeHelp)

#ParkingQtyA{i}=m,5,L

#ParkingAreaA{i}=m,8.2,L

##end

##loop{times:100,i:1,j:0,rowSeq:2}
#HIDE_PP_ROW_{i}=@,1,S
INVOKEJS(SHOW,grd2_{rowSeq},0)

#SHOW_PP_ROW_{i}=@,1,S
INVOKEJS(SHOW,grd2_{rowSeq},1)

!車位編號
#ParkingNo{i}=x,20,L
IF(#PAGE_FG==4,$,CALL(#SHOW_4))
C(4,#ParkingNo{i},CALL(#HIDE_PP_ROW_{i}),CALL(#SHOW_PP_ROW_{i}))

!車位數量
#ParkingQty{i}=m,5,L
C(4,#ParkingNo{i},S,$)

!停車位型式
#ParkingTypeCode{i}=X,1,L
C(4,#ParkingNo{i},S,$)
HELP(#ParkingTypeCodeHelp)

#ParkingTypeCodeX{i}=x,20,L
C(4,#ParkingNo{i},S,$)
T(H,#ParkingTypeCode{i},#ParkingTypeCodeHelp)

!持份比率(分子)
#ParkingOwnerPart{i}=m,8,L
C(4,#ParkingNo{i},S,$)

!持份比率(分母)
#ParkingOwnerTotal{i}=m,8,L
C(4,#ParkingNo{i},S,$)
C(3,#ParkingOwnerPart{i},0,S,$)

! [車位-登記面積(坪)]
#ParkingArea{i}=m,14.2,L
C(4,#ParkingNo{i},S,$)

!段小段代碼
!#ParkingIrCode{i}=X,5,L
!C(4,#ParkingNo{i},S,$)

! [獨立產權車位-建號]
#ParkingBdNoA{i}=A,5,L
C(4,#ParkingNo{i},S,$)

#ParkingBdNoB{i}=A,3,L
C(4,#ParkingNo{i},S,$)
C(3,#ParkingBdNoA{i},0,S,$)

!地號
#ParkingLandNoA{i}=A,4,L
C(4,#ParkingNo{i},S,$)

!地號(子號)
#ParkingLandNoB{i}=A,4,L
C(4,#ParkingNo{i},S,$)
C(3,#ParkingLandNoA{i},0,S,$)

! [車位-價格(元)]
#ParkingAmount{i}=m,14.2,L
C(4,#ParkingNo{i},S,$)


##end

#OwnerId0=X,1,S
T(3,X)

##loop{times:10,i:1,j:0,rowSeq:2}

#HIDE_OWNER_ROW_{i}=@,1,S
INVOKEJS(SHOW,grd3_{rowSeq},0)

#SHOW_OWNER_ROW_{i}=@,1,S
INVOKEJS(SHOW,grd3_{rowSeq},1)

! [建物所有權人-統編]
#OwnerId{i}=X,10,L
IF(#PAGE_FG==5,$,CALL(#SHOW_5))
C(4,#OwnerId{i},CALL(#HIDE_OWNER_ROW_{i}),CALL(#SHOW_OWNER_ROW_{i}))

! [建物所有權人-姓名]
#OwnerName{i}=c,100,L

! [建物所有權人-與授信戶關係]
#OwnerRelCode{i}=X,2,L

#OwnerNameOwnerRelCodeX{i}=X,20,L
T(3,)T(H,#OwnerRelCode{i},#OwnerRelCodeHelp)

! [建物所有權人-持份比率(分子)]
#OwnerPart{i}=m,10,L

! [建物所有權人-持份比率(分母)]
#OwnerTotal{i}=m,10,L

##end

#Reason0=X,1,S
T(3,X)

! [建物修改原因-原因]
#Reason1=X,1,L
IF(#PAGE_FG==6,$,CALL(#SHOW_6))

#ReasonX1=X,20,L
T(3,)T(H,#Reason1,#ReasonHelp)

#OtherReason1=c,60,L
IF(#Reason1=="",s,$)
IF(#Reason1==6,SHOW(#OtherReason1),HIDE(#OtherReason1))

! [建物修改原因-建立者]
#CreateEmpNo1=X,6,L

! [建物修改原因-建立日期]
#CreateDate1=D,7,L

#ShowAll=X,1,S
ENABLE(#BTNExpand)
E(0,@PAGE_FG,7)
CALL(#RESET_PAGES)

!---- Expand 展開
#BINDExpand=X,1,S
BIND(#BTNExpand,click, {cmd=CALLSEND;DOCODE=Expand})

#BTNExpand=X,4,I,ui:button;value:展開;enable:1;tabbable:1

#RPTFG=A,1,S



</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>

</sub>


!---------- TXFORM = L2915 ----------
<sub type="FORM" name="L2915">

!#SCRPRT=_,_,S
!C(5,#TXFORM,L2915,$,S)

#SCRTIL=_,_,S
T(3,[L2915] 不動產建物資料)

!------ TOM(HEAD)   Variables (FOR OUTPUT SCREEN) ------
!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------

!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------

</sub>


!------ 上行電文 ------
<sub type="TIM">
#ClCode1
#ClCode2
#ClNo
#END
</sub>


!------ 下行電文TOM ------
<sub type="TOM">
TXFORM=L2915
#BdLocation
#BdMainUseCode
#BdMtrlCode
#BdTypeCode
#TotalFloor
#FloorNo
#FloorArea
#EvaUnitPrice
#RoofStructureCode
#BdDate
#BdSubUsageCode
#BdSubArea
#SellerId
#SellerName
#ContractPrice
#ContractDate
#BdUsageCode
#ParkingTypeCode
#ParkingProperty
#ParkingArea
#HouseTaxNo
#HouseBuyDate
#ClStatus
#Reason1
#OtherReason1
#CreateEmpNo1
#CreateDate1
##loop{times:10,i:1}
#PublicBdNoA{i}
#PublicBdNoB{i}
#PublicArea{i}
#PublicOwnerId{i}
#PublicOwnerName{i}
#OwnerId{i}
#OwnerName{i}
#OwnerRelCode{i}
#OwnerPart{i}
#OwnerTotal{i}
##end
##loop{times:100,i:1}
#ParkingNo{i}
#ParkingQty{i}
#ParkingTypeCode{i}
#ParkingOwnerPart{i}
#ParkingOwnerTotal{i}
#ParkingArea{i}
#ParkingBdNoA{i}
#ParkingBdNoB{i}
#ParkingLandNoA{i}
#ParkingLandNoB{i}
#ParkingAmount{i}
##end
^
<include src="COM.icf::TRCTL.tom"/>
<include src="ROM.icf::L2R17.tom"/>
<include src="ROM.icf::L2R27.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">
<include src="PRT.icf::INQ01.sel"/>
</sub>
