----- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">

!#TXCD
!T(3,L2603)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,37)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,204)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,20)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
K(MODIFYBUTTON,查詢)

</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[130,870];printer.width=[20,20];">
[
["[L2603]                                 法拍費用借支報表列印"],
["#FdREC_DT+收件日",#ReceiveDateSt,"-",#ReceiveDateEd],
]
!---------- AP Button AREA ----------
![Buttom資料查詢]
#BUF1=X,42,S

#FdREC_DT=X,2,L
T(3,*)

#FdRPTFG=X,2,L
T(3,*)
!---------- AP TEXT AREA Variables ----------

! Help
<include src="HELPRIM.icf::HELPRIM.rtn"/>
!FeeCode
#CDDEF0001=x,20,S
T(3,CdCode.FeeCode)

#FeeCodeHelp=x,1024,S

#CDDEF0002=x,26,S
T(3,CdCode.CurrPrecision)

#CurrPrecisionHelp=x,1024,S

#FeeCodeHelpRim=X,1,S
RESET_RIM(#FeeCodeHelpRim,XXR99)
S(XXR99,01,#CDDEF0001,#CDDEF0002)
R(1,XXR99)
CALL(#HelpProc)
T(2,@FeeCodeHelp,#HelpDesc1)
T(2,@CurrPrecisionHelp,#HelpDesc2)


#CHAIN=A,1,S
T(4,CHAIN$)

!收件日起 必須輸入
#ReceiveDateSt=D,7,I
@A(DATE,0,#ReceiveDateSt)
V(7)

!收件日止 必須輸入
#ReceiveDateEd=D,7,I
C(3,#ReceiveDateSt,0,E(0,9991231),E(0,#ReceiveDateSt))
@A(DATE,0,#ReceiveDateEd)
V(7)V(5,#ReceiveDateSt,9991231)



!顯示方式
#RPTFG=A,1,S
E(0,0)
E(0,@FUNCIND,5)



#CHAINXMT=X,1,S
C(3,#CHAIN,1,E(0,@CHAIN,0)XMT(),$)

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>


!---------- TXFORM = L2603 ----------
<sub type="FORM" name="L2603">

!#SCRPRT=_,_,S
!C(5,#TXFORM,L2603,$,S)

#SCRTIL=_,_,S
T(3,[L2603] 法拍費用借支報表列印)

!------ TOM(HEAD)   Variables (FOR OUTPUT SCREEN) ------

#OOCurrencyCode=X,3,O
T(3,TWD)

#OOPrecision=N,1,S
T(H,#OOCurrencyCode,#CurrPrecisionHelp)
#OFeeAmt=m,14.2,S
#OFeeAmtX=X,22,L
CALL2(#ADJUSTDOT,#OOPrecision,#OFeeAmt,#OFeeAmtX)
P(R,#OFeeAmtX)

#OAmt=m,14.2,S
#OAmtX=X,22,L
CALL2(#ADJUSTDOT,#OOPrecision,#OAmt,#OAmtX)
P(R,#OAmtX)

#OCnt=X,5,L
!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------
#LOOP=X,1,S
T(3,1)ASGN(LOOP$)

#OOCustNo=A,7,L
#OOCustName=X,100,L
#OOReceiveDate=D,7,L
#OOFee=m,14.2,L
#OOFeeX=X,22,L
CALL2(#ADJUSTDOT,#OOPrecision,#OOFee,#OOFeeX)
P(R,#OOFeeX)


#OOFeeCode=A,2,S
#OOFeeCodeX=X,12,L
T(H,#OOFeeCode,#FeeCodeHelp)

#OOCloseNo=A,6,L
#OOLegalStaff=X,6,L
#OOName=X,10,L
#OOName1=X,18,L
T(2,#OOLegalStaff+  +#OOName)
#OORmk=X,60,L
!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------

</sub>


!------ 上行電文 ------
<sub type="TIM">
#ReceiveDateSt
#ReceiveDateEd
</sub>


!------ 下行電文TOM ------
<sub type="TOM">
TXFORM=L2603
#OFeeAmt
#OAmt
#OCnt
#OOCustNo
#OOCustName
#OOReceiveDate
#OOFee
#OOFeeCode
#OOCloseNo
#OOLegalStaff
#OOName
#OORmk
^
<include src="HELPRIM.icf::HELPRIM.tom"/>
<include src="COM.icf::TRCTL.tom"/>
</sub>

<sub type="PART" name="L2603" layout="cols=3;screen.width=[250,200,250,200];printer.width=[15,30,15,30];order=1">
[
["[L2603]                                 法拍費用借支報表列印"],
["@暫付及待結轉款項-法務費金額",#OFeeAmtX],
["@暫付及待結轉款項-鑑定費金額",#OAmtX],
["@共計",#OCnt,"@筆"],
]
</sub>
!---------- 單據輸出組合 ----------
<sub type="SELECT">

#RPTFG=0,QUERY.GRID,L2603
#any={detail:true, header:'L2603.part', caption:'', width:1010, rowNum:20, rowList:[20,40,60]}


#OOCustNo=戶號
{width:80,align:'center'}

#OOCustName=戶名
{width:120,align:'left'}

#OOReceiveDate=收件日
{width:80,align:'center'}

#OOFeeX=法拍費
{width:170,align:'center'}

#OOFeeCodeX=科目
{width:100,align:'left'}

#OOCloseNo=銷帳編號
{width:100,align:'center'}

#OOName1=法務人員
{width:120,align:'left'}

#OORmk=備註
{width:100,align:'left'}


^

<include src="PRT.icf::INQ01.sel" map="i=L2603;cpi=15"/>
#ReceiveDateSt#ReceiveDateEd#OFeeAmtX#OAmtX#OCnt
%
#OOCustNo#OOReceiveDate#OOFeeX#OOFeeCodeX#OOCloseNo#OOLegalStaff#OOCustName#OORmk
@^
</sub>
