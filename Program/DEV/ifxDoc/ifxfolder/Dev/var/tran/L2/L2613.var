----- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">

!#TXCD
!T(3,L2613)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,0)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,63)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,20)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
K(MODIFYBUTTON,查詢)

</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[150,850];printer.width=[20,20];">
[
["[L2613]                                 法務費轉催收明細表"],
["#FdCONVERSION_DATE_ST+轉催收日期",#OverdueDateStart,"~",#OverdueDateEnd],
]
!---------- AP Button AREA ----------
! Help
<include src="HELPRIM.icf::HELPRIM.rtn"/>

#CDDEF01=x,26,S
T(3,CdCode.CurrPrecision)

#CurrPrecisionHelp=x,1024,S

#CDDEF02=x,26,S
T(3,CdCode.FeeCode)

#FeeCodeHelp=x,1024,S

#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#CDDEF01,#CDDEF02)
R(1,XXR99)
CALL(#HelpProc)  
T(2,@CurrPrecisionHelp,#HelpDesc1)
T(2,@FeeCodeHelp,#HelpDesc2)

![Buttom資料查詢]
#BUF1=X,42,S

#FdPRINTER_IND=X,2,L
#FdREPORT_PART=X,2,L


#FdCONVERSION_DATE_ST=X,2,L
T(3,*)

!---------- AP TEXT AREA Variables ----------
#CHAIN=A,1,S
T(4,CHAIN$)

#FUNCIND=_,_,S
E(0,5)

#POSINTDT=D,8,S
T(4,DATE$)

!轉催收日期起日 必須輸入
#OverdueDateStart=D,7,I
T(1,#POSINTDT,2,7)
@A(DATE,0,#OverdueDateStart)
V(2,0)V(7)

!轉催收日期迄日 必須輸入
#OverdueDateEnd=D,7,I
T(1,#POSINTDT,2,7)
@A(DATE,0,#OverdueDateEnd)
V(5,#OverdueDateStart,9991231)
V(2,0)V(7)


#RPTFG=A,1,S

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>


!---------- TXFORM = L2613 ----------
<sub type="FORM" name="L2613">

!#SCRPRT=_,_,S
!C(5,#TXFORM,L2613,$,S)

#SCRTIL=_,_,S
T(3,[L2613] 法務費轉催收明細表)

#CurrencyCode=X,3,S
T(3,TWD)

#PRECISION=N,1,S
T(H,#CurrencyCode,#CurrPrecisionHelp)
!------ TOM(HEAD)   Variables (FOR OUTPUT SCREEN) ------
!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------
#LOOP=X,1,S
T(3,1)ASGN(LOOP$)

! #OOOverdueDate=D,7,L

! #OOAcDate=D,7,L

! #OOENTRYDATE=D,7,L

! #OOCustNo=A,7,S

! #OOFacmNo=A,3,S

! #OOCustNoFacmNo=X,11,L
! T(2,#OOCustNo+-+#OOFacmNo)

! #OOFEEAMT=m,14.2,S

! #OOFee=X,21,L
! CALL2(#ADJUSTDOT,#PRECISION,#OOFEEAMT,#OOFee)
! P(R,#OOFee)

! #OOFeeCode=A,2,S

! #OOFeeCodeX=X,20,L
! T(A,#OOFeeCode,L2DEF,FEEINDDEF,FEEIND,FEEINDX) 


! #OOReceiveDate=D,7,L

! #OOCloseDate=D,7,L


! ////
!轉換日
#OOOverdueDate=D,7,L


!戶號
#OOCustNo=A,7,L


!戶名
#OOCustName=x,100,L


!收件日
#OOReceiveDate=D,7,L


!入帳日
#OODocDate=D,7,L


!科目
#OOFeeCode=A,2,S

#OOFeeCodeX=X,20,L
T(H,#OOFeeCode,#FeeCodeHelp) 


!法務費
#OOFeeAmt=m,14,O

#OOFeeAmtX=X,20,O
X(#OOFeeAmt)
!CALL2(#ADJUSTDOT,#PRECISION,#OOFeeAmt,#OOFeeAmtX)
!P(R,#OOFeeAmtX)

!記錄號碼
#OORecordNo=A,7,L


!借方傳票
#OODSlipNo=A,6,L


!貸方傳票
#OOCSlipNo=A,6,L




!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------

</sub>


!------ 上行電文 ------
<sub type="TIM">
#OverdueDateStart
#OverdueDateEnd
</sub>


!------ 下行電文TOM ------
<sub type="TOM">
TXFORM=L2613
#OOOverdueDate
#OOCustNo
#OOCustName
#OOReceiveDate
#OODocDate
#OOFeeCode
#OOFeeAmt
#OORecordNo
#OODSlipNo
#OOCSlipNo
^
<include src="COM.icf::TRCTL.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
</sub>

! <sub type="PART" name="L2613" layout="cols=3;screen.width=[130,370,130,370];printer.width=[15,30,15,30];order=1">
! [
! ["[L2613]                                 法務費轉催收明細表"],
! [#<->#,"@案件編號"],
! [#<->#,"@統一編號"],
! ["@借戶戶號"],
! ["@核准編號"],
! ]
! </sub>
!---------- 單據輸出組合 ----------
<sub type="SELECT">


#RPTFG=0,QUERY.GRID,L2613
#any={detail:true, header:'L2613.part', caption:'', width:1000, rowNum:20, rowList:[20,40,60]}




! OOOverdueDate   // 會計日期
! OOCustNo    // 戶號
! OOCustName  // 戶名
! OOReceiveDate  // 收件日期
! OODocDate   // 單據日期
! OOFeeCode   // 科目
! OOFeeAmt    // 法拍費用
! OORecordNo  // 記錄號碼
! OODSlipNo   // d借傳票號碼
! OOCSlipNo   // c貸傳票號碼

#OOOverdueDate=轉催日期
{width:100,align:'center'}

#OOCustNo=戶號
{width:100,align:'center'}

#OOCustName=戶名
{width:100,align:'center'}

#OOReceiveDate=收件日
{width:100,align:'center'}

#OODocDate=單據日期
{width:180,align:'center'}

#OOFeeCodeX=科目
{width:100,align:'left',sum:'轉催收合計'}

#OOFeeAmt=法務費
{width:150,align:'right',sum:true}

#OORecordNo=記錄號碼
{width:100,align:'center'}

#OODSlipNo=借方傳票
{width:100,align:'center'}
#OOCSlipNo=貸方傳票
{width:100,align:'center'}


^

<include src="PRT.icf::INQ01.sel" map="i=L2613;cpi=15"/>

<include src="PRT.icf::INQ01.sel"/>
</sub>
