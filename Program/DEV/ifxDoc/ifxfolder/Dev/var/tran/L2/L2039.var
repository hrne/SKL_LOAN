----- BASIC LABEL Variables ----------
<sub type="SYS">
#KeyInq=X,1,S
K(MODIFYBUTTON,查詢)
</sub>

<sub type="SYS" name="label">

!#TXCD
!T(3,L2039)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,0)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,185)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,20)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)

#FirstIn=A,1,S
E(0,0)


#BTNADDBUF=X,19,S
T(2,1+0+00+0000000+00)


#BtnAddA=x,100,S
T(2,{cmd=CHAIN; ntxcd=L2480; ntxbuf=#BTNADDBUF; ntxbuf5=type})
ASGN(BTN_NEW1$)
K(MODIFYBUTTON,1,新增)

</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[130,870];printer.width=[20,20];">
[
["[L2039]                                 擔保品重評明細資料查詢"],
["#FdClCode1+代號1",#ClCode1,#ClCode1X],
["#FdClCode2+代號2",#ClCode2,#ClCode2X],
["#FdClNo+擔保品編號",#ClNo],
]

#FdClCode1=X,2,L
T(3,*)
#FdClCode2=X,2,L
T(3,*)
#FdClNo=X,2,L
T(3,*)
#FdRPTFG=X,2,L
T(3,*)

!---------- AP Button AREA ----------
![Buttom資料查詢]
! #BTN1=X,15,I,ui:button;value:新增;enable:0;tabbable:0;title:L2480 擔保品重評明細資料登錄
! ENABLE(#BTN1)
! #BUF1=X,42,S
!---------- AP TEXT AREA Variables ----------
<include src="HELPRIM.icf::HELPRIM.rtn"/>
#ClCode1Help=X,20,S
T(3,1:房地;2:土地)

#CHAIN=A,1,S
T(4,CHAIN$)

#Init=X,1,S
INVOKEJS(SHOW,p1,10,16,0)

!代號1
#ClCode1=A,1,I
C(3,#FirstIn,1,E(0,@CHAIN,1),$)
C(3,#FirstIn,1,S,$)
HELP(#ClCode1Help) 
@V(H,#ClCode1Help)

#ClCode1X=X,4,L
C(4,#ClCode1,S,$)
T(H,#ClCode1,#ClCode1Help)

!代號2
#CDDEFClCode2=x,20,S
SWITCH(#ClCode1,1,T(3,CdCode.ClCode21),
                2,T(3,CdCode.ClCode22))

                
#CDDEF02=x,26,S
T(3,CdCode.CurrPrecision)

#CurrPrecisionHelp=x,1024,S

#ClCode2HelpRim=X,1,S
C(4,#CDDEFClCode2,S,$)
RESET_RIM(#ClCode2HelpRim,XXR99)
S(XXR99,01,#CDDEFClCode2)
R(1,XXR99)
CALL(#HelpProc)
T(2,@ClCode2Help,#HelpDesc1)
T(2,@CurrPrecisionHelp,#HelpDesc2)

#ClCode2Help=x,300,S

#ClCode2=A,2,I
C(3,#FirstIn,1,E(0,@CHAIN,1),$)
C(3,#FirstIn,1,S,$)
HELP(#ClCode2Help)
@C(3,#ClCode1,0,s,$)
V(H,#ClCode2Help)

#COLIND=A,3,S
T(2,#ClCode1+#ClCode2)

#ClCode2X=X,13,L
T(H,#ClCode2,#ClCode2Help)

!擔保品編號
#ClNo=A,7,I
C(3,#FirstIn,1,E(0,@CHAIN,1),$)
C(3,#FirstIn,1,S,$)
@V(2,0)


#RETURN=A,1,S
E(0,0)

![折返KEY]
#RTNTXT=X,9,S

#FunCd=A,1,S
E(0,2)
E(0,@FirstIn,0)

! #BUF1=X,11,S
! C(3,#ClNo,0,HIDE(#BTN1),SHOW(#BTN1))
! T(2,1+#ClCode1+#ClCode2+#ClNo)
! E(0,@FirstIn,0)

! #BIND1=X,1,S
! BIND(#BTN1,click, {cmd=CHAIN; ntxcd=L2480; ntxbuf=#BUF1})

#RPTFG=A,1,S
E(0,0)

#CHAINXMT=X,1,S
C(3,#CHAIN,1,E(0,@CHAIN,0)XMT(),$)

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>


!---------- TXFORM = L2039 ----------
<sub type="FORM" name="L2039">

!#SCRPRT=_,_,S
!C(5,#TXFORM,L2039,$,S)

#SCRTIL=_,_,S
T(3,[L2039] 擔保品重評明細資料)

#OOCurrencyCode=X,3,O
T(3,TWD)

#OOPrecision=N,1,S
E(0,0)
T(H,#OOCurrencyCode,#CurrPrecisionHelp)
!------ TOM(HEAD)   Variables (FOR OUTPUT SCREEN) ------
!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------

#LOOP=X,1,S
T(3,1)ASGN(LOOP$)


#OOClCode1=A,1,S

#OOClCode2=A,2,S

#OOClNo=A,7,S

#OOClNoLabel=X,12,L
T(2,#OOClCode1+-+#OOClCode2+-+#OOClNo)

!鑑估序號
#OOEvaNo=A,2,L

#OOEvaDate=D,7,L

#OOEvaAmt=m,14.2,L

#OOEvaAmtLabel=m,14,L
T(2,#OOEvaAmt)

#Amt=X,21,S
X(#OOEvaAmtLabel)


#OOEvaNetWorth=m,14,L

#OOEvaNetWorthX=X,22,L
CALL2(#ADJUSTDOT,#OOPrecision,#OOEvaNetWorth,#OOEvaNetWorthX)
P(R,#OOEvaNetWorthX)

#OORentEvaValue=m,14,L

#OORentEvaValueX=X,22,L
CALL2(#ADJUSTDOT,#OOPrecision,#OORentEvaValue,#OORentEvaValueX)
P(R,#OORentEvaValueX)



#OOEvaAmt14=X,14,S
T(2,@OOEvaAmt14,#OOEvaAmt)

#OOEvaCompanyId=X,2,L

#OOEvaCompanyName=X,100,L

#OOEvaEmpno=X,6,S

#OOEvaReason=A,2,S

!修改
#OOBUF2=X,200,S
T(2,2+#OOClCode1+#OOClCode2+#OOClNo+#OOEvaNo)

#OOBTN2=X,1,S
BIND(grid,{ cmd=CHAIN; ntxcd=L2480; ntxbuf=#OOBUF2})

!複製
#OOBUF3=X,200,S
T(2,3+#OOClCode1+#OOClCode2+#OOClNo+#OOEvaNo)

#OOBTN3=X,1,S
BIND(grid,{ cmd=CHAIN; ntxcd=L2480; ntxbuf=#OOBUF3})

!刪除
#OOBUF4=X,200,S
T(2,4+#OOClCode1+#OOClCode2+#OOClNo+#OOEvaNo+#OOEvaDate+#OOEvaAmt14+#OOEvaCompanyId+#OOEvaCompanyName+#OOEvaEmpno+#OOEvaReason)

#OOBTN4=X,1,S
BIND(grid,{ cmd=CHAIN; ntxcd=L2480; ntxbuf=#OOBUF4})

!查詢
#OOBUF5=X,200,S
T(2,5+#OOClCode1+#OOClCode2+#OOClNo+#OOEvaNo+#OOEvaDate+#OOEvaAmt14+#OOEvaCompanyId+#OOEvaCompanyName+#OOEvaEmpno+#OOEvaReason)

#OOBTN5=X,1,S
BIND(grid,{ cmd=CHAIN; ntxcd=L2480; ntxbuf=#OOBUF5})

!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------

</sub>


!------ 上行電文 ------
<sub type="TIM">
#ClCode1
#ClCode2
#ClNo
#END
</sub>


!------ 下行電文TOM ------
<sub type="TOM">
TXFORM=L2039
#OOClCode1
#OOClCode2
#OOClNo
#OOEvaNo
#OOEvaDate
#OOEvaAmt
#OOEvaNetWorth
#OORentEvaValue
#OOEvaCompanyId
#OOEvaCompanyName
#OOEvaEmpno
#OOEvaReason
^
<include src="COM.icf::TRCTL.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
</sub>


<sub type="PART" name="L2039" layout="cols=1;screen.width=[130,870];printer.width=[15,30]">
[
["[L2039]                                 擔保品重評明細資料查詢"],
[""],
]
</sub>

<sub type="SELECT">

#RPTFG=0,QUERY.GRID,L2039
#any={detail:true, header:'L2039.part', caption:'', width:1010, rowNum:20, rowList:[20,40,60]}

#OOBTN2=修改
{width:50,search:false,formatter:'cust:bind-button:修改',align:'center',canExport:false}

#OOBTN3=複製
{width:50,search:false,formatter:'cust:bind-button:複製',align:'center',canExport:false}

#OOBTN4=刪除
{width:50,search:false,formatter:'cust:bind-button:刪除',align:'center',canExport:false}

#OOBTN5=查詢
{width:50,search:false,formatter:'cust:bind-button:查詢',align:'center',canExport:false}

#OOClNoLabel=擔保品號碼
{width:120,align:'center'}

#OOEvaNo=鑑估</br>序號
{width:50,align:'center'}

#OOEvaDate=鑑價日期
{width:100,align:'center'}

#Amt=評估總價
{width:100,align:'right'}

#OOEvaNetWorth=評估淨值
{width:100,align:'right'}

#OORentEvaValue=出租評估淨值
{width:100,align:'right'}

#OOEvaCompanyId=估價</br>公司</br>代碼
{width:50,align:'center'}

#OOEvaCompanyName=估價公司名稱
{width:150,align:'left'}
^
<include src="PRT.icf::INQ01.sel" map="i=L2039;cpi=15"/>
#ClCode1#ClCode2#ClNo
%
#OOClNoLabel#OOEvaNo#OOEvaDate#OOEvaAmtLabel#OOEvaCompanyId#OOEvaCompanyName
@^
</sub>
