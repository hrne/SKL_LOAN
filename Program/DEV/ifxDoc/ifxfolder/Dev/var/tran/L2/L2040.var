----- BASIC LABEL Variables ----------
<sub type="SYS">
#KeyInq=X,1,S
K(MODIFYBUTTON,查詢)
</sub>

<sub type="SYS" name="label">

!#TXCD
!T(3,L2040)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,0)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,32)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,20)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)

</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[200,800];printer.width=[20,20];">
[
["[L2040]                                 擔保品號碼新舊對照查詢"],
["#FdFunCd+#FdFunCdName",#FunCd,#FunCdX],
["#FdClCode1+#FdClCode1Name",#ClCode1,#ClCode1X],
["#FdClCode2+#FdClCode2Name",#ClCode2,#ClCode2X],
["#FdClNo+#FdClNoName",#ClNo],
["#FdClSeq+#FdClSeqName",#ClSeq],
]

#FdFunCd=X,1,L
T(3,*)
#FdClCode1=X,1,L
T(3,*)
#FdClCode2=X,1,L
T(3,*)
#FdClNo=X,1,L
T(3,*)
#FdClSeq=X,1,L

#FdFunCdName=X,14,L
T(3,查詢功能)

#FdClCode1Name=X,14,L
T(3,擔保品代號1)

#FdClCode2Name=X,14,L
T(3,擔保品代號2)

#FdClNoName=X,14,L
T(3,擔保品編號)

#FdClSeqName=X,14,L
T(3,原擔保品序號)
!---------- AP Button AREA ----------
![Buttom資料查詢]
#BUF1=X,42,S
!---------- AP TEXT AREA Variables ----------
! Help
<include src="HELPRIM.icf::HELPRIM.rtn"/>

#FunCdHelp=X,30,S
T(3,1:原擔保品編號;2:新擔保品編號)

#ClCode1Help=X,20,S
T(3,1:房地;2:土地)

!ClCode21
#CDDEF0001=x,20,S
T(3,CdCode.ClCode21)

#ClCode21HelpRim=X,1,S
RESET_RIM(#ClCode21HelpRim,XXR99)
S(XXR99,01,#CDDEF0001)
R(1,XXR99)
CALL(#HelpProc)
T(2,@ClCode21Help,#HelpDesc1)

#ClCode21Help=x,1024,S

#CDDEF0002=x,20,S
T(3,CdCode.ClCode22)

#ClCode22HelpRim=X,1,S
RESET_RIM(#ClCode22HelpRim,XXR99)
S(XXR99,01,#CDDEF0002)
R(1,XXR99)
CALL(#HelpProc)
T(2,@ClCode22Help,#HelpDesc1)

#ClCode22Help=x,1024,S

#CHAIN=A,1,S
T(4,CHAIN$)

#INIT=X,1,S
INVOKEJS(SHOW,p1_5,0)
	
#NTXBUF=X,10,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
T(1,@ClCode1,#NTXBUF,1,1)
T(1,@ClCode2,#NTXBUF,2,2)
T(1,@ClNo,#NTXBUF,4,7)


!查詢功能
#FunCd=A,1,I
C(3,#CHAIN,1,s,$)
E(0,1)
HELP(#FunCdHelp) 
@V(H,#FunCdHelp)

#FunCdX=X,20,L
T(H,#FunCd,#FunCdHelp)
C(3,#FunCd,1,T(3,@FdClCode1Name,原擔保品代號1)T(3,@FdClCode2Name,原擔保品代號2)T(3,@FdClNoName,原擔保品編號)INVOKEJS(SHOW,p1_5,1),
T(3,@FdClCode1Name,新擔保品代號1)T(3,@FdClCode2Name,新擔保品代號2)T(3,@FdClNoName,新擔保品編號)INVOKEJS(SHOW,p1_5,0))


!代號1
#ClCode1=A,1,I
C(3,#CHAIN,1,s,$)
@V(2,0)


#ClCode1X=X,4,L


!代號2
#ClCode2=A,2,I
C(3,#CHAIN,1,s,$)
@V(2,0)



#COLIND=A,3,S
T(2,#ClCode1+#ClCode2)

#ClCode2X=X,13,L



!擔保品編號
#ClNo=A,7,I
C(3,#CHAIN,1,s,$)
@V(2,0)


#ClSeq=A,2,I
C(3,#CHAIN,1,s,$)
C(3,#FunCd,1,$,S)

#RPTFG=A,1,S
C(3,#FunCd,1,E(0,0),E(0,1))

#CHAINXMT=X,1,S
C(3,#CHAIN,1,E(0,@CHAIN,0)XMT(),$)

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>


!---------- TXFORM = L2040 ----------
<sub type="FORM" name="L2040">

!#SCRPRT=_,_,S
!C(5,#TXFORM,L2040,$,S)

#SCRTIL=_,_,S
T(3,[L2040] 不動產土地明細資料)


!------ TOM(HEAD)   Variables (FOR OUTPUT SCREEN) ------
!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------

#LOOP=X,1,S
T(3,1)ASGN(LOOP$)

#OOClCode1=A,1,S
#OOClCode2=A,2,S
#OOClNo=A,7,S

#OOClCodeX=X,12,S
T(2,#OOClCode1+-+#OOClCode2+-+#OOClNo)

#OOClSeq=A,2,S

#OOCustNo=A,7,L

#OOFacmNo=A,3,L

#OOAddress=X,100,L

!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------

</sub>

!------ 上行電文 ------
<sub type="TIM">
#FunCd
#ClCode1
#ClCode2
#ClNo
#ClSeq
#END
</sub>


!------ 下行電文TOM ------
<sub type="TOM">
TXFORM=L2040
#OOClCode1
#OOClCode2
#OOClNo
#OOClSeq
#OOCustNo
#OOFacmNo
#OOAddress
^

<include src="COM.icf::TRCTL.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
</sub>

<sub type="PART" name="L2040" layout="cols=1;screen.width=[130,870];printer.width=[15,30,15,30];order=1">
[
["[L2040]                                 擔保品號碼新舊對照查詢"],
[""],
]
</sub>
!---------- 單據輸出組合 ----------
<sub type="SELECT">

#RPTFG=0,QUERY.GRID,L2040
#any={detail:true, header:'L2040.part', caption:'', width:1010, rowNum:20, rowList:[20,40,60]}


#OOClCodeX=新擔保品編號
{width:100,align:'center'}

#OOClSeq=原擔保品序號
{width:100,align:'center'}

#OOCustNo=戶號
{width:100,align:'center'}

#OOFacmNo=額度
{width:100,align:'center'}

#OOAddress=地址
{width:400,align:'center'}

^

#RPTFG=1,QUERY.GRID,L2040
#any={detail:true, header:'L2040.part', caption:'', width:1010, rowNum:20, rowList:[20,40,60]}


#OOClCodeX=原擔保品編號
{width:100,align:'center'}

#OOCustNo=戶號
{width:100,align:'center'}

#OOFacmNo=額度
{width:100,align:'center'}

#OOAddress=地址
{width:400,align:'center'}

^

</sub>
