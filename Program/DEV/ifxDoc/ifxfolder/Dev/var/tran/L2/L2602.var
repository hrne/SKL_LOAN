----- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">

!#TXCD
!T(3,L2602)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,27)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,75)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,20)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)

</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=3;screen.width=[130,1100];printer.width=[20,20,20,20];order=1;">
[
["[L2602]                                 法拍費用維護"],
[#<->#,"#FdFUNCD+功能",#FunCdX],
[#<->#,"#FdCUSTNO+借戶戶號",#CustNo],
[#<->#,"#FdFacmNo+額度編號",#FacmNo],
[#<->#,"#FdREC_DT+收件日",#ReceiveDate],
[#<->#,"#FdDOC_DT+單據日期",#DocDate],
[#<->#,"#FdFEE+法拍費用",#TwFee,#UsFee],
[#<->#,"#FdFEE_IND+科目",#FeeCode,#FeeCodeX],
![#<->#,"#FdCASE_NO+案號",#CaseNo],
[#<->#,"#FdPAYMENT_DT+銷號日期",#CloseDate],
[#<->#,"#FdRMK+備註",#Rmk],
[#<->#,"#FdPAYMENT_NO+銷帳編號",#CloseNo],
["#FdOVERDUE_DT+轉催收日",#OverdueDate],
]
!---------- AP Button AREA ----------
![Buttom資料查詢]
#BUF1=X,42,S

! 永遠為必輸欄位
#FdFUNCD=X,2,L
#FdCUSTNO=X,2,L
#FdFacmNo=X,2,L
#FdREC_DT=X,2,L
#FdDOC_DT=X,2,L
#FdFEE=X,2,L
#FdFEE_IND=X,2,L
#FdCASE_NO=X,2,L
#FdPAYMENT_DT=X,2,L
#FdRMK=X,2,L
#FdPAYMENT_NO=X,2,L
#FdOVERDUE_DT=X,2,L

!---------- AP TEXT AREA Variables ----------
<include src="HELPRIM.icf::HELPRIM.rtn"/>

#SetSysPar=X,1,S
C(3,#FunCd,1,S,$)
E(0,1)ASGN(AGAIN$)

!FeeCode
#CDDEF0001=x,20,S
T(3,CdCode.FeeCode)
#FeeCodeHelp=x,1024,S

#CDDEF0002=x,26,S
T(3,CdCode.CurrPrecision)
#CurrPrecisionHelp=x,1024,S

#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#CDDEF0001,#CDDEF0002)
R(1,XXR99)
CALL(#HelpProc)
T(2,@FeeCodeHelp,#HelpDesc1)
T(2,@CurrPrecisionHelp,#HelpDesc2)

#FunCdHelp=x,40,S
T(3,2:修改;4:刪除;5:查詢)

#CHAIN=A,1,S
T(4,CHAIN$)
IF(#CHAIN!=1,V(P,此為連動交易，請從交易:[L2078法拍費用明細資料查詢]進入),$)
![幣別]
#CurrencyCode=X,3,S
T(3,TWD)

#Precision=N,1,S
T(H,#CurrencyCode,#CurrPrecisionHelp)

#init=X,1,S
HIDE(#UsFee)


#NTXBUF=X,179,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
T(1,@FunCd,#NTXBUF,1,1)
T(1,@RecordNo,#NTXBUF,2,7)
T(1,@CustNo,#NTXBUF,9,7)
T(1,@FacmNo,#NTXBUF,16,3)

![功能] 
!下拉式選單 1.新增 2.修改4.刪除 5.查詢
#FunCd=A,1,S
C(3,#CHAIN,1,s,$)
HELP(#FunCdHelp) 
@V(H,#FunCdHelp)
IF(#RecordNo == 0,V(P,請先至L2941查詢),$)
E(0,@FUNCIND,#FunCd)

#FunCdX=X,4,L
C(4,#FunCd,S,$)
T(H,#FunCd,#FunCdHelp)
C(2,#FunCd,$,K(MODIFYBUTTON,新增),K(MODIFYBUTTON,修改),K(MODIFYBUTTON,新增),K(MODIFYBUTTON,刪除),K(MODIFYBUTTON,查詢)K(NOBUTTON,CLOSEY))

#ShowFd=X,1,S
IF(#FunCd == 2,T(3,*),S)
T(2,@FdREC_DT,#ShowFd)
T(2,@FdDOC_DT,#ShowFd)
T(2,@FdFEE,#ShowFd)
T(2,@FdFEE_IND,#ShowFd)
T(2,@FdCASE_NO,#ShowFd)
T(2,@FdRMK,#ShowFd)
									
!紀錄號碼
#RecordNo=A,7,S

!調RIM參數
#RimRecordNo=A,7,S

<include src="ROM.icf::L2R34.dec"/>

!調RIM取法拍費用檔
#FEEL2R34=X,1,S
E(0,@RimRecordNo,#RecordNo)
RESET_RIM(#FEEL2R34,L2R34)
S(L2R34,1,#RimRecordNo)
R(1,L2R34)

#checkL2R34=X,1,S
E(0,@ReceiveDate,#L2r34ReceiveDate)
E(0,@DocDate,#L2r34DocDate)
E(0,@TwFee,#L2r34Fee)
E(0,@UsFee,#L2r34Fee)
E(0,@FeeCode,#L2r34FeeCode)
!T(2,@CaseNo,#L2r34CaseNo)
E(0,@CloseDate,#L2r34CloseDate)
T(2,@Rmk,#L2r34Rmk)
E(0,@CloseNo,#L2r34CloseNo)
E(0,@OverdueDate,#L2r34OverdueDate)

! Y=已沖銷費用 
#checkClose=X,1,S
C(3,#L2r34CloseDate,0,T(3,N),T(3,Y))

!刪除時關閉框線
#WKTF=X,1,S
IF (#FunCd==4 || #FunCd==5,T(F,@CustNo,0)T(F,@FacmNo,0)T(F,@ReceiveDate,0)T(F,@DocDate,0)T(F,@TwFee,0)T(F,@FeeCode,0)T(F,@CloseDate,0)T(F,@Rmk,0)T(F,@CloseNo,0)T(F,@OverdueDate,0)T(F,@,0)T(F,@,0),$)
IF(#FunCd==2,T(F,@CustNo,0)T(F,@FacmNo,0)T(F,@CloseDate,0),$)
IF(#checkClose == "Y",T(F,@ReceiveDate,0)T(F,@TwFee,0)T(F,@FeeCode,0)
                      T(3,@FdREC_DT, )T(3,@FdFEE, )T(3,@FdFEE_IND, )T(3,@FdCASE_NO, ),$)           
              


!借戶戶號 必須輸入
#CustNo=A,7,I
C(3,#CHAIN,1,s,$)
C(3,#FunCd,4,s,$)
C(3,#FunCd,5,s,$)
@V(2,0)

#FacmNo=A,3,I
C(3,#CHAIN,1,s,$)
C(3,#FunCd,4,s,$)
C(3,#FunCd,5,s,$)
@V(2,0)

#POSINTDT=D,8,S
T(4,DATE$)

!收件日 必須輸入 預設日期 系統帳務日期
#ReceiveDate=D,7,I
C(3,#FunCd,4,s,$)
C(3,#FunCd,5,s,$)
C(5,#checkClose,Y,s,$)
@A(DATE,0,#ReceiveDate)
V(7)V(2,0)

!單據日期 
#DocDate=D,7,I
C(3,#FunCd,4,s,$)
C(3,#FunCd,5,s,$)
@V(2,0)V(7)
A(DATE,0,#DocDate)

!法拍費用 
#TwFee=m,14,I
C(3,#Precision,0,$,s)
C(3,#FunCd,4,s,$)
C(3,#FunCd,5,s,$)
C(5,#checkClose,Y,s,$)
@V(2,0)

#UsFee=m,14.2,I
C(3,#Precision,0,s,$)
C(3,#FunCd,4,s,$)
C(3,#FunCd,5,s,$)
C(5,#checkClose,Y,s,$)
@V(2,0)

#TimFee=m,14.2,S
C(3,#Precision,0,E(0,#TwFee),E(0,#UsFee))


!科目 
#FeeCode=A,2,I
C(3,#FunCd,4,s,$)
C(3,#FunCd,5,s,$)
C(5,#checkClose,Y,s,$)
HELP(#FeeCodeHelp,cols:2)
@V(H,#FeeCodeHelp)

#FeeCodeX=X,12,L
T(H,#FeeCode,#FeeCodeHelp) 

! !件別
! #CaseCode=A,1,I
! C(3,#FunCd,4,s,$)
! C(3,#FunCd,5,s,$)
! C(3,#L2r34CloseDate,0,$,s)
! HELP(2:匯款)

! #CaseCodeX=X,4,L
! SWITCH(#CaseCode,0,T(3,),
!                  2,T(3,匯款))

! !匯款單位   
! #RemitBranch=X,3,I
! C(3,#FunCd,4,s,$)
! C(3,#FunCd,5,s,$)

! !匯款人
! #Remitter=x,10,I
! C(3,#FunCd,4,s,$)
! C(3,#FunCd,5,s,$)

!案號 
#CaseNo=X,3,L
!C(3,#FunCd,4,s,$)
!C(3,#FunCd,5,s,$)
!C(5,#checkClose,Y,s,$)

!銷號日期
#CloseDate=D,7,I
C(3,#FunCd,2,s,$)
C(3,#FunCd,4,s,$)
C(3,#FunCd,5,s,$)
C(5,#checkClose,Y,s,$)

!備註 可不輸入
#Rmk=X,60,I
C(3,#FunCd,4,s,$)
C(3,#FunCd,5,s,$)

!銷帳編號
#CloseNo=A,7,L

!轉催收日
#OverdueDate=D,7,L

#RPTFG=A,1,S



</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>


!---------- TXFORM = L2602 ----------
<sub type="FORM" name="L2602">

!#SCRPRT=_,_,S
!C(5,#TXFORM,L2602,$,S)

#SCRTIL=_,_,S
T(3,[L2602] 法拍費用管理系統-法拍費用維護)

!------ TOM(HEAD)   Variables (FOR OUTPUT SCREEN) ------
!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------

!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------

</sub>


!------ 上行電文 ------
<sub type="TIM">
#FunCd
#RecordNo
#CustNo
#ReceiveDate
#DocDate
#TimFee
#FeeCode
#CaseNo
#CloseDate
#Rmk
#CloseNo
#OverdueDate
</sub>


!------ 下行電文TOM ------
<sub type="TOM">
TXFORM=L2602^
<include src="COM.icf::TRCTL.tom"/>
<include src="ROM.icf::L2R34.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
</sub>

<sub type="PART" name="L2602" layout="cols=3;screen.width=[130,370,130,370];printer.width=[15,30,15,30];order=1">
[
["[L2602]                                 法拍費用維護"],
[#<->#,"@案件編號"],
[#<->#,"@統一編號"],
["@借戶戶號"],
["@核准編號"],
]
</sub>
!---------- 單據輸出組合 ----------
<sub type="SELECT">

<include src="PRT.icf::UPD01.sel"/>
</sub>
