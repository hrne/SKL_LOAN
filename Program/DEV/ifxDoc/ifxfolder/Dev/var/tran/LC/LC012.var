!---------- BASIC LABEL Variables ----------
!移除"主管"的交易明細
<sub type="SYS">
</sub>

<sub type="SYS" name="label">

#TXCD
T(3,LC012)

</sub>


<sub type="DC" name="p1"
         layout="cols=1;
			screen.width=[100,800];
			printer.width=[10,40];">
[
["[LC012]                表單補印"],
![" ^ 順序","#srh_order"],
![" ^ 交易序號","#srh_txno"],
![" ^ 交易代號","#srh_txcd"],
[" @ 使用單位",#srh_brno],
[" * 業務",#txcode2,#txcode2X],
[" @ 經@@@@辦",#srh_tlrno],
[" @ 戶號/編號",#srh_mrkey],
[" * 起迄日",#srh_date1,"@~@",#srh_date2],
![" ^ 統編","#srh_cifkey"],
![" @ 備註","業務別為XS/XF時,起迄日限當日"],
!["　 ","存款(XS)與定存(XF)交易,[重印單據]需主管授權"],
![" ^ 受理行","#srh_rbrno"],
![" ^ 指定行","#srh_fbrno"],
![" ^ 審單行","#srh_pbrno"],
![" ^ 分行","#srh_brno","#srh_rbrno","#srh_fbrno","#srh_acbrno","#srh_pbrno","#srh_mrkey"],
![" ^ 櫃員","#srh_tlrno"],
![" ^ 交易時間","From:","#srh_time1", "To:","#srh_time2"],
]

<include src="HELPRIM.icf::HELPRIM.rtn"/>

#CDDEF01=x,26,S
T(3,CdCode.Currency)

#CurrencyHelp=x,1024,S

#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#CDDEF01)
R(1,XXR99)
CALL(#HelpProc)
T(2,@CurrencyHelp,#HelpDesc1) 

#txcode2Help=x,100,S
T(3,L1:顧客管理作業;L2:業務作業;L3:帳務作業;L4:批次作業;L5:管理性作業;L6:共同作業;L7:介接外部系統;L8:遵循法令作業;L9:報表作業)

#TXTNO=A,8,S

#srh_order=X,1,S
E(0,1)
!HELP_AC(0:ASC;1:DESC)

#srh_txno=X,16,S

#srh_txcd=X,5,S


#srh_brno=X,4,L
!T(4,BRN$)

!#whatbrno=X,1,I
!T(3,1)
!HELP(1:輸入行;2:審單行)
!@V(1,1,2)
!
!#whatbrnox=X,6,O
!SWITCH(#whatbrno,1,T(3,輸入行)
!                ,2,T(3,審單行))
!T(3,#srh_brno,)
!T(3,#srh_pbrno,)
!SWITCH(#whatbrno,1,T(2,@srh_brno,#KINBR)
!                ,2,T(2,@srh_pbrno,#KINBR))
!

#whatbrnox=X,6,O
T(2,@srh_brno,#KINBR)


#txcode2=X,2,I
HELP(#txcode2Help)
@T(3,@txcode2X,)
@V(H,#txcode2Help)
!HELP(L1:顧客管理作業;
!L2:業務作業;
!L3:帳務作業;
!L4:批次作業;
!L5:管理性作業;
!L6:共同作業;
!L7:介接外部系統;
!L8:遵循法令作業;
!L9:報表作業)
!@V(3,L1,L2,L3,L4,L5,L6,L7,L8,L9)
T(2,@srh_txcd,#txcode2)


#txcode2X=X,20,L 
T(3,)T(H,#txcode2,#txcode2Help)
!SWITCH(#txcode2,L1,T(3,顧客管理作業)
!,L2,T(3,業務作業)
!,L3,T(3,帳務作業)
!,L4,T(3,批次作業)
!,L5,T(3,管理性作業)
!,L6,T(3,共同作業)
!,L7,T(3,介接外部系統)
!,L8,T(3,遵循法令作業)
!,L9,T(3,報表作業))

#srh_tlrno=X,6,I
T(4,TLRNO$)

#srh_mrkey=X,20,I

#srh_date1=D,7,I
E(0,#SYSDATE)
D(8)
@V(7)

#srh_datef1=F,8,S
E(0,#srh_date1+19110000)

#srh_date2=D,7,I
E(0,#SYSDATE)
D(8)
@IF( #srh_date1 > #srh_date2 ,V(P,起日不可大於迄日),$)
V(7)

#srh_datef2=F,8,S
E(0,#srh_date2+19110000)


#srh_cifkey=X,10,S

#srh_rbrno=X,4,S
!C(4,#srh_cifkey,$,S)
!T(4,BRN$)

#srh_fbrno=X,4,S
!C(4,#srh_cifkey,$,S)
!T(4,BRN$)

#srh_acbrno=X,4,S
!T(4,BRN$)

#srh_pbrno=X,4,S
!C(4,#srh_cifkey,$,S)
!T(4,BRN$)

#SYSDATEF=_,_,S

!抓取天數
!!#GETDAYNUM=A,4,S
!E(0,1)

!#RIM_XXRLD=X,1,S
!S(XXRLD,01,#SYSDATEF,#GETDAYNUM,#END)
!R(1,XXRLD)

!#AFTER_RIM_XXRLD=X,1,S
!E(0,@srh_date1,#XXRLD_FLBSDY)
!C(4,#XXRLD_FLBSDY,D(6,3,@srh_date1,#SYSDATEF,1),$)

!server沒有serch時間
#srh_time1=A,6,S
!E(0,000000)
#srh_time2=A,6,S
!E(0,235959)



#XXRLD_FLBSDY=X,8,S

</sub>
<sub type="RTN">
#responseTime=X,30,S

#jnlId=X,15,S

#jnlDate=X,10,S
#jnlTime=X,16,S

#busDate=X,10,S
#busYearF=N,4,S
T(1,#busDate,1,4)
#busYear=N,3,S
E(0,#busYearF-1911)
#busMMDD=X,6,S
T(1,#busDate,5,6)
#busDateX=X,9,S
T(2,#busYear+#busMMDD)

#jnlSeq=A,4,S

#jnlTxcd=X,5,S

#jnlTxcdx=X,20,S
!T(A,#jnlTxcd,TXCD,TXCDDEF,NO,DESC)

#jnlCifkey=X,20,S

#jnlFbrno=X,4,S

#jnlPbrno=X,4,S

#jnlAcbrno=X,4,S

#jnlBrn=X,4,S

#jnlTlrno=X,6,S

#jnlOverd=X,1,S

#jnlRqsp=X,5,S

#jnlSupno=X,2,S

#jnlTxno=X,16,S

#jnlMrkey=X,20,S

#jnlCurrency=X,3,S

#jnlCurrencyx=X,3,S
T(3,)T(H,#jnlCurrency,#CurrencyHelp)
!T(A,#jnlCurrency,CURR,CURDEF,CURCD,ENAME)

#jnlTxamt=m,14.2,S
#jnlTxamt1=m,14,S
E(0,#jnlTxamt)
#jnlTxamtX=X,17,S
C(3,#jnlTxamt1,0,T(3,)T(3,@jnlCurrencyx,),X(#jnlTxamt1)) ! 金額為0時隱藏幣別與金額

#btnView=X,5,S
BIND(grid, {cmd=VIEWEJ; ntxcd=#jnlTxcd; id=#jnlId} )

#btnPrint=X,5,S
BIND(grid, {cmd=DUPDOC; id=#jnlTxno;date=#jnlDate} )

</sub>
!------ 上行電文TIM：BASIC LABEL + AP TEXT AREA + AP TEXT ------
<sub type="TIM" target="bean" bean="url:/mvc/hnd/jnl/scan">
put={
   opt:1,
   order:#srh_order,
   txno:#srh_txno,
   brn:#srh_brno,
   rbrno:#srh_rbrno,
   fbrno:#srh_fbrno,
   acbrno:#srh_acbrno,
   pbrno:#srh_pbrno,
   cifkey:#srh_cifkey,
   mrkey:#srh_mrkey,
   tlrno:#srh_tlrno,
   txcode:#srh_txcd,
   dateFrom:#srh_datef1,
   dateTo:#srh_datef2,
   timeFrom:#srh_time1,
   timeTo:#srh_time2
}
get.header={
   #responseTime
}
get={
   #jnlId:id,
   #jnlDate:jnlDate,
   #jnlTime:jnlTime,
   #busDate:busDate,
   #jnlTxno:txno,
   #jnlMrkey:mrkey,
   #jnlCurrency:currency,
   #jnlTxamt:txamt,
   #jnlTxcd:txcode,
   #jnlCifkey:cifkey,
   #jnlFbrno:fbrno,
   #jnlPbrno:pbrno,
   #jnlAcbrno:acbrno,
   #jnlBrn:brn,
   #jnlTlrno:tlrno,
   #jnlOverd:overd,
   #jnlRqsp:rqsp,
   #jnlSupno:supno
}

</sub>

!------ 下行電文TOM ------
<sub type="TOM">

TXFORM=XXRLD
#XXRLD_FLBSDY
^
<include src="HELPRIM.icf::HELPRIM.tom"/>

</sub>

!------ 單據輸出組合 ------
<sub type="SELECT">
#YN=9,QUERY.GRID
#any={caption:'表單補印', viewInNewWindow:false,sortname:'#jnlTxcd', width:790,rowNum:10, rowList:[10,20,40]}

#jnlId

#btnView=
{width:60,align:'center',search:false,formatter:'cust:bind-button:查詢'}


#jnlTxcd=交易代號
{width:80,align:'center'}

  !#jnlTxcdx=交易名稱
  !{width:190,align:'left'}

#busDateX=會計日期
{width:100,align:'center'}

#jnlTime=交易時間
{width:100,align:'center'}

#jnlMrkey=戶號/編號
{width:180,align:'left'}

#jnlCurrencyx=幣別
{width:60,align:'center'}

#jnlTxamtX=金額
{width:190,align:'right'}

  !#jnlCifkey=戶號
  !{width:180,align:'center'}

#jnlTlrno=經辦
{width:80,align:'center'}


!{search:false,formatter:'cust:chain:View:false:9:#jnlId'}

!#btnPrint=列印
!{search:false,formatter:'cust:bind-button:Print'}

^

</sub>
