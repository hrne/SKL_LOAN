!---------- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">
!#TXCD
!T(3,L4950)
</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="L4950" layout="cols=1;screen.width=[130,870];printer.width=[20,80];order=1">
[
["[L4950]@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@員工扣薪設定檢核表"],
[""],
! [#<->#,"#FdAcDate+會計日期",#AcDate],
] 

#FdAcDate=X,2,L

#CHAIN=A,1,S
T(4,CHAIN$) 

#NEXT_DATE=D,8,S
T(4,NBSDY$)

#COLDIS=A,1,S
T(1,@AcDate,#SYSDATE,2,7)

! 會計日期
#AcDate=D,7,L

#ReportA=A,1,S
E(0,1)

#RPTFG=A,1,S
E(1,1)
</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
#L4950PRT=A,1,S
C(4,#ReportA,E(0,0),E(0,1))
![資料表頭(HEADER)長度]
#L4950HD=n,3,S
C(4,#ReportA,S,$)E(0,6)ASGN(INQHD$)
![每筆明細(OCCURS)長度]
#L4950LN=n,3,S
C(4,#ReportA,S,$)E(0,133)ASGN(INQLEN$)
![每張印錄單列印的筆數]
#L4950QPRT=n,2,S
C(4,#ReportA,S,$)E(0,30)ASGN(INQPRT$)
![畫面顯示的明細間的高度]
#L4950LOOP=n,3,S
C(4,#ReportA,S,$)E(0,1)ASGN(LOOPHEIGHT$)

</sub>

!------------ TXFORM = L4950 -----------
<sub type="FORM" name="L4950">
#OErrCnt=m,6,O

#LOOP=X,1,S
E(0,1)ASGN(LOOP$)

#OOCustNo=A,7,O
#OOFacmNo=A,3,O
#OOBormNo=A,3,O
#OOEmpName=x,40,O
#OOEmpNo=x,10,O
#OOEmpId=x,10,O
#OOErrMsg=x,60,O
</sub>

!------ 上行電文 TEXT ------
<sub type="TIM">
#AcDate
</sub>

!------ 下行電文TOM ------
<sub type="TOM">
<include src="COM.icf::TRCTL.tom"/>
TXFORM=L4950
#OErrCnt
#OOCustNo
#OOFacmNo
#OOBormNo
#OOEmpName
#OOEmpNo
#OOEmpId
#OOErrMsg

^
</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">
<include src="PRT.icf::INQ01.sel" map="i=L4950;cpi=15"/>
%
#OOCustNo
#OOFacmNo
#OOBormNo
#OOEmpName
#OOEmpNo
#OOEmpId
#OOErrMsg
@
+
#OErrCnt
^

</sub>
