!---------- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">
!#TXCD
!T(3,L4603)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,8)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,61)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,40)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)
</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="L4603" layout="cols=1;screen.width=[150,850];printer.width=[20,80];order=1">
[
["[L4603]@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@火險通知作業"],
[#<->#,"#FdInsuEndMonth+火險到期年月",#InsuEndMonth],
]

#FdInsuEndMonth=X,2,L
T(3,*)

#CHAIN=A,1,S
T(4,CHAIN$) 

#NEXT_MONTH=D,8,S
D(7,2,#SYSDATE,1,0)

#CheckDays=m,2,S
T(1,#SYSDATE,7,2)

! 火險到期年月 15號前為當月，15號後為下個月
#InsuEndMonth=A,5,I
IF(#CheckDays<15,T(1,#SYSDATE,2,5),T(1,#NEXT_MONTH,2,5))
@A(YM,1,#InsuEndMonth)

#RPTFG=A,1,S
</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!------------ TXFORM = L4603 -----------
<sub type="FORM" name="L4603">
! 媒體檔FileNo
#PdfSnoM=X,8,S
E(2,@SnoM,#PdfSnoM)
#SnoM=A,8,S

! 媒體檔FileNo
#PdfPrtM=A,1,S
C(3,#SnoM,0,E(0,0),E(0,1))

#LOOP=X,1,S
E(0,1)ASGN(LOOP$)

#OOCustNo=A,7,O
#OOFacmNo=A,3,O

#OOCustNoX=X,11,O
T(2,#OOCustNo+-+#OOFacmNo)

#OOClCode1=A,1,O
#OOClCode2=A,2,O
#OOClNo=A,7,O

#OOClNoX=X,12,O
T(2,#OOClCode1+-+#OOClCode2+-+#OOClNo)

#OOCustName=c,40,O

#OOInsuNo=X,20,O

#OOLableA=A,1,O

#OOLableAX=X,10,O
C(2,#OOLableA,T(2,火險通知單),
T(2,書面通知),
T(2,簡訊通知),
T(2,電子郵件),
T(2,不通知))

</sub>

!------ 上行電文 TEXT ------
<sub type="TIM">
#InsuEndMonth
#END
</sub>

!------ 下行電文TOM ------
<sub type="TOM">
<include src="COM.icf::TRCTL.tom"/>
TXFORM=L4603
#PdfSnoM
#OOCustNo
#OOFacmNo
#OOClCode1
#OOClCode2
#OOClNo
#OOInsuNo
#OOCustName
#OOLableA
^
</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">
#RPTFG=0,QUERY.GRID
#any={detail:true, caption:'', rowNum:20, rowList:[20,40,60]}
#OOCustNoX=戶號
{width:120}

#OOClNoX=擔保品代號
{width:120}

#OOInsuNo=原保單號碼
{width:120}

#OOCustName=戶名
{width:120}

#OOLableAX=通知種類
{width:120}
^
#PdfPrtM=1,PDF,,,,,,,,,,,,,PdfSnoM;3,火險通知作業_LNM52P.txt
^

</sub>
