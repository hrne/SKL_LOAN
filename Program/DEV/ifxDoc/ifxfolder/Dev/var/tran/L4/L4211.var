!---------- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">
</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
</sub>


!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="L4211" layout="cols=3;screen.width=[150,400,150,300];printer.width=[20,80];order=1">
[
["[L4211]                                 匯款轉帳報表                                 "],
[#<->#,"#FdFunctionCodeX+報表種類",#FunctionCode,#FunctionCodeX], 
[#<->#,"#FdAcDate+會計日期",#AcDate],
[#<->#,"#FdEntryDate+入帳日期",#EntryDate],
[#<->#,"#FdReconCode+存摺代號",#ReconCode,"(A1～A7，空白:全部)"],
]

#FdFunctionCodeX=X,2,L
T(3,*)
#FdAcDate=X,2,L
T(3,*)
#FdEntryDate=X,2,L
T(3,*)
#FdReconCode=X,2,L
T(3,*)

#CHAIN=A,1,S
T(4,CHAIN$)

#NTXBUF=X,20,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
!T(1,@FunctionCode,#NTXBUF,1,1)

#FunctionCodeHelp=X,20,S
T(3,1:成功;2:失敗)

! 作業項目
#FunctionCode=A,1,I
HELP(#FunctionCodeHelp)
@V(H,#FunctionCodeHelp)

#FunctionCodeX=X,10,L
T(H,#FunctionCode,#FunctionCodeHelp)

#CheckHide=X,1,S
IF(#FunctionCode == 1,INVOKEJS(SHOW,L4211,3,3,0),INVOKEJS(SHOW,L4211,3,3,1))
IF(#FunctionCode == 2,INVOKEJS(SHOW,L4211,2,2,0),INVOKEJS(SHOW,L4211,2,2,1))

! 會計日期
#AcDate=D,7,I
C(3,#FunctionCode,1,$,S)
E(0,#SYSDATE)
@V(7)A(DATE,0,#AcDate)

! 入帳日
#EntryDate=D,7,I
C(3,#FunctionCode,2,$,S)
E(0,@EntryDate,#SYSDATE)
@V(7)A(DATE,0,#EntryDate)

#ReconCode=X,3,I
@
C(4,#ReconCode,$,V(3,A1,A2,A3,A4,A5,A6,A7))

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>


!------ 上行電文 TEXT ------
<sub type="TIM">
#FunctionCode
#AcDate
#EntryDate
#ReconCode
</sub>

!------ 下行電文TOM ------
<sub type="TOM">
<include src="COM.icf::TRCTL.tom"/>
TXFORM=L4211
^
</sub>


!---------- 單據輸出組合 ----------
<sub type="SELECT">
<include src="PRT.icf::UPD01.sel"/>
</sub>
