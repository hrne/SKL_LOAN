!---------- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">
!#TXCD
!T(3,L4520)
</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="L4520" layout="cols=1;screen.width=[130,870];printer.width=[20,80];order=1">
[
["[L4520]@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@產生員工扣薪報表"],
[#<->#,"#FdAcDate+會計日期",#AcDate],
[#<->#,"#FdPerfMonth+業績年月",#PerfMonth],
[#<->#,"#FdProcCode+流程別",#ProcCode],
] 

#FdAcDate=X,2,L
T(3,*) 
#FdPerfMonth=X,2,L
T(3,*) 
#FdProcCode=X,2,L
T(3,*)                                                                                                  

#CHAIN=A,1,S
T(4,CHAIN$) 

#NEXT_DATE=D,8,S
T(4,NBSDY$)

! 會計日期
#AcDate=D,7,I
T(1,#SYSDATE,2,7)
@
V(7)A(DATE,0,#AcDate)
! 業績年月
#PerfMonth=A,5,I
T(1,#SYSDATE,2,5)
@A(YM,1,#PerfMonth)

#ProcCode=A,1,I
@V(1,1,2,3,4,5,6,7,8,9)

#ReportA=A,1,S
E(0,1)
</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
#L452APRT=A,1,S
C(4,#ReportA,E(0,0),E(0,1))
![資料表頭(HEADER)長度]
#L452AHD=n,3,S
C(4,#ReportA,S,$)E(0,68)ASGN(INQHD$)
![每筆明細(OCCURS)長度]
#L452ALN=n,3,S
C(4,#ReportA,S,$)E(0,118)ASGN(INQLEN$)
![每張印錄單列印的筆數]
#L452AQPRT=n,2,S
C(4,#ReportA,S,$)E(0,30)ASGN(INQPRT$)
![畫面顯示的明細間的高度]
#L452ALOOP=n,3,S
C(4,#ReportA,S,$)E(0,1)ASGN(LOOPHEIGHT$)

#L452BPRT=A,1,S
C(4,#ReportA,E(0,0),E(0,1))
![資料表頭(HEADER)長度]
#L452BHD=n,3,S
C(4,#ReportA,S,$)E(0,68)ASGN(INQHD$)
![每筆明細(OCCURS)長度]
#L452BLN=n,3,S
C(4,#ReportA,S,$)E(0,118)ASGN(INQLEN$)
![每張印錄單列印的筆數]
#L452BQPRT=n,2,S
C(4,#ReportA,S,$)E(0,30)ASGN(INQPRT$)
![畫面顯示的明細間的高度]
#L452BLOOP=n,3,S
C(4,#ReportA,S,$)E(0,1)ASGN(LOOPHEIGHT$)
</sub>

!------------ TXFORM = L4520 -----------
<sub type="FORM" name="L452A" tota-mode="1">
#OA_SuccCnt=m,6,O
#OA_SuccRpAmt=m,14,O
#OA_SuccTxAmt=m,14,O
#OA_TotlCnt=m,6,O
#OA_TotlRpAmt=m,14,O
#OA_TotlTxAmt=m,14,O

#L452A_LOOP=X,1,S
E(0,1)ASGN(LOOP$)

#OOA_CustNo=A,7,O
#OOA_EmpName=x,20,O
#OOA_FailMsg=x,20,O
#OOA_RepayAmt=m,14,O
#OOA_TxAmt=m,14,O
#OOA_EmpNo=x,6,O
#OOA_EmpId=x,10,O
#OOA_AcDate=D,7,O
#OOA_Remark=x,20,O
![防止二次單據]
E(0,@L452BPRT,0)

</sub>

<sub type="FORM" name="L452B" tota-mode="1">
#OB_FailCnt=m,6,O
#OB_FailRpAmt=m,14,O
#OB_FailTxAmt=m,14,O
#OB_TotlCnt=m,6,O
#OB_TotlRpAmt=m,14,O
#OB_TotlTxAmt=m,14,O

#L452B_LOOP=X,1,S
E(0,1)ASGN(LOOP$)

#OOB_CustNo=A,7,O
#OOB_EmpName=x,20,O
#OOB_FailMsg=x,20,O
#OOB_RepayAmt=m,14,O
#OOB_TxAmt=m,14,O
#OOB_EmpNo=x,6,O
#OOB_EmpId=x,10,O
#OOB_AcDate=D,7,O
#OOB_Remark=x,20,O
![防止二次單據]
E(0,@L452APRT,0)


</sub>

!------ 上行電文 TEXT ------
<sub type="TIM">
#AcDate
#PerfMonth
#ProcCode
</sub>

!------ 下行電文TOM ------
<sub type="TOM">
<include src="COM.icf::TRCTL.tom"/>
TXFORM=L452A
#OA_SuccCnt
#OA_SuccRpAmt
#OA_SuccTxAmt
#OA_TotlCnt
#OA_TotlRpAmt
#OA_TotlTxAmt
#OOA_CustNo
#OOA_EmpName
#OOA_FailMsg
#OOA_RepayAmt
#OOA_TxAmt
#OOA_EmpNo
#OOA_EmpId
#OOA_AcDate
#OOA_Remark
^
TXFORM=L452B
#OB_FailCnt
#OB_FailRpAmt
#OB_FailTxAmt
#OB_TotlCnt
#OB_TotlRpAmt
#OB_TotlTxAmt
#OOB_CustNo
#OOB_EmpName
#OOB_FailMsg
#OOB_RepayAmt
#OOB_TxAmt
#OOB_EmpNo
#OOB_EmpId
#OOB_AcDate
#OOB_Remark
^

</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">
<include src="PRT.icf::UPD01.sel"/>
#L452APRT=1,L452A,NA,,D,15
%
#OOA_CustNo
#OOA_EmpName
#OOA_FailMsg
#OOA_RepayAmt
#OOA_TxAmt
#OOA_EmpNo
#OOA_EmpId
#OOA_AcDate
#OOA_Remark
@
#OA_SuccCnt
#OA_SuccRpAmt
#OA_SuccTxAmt
#OA_TotlCnt
#OA_TotlRpAmt
#OA_TotlTxAmt
^

#L452BPRT=1,L452B,NA,,D,15
%
#OOB_CustNo
#OOB_EmpName
#OOB_FailMsg
#OOB_RepayAmt
#OOB_TxAmt
#OOB_EmpNo
#OOB_EmpId
#OOB_AcDate
#OOB_Remark
@
#OB_FailCnt
#OB_FailRpAmt
#OB_FailTxAmt
#OB_TotlCnt
#OB_TotlRpAmt
#OB_TotlTxAmt
^

</sub>
