!---------- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">
!#TXCD
!T(3,L4702)
</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="L4702" layout="cols=1;screen.width=[130,870];printer.width=[20,80];order=1">
[
["[L4702]@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@產生放款本息攤還表暨繳息通知單"],
[#<->#,"#FdFunctionCodeX+功能",#FunctionCode,#FunctionCodeX],
[#<->#,"#FdACCTDATE_ST+會計日期",#ACCTDATE_ST,"～",#ACCTDATE_ED,"止有變動者"],
[#<->#,"#FdCUSTNO+戶號",#CUSTNO,#BTNA,"～",#CUSTNOB,#BTNB],
[#<->#,"#FdCONDITION1+選擇條件一",#CONDITION1,#CONDITION1X],
[#<->#,"#FdCONDITION2+選擇條件二",#CONDITION2,#CONDITION2X],
[#<->#,"#FdID_TYPE+個金/企金",#ID_TYPE,#ID_TYPEX],
[#<->#,"#FdCORP_IND+企金別",#CORP_IND,#CORP_INDX],
[#<->#,"#FdAPNO+業務科目",#APNO,#APNOX],
] 

#FdFunctionCodeX=X,2,L
T(3,*)
#FdACCTDATE_ST=X,2,L
T(3,*)
#FdCUSTNO=X,2,L
T(3,*)
#FdCONDITION1=X,2,L
T(3,*)
#FdCONDITION2=X,2,L
#FdID_TYPE=X,2,L
#FdCORP_IND=X,2,L
#FdAPNO=X,2,L

#BTNA=X,1,I,ui:button;value:額度明細查詢;enable:1;tabbable:0
#BTNB=X,1,I,ui:button;value:額度明細查詢;enable:1;tabbable:0

<include src="HELPRIM.icf::HELPRIM.rtn"/>
!Condition1
#CDCODECondition1=x,20,S                  
T(3,CdCode.Condition1)                  
                                      
#Condition1Help=x,100,S        

!Condition2
#CDCODECondition2=x,20,S                  
T(3,CdCode.Condition2)                  
                                        
#Condition2Help=x,100,S        

!CustType
#CDCODECustType=x,20,S                  
T(3,CdCode.CustType)                  
                                         
#CustTypeHelp=x,50,S   

!CorpInd
#CDCODECorpInd=x,20,S                  
T(3,CdCode.CorpInd)                  
                                         
#CorpIndHelp=x,50,S  

!Apno
#CDCODEApno=x,20,S                  
T(3,CdCode.Apno)                  
                                         
#ApnoHelp=x,100,S 


#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#CDCODECondition1,#CDCODECondition2,#CDCODECustType,#CDCODECorpInd,#CDCODEApno)
R(1,XXR99)
CALL(#HelpProc)
T(2,@Condition1Help,#HelpDesc1)
T(2,@Condition2Help,0:+全部;+#HelpDesc2)
T(2,@CustTypeHelp,0:+全部;+#HelpDesc3)
T(2,@CorpIndHelp,#HelpDesc4)
T(2,@ApnoHelp,0:+全部;+#HelpDesc5)

!功能
#FunctionHelp=x,20,S
T(3,1:個別列印;2:整批列印)

#YNHelp=x,20,S
T(3,Y:是;N:否)

#CHAIN=A,1,S
T(4,CHAIN$) 

! 收票日
#EntryDate=D,7,O
T(1,#SYSDATE,2,7)

! 下一營業日
#NEXT_DATE=D,8,S
T(4,NBSDY$)

! 功能
#FunctionCode=A,1,I
C(3,#CHAIN,0,E(0,1),E(0,2))
C(3,#CHAIN,0,$,s)
HELP(#FunctionHelp)
@V(H,#FunctionHelp)

#FunctionCodeX=X,4,L  
T(3,)T(H,#FunctionCode,#FunctionHelp)
!SWITCH(#FunctionCode,1,T(2,個別列印),
!                   2,T(2,整批列印))

#ColDisplay=A,1,S
C(3,#CHAIN,0,
C(3,#FunctionCode,2,INVOKEJS(SHOW,L4702,3,8,0)
T(F,@ACCTDATE_ED,0)
T(F,@CUSTNO,0)
T(F,@CUSTNOB,0)
HIDE(#BTNA,#BTNB),INVOKEJS(SHOW,L4702,2,8,1)
T(F,@ACCTDATE_ED,1)
T(F,@CUSTNO,1)
T(F,@CUSTNOB,1)
SHOW(#BTNA,#BTNB)),
INVOKEJS(SHOW,L4702,2,8,0)
T(F,@ACCTDATE_ED,0)
T(F,@CUSTNO,0)
T(F,@CUSTNOB,0)
HIDE(#BTNA,#BTNB)
)


#DT1=D,8,S
T(4,DATE$)

#DT2=D,7,S
T(1,#DT1,2,7)

#DT_YM=A,5,S
T(1,#DT1,2,5)

! 版面配置
#COLDIS=A,1,S
T(2,@ACCTDATE_ST,#DT2)
T(2,@ACCTDATE_ED,#DT2)
E(0,@CUSTNO,1)
E(0,@CUSTNOB,9999999)


!會計日期 必須輸入，不可大於本營業日
#ACCTDATE_ST=D,7,I
C(3,#CHAIN,0,T(2,#DT_YM+01),T(2,#DT2))
C(3,#FunctionCode,2,T(2,#DT2),$)
C(3,#CHAIN,0,$,s)
@V(7)
V(5,0,#DT2)
A(DATE,0,#ACCTDATE_ST)

#ACCTDATE_ED=D,7,I
T(2,#DT2)
C(3,#FunctionCode,2,T(2,#ACCTDATE_ST),$)
C(3,#FunctionCode,2,s,$)
C(3,#CHAIN,0,$,s)
@V(7)
V(5,#ACCTDATE_ST,#DT2)
A(DATE,0,#ACCTDATE_ED)

!<瀏覽>
#BUFA=X,18,S
T(3,00000009999999000)
#BINDA=X,1,S
BIND(#BTNA,click, {cmd=CHAIN; ntxcd=L2015; ntxbuf=#BUFA;ntxbuf5=type<-1:CUSTNO<-OOCustNo})
!<瀏覽>
#BUFB=X,18,S
T(3,00000009999999000)
#BINDB=X,1,S
BIND(#BTNB,click, {cmd=CHAIN; ntxcd=L2015; ntxbuf=#BUFB;ntxbuf5=type<-1:CUSTNOB<-OOCustNo})

!戶號
#CUSTNO=A,7,I
C(3,#FunctionCode,2,s,$)
E(0,1)
C(3,#CHAIN,0,$,s)
@V(2,0)
C(3,#CUSTNO,1,E(0,@CUSTNOB,9999999),E(0,@CUSTNOB,#CUSTNO))

!戶號
#CUSTNOB=A,7,I
C(3,#FunctionCode,2,s,$)
C(3,#CHAIN,0,$,s)
@V(2,0)
V(5,#CUSTNO,9999999)

!選擇條件一
#CONDITION1=A,1,I
C(3,#FunctionCode,2,s,$)
C(3,#CHAIN,0,$,s)
E(0,1)
HELP(#Condition1Help)
@V(H,#Condition1Help)

#CONDITION1X=X,12,L
T(H,#CONDITION1,#Condition1Help)

!選擇條件二
#CONDITION2=A,1,I
C(3,#FunctionCode,2,s,$)
C(3,#CHAIN,0,$,s)
HELP(#Condition2Help)
@V(H,#Condition2Help)

#CONDITION2X=X,12,L
T(H,#CONDITION2,#Condition2Help)

!戶別
#ID_TYPE=A,1,I
C(3,#FunctionCode,2,s,$)
C(3,#CHAIN,0,$,s)
HELP(#CustTypeHelp)
@V(H,#CustTypeHelp)

#ID_TYPEX=X,6,L
T(H,#ID_TYPE,#CustTypeHelp)

!企金別
#CORP_IND=A,1,I
C(3,#FunctionCode,2,s,$)
C(3,#CHAIN,0,$,s)
HELP(#CorpIndHelp)
@V(H,#CorpIndHelp)

#CORP_INDX=X,8,L
T(H,#CORP_IND,#CorpIndHelp)

!業務科目
#APNO=A,1,I
C(3,#FunctionCode,2,s,$)
C(3,#CHAIN,0,$,s)
HELP(#ApnoHelp)
@V(H,#ApnoHelp)

#APNOX=X,12,L
T(H,#APNO,#ApnoHelp)


</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
<include src="COM.icf::RPTFG.dec"/>
</sub>

!------------ TXFORM = L4702 -----------
<sub type="FORM" name="L4702">
#SCRTIL=_,_,S
T(3,[L4702] 放款本息攤還表暨繳息通知單)

</sub>

!------ 上行電文 TEXT ------
<sub type="TIM">
#FunctionCode
#ACCTDATE_ST
#ACCTDATE_ED
#CUSTNO
#CUSTNOB
#CONDITION1
#CONDITION2
#ID_TYPE
#CORP_IND
#APNO
#END
</sub>

!------ 下行電文TOM ------
<sub type="TOM">
<include src="COM.icf::TRCTL.tom"/>
TXFORM=L4702
^
<include src="HELPRIM.icf::HELPRIM.tom"/>
</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">
<include src="PRT.icf::UPD01.sel"/>
</sub>
