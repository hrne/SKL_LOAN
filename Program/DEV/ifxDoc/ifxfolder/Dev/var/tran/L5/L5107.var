----- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">

#TXCD
T(3,L5107)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD2.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[200,800];printer.width=[20,20];">
[
["[L5107]                                 指定覆審案件資料維護"],
["#FdFunctionCode+功能",#FunctionCodeX],
["#FdCustNo+戶號",#CustNo,#FacmNo,#CustName],
["#FdReChkYearMonth+第一次覆審年月",#ReChkYearMonth],
["#FdCycle+指定覆審週期",#Cycle],
["#FdRemark+備註",#Remark]
]

!---------- AP Button AREA ----------
<include src="ROM.icf::L5R47.dec"/>
#CHAIN=A,1,S
T(4,CHAIN$) 
IF(#CHAIN!=1,V(P,此為連動交易，請從交易:L5907進入),$)
C(3,#CHAIN,1,E(0,@FunctionCode,1),s)

#FdFunctionCode=X,2,L

#FdCustNo=X,2,L
T(2,*)
#FdReChkYearMonth=X,2,L
T(2,*)
#FdCycle=X,2,L
#FdRemark=X,2,L




<include src="HELPRIM.icf::HELPRIM.rtn"/>
#FuncCodeRimName=x,20,S
T(3,CdCode.FunctionCd)

#FuncCodeHelpRim=X,1,S
RESET_RIM(#FuncCodeHelpRim,XXR99)
S(XXR99,01,#FuncCodeRimName)
R(1,XXR99)
CALL(#HelpProc)
T(2,@FuncCodeHelp,#HelpDesc1)
#FuncCodeHelp=x,1024,S

#NTXBUF=X,65,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
T(1,@FunctionCode,#NTXBUF,1,1)
T(1,@CustNo,#NTXBUF,2,7)
T(1,@RimCustNo,#NTXBUF,2,7)
T(1,@FacmNo,#NTXBUF,9,3)
T(1,@RimFacmNo,#NTXBUF,9,3)
#RimCustNo=A,7,S
#RimFacmNo=A,3,S
#Space=X,1,S
C(3,#FunctionCode,2,T(F,@CustNo,0)T(F,@FacmNo,0)T(2,@FdCustNo, ),$)
C(3,#FunctionCode,4,T(F,@CustNo,0)T(F,@FacmNo,0)T(F,@ReChkYearMonth,0)T(F,@Cycle,0)T(F,@Remark,0)T(2,@FdCustNo, )T(2,@FdReChkYearMonth, ),$)

#Submit=X,4,S
C(2,#FunctionCode,S,K(MODIFYBUTTON,新增),K(MODIFYBUTTON,修改),K(MODIFYBUTTON,新增),K(MODIFYBUTTON,刪除))

#SendL5R47=X,1,S
C(3,#FunctionCode,1,S,$)
RESET_RIM(#SendL5R47,L5R47)
S(L5R47,1,#RimCustNo,#RimFacmNo)
R(1,L5R47)
T(2,@CustName,#L5R47CustName)
E(0,@ReChkYearMonth,#L5R47ReCheckYearMonth)
E(0,@Cycle,#L5R47Cycle)
T(2,@Remark,#L5R47Remark)

! 功能
#FunctionCode=A,1,S

#FunctionCodeX=X,4,L
T(H,#FunctionCode,#FuncCodeHelp)

#CDate=A,5,S
T(1,#SYSCDATE,2,5)
! 戶號
#CustNo=A,7,I
C(3,#FunctionCode,1,$,s)
@V(2,0)

<include src="ROM.icf::L5R36.dec"/>
C(3,#FunctionCode,1,$,S)
T(2,@RimCustNo,#CustNo)
RESET_RIM(#SendL5R47,L5R36)
S(L5R36,1,#RimCustNo)
R(1,L5R36)
T(2,@CustName,#L5R36CustName)

! 額度
#FacmNo=A,3,I
C(3,#FunctionCode,1,$,s)
@V(2,0)
#CustName=x,100,L
! 第一次覆審年月
#ReChkYearMonth=A,5,I
C(3,#FunctionCode,4,s,$)
@A(YM,0,#ReChkYearMonth)V(2,0)
IF(#ReChkYearMonth > #CDate,$,V(P,第一次覆審年月必須大於現在月份))
! 指定覆審週期
#Cycle=A,2,I
C(3,#FunctionCode,4,s,$)
@V(5,00,12)
! 備註
#Remark=x,120,I
C(3,#FunctionCode,4,s,$)
</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!---------- TXFORM = L5107 ----------
<sub type="FORM" name="L5107">

</sub>


!------ 上行電文 ------
<sub type="TIM">
#FunctionCode
#CustNo
#FacmNo
#ReChkYearMonth
#Cycle
#Remark
</sub>


!------ 下行電文TOM ------
<sub type="TOM">

TXFORM=L5107

^

<include src="COM.icf::TRCTL.tom"/>
<include src="ROM.icf::L5R47.tom"/>
<include src="ROM.icf::L5R36.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">
</sub>
