!---------- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">
!#TXCD
!T(3,L5952)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,0)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,371)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,60)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,60)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="L5952" layout="cols=1;screen.width=[130,870];printer.width=[20,80];order=1">
[
["[L5952]                                 房貸專員業績明細查詢"],
["#FdWorkMonthFm+工作月",#WorkMonthFm,"~",#WorkMonthTo],
["#FdSumByFacm+額度加總",#SumByFacm],
]
!---------- AP TEXT AREA Variables ----------

#button=x,100,S
T(2,{cmd=CHAIN; ntxcd=LD006; ntxbuf=#BufLD006})ASGN(BTN_NEW1$)
K(MODIFYBUTTON,1,產生媒體檔)
K(MODIFYBUTTON,查詢)

!查詢方式
#FuncHelp=X,50,S
T(3,1:工作月;2:戶號)

!YN
#YNHelp=X,50,S
T(3,Y: ;N: )

#FdWorkMonthFm=X,2,L
T(3,*)
#FdSumByFacm=X,2,L
T(3,*)

#CHAIN=A,1,S
T(4,CHAIN$) 

#NTXBUF=X,10,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
T(1,@WorkMonthFm,#NTXBUF,1,5)
T(1,@WorkMonthTo,#NTXBUF,6,5)

#PREVALUE=A,1,S
T(1,@WorkMonthFm,#SYSDATE,2,5)
T(1,@WorkMonthTo,#SYSDATE,2,5)
T(2,@SumByFacm,Y)

! 查詢方式
#FunctionCd=A,1,S
E(0,1)
HELP(#FuncHelp)
@V(H,#FuncHelp)
C(3,#FunctionCd,1,INVOKEJS(SHOW,L5952_2,1)INVOKEJS(SHOW,L5952_3,0),
                  INVOKEJS(SHOW,L5952_2,0)INVOKEJS(SHOW,L5952_3,1))
#FunctionCdX=X,8,S
T(3, )
T(H,#FunctionCd,#FuncHelp)

! 業績日期
#WorkMonthFm=A,5,I
C(3,#FunctionCd,1,$,s)
@V(7)
A(YM13,1,#WorkMonthFm)
IF(#WorkMonthFm==0,V(P,工作月不可空白),$)

#WorkMonthTo=A,5,I
C(3,#FunctionCd,1,$,s)
@V(7)
A(YM13,1,#WorkMonthTo)
IF(#WorkMonthTo==0,V(P,工作月不可空白),$)

#CheckWorkMonth=X,1,S
C(3,#FunctionCd,1,$,s)
@IF(#WorkMonthTo>=#WorkMonthFm,$,V(P,工作月起不得大於訖))

#CustNo=A,7,S
C(3,#FunctionCd,2,$,s)
@IF(#CustNo>0,s,$)
V(P,請填寫戶號)

#FacmNo=A,3,S
C(3,#FunctionCd,2,$,s)

#MRKEY=_,_,S
C(3,#CustNo,0,S,$)
C(3,#FacmNo,0,T(2,#CustNo),T(2,#CustNo+-+#FacmNo)) 

! 額度加總
#SumByFacm=X,1,I
HELP(#YNHelp)
@V(H,#YNHelp)

#RPTFG=A,1,S
E(0,1)

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!------------ TXFORM = L5952 -----------
<sub type="FORM" name="L5952">

#SCRTIL=_,_,S
T(3,[L5952] 房貸專員業績明細)

#LOOP=X,1,S
E(0,1)ASGN(LOOP$)
! 部室名
#OOBsDeptX=X,50,O
! 房貸專員名稱
#OOBsOfficerName=X,20,O
! 件數
#OOPerfCnt=+m,5.1,O
! 業績金額
#OOPerfAmt=+m,12,O
! 房貸專員
#OOBsOfficer=X,8,O
! 戶名
#OOCustNm=X,100,O
! 戶號
#OOCustNo=A,7,O
#OOCustNoX=X,7,L
C(3,#OOCustNo,0,S,T(2,#OOCustNo))
! 額度
#OOFacmNo=A,3,O
#OOFacmNoX=X,3,O
C(3,#OOFacmNo,0,S,T(2,#OOFacmNo))
! 撥款序號
#OOBormNo=A,3,O
#OOBormNoX=X,3,O
C(3,#OOBormNo,0,S,T(2,#OOBormNo))
! 撥款日
#OODrawdownDate=D,7,S
C(3,OODrawdownDate,0,S,$)
! 商品代碼
#OOProdCode=X,5,O
! 計件代碼
#OOPieceCode=X,1,O
! 撥款金額
#OODrawdownAmt=+m,12,O
! 工作月
#OOWorkMonth=X,5,O
! 部室名稱
#OOIntDept=X,30,O
! 區部名稱
#OODistDept=X,30,O
! 單位名稱
#OOUnitDept=X,30,O
! 姓名
#OOIntroducerName=X,30,O
! 員編
#OOIntroducer=X,8,O
</sub>

!------ 上行電文 TEXT ------
<sub type="TIM">
#FunctionCd
#WorkMonthFm
#WorkMonthTo
#CustNo
#FacmNo
#SumByFacm
</sub>

!------ 下行電文TOM ------
<sub type="TOM">
<include src="COM.icf::TRCTL.tom"/>
TXFORM=L5952
#OOBsDeptX
#OOBsOfficerName
#OOPerfCnt
#OOPerfAmt
#OOBsOfficer
#OOCustNm
#OOCustNo
#OOFacmNo
#OOBormNo
#OODrawdownDate
#OOProdCode
#OOPieceCode
#OODrawdownAmt
#OOWorkMonth
#OOIntDept
#OODistDept
#OOUnitDept
#OOIntroducerName
#OOIntroducer
^
</sub>


! !---------- 單據輸出組合 ----------
<sub type="PART" prompt='{{#SCRTIL}} world' name="L5952" layout="cols=1;screen.width=[130,870];order=1;">
[
["[L5952]                                 房貸專員業績明細查詢                                                                         "],
! ["@工作月",#WorkMonthFm,"~",#WorkMonthTo],
! ["@額度加總",#SumByFacm],
]
</sub>

! <sub type="PART" prompt='{{#SCRTIL}} world' name="L5952B" layout="cols=1;screen.width=[130,870];order=1;">
! [
! ["[L5952]                                 房貸專員業績明細查詢"],
! ["@戶號",#CustNo,"-",#FacmNo],
! ["@額度加總",#SumByFacm],
! ]
! </sub>

<sub type="SELECT">

#RPTFG=1,QUERY.GRID,L5952
#any={detail:true, header:'L5952.part', caption:'', width:1020, rowNum:10, rowList:[20,40,60]}
#OOBsOfficer=房貸專員
{width:80,align:'center'}
#OOBsOfficerName=
{width:80,align:'left'}
#OOCustNm=戶名
{width:120,align:'left'}
#OOCustNoX=戶號
{width:95,align:'center'}
#OOFacmNoX=額度
{width:95,align:'center'}
#OOBormNoX=撥款
{width:95,align:'center'}
#OODrawdownDate=撥款日
{width:95,align:'center'}
#OODrawdownAmt=撥款金額
{width:95,align:'right'}
#OOPerfCnt=件數
{width:60,align:'right'}
#OOPerfAmt=業績金額
{width:95,align:'right'}
#OOProdCode=利率代碼
{width:95,align:'center'}
#OOPieceCode=計件代碼
{width:95,align:'center'}
#OOWorkMonth=工作月
{width:95,align:'center'}
#OOBsDeptX=部室別
{width:95,align:'left'}
#OOIntDept=部室名稱
{width:95,align:'left'}
#OODistDept=區部名稱
{width:95,align:'left'}
#OOUnitDept=單位名稱
{width:95,align:'left'}
#OOIntroducerName=介紹人姓名
{width:110,align:'left'}
#OOIntroducer=介紹人員
{width:110,align:'center'}
^
</sub>
