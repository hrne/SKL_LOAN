!---------- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">
!#TXCD
!T(3,L5607)
</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="L5607" layout="cols=3;screen.width=[150,350,150,350];printer.width=[20,80];order=1">
[
["[L5607]                                 個案人員指派維護"],
[#<->#,"#FdCustNo+戶號",#CustNo,"@",#CustName],
[#<->#,"#FdFacmNo+額度編號",#FacmNo],
[#<->#,"#FdCityCode+地區別",#CityCode,#CityCodeX],
[#<->#,"#FdIsSpecify+是否指定",#IsSpecify],
["#FdAccCollPsn+催收人員",#AccCollPsn,#AccCollPsnX],["#FdLegalPsn+法務人員",#LegalPsn,#LegalPsnX],
["#FdAccTelArea+催收人員電話",#AccTelArea,#AccTelNo,#AccTelExt],["#FdLegalArea+法務人員電話",#LegalArea,#LegalNo,#LegalExt],
]

#FdCustNo=X,2,L
#FdFacmNo=X,2,L
#FdCityCode=X,2,L
#FdIsSpecify=X,2,L
T(3,*)
#FdAccCollPsn=X,2,L
T(3,*)
#FdLegalPsn=X,2,L
T(3,*)
#FdAccTelArea=X,2,L
T(3,*)
#FdLegalArea=X,2,L
T(3,*)

!YN
#YNHelp=X,50,S
T(3,Y: ;N: )

#CHAIN=A,1,S
T(4,CHAIN$) 
IF(#CHAIN!=1,V(P,此為連動交易，請從交易:[L5060案件處理清單]進入),$)


#AutoReFresh=A,1,S
C(3,#CHAIN,1,$,S)
E(0,1)
ASGN(CAUTO$)

K(MODIFYBUTTON,修改)

#NTXBUF=X,13,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
T(1,@CustNo,#NTXBUF,1,7)
T(1,@FacmNo,#NTXBUF,8,3)
T(1,@CityCode,#NTXBUF,11,2)
T(1,@IsSpecify,#NTXBUF,13,1)


<include src="ROM.icf::L5R15.dec"/>
#RimCustNo=X,7,S
#RimFacmNo=X,3,S
#RimL5R15=X,1,S
T(2,@RimCustNo,#CustNo)
T(2,@RimFacmNo,#FacmNo)
RESET_RIM(#RimL5R15,L5R15)
S(L5R15,1,#RimCustNo,#RimFacmNo)
R(1,L5R15)
T(2,@CustName,#L5R15CustName)
T(2,@AccCollPsn,#L5R15AccCollPsn)
T(2,@LegalPsn,#L5R15LegalPsn)
T(2,@AccCollPsnX,#L5R15AccCollPsnX)
T(2,@LegalPsnX,#L5R15LegalPsnX)
T(2,@AccTelArea,#L5R15AccTelArea)
T(2,@AccTelNo,#L5R15AccTelNo)
T(2,@AccTelExt,#L5R15AccTelExt)
T(2,@LegalArea,#L5R15LegalArea)
T(2,@LegalNo,#L5R15LegalNo)
T(2,@LegalExt,#L5R15LegalExt)


! 調rim CdCity
<include src="ROM.icf::L5R44.dec"/>
#RimL5R44=X,1,S
#RimCityCode=X,2,S
C(4,#CityCode,s,$)
T(2,@RimCityCode,#CityCode)
RESET_RIM(#RimL5R44,L5R44)
S(L5R44,1,#RimCityCode)
R(1,L5R44)
T(2,@CityCodeX,#L5R44CityCodeX)
T(2,@AccCollPsn,#L5R44AccCollPsn)
T(2,@AccCollPsnX,#L5R44AccCollPsnX)
T(2,@LegalPsn,#L5R44LegalPsn)
T(2,@LegalPsnX,#L5R44LegalPsnX)
T(2,@AccTelArea,#L5R44AccTelArea)
T(2,@AccTelNo,#L5R44AccTelNo)
T(2,@AccTelExt,#L5R44AccTelExt)
T(2,@LegalArea,#L5R44LegalArea)
T(2,@LegalNo,#L5R44LegalNo)
T(2,@LegalExt,#L5R44LegalExt)

#TEST=X,1,S
C(5,#IsSpecify,Y,
T(2,@AccCollPsn,#L5R15AccCollPsn)
T(2,@LegalPsn,#L5R15LegalPsn)
T(2,@AccCollPsnX,#L5R15AccCollPsnX)
T(2,@LegalPsnX,#L5R15LegalPsnX)
T(2,@AccTelArea,#L5R15AccTelArea)
T(2,@AccTelNo,#L5R15AccTelNo)
T(2,@AccTelExt,#L5R15AccTelExt)
T(2,@LegalArea,#L5R15LegalArea)
T(2,@LegalNo,#L5R15LegalNo)
T(2,@LegalExt,#L5R15LegalExt)
,
T(2,@AccCollPsn,#L5R44AccCollPsn)
T(2,@AccCollPsnX,#L5R44AccCollPsnX)
T(2,@LegalPsn,#L5R44LegalPsn)
T(2,@LegalPsnX,#L5R44LegalPsnX)
T(2,@AccTelArea,#L5R44AccTelArea)
T(2,@AccTelNo,#L5R44AccTelNo)
T(2,@AccTelExt,#L5R44AccTelExt)
T(2,@LegalArea,#L5R44LegalArea)
T(2,@LegalNo,#L5R44LegalNo)
T(2,@LegalExt,#L5R44LegalExt)
)

! 戶號
#CustNo=A,7,L
! 戶名----調RIM
#CustName=X,100,L
! 額度編號
#FacmNo=A,3,L
!地區別
#CityCode=X,2,L
#CityCodeX=X,8,L

!是否指定
#IsSpecify=X,1,I
HELP(#YNHelp)
@V(H,#YNHelp)

!顯示框線
#WKTF=X,1,S
IF (#IsSpecify=="Y",T(F,@AccCollPsn,1)T(F,@AccTelArea,1)T(F,@AccTelNo,1)T(F,@AccTelExt,1)
                    T(F,@LegalPsn,1)T(F,@LegalArea,1)T(F,@LegalNo,1)T(F,@LegalExt,1),
                    T(F,@AccCollPsn,0)T(F,@AccTelArea,0)T(F,@AccTelNo,0)T(F,@AccTelExt,0)
                    T(F,@LegalPsn,0)T(F,@LegalArea,0)T(F,@LegalNo,0)T(F,@LegalExt,0)
                    )
                    
#TEST2=X,1,S
C(5,#IsSpecify,Y,
T(2,@AccCollPsn,#L5R15AccCollPsn)
T(2,@LegalPsn,#L5R15LegalPsn)
T(2,@AccCollPsnX,#L5R15AccCollPsnX)
T(2,@LegalPsnX,#L5R15LegalPsnX)
T(2,@AccTelArea,#L5R15AccTelArea)
T(2,@AccTelNo,#L5R15AccTelNo)
T(2,@AccTelExt,#L5R15AccTelExt)
T(2,@LegalArea,#L5R15LegalArea)
T(2,@LegalNo,#L5R15LegalNo)
T(2,@LegalExt,#L5R15LegalExt)
,
T(2,@AccCollPsn,#L5R44AccCollPsn)
T(2,@AccCollPsnX,#L5R44AccCollPsnX)
T(2,@LegalPsn,#L5R44LegalPsn)
T(2,@LegalPsnX,#L5R44LegalPsnX)
T(2,@AccTelArea,#L5R44AccTelArea)
T(2,@AccTelNo,#L5R44AccTelNo)
T(2,@AccTelExt,#L5R44AccTelExt)
T(2,@LegalArea,#L5R44LegalArea)
T(2,@LegalNo,#L5R44LegalNo)
T(2,@LegalExt,#L5R44LegalExt)
)


! 催收人員
#AccCollPsn=X,6,I
C(5,#IsSpecify,Y,$,s)
@V(7)

#AccCollPsnX=X,40,L

<include src="ROM.icf::L5R17.dec"/>
#RimEmpNo=X,6,S
#RimL5R17=X,1,S
C(4,#AccCollPsn,S,$)
T(2,@RimEmpNo,#AccCollPsn)
RESET_RIM(#RimL5R17,L5R17)
S(L5R17,1,#RimEmpNo)
R(1,L5R17)
T(2,@AccCollPsnX,#L5R17FullName)

! 催收人員電話
#AccTelArea=X,5,I
C(5,#IsSpecify,Y,$,s)
C(4,#AccCollPsn,S,$)
@
C(4,#AccTelArea,S,$)
V(9)

#AccTelNo=X,10,I
C(5,#IsSpecify,Y,$,s)
C(4,#AccCollPsn,S,$)
@V(9)

#AccTelExt=X,5,I
C(5,#IsSpecify,Y,$,s)
C(4,#AccCollPsn,S,$)
@C(4,#AccTelExt,S,$)
V(9)


! 法務人員
#LegalPsn=X,6,I
C(5,#IsSpecify,Y,$,s)
@V(7)

#LegalPsnX=X,40,L
C(4,#LegalPsn,S,$)
T(2,@RimEmpNo,#LegalPsn)
RESET_RIM(#RimL5R17,L5R17)
S(L5R17,1,#RimEmpNo)
R(1,L5R17)
T(2,@LegalPsnX,#L5R17FullName)

#LegalArea=X,5,I
C(5,#IsSpecify,Y,$,s)
C(4,#LegalPsn,S,$)
@C(4,#LegalArea,S,$)
V(9)

#LegalNo=X,10,I
C(5,#IsSpecify,Y,$,s)
C(4,#LegalPsn,S,$)
@V(9)

#LegalExt=X,5,I
C(5,#IsSpecify,Y,$,s)
C(4,#LegalPsn,S,$)
@C(4,#LegalExt,S,$)
V(9)

!參考編號
#MRKEY=_,_,S
T(2,#CustNo+#FacmNo)

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!------------ TXFORM = L5607 -----------
<sub type="FORM" name="L5607">
</sub>

!------ 上行電文 TEXT ------
<sub type="TIM">
#CustNo
#FacmNo
#IsSpecify
#AccCollPsn
#AccTelArea
#AccTelNo
#AccTelExt
#LegalPsn
#LegalArea
#LegalNo
#LegalExt
</sub>

!------ 下行電文TOM ------
<sub type="TOM">
<include src="COM.icf::TRCTL.tom"/>
<include src="ROM.icf::L5R15.tom"/>
<include src="ROM.icf::L5R17.tom"/>
<include src="ROM.icf::L5R44.tom"/>
TXFORM=L5607

^
</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">
</sub>
