!---------- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">
!#TXCD
!T(3,L5965)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,0)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,251)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,40)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
K(MODIFYBUTTON,查詢)
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="L5965" layout="cols=1;screen.width=[130,870];printer.width=[20,80];order=1">
[
["[L5965]                                 提醒事項查詢"],
[#<->#,"@案件種類",#CaseCode,#CaseCodeX],
[#<->#,"@借款人戶號",#CustNo,#CUSTNM],
[#<->#,"@額度編號",#FacmNo],
[#<->#,"@項目",#CondCodeFlag,#CondCodeFlagX],
]
!---------- AP TEXT AREA Variables ----------

#CHAIN=A,1,S
T(4,CHAIN$) 
IF(#CHAIN!=1,V(P,此為連動交易),$)

#NTXBUF=X,12,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
T(1,@CaseCode,#NTXBUF,1,1)
T(1,@CustNo,#NTXBUF,2,7)
T(1,@FacmNo,#NTXBUF,9,3)
T(1,@CondCodeFlag,#NTXBUF,12,1)
INVOKEJS(SHOW,p1,02,02,1)

<include src="HELPRIM.icf::HELPRIM.rtn"/>
! 案件種類下拉選單1
#CaseCodeRimName=x,20,S
T(3,CdCode.CaseCode)
#CaseCodeHelp=x,1024,S

! 狀態下拉選單2
#CondCodeRimName=x,20,S
T(3,CdCode.CondCode)
#CondCodeHelp=x,1024,S

! 提醒項目下拉選單3
#RemindCodeRimName=x,20,S
T(3,CdCode.RemindCode)
#RemindCodeHelp=x,1024,S

#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#CaseCodeRimName,#CondCodeRimName,#RemindCodeRimName)
R(1,XXR99)
CALL(#HelpProc)
T(2,@CaseCodeHelp,#HelpDesc1)
T(2,@CondCodeHelp,#HelpDesc2)
T(2,@RemindCodeHelp,#HelpDesc3)


! 案件種類
#CaseCode=A,1,I
HELP(#CaseCodeHelp)
@V(H,#CaseCodeHelp)
#CaseCodeX=X,4,L
T(H,#CaseCode,#CaseCodeHelp)

! 借款人戶號
#CustNo=A,7,I
! C(3,#CHAIN,0,$,s)
@V(2,0)

! 借款人戶名----調RIM
#CUSTNM=X,20,L

! 額度編號
#FacmNo=A,3,I
! C(3,#CHAIN,0,$,s)
C(3,#CaseCode,2,S,$)
@V(2,0)

#MRKEY=_,_,S
C(3,#CustNo,0,S,$)
C(3,#FacmNo,0,T(2,#CustNo),T(2,#CustNo+-+#FacmNo)) 

! 項目
#CondCodeFlag=A,1,I
HELP(#CondCodeHelp)
@V(H,#CondCodeHelp)
#CondCodeFlagX=X,9,L
T(H,#CondCodeFlag,#CondCodeHelp)

#RPTFG=A,1,S
</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!------------ TXFORM = L5965 -----------
<sub type="FORM" name="L5965">
#SCRTIL=_,_,S
T(3,[L5965] 提醒明細資料)

#LOOP=X,1,S
E(0,1)ASGN(LOOP$)
! 額度
#OOFacmNo=A,3,O
! 狀態
#OOCondCode=A,1,O
#OOCondCodeX=X,6,O
C(1,#OOCondCode,S,S,$)
T(H,#OOCondCode,#CondCodeHelp)
! 提醒日期
#OORemindDate=D,7,O
! 維護日期
#OOEditDate=D,7,O
! 維護時間
#OOEditTime=X,4,O
! 提醒項目
#OORemindCode=A,2,O
#OORemindCodeX=X,30,O
C(1,#OORemindCode,S,S,$)
T(H,#OORemindCode,#RemindCodeHelp)
! 其他記錄(160)
#OORemark=X,4.40,O
! 增修人員
#OOEditEmpNo=X,6,O
#Space=X,1,S
T(2, )
#OOEditEmpNoX=X,40,S

#EditEmpCombine=X,47,S
T(2,#OOEditEmpNo+#Space+#OOEditEmpNoX)

! 交易序號
#OOTitaTxtNo=X,8,L
! 經辦
#OOTitaTlrNo=X,6,L
! 系統日期
#OOTitaAcDate=D,7,L

! 1+7+3+1 +1+7+7+5+2+160+6+20=220
#OOBUF_MAINTAIN=X,241,S
T(2,2+#CaseCode+#CustNo+#FacmNo+#OOTitaTlrNo+#OOTitaTxtNo+#OOTitaAcDate)
#OOBUF_DELETE=X,241,S
T(2,4+#CaseCode+#CustNo+#FacmNo+#OOTitaTlrNo+#OOTitaTxtNo+#OOTitaAcDate)
#OOBUF_LIFT=X,241,S
T(2,6+#CaseCode+#CustNo+#FacmNo+#OOTitaTlrNo+#OOTitaTxtNo+#OOTitaAcDate)

#OOBTN_MAINTAIN=A,2,O
BIND(grid,{ cmd=CHAIN; ntxcd=L5605; ntxbuf=#OOBUF_MAINTAIN})
#OOBTN_DELETE=A,2,O
BIND(grid,{ cmd=CHAIN; ntxcd=L5605; ntxbuf=#OOBUF_DELETE})
#OOBTN_LIFT=A,2,O
BIND(grid,{ cmd=CHAIN; ntxcd=L5605; ntxbuf=#OOBUF_LIFT})

</sub>

!------ 上行電文 TEXT ------
<sub type="TIM">
#CustNo#FacmNo#CondCodeFlag#CaseCode
#END
</sub>

!------ 下行電文TOM ------
<sub type="TOM">
<include src="COM.icf::TRCTL.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
TXFORM=L5965
#OOFacmNo
#OOCondCode
#OORemindDate
#OOEditDate
#OOEditTime
#OORemindCode
#OORemark
#OOEditEmpNo
#OOTitaTxtNo
#OOTitaTlrNo
#OOTitaAcDate
#OOEditEmpNoX
^
</sub>


!---------- 單據輸出組合 ----------
<sub type="PART" prompt='{{#SCRTIL}} world' name="L5965" layout="cols=1;screen.width=[130,870];order=1;">
[
["[L5965]                                 提醒事項查詢                                                                           "],
! [#<->#,"@案件種類",#CaseCode,#CaseCodeX],
! [#<->#,"@借款人戶號",#CustNo,#CUSTNM],
! [#<->#,"@額度編號",#FacmNo],
! [#<->#,"@項目",#CondCodeFlag,#CondCodeFlagX],
]
</sub>

<sub type="SELECT">

#RPTFG=0,QUERY.GRID,L5965
#any={detail:true, header:'L5965.part', caption:'', width:1020, rowNum:20, rowList:[20,40,60]}

#OOBTN_MAINTAIN=修改
{search:false,formatter:'cust:bind-button:修改',align:'center',canExport:false,width:40}
#OOBTN_DELETE=刪除
{search:false,formatter:'cust:bind-button:刪除',align:'center',canExport:false,width:40}
#OOBTN_LIFT=解除
{search:false,formatter:'cust:bind-button:解除',align:'center',canExport:false,width:40}

#OOFacmNo=額度
{width:40,align:'center'}
#OOCondCodeX=狀態
{width:65}
#OORemindDate=提醒日期
{width:80,align:'center'}
#OOEditDate=維護日期
{width:80,align:'center'}
#OOEditTime=維護時間
{width:80,align:'center'}
#OORemindCodeX=提醒項目
{width:135}
#OORemark=其他記錄
{width:120}
#EditEmpCombine=增修人員
{width:80,align:'center'}
#OOTitaTxtNo=登放序號
{width:85,align:'center'}
^
<include src="PRT.icf::INQ04.sel" map="i=L5965;cpi=15"/>
#CustNo#FacmNo#CondCodeFlag#CaseCode
%
#OOFacmNo
#OOCondCode
#OORemindDate
#OOEditDate
#OOEditTime
#OORemindCode
#OORemark
#OOEditEmpNo
@^
</sub>
