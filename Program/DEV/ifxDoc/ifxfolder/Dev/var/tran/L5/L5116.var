----- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">

!#TXCD
!T(3,L5116)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,27)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,75)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,20)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[200,800];printer.width=[20,20];">
[
["[L5116]                                 寬限條件控管維護"],
["#FdFunctionCode+功能",#FunctionCodeX],
["#FdCustNo+借款人戶號",#CustNo,#CustName],
["#FdFacmNo+額度編號",#FacmNo],
["#FdActUse+使用碼",#ActUse,#ActUseX],
]

!---------- AP Button AREA ----------
#FdFunctionCode=X,2,L
#FdCustNo=X,2,L
T(3,*)
#FdFacmNo=X,2,L
T(3,*)
#FdActUse=X,2,L
T(3,*)
![Buttom資料查詢]
!#BUF1=X,42,S
<include src="HELPRIM.icf::HELPRIM.rtn"/>
#FuncCodeRimName=x,20,S
T(3,CdCode.FunctionCd)
#FuncCodeHelp=X,1024,S
#YesNoRimName=x,20,S
T(3,CdCode.YesNo)
#YesNoHelp=X,1024,S

#HelpRim=X,1,S
RESET_RIM(#FuncCodeHelpRim,XXR99)
S(XXR99,01,#FuncCodeRimName,#YesNoRimName)
R(1,XXR99)
CALL(#HelpProc)
T(2,@FuncCodeHelp,#HelpDesc1)
T(2,@YesNoHelp,#HelpDesc2)




#CHAIN=A,1,S
T(4,CHAIN$) 
IF(#CHAIN!=1,V(P,此為連動交易，請從交易:L5906進入),$)
C(3,#CHAIN,1,E(0,@FunctionCode,1),s)

#NTXBUF=X,65,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
T(1,@FunctionCode,#NTXBUF,1,1)
T(1,@CustNo,#NTXBUF,2,7)
T(1,@FacmNo,#NTXBUF,9,3)
<include src="ROM.icf::L5R35.dec"/>
#RimCustNo=X,7,S
#RimFacmNo=X,3,S
#RimFunCd=A,1,S
T(2,@RimCustNo,#CustNo)
T(2,@RimFacmNo,#FacmNo)
E(0,@RimFunCd,#FunctionCode)
C(3,#FunctionCode,1,S,$)
RESET_RIM(#RimL5R35,L5R35)
S(L5R35,1,#RimCustNo,#RimFacmNo,#RimFunCd)
R(1,L5R35)
T(2,@ActUse,#L5R35ActUse)
T(H,@ActUseX,#ActUse,#YesNoHelp)
#Name=X,1,S
<include src="ROM.icf::L5R36.dec"/>
C(3,#FunctionCode,1,S,$)
RESET_RIM(#RimL5R36,L5R36)
S(L5R36,1,#RimCustNo)
R(1,L5R36)
T(2,@CustName,#L5R36CustName)


#Submit=X,4,S
C(2,#FunctionCode,$,K(MODIFYBUTTON,新增),K(MODIFYBUTTON,修改),K(MODIFYBUTTON,新增),K(MODIFYBUTTON,刪除))

#FunctionCode=A,1,S
C(3,#FunctionCode,1,T(F,@CustNo,1)T(F,@FacmNo,1),T(F,@CustNo,0)T(F,@FacmNo,0)T(3,@FdCustNo, )T(3,@FdFacmNo, ))
C(3,#FunctionCode,4,T(F,@ActUse,0)T(3,@FdActUse, ),T(F,@ActUse,1))

!刪除隱藏重新交易按鈕
#AGAIN=X,1,S
C(3,#FunctionCode,1,S,$)
E(0,1)ASGN(AGAIN$)

#FunctionCodeX=X,4,L
T(H,#FunctionCode,#FuncCodeHelp)

#CustNo=A,7,I
C(3,#FunctionCode,1,$,s)
@T(3,@CustName,)
V(2,0)

#Sapce=X,1,S
T(2,@RimCustNo,#CustNo)
RESET_RIM(#RimL5R36,L5R36)
S(L5R36,1,#RimCustNo)
R(1,L5R36)
T(2,@CustName,#L5R36CustName)


#CustName=X,50,L

#FacmNo=A,3,I
C(3,#FunctionCode,1,$,s)
@V(2,0)

#L5R35A=X,1,S
T(2,@RimCustNo,#CustNo)
T(2,@RimFacmNo,#FacmNo)
E(0,@RimFunCd,1)
C(3,#FunctionCode,1,$,S)
RESET_RIM(#RimL5R35,L5R35)
S(L5R35,1,#RimCustNo,#RimFacmNo,#RimFunCd)
R(1,L5R35)

#ActUse=X,1,I
C(3,#FunctionCode,4,s,$)
C(3,#FunctionCode,1,T(2,N),$)
HELP(#YesNoHelp)
@T(3,@ActUseX,)
V(H,#YesNoHelp)

#ActUseX=X,10,L
T(H,#ActUse,#YesNoHelp)
</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!---------- TXFORM = L5116 ----------
<sub type="FORM" name="L5116">

#SCRTIL=_,_,S
T(3,[L5116] 寬限條件控管維護)
#LOOP=X,1,S
T(3,1)ASGN(LOOP$)

</sub>


!------ 上行電文 ------
<sub type="TIM">
#FunctionCode
#CustNo
#FacmNo
#ActUse
#END
</sub>


!------ 下行電文TOM ------
<sub type="TOM">

TXFORM=L5116

^

<include src="COM.icf::TRCTL.tom"/>
<include src="ROM.icf::L5R35.tom"/>
<include src="ROM.icf::L5R36.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">
<include src="PRT.icf::UPD01.sel"/>
</sub>
