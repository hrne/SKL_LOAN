!---------- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">
!#TXCD
!T(3,L5951)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,0)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,859)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,60)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,60)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="L5951" layout="cols=1;screen.width=[130,870];printer.width=[20,80];order=1">
[
["[L5951]                                 房貸介紹人業績明細查詢"],
["#FdWorkMonthFm+工作月",#WorkMonthFm,"~",#WorkMonthTo],
["#FdSumByFacm+額度加總",#SumByFacm],
]
!---------- AP TEXT AREA Variables ----------

#FdWorkMonthFm=X,2,L
T(3,*)
#FdSumByFacm=X,2,L
T(3,*)

#BufLD006=X,3,S
T(3,111)

#button=x,100,S
T(2,{cmd=CHAIN; ntxcd=LD006; ntxbuf=#BufLD006})ASGN(BTN_NEW1$)
K(MODIFYBUTTON,1,產生媒體檔)
K(MODIFYBUTTON,查詢)

! 最大資料筆數
! 需小於等於6W/每筆資料明細(OCCURS)長度
#MaxDataRow=A,3,S
E(0,40)

!YN
#YNHelp=X,50,S
T(3,Y:是;N:否)

#CHAIN=A,1,S
T(4,CHAIN$) 

#NTXBUF=X,10,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
T(1,@WorkMonthFm,#NTXBUF,1,5)
T(1,@WorkMonthTo,#NTXBUF,6,5)

#PREVALUE=A,1,S
T(1,@WorkMonthFm,#SYSDATE,2,5)
T(1,@WorkMonthTo,#SYSDATE,2,5)
T(2,@SumByFacm,Y)

! 工作月
#WorkMonthFm=A,5,I
@
A(YM13,1,#WorkMonthFm)
!IF(#WorkMonthFm==0,V(P,工作月不可空白),$)

#WorkMonthTo=A,5,I
@
A(YM13,1,#WorkMonthTo)
!IF(#WorkMonthTo==0,V(P,工作月不可空白),$)
IF(#WorkMonthTo<#WorkMonthFm,V(P,工作月訖起不得小於工作月起),$)

! 額度加總
#SumByFacm=X,1,I
HELP(#YNHelp)
@V(H,#YNHelp)

#RPTFG=A,1,S
E(0,1)


! 計件代碼於L5951查詢條件須排除
! String strPieceCodeNotIn ="'G','G1','G2','GA','GB','GC','GD','GF','GG','GH','GJ','GA', '1B','1C','1D'";
#PieceCodeNotIn=X,100,S
T(3,G，G1，G2，GA，GB，GC，GD，GF，GG，GH，GJ，GA，1B，1C，1D)

! 排除[團體意外險部]
! String strDeptCodeNotIn="'109000', 'A0Y000'";
#DeptCodeNotIn=X,100,S
T(3,109000，A0Y000)
</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>


!------------ TXFORM = L5951 -----------
<sub type="FORM" name="L5951">

#SCRTIL=_,_,S
T(3,[L5951] 房貸介紹人業績明細)

#LOOP=X,1,S
E(0,1)ASGN(LOOP$)
! 部室名
#OOBsDeptX=X,40,O
! 房貸專員名稱
#OOBsOfficerName=X,80,O
! 房貸專員
#OOBsOfficer=X,6,O
! 戶名
#OOCustNm=X,200,O
! 戶號
#OOCustNo=A,7,O
#OOCustNoX=X,7,O
C(3,#OOCustNo,0,S,T(2,#OOCustNo))
! 額度
#OOFacmNo=A,3,O
#OOFacmNoX=X,3,O
C(3,#OOFacmNo,0,S,T(2,#OOFacmNo))
! 撥款序號
#OOBormNo=A,3,O
#OOBormNoX=X,3,O
C(3,#OOBormNo,0,S,T(2,#OOBormNo))
! 撥款日
#OODrawdownDate=D,7,S
C(3,OODrawdownDate,0,S,$)
! 商品代碼
#OOProdCode=X,5,O
! 計件代碼
#OOPieceCode=X,1,O
! 是否計件
#OOCntingCode=X,1,O
! 撥款金額 
#OODrawdownAmt=+m,14,O
! 介紹人部室代號
#OODeptCode=X,6,O
! 介紹人區部代號
#OODistCode=X,6,O
! 介紹人單位代號
#OOUnitCode=X,6,O
! 介紹人部室名稱
#OODeptCodeX=X,24,O
! 介紹人區部名稱
#OODistCodeX=X,24,O
! 介紹人單位名稱
#OOUnitCodeX=X,24,O
! 介紹人員編
#OOIntroducer=X,6,O
! 介紹人姓名
#OOIntroducerName=X,80,O
! 部經理代號
#OODeptManager=X,6,O
! 部經理名稱
#OODeptManagerName=X,80,O
! 區經理代號
#OODistManager=X,6,O
! 區經理名稱
#OODistManagerName=X,80,O
! 處經理代號
#OOUnitManager=X,6,O
! 處經理名稱
#OOUnitManagerName=X,80,O
! 三階換算業績 
#OOPerfEqAmt=+m,14,O
! 三階業務報酬 
#OOPerfReward=+m,14,O
! 已用額度
#OOPerfAmt=+m,14,O
! 工作月
#OOWorkMonth=A,5,O
! 業績日期
#OOPerfDate=D,7,O
</sub>

!------ 上行電文 TEXT ------
<sub type="TIM">
#MaxDataRow
#WorkMonthFm
#WorkMonthTo
#SumByFacm
#PieceCodeNotIn
#DeptCodeNotIn
</sub>

!------ 下行電文TOM ------
<sub type="TOM">
<include src="COM.icf::TRCTL.tom"/>
TXFORM=L5951
#OOBsDeptX
#OOBsOfficerName
#OOBsOfficer
#OOCustNm
#OOCustNo
#OOFacmNo
#OOBormNo
#OODrawdownDate
#OOProdCode
#OOPieceCode
#OOCntingCode
#OODrawdownAmt
#OODeptCode
#OODistCode
#OOUnitCode
#OODeptCodeX
#OODistCodeX
#OOUnitCodeX
#OOIntroducerName
#OOIntroducer
#OODeptManager
#OODeptManagerName
#OODistManager
#OODistManagerName
#OOUnitManager
#OOUnitManagerName
#OOPerfEqAmt
#OOPerfReward
#OOPerfAmt
#OOWorkMonth
#OOPerfDate
^
</sub>


!---------- 單據輸出組合 ----------
<sub type="PART" prompt='{{#SCRTIL}} world' name="L5951A" layout="cols=1;screen.width=[130,870];order=1;">
[
["[L5951]                                 房貸介紹人業績明細查詢                                                                       "],
]
</sub>

!#OOBsDeptX=部室別
!{width:95,align:'left'}

<sub type="SELECT">
#RPTFG=1,QUERY.GRID,L5951A
#any={detail:true, header:'L5951A.part', caption:'', width:1020, rowNum:10, rowList:[20,40,60]}
#OOIntroducer=介紹人
{width:60,align:'center'}
#OOIntroducerName=
{width:80,align:'left'}
#OOCustNm=戶名
{width:120,align:'left'}
#OOCustNoX=戶號
{width:95,align:'center'}
#OOFacmNoX=額度
{width:95,align:'center'}
#OOBormNoX=撥款
{width:95,align:'center'}
#OODrawdownDate=撥款日
{width:95,align:'center'}
#OODrawdownAmt=撥款金額
{width:95,align:'right'}
#OOPerfEqAmt=換算業績
{width:95,align:'right'}
#OOPerfReward=業務報酬
{width:95,align:'right'}
#OOPerfAmt=業績金額
{width:95,align:'right'}
#OOProdCode=利率代碼
{width:95,align:'center'}
#OOPieceCode=計件代碼
{width:95,align:'center'}
#OOCntingCode=是否計件
{width:95,align:'center'}
#OOBsOfficer=房貸專員
{width:95,align:'center'}
#OOBsOfficerName=
{width:95,align:'left'}
#OODeptCode=部室代號
{width:95,align:'center'}
#OODistCode=區部代號
{width:95,align:'center'}
#OOUnitCode=單位代號
{width:95,align:'center'}
#OODeptCodeX=部室
{width:95,align:'left'}
#OODistCodeX=區部
{width:95,align:'left'}
#OOUnitCodeX=單位
{width:95,align:'left'}
#OOUnitManagerName=處經理名稱
{width:110,align:'left'}
#OODistManagerName=區經理名稱
{width:110,align:'left'}
^
</sub>