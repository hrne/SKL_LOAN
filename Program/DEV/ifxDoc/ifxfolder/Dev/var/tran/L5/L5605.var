!---------- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">
!#TXCD
!T(3,L5605)
</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="L5605" layout="cols=3;screen.width=[150,400,150,400];printer.width=[20,80];order=1">
[
["[L5605]                                 提醒事項登錄"],
[#<->#,"#FdFunctionCd+功能",#FunctionCdX],
[#<->#,"#FdCaseCode+案件種類",#CaseCode,#CaseCodeX],
[#<->#,"#FdCustNo+戶號",#CustNo,"@",#CustName],
[#<->#,"#FdFacmNo+額度編號",#FacmNo],
["#FdAccCollPsn+催收人員",#AccCollPsn,#AccCollPsnX],["#FdLegalPsn+法務人員",#LegalPsn,#LegalPsnX],
["#FdPrevIntDate+繳息迄日",#PrevIntDate],["#FdLoanBal+放款餘額",#LoanBal],
["#FdNextIntDate+下次應繳日",#NextIntDate],
[#<->#,"@",#BTNA,#BTNB,#BTNC,#BTND,#BTNE],
[#<->#,"#FdRemindCode+提醒項目",#RemindCode,#RemindCodeX],
[#<->#,"#FdRemark+其他記錄",#Remark],
[#<->#,"#FdRemindDate+提醒日期",#RemindDate],
[#<->#,"#FdCondCode+狀態",#CondCode,#CondCodeX],
["#FdEditDate+維護日期",#EditDate],["#FdEditTime+維護時間",#EditTime],
[#<->#,"#FdEditEmpNo+維護人員",#EditEmpNo,#EditEmpNoX],
]
!---------- AP TEXT AREA Variables ----------
#BTNA=X,1,I,ui:button;value:電催查詢;enable:1;tabbable:0
#BTNB=X,1,I,ui:button;value:面催查詢;enable:1;tabbable:0
#BTNC=X,1,I,ui:button;value:函催查詢;enable:1;tabbable:0
#BTND=X,1,I,ui:button;value:法務查詢;enable:1;tabbable:0
#BTNE=X,1,I,ui:button;value:提醒查詢;enable:1;tabbable:0

#CHAIN=A,1,S
T(4,CHAIN$) 
IF(#CHAIN!=1,V(P,此為連動交易，請從L5060進入),$)

!做完交易自動更新原畫面
#AutoReFresh=A,1,S
C(3,#CHAIN,1,$,S)
E(0,1)
ASGN(CAUTO$)

<include src="HELPRIM.icf::HELPRIM.rtn"/>
! 功能下拉選單1
#FunctionCdRimName=x,30,S
T(3,CdCode.RemindFunctionCd)
#FunctionCdHelp=x,1024,S

! 案件種類下拉選單2
#CaseCodeRimName=x,20,S
T(3,CdCode.CaseCode)
#CaseCodeHelp=x,1024,S

! 提醒項目下拉選單3
#RemindCodeRimName=x,20,S
T(3,CdCode.RemindCode)
#RemindCodeHelp=x,1024,S

! 狀態下拉選單4
#CondCodeRimName=x,20,S
T(3,CdCode.CondCode)
#CondCodeHelp=x,1024,S

#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#FunctionCdRimName,#CaseCodeRimName,#RemindCodeRimName,#CondCodeRimName)
R(1,XXR99)
CALL(#HelpProc)
T(2,@FunctionCdHelp,#HelpDesc1)
T(2,@CaseCodeHelp,#HelpDesc2)
T(2,@RemindCodeHelp,#HelpDesc3)
T(2,@CondCodeHelp,#HelpDesc4)


#NTXBUF=X,33,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
T(1,@FunctionCd,#NTXBUF,1,1)
T(1,@CaseCode,#NTXBUF,2,1)
T(1,@CustNo,#NTXBUF,3,7)
T(1,@FacmNo,#NTXBUF,10,3)
T(1,@TitaTlrNo,#NTXBUF,13,6)
T(1,@TitaTxtNo,#NTXBUF,19,8)
T(1,@TitaAcDate,#NTXBUF,27,7)
INVOKEJS(SHOW,p1,02,02,1)

#PRE_EVELU=A,1,S

<include src="ROM.icf::L5R15.dec"/>
#RimCustNo=X,7,S
#RimFacmNo=X,3,S
#RimL5R15=X,1,S
T(2,@RimCustNo,#CustNo)
T(2,@RimFacmNo,#FacmNo)
RESET_RIM(#RimL5R15,L5R15)
S(L5R15,1,#RimCustNo,#RimFacmNo)
R(1,L5R15)
T(2,@CustName,#L5R15CustName)
T(2,@AccCollPsn,#L5R15AccCollPsn)
T(2,@LegalPsn,#L5R15LegalPsn)
T(2,@AccCollPsnX,#L5R15AccCollPsnX)
T(2,@LegalPsnX,#L5R15LegalPsnX)
T(2,@PrevIntDate,#L5R15PrevIntDate)
T(2,@LoanBal,#L5R15LoanBal)
T(2,@NextIntDate,#L5R15NextIntDate)
#Space=X,1,S

<include src="ROM.icf::L5R22.dec"/>
#RimCaseCode=X,1,S
! #RimCustNo=X,7,S
! #RimFacmNo=X,3,S
#RimAcDate=X,7,S
#RimTitaTlrNo=X,6,S
#RimTitaTxtNo=X,8,S
#RimL5R22=X,1,S
T(2,@RimCaseCode,#CaseCode)
! T(2,@RimCustNo,#CustNo)
! T(2,@RimFacmNo,#FacmNo)
T(2,@RimAcDate,#TitaAcDate)
T(2,@RimTitaTlrNo,#TitaTlrNo)
T(2,@RimTitaTxtNo,#TitaTxtNo)
C(3,#FunctionCd,1,S,$)
RESET_RIM(#RimL5R22,L5R22)
S(L5R22,1,#RimCaseCode,#RimCustNo,#RimFacmNo,#RimAcDate,#RimTitaTlrNo,#RimTitaTxtNo)
R(1,L5R22)
T(2,@CondCode,#L5R22CondCode)
T(2,@RemindDate,#L5R22RemindDate)
T(2,@EditDate,#L5R22EditDate)
T(2,@EditTime,#L5R22EditTime)
T(2,@RemindCode,#L5R22RemindCode)
T(2,@Remark,#L5R22ReMark)
T(2,@EditEmpNo,#L5R22EditEmpNo)
! 調Rim完成預先帶入
T(H,@CondCodeX,#CondCode,#CondCodeHelp)
T(H,@RemindCodeX,#RemindCode,#RemindCodeHelp)
#Space2=X,1,S
!C(2,#FunctionCd,s,$,$,s,s,s,$)
!T(4,@EditEmpNo,TLRNO$)
<include src="ROM.icf::L5R28.dec"/>
#RimEmployeeNo=X,6,S
#RimL5R28=X,1,S
T(2,@RimEmployeeNo,#EditEmpNo)
RESET_RIM(#RimL5R28,L5R28)
S(L5R28,1,#RimEmployeeNo)
R(1,L5R28)
T(2,@EditEmpNoX,#L5r28FullName)

!必輸欄位
#FdFunctionCd=X,1,L
#FdCaseCode=X,1,L
#FdCustNo=X,1,L
#FdAccCollPsn=X,1,L
#FdLegalPsn=X,1,L
#FdPrevIntDate=X,1,L
#FdLoanBal=X,1,L
#FdNextIntDate=X,1,L
#FdTelPhone=X,1,L
#FdCallDate=X,1,L
#FdRemark=X,1,L
#FdEditEmpNo=X,1,L
#FdFacmNo=X,1,L
#FdEditDate=X,1,L
#FdEditTime=X,1,L
#FdRemindCode=X,1,L
IF(#FunctionCd== 4 || #FunctionCd== 6,T(3,#FdRemindCode, ),T(3,#FdRemindCode,*))
#FdRemindDate=X,1,L
IF(#FunctionCd== 4 || #FunctionCd== 6,T(3,#FdRemindDate, ),T(3,#FdRemindDate,*))
#FdCondCode=X,1,L
IF(#FunctionCd== 4 || #FunctionCd== 6,T(3,#FdCondCode, ),T(3,#FdCondCode,*))



! 登放序號
#ActSeq=X,20,S
IF (#FunctionCd==1 || #FunctionCd==2|| #FunctionCd==3,T(F,@RemindCode,1)T(F,@Remark,1)T(F,@RemindDate,1)T(F,@CondCode,1)T(F,@EditDate,1)T(F,@EditTime,1)T(F,@EditEmpNo,1),
                                                      T(F,@RemindCode,0)T(F,@Remark,0)T(F,@RemindDate,0)T(F,@CondCode,0)T(F,@EditDate,0)T(F,@EditTime,0)T(F,@EditEmpNo,0))

IF(#FunctionCd== 4 || #FunctionCd== 6,INVOKEJS(SHOW,L5605,8,8,0),INVOKEJS(SHOW,L5605,8,8,1))

IF(#FunctionCd==5,K(NOBUTTON,CLOSEY),$)
C(2,#FunctionCd,$,K(MODIFYBUTTON,新增),K(MODIFYBUTTON,修改),K(MODIFYBUTTON,新增),K(MODIFYBUTTON,刪除),$,K(MODIFYBUTTON,解除))
! 功能
#FunctionCd=A,1,S
! C(3,#FunctionCd,6,s,$)
C(3,#CHAIN,0,$,s)
HELP(#FunctionCdHelp)
@V(H,#FunctionCdHelp)
E(0,@FUNCIND,#FunctionCd)

#FunctionCdX=X,4,L
T(H,#FunctionCd,#FunctionCdHelp)
!刪除隱藏重新交易按鈕
#AGAIN=X,1,S
C(2,#FunctionCd,$,$,E(0,1),$,E(0,1),E(0,1),E(0,1))
ASGN(AGAIN$)
! 案件種類
#CaseCode=A,1,L
C(3,#CHAIN,0,$,s)
C(2,#FunctionCd,S,$,$,s,s,s,s)
HELP(#CaseCodeHelp)
@V(H,#CaseCodeHelp)
#CaseCodeX=X,4,L
T(H,#CaseCode,#CaseCodeHelp)
!<電催查詢>
#BUFA=X,11,S
T(2,#CaseCode+#CustNo+#FacmNo)
#BINDA=X,1,S
BIND(#BTNA,click, {cmd=CHAIN; ntxcd=L5961; ntxbuf=#BUFA})
!<面催查詢>
#BUFB=X,11,S
T(2,#CaseCode+#CustNo+#FacmNo)
#BINDB=X,1,S
BIND(#BTNB,click, {cmd=CHAIN; ntxcd=L5962; ntxbuf=#BUFB})
!<函催查詢>
#BUFC=X,11,S
T(2,#CaseCode+#CustNo+#FacmNo)
#BINDC=X,1,S
BIND(#BTNC,click, {cmd=CHAIN; ntxcd=L5963; ntxbuf=#BUFC})
!<法務查詢>
#BUFD=X,11,S
T(2,#CaseCode+#CustNo+#FacmNo)
#BINDD=X,1,S
BIND(#BTND,click, {cmd=CHAIN; ntxcd=L5964; ntxbuf=#BUFD})
!<提醒查詢>
#BUFE=X,12,S
T(2,#CaseCode+#CustNo+#FacmNo+1)
#BINDE=X,1,S
BIND(#BTNE,click, {cmd=CHAIN; ntxcd=L5965; ntxbuf=#BUFE})

! 戶號
#CustNo=A,7,L
C(3,#CHAIN,0,$,s)
C(2,#FunctionCd,S,$,$,s,s,s,s)

! 戶名----調RIM
#CustName=X,20,L

! 額度編號
#FacmNo=A,3,L
C(3,#CHAIN,0,$,s)
C(2,#FunctionCd,S,$,$,s,s,s,s)

! ---------調RIM
! 催收人員
#AccCollPsn=X,8,L
#AccCollPsnX=X,40,L
! 法務人員
#LegalPsn=X,8,L
#LegalPsnX=X,40,L
! 繳息迄日
#PrevIntDate=D,7,L
! 放款餘額
#LoanBal=M,14,L
! 下次繳息日
#NextIntDate=D,7,L
! ---------調RIM
! 提醒項目
#RemindCode=A,2,I
C(2,#FunctionCd,S,$,$,s,s,s,s)
HELP(#RemindCodeHelp)
@V(H,#RemindCodeHelp)
#RemindCodeX=X,30,L
T(H,#RemindCode,#RemindCodeHelp)
! 其他記錄
#Remark=x,10.50,I
C(2,#FunctionCd,S,$,$,s,s,s,s)
! 提醒日期
#CDate=D,7,S
T(1,#SYSCDATE,2,7)
#RemindDate=D,7,I
C(2,#FunctionCd,S,T(2,#CDate),$,T(2,#CDate),s,s,s)
@A(DATE,0,#RemindDate)
! D(8)
! 狀態
#CondCode=A,1,I
C(2,#FunctionCd,S,$,$,s,E(0,4),s,E(0,6))
C(2,#FunctionCd,S,$,$,s,s,s,s)
HELP(#CondCodeHelp)
@V(H,#CondCodeHelp)
#CondCodeX=X,6,L
T(H,#CondCode,#CondCodeHelp)
! 維護日期
#EditDate=D,7,L
C(2,#FunctionCd,S,T(2,#CDate),T(2,#CDate),s,s,s,T(2,#CDate))

! 維護時間
#EditTimeX=X,6,S
T(4,TIME$)
#EditTime=X,4,L
C(2,#FunctionCd,S,$,$,s,s,s,$)
T(1,#EditTimeX,1,4)
@V(7)


! 維護人員
#EditEmpNo=X,6,L
C(2,#FunctionCd,S,$,$,s,s,s,$)
T(4,@EditEmpNo,TLRNO$)
T(2,@RimEmployeeNo,#EditEmpNo)
RESET_RIM(#RimL5R28,L5R28)
S(L5R28,1,#RimEmployeeNo)
R(1,L5R28)
T(2,@EditEmpNoX,#L5r28FullName)


#EditEmpNoX=X,50,L
! 經辦
#TitaTlrNo=X,6,L
! 交易序號
#TitaTxtNo=X,8,L
! 系統日期
#TitaAcDate=D,7,L
</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!------------ TXFORM = L5605 -----------
<sub type="FORM" name="L5605">
</sub>

!------ 上行電文 TEXT ------
<sub type="TIM">
#FunctionCd
#CaseCode
#CustNo
#FacmNo
#AccCollPsn
#LegalPsn
#PrevIntDate
#LoanBal
#RemindCode
#Remark
#RemindDate
#CondCode
#TitaTlrNo
#TitaTxtNo
#TitaAcDate
#END
</sub>

!------ 下行電文TOM ------
<sub type="TOM">
<include src="COM.icf::TRCTL.tom"/>
<include src="ROM.icf::L5R15.tom"/>
<include src="ROM.icf::L5R22.tom"/>
<include src="ROM.icf::L5R28.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
TXFORM=L5605

^
</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">
</sub>
