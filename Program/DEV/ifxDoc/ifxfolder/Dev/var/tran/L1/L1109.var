----- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">

!#TXCD
!T(3,L1109)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,0)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,0)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,20)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,1)ASGN(INQPRT$)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)

</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=3;screen.width=[170,830];printer.width=[20,20,20,20];order=1">
[
["[L1109]                                 客戶交互運用維護"],
[#<->#,"#FdFunCd+功能",#FunCdx],
[#<->#,"#FdCustId+統一編號",#CustId],
[#<->#,"#FdCustNo+戶號",#CustNo],
[#<->#,"#FdCustName+戶名",#CustName1,"</br>",#CustName2],
[#<->#,"#FdSubCompanyFg+交互運用同意書",#SubCompanyFg,#SubCompanyFgX],
]
!---------- AP Button AREA ----------
!---------- Required Input Setting ----------
!init grid
#Init=X,1,S
INVOKEJS(SHOW,p2,0)
INVOKEJS(SHOW,grd1,1,20,0)

! 永遠為必輸欄位
#FdFunCd=X,2,L
T(3, )
#FdCustId=X,2,L
! T(3,*)
#FdCustNo=X,2,L
T(3,*)
#FdCustName=X,2,L
T(3, )
#FdSubCompanyFg=X,2,L
T(3,*)

!---------- AP TEXT AREA Variables ----------
<include src="HELPRIM.icf::HELPRIM.rtn"/>
#CDDEF0001=x,20,S
T(3,CdCode.FunctionCd)
#FunCdHelp=x,1024,S
#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#CDDEF0001)
R(1,XXR99)
CALL(#HelpProc)
T(2,@FunCdHelp,#HelpDesc1)

#CHAIN=A,1,S
T(4,CHAIN$)

#NTXBUF=X,11,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)

#CHAIN_Funcd=A,1,S
T(1,#NTXBUF,1,1)

#CHAIN_CustId=X,10,S
T(1,#NTXBUF,2,10)

!功能
#FunCd=A,1,S
E(0,2)

#FunCdx=X,4,L
T(H,#FunCd,#FunCdHelp)
C(2,#FunCd,$,K(MODIFYBUTTON,新增),K(MODIFYBUTTON,修改),K(MODIFYBUTTON,複製),K(MODIFYBUTTON,刪除),K(MODIFYBUTTON,查詢))
C(3,#CHAIN,1,T(2,@FdCustId, ),T(2,@FdCustId,*))
!刪除隱藏重新交易按鈕
#AGAIN=X,1,S
C(2,#FunCd,$,$,E(0,1),$,E(0,1))
ASGN(AGAIN$)

#HideGrid=X,1,S
##loop{times:20,n:1}
HIDE(#SubCompanyCode{n})
HIDE(#SubCompanyItem{n})
HIDE(#CrossUse{n})
##end

!統一編號
#CustId=X,10,I
INVOKEJS(SHOW,p1,2,3,1)
C(3,#CHAIN,1,T(F,#CustId,0),T(F,#CustId,1))
C(3,#CHAIN,1,T(2,#CHAIN_CustId),$)
C(3,#CHAIN,1,s,$)
@
C(4,#CustId,INVOKEJS(SHOW,p1,2,2,0),INVOKEJS(SHOW,p1,3,3,0))
C(4,#CustId,$,A(ID_UNINO,0,#CustId))

! 戶號
#CustNo=A,7,I
C(3,#CHAIN,1,INVOKEJS(SHOW,p1,3,3,0),$)
C(3,#CHAIN,1,S,$)
C(4,#CustId,INVOKEJS(SHOW,p1,3,3,1),S)
@
C(4,#CustId,$,s)
C(3,#CustNo,0,V(P,統一編號與戶號須擇一輸入),s)

<include src="ROM.icf::L1R06.dec"/>
#RimCustId=X,10,S
#RimCustNo=A,7,S

#YNdef=X,1,S
T(3,N)

#RimL1r06=X,1,S
T(2,@RimCustId,#CustId)
E(0,@RimCustNo,#CustNo)
RESET_RIM(#RimL1r06,L1R06)
S(L1R06,1,#RimCustId,#RimCustNo)
R(1,L1R06)
T(2,@CustName,#L1r06CustName)
T(1,@CustName1,#L1r06CustName,1,50)
T(1,@CustName2,#L1r06CustName,51,50)
##loop{times:20,n:1}
C(4,#L1r06SubCompanyCode{n},$,SHOW(#SubCompanyCode{n})T(2,@SubCompanyCode{n},#L1r06SubCompanyCode{n}))
C(4,#L1r06SubCompanyItem{n},$,SHOW(#SubCompanyItem{n})T(2,@SubCompanyItem{n},#L1r06SubCompanyItem{n}))
C(4,#L1r06CrossUse{n},$,SHOW(#CrossUse{n})T(2,@CrossUse{n},#L1r06CrossUse{n}))
C(5,#L1r06CrossUse{n},Y,T(3,@YNdef,Y),$)
##end
!戶名
#CustName=c,100,S
#CustName1=c,50,L
#CustName2=c,50,L

##loop{times:20,n:1}
#Show{n}=S,1,S
C(5,#SubCompanyFg,N,S,$)
C(4,#L1r06SubCompanyCode{n},S,$)
INVOKEJS(SHOW,grd1,{n},{n},1)
##end

#YN=X,1,S
C(5,#YNdef,Y,INVOKEJS(SHOW,p2,1),INVOKEJS(SHOW,p2,0))

#SubCompanyFgHelp=X,200,S
T(3,Y:同意提供申請人之帳務、信用、投資及保險資料作為共同行鎖之用;N:不同意)

#SubCompanyFg=X,1,I
C(4,#SubCompanyFg,T(2,#YNdef),$)
HELP(#SubCompanyFgHelp)
@
V(H,#SubCompanyFgHelp)
C(5,#SubCompanyFg,Y,INVOKEJS(SHOW,p2,1),INVOKEJS(SHOW,p2,0))

#SubCompanyFgX=X,60,L
T(H,#SubCompanyFg,#SubCompanyFgHelp)


! Grid區塊
##loop{times:20,n:1}
#SubCompanyCode{n}=X,2,L
C(4,#L1r06SubCompanyCode{n},S,$)

#SubCompanyItem{n}=X,60,L
C(4,#L1r06SubCompanyItem{n},S,$)

#CrossUse{n}=X,1,I
C(5,#SubCompanyFg,N,T(3,N),$)
C(5,#SubCompanyFg,N,s,$)
C(4,#L1r06CrossUse{n},S,$)
@V(3,Y,N)
##end

#Check=X,1,S
C(5,#SubCompanyFg,Y,$,S)
##loop{times:20,n:1}
C(5,#CrossUse{n},Y,S,$)
##end
V(P,至少勾選一筆同意)


!統一編號找戶號
<include src="ROM.icf::L2R47.dec"/>
#Rim2R47CustId=X,10,S

#RimL2R47=X,1,S
T(2,@Rim2R47CustId,#CustId)
RESET_RIM(#RimL2R47,L2R47)
C(4,#CustId,s,$)
S(L2R47,1,#Rim2R47CustId)
R(1,L2R47)

#MRKEY=_,_,S
C(4,#CustId,T(2,#CustNo),T(2,#L2R47CustNo))

#RPTFG=A,1,S

</sub>
<sub type="DC" name="p2" layout="cols=3;screen.width=[170,830];printer.width=[20,20,20,20];order=1">
[
["交互運用同意書"],
["#grid#,{id:1,expand:true,loop:20,row_height:1,s_cols:[150,300,200], p_cols:[15,15,15]}","","",
["分公司代號","公司名稱","是否同意@(Y:同意/N:不同意)"],
[[#SubCompanyCode1],[#SubCompanyItem1],[#CrossUse1],],
],
]
</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>


!---------- TXFORM = L1109 ----------
<sub type="FORM" name="L1109">

!#SCRPRT=_,_,S
!C(5,#TXFORM,L1109,$,S)

#SCRTIL=_,_,S
T(3,[L1109] 客戶交互運用維護)

!------ TOM(HEAD)   Variables (FOR OUTPUT SCREEN) ------
!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------


!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------


</sub>

!------ 上行電文 ------
<sub type="TIM">
#FunCd
#CustId
#CustNo
#SubCompanyFg
##loop{times:20,n:1}
#SubCompanyCode{n}
#CrossUse{n}
##end
</sub>

!------ 下行電文TOM ------
<sub type="TOM">
TXFORM=L1109
^
<include src="HELPRIM.icf::HELPRIM.tom"/>
<include src="ROM.icf::L1R01.tom"/>

<include src="ROM.icf::L1R06.tom"/>

<include src="ROM.icf::L2R47.tom"/>

<include src="COM.icf::TRCTL.tom"/>
</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">
<include src="PRT.icf::UPD01.sel"/>
</sub>
