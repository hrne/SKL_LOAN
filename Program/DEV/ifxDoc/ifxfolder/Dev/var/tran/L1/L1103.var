----- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">

!#TXCD
!T(3,L1103)

![一段式/二段式/三段式]
#RELCD=_,_,S
C(2,#FKEY,$,s,s,s,$,$,s,s,$,$)
E(0,2)

#ACTFG=_,_,S
C(2,#FKEY,$,s,s,s,$,$,s,s,$,$)
E(0,1)

![資料表頭(HEADER)長度]
#INQHD=n,3,S
E(0,27)ASGN(INQHD$)

![每筆資料明細(OCCURS)長度]
#INQLEN=n,3,S
E(0,75)ASGN(INQLEN$)

![多筆查詢之一個畫面有N筆資料]
#INQREC=n,2,S
E(0,20)ASGN(INQREC$)

![畫面顯示的明細間的高度]
#LOOPH=n,3,S
E(0,1)ASGN(LOOPHEIGHT$)

![每張印錄單列印的筆數]
#INQPRT=n,2,S
E(0,40)ASGN(INQPRT$)

</sub>

<sub type="PREDC" name="PreDC">
<include src="COM.icf::TITLE-RUN.pre"/>
</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)

</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=3;screen.width=[200,300,50,500];printer.width=[20,20,20,20];order=1">
[
["[L1103]                                 顧客基本資料修改-自然人"],
[#<->#,"#FdCustId+身分證字號",#CustId],
["@","@修改前"],["@","@修改後"],
["#FdCustIdBef+身分證字號",#CustIdBef],[#CustIdInd,#CustIdAft],
["#FdTypeCode+建檔身分別",#TypeCodeBef,#TypeCodeXBef],[#TypeCodeInd,#TypeCodeAft,#TypeCodeXAft],
[#<->#,"#FdCustNameBef1+修改前-戶名",#CustNameBef],
[#<->#,"#FdCustNameBef2+修改後-戶名@@@@@@+#CustNameInd",#CustNameAft],
["#FdEnameBef+英文姓名",#EnameBef],[#EnameInd,#EnameAft],
["#FdBirthdayBef+出生年月日",#BirthdayBef],[#BirthdayInd,#BirthdayAft],
["#FdGenderBef+性別",#GenderBef,#SexBefX],[#GenderInd,#GenderAft,#SexAftX],
["#FdCustTypeBef+客戶別",#CustTypeBef,#CustTypeCodeBefX],[#CustTypeInd,#CustTypeAft,#CustTypeCodeAftX],
["#FdEmpnoBef+員工代號",#EmpnoBef,#EmpnameBef],[#EmpnoInd,#EmpnoAft,#BtnCdEmp,#EmpnameAft],
["#FdEntcodeBef+企金別",#EntcodeBef,#EntcodeBefX],[#EntcodeInd,#EntcodeAft,#EntcodeAftX],
["#FdIndustryBef+行業別",#IndustryBef,#IndustryBefX],[#IndustryInd,#IndustryAft,#IndustryAftX],
["#FdCountryBef+出生地國籍",#CountryBef,#CountryX],[#CountryInd,#CountryAft,#CountryXAft],
["#FdBussNationalityCode+居住地國籍",#BussNationalityCodeBef,#BussNationalityCodeBefX],[#BussNationalityCodeInd,#BussNationalityCodeAft,#BussNationalityCodeAftX],
["#FdSpouseIdBef+配偶身分證字號",#SpouseIdBef],[#SpouseIdInd,#SpouseIdAft],
[#<->#,"#FdSpouseNmBef1+修改前-配偶姓名",#SpouseNmBef],
[#<->#,"#FdSpouseNmBef2+修改後-配偶姓名@@@+#SpouseNmInd",#SpouseNmAft],
![#<->#,"#FdRegAdrBef+修改前-戶籍地址",#RegCityCodeBef,#RegCityItemBef,#RegAreaCodeBef,#RegAreaItemBef,"</br>",#RegRoadBef,"</br>",#RegSectionBef,"段",#RegAlleyBef,"巷",#RegLaneBef,"弄",#RegNumBef,"號","之",#RegNumDashBef,",",#RegFloorBef,"樓","之",#RegFloorDashBef],
[#<->#,"#FdRegAdrBef+修改前-戶籍地址",#RegAddressBef],
[#<->#,"#FdRegAdrAft+修改後-戶籍地址",#RegCityCodeAft,#RegCityItemAft,#RegAreaCodeAft,#RegAreaItemAft,"</br>",#RegRoadAft,"</br>",#RegSectionAft,"段",#RegAlleyAft,"巷",#RegLaneAft,"弄",#RegNumAft,"號","之",#RegNumDashAft,",",#RegFloorAft,"樓","之",#RegFloorDashAft],
[#<->#,"#RegAddressInd",#RegAddressAft],
["#FdRegZipBef+戶籍-郵遞區號",#RegZip3Bef,#RegZip2Bef],
["#RegZip2Ind",#RegZip3Aft,#RegZip2Aft],
![#<->#,"#FdCurrAdrBef+修改前通訊-地址",#CurrCityCodeBef,#CurrCityItemBef,#CurrAreaCodeBef,#CurrAreaItemBef,"</br>",#CurrRoadBef,"</br>",#CurrSectionBef,"段",#CurrAlleyBef,"巷",#CurrLaneBef,"弄",#CurrNumBef,"號","之",#CurrNumDashBef,",",#CurrFloorBef,"樓","之",#CurrFloorDashBef],
[#<->#,"#FdCurrAdrBef+修改前-通訊地址",#CurrAddressBef],
[#<->#,"#FdCurrAdrAft+修改後-通訊地址",#SameReg,#SameRegX,"</br>",#CurrCityCodeAft,#CurrCityItemAft,#CurrAreaCodeAft,#CurrAreaItemAft,"</br>",#CurrRoadAft,"</br>",#CurrSectionAft,"段",#CurrAlleyAft,"巷",#CurrLaneAft,"弄",#CurrNumAft,"號","之",#CurrNumDashAft,",",#CurrFloorAft,"樓","之",#CurrFloorDashAft],
[#<->#,"#CurrAddressInd",#CurrAddressAft],
["#FdCurrZipBef+通訊-郵遞區號",#CurrZip3Bef,#CurrZip2Bef],
["#CurrZip2Ind",#CurrZip3Aft,#CurrZip2Aft],
["#FdEmailBef+電子信箱",#EmailBef],[#EmailInd,#EmailAft],
["#FdEducodeBef+教育程度代號",#EducodeBef,#EducodeBefX],[#EducodeInd,#EducodeAft,#EducodeAftX],
["#FdOwnedhomeBef+自有住宅有無",#OwnedhomeBef],[#OwnedhomeInd,#OwnedhomeAft],
["#FdCurrcompidBef+任職機構統編",#CurrcompidBef],[#CurrcompidInd,#CurrcompidAft],
["#FdCurrcompnameBef+任職機構名稱",#CurrcompnameBef],[#CurrcompnameInd,#CurrcompnameAft],
["#FdCurrcomptelBef+任職機構電話",#CurrcomptelBef],[#CurrcomptelInd,#CurrcomptelAft],
["#FdJobtitleBef+職位名稱",#JobtitleBef],[#JobtitleInd,#JobtitleAft],
["#FdJobTenureBef+服務年資",#JobTenureBef],[#JobTenureInd,#JobTenureAft],
["#FdIncomeofyearlyBef+年收入",#IncomeofyearlyBef,"仟元"],[#IncomeofyearlyInd,#IncomeofyearlyAft,"仟元"],
["#FdIncomedatadateBef+年收入資料年月",#IncomedatadateBef],[#IncomedatadateInd,#IncomedatadateAft],
["#FdPassportnoBef+護照號碼",#PassportnoBef],[#PassportnoInd,#PassportnoAft],
["#FdAmljobcodeBef+AML職業別",#AmljobcodeBef,#AmljobcodeBefX],[#AmljobcodeInd,#AmljobcodeAft,#AmljobcodeAftX],
["#FdAmlgroupBef+AML組織",#AmlgroupBef,#AmlgroupBefX],[#AmlgroupInd,#AmlgroupAft,#AmlgroupAftX],
[#<->#,"#FdIndigenousnameBef1+修改前-原住民姓名",#IndigenousnameBef],
[#<->#,"#FdIndigenousnameBef2+修改後-原住民姓名@+#IndigenousnameInd",#IndigenousnameAft],
]
!["#FdIsLimit+是否為授信限制對象",#IsLimitX],[#IsLimitXInd,#IsLimitXAft],
!["#FdIsRelated+是否為利害關係人",#IsRelatedX],[#IsRelatedXInd,#IsRelatedXAft],
!["#FdIsLnrelNear+是否為準利害關係人",#IsLnrelNearX],[#IsLnrelNearXInd,#IsLnrelNearXAft],
!---------- AP Button AREA ----------
![Buttom資料查詢]
!#BTN1=X,15,I,ui:button;value:瀏覽;enable:0;tabbable:0
!#BTN2=X,15,I,ui:button;value:行業別代號查詢;enable:1;tabbable:0;title=行業別代號查詢;
!#BTN3=X,15,I,ui:button;value:瀏覽;enable:0;tabbable:0
#BUF1=X,42,S
!ENABLE(#BTN1)ENABLE(#BTN2)ENABLE(#BTN3)

![Buttom資料查詢]
#BtnCdEmp=X,15,I,ui:button;value:員工資料查詢;enable:1;tabbable:0;title:L6088 員工資料檔查詢;
#BindCdEmp=X,1,S
BIND(#BtnCdEmp,click, {cmd=CHAIN; ntxcd=L6088; ntxbuf=;ntxbuf5=type<-1:EmpnoAft<-OOEmployeeNo:EmpnameAft<-OOFullname})

#Submit=A,1,S
K(MODIFYBUTTON,修改)
!---------- AP TEXT AREA Variables ----------
<include src="ROM.icf::L0Rim.dec"/>
<include src="ROM.icf::L1R01.dec"/>
<include src="ROM.icf::L1R10.dec"/>
<include src="ROM.icf::L1R12.dec"/>
<include src="ROM.icf::L1R16.dec"/>
<include src="ROM.icf::L1R17.dec"/>
<include src="ROM.icf::L2Rim.dec"/>
<include src="ROM.icf::L2R08.dec"/>
<include src="ROM.icf::L6R06.dec"/>
<include src="ROM.icf::L6R11Rim.dec"/>
<include src="ROM.icf::L6R03.dec"/>

#FdCustId=X,2,L
HIDE(#BtnCdEmp)

#FdCustIdBef=X,2,L


#FdTypeCode=X,2,L
T(3,*)

! Help

#TypeCodeHelp=x,100,S
T(3,0:借戶;1:保證人;2:擔保品提供人;3:交易關係人;4:借戶關係人／關係企業)

<include src="HELPRIM.icf::HELPRIM.rtn"/>
!Sex 性別
#CDDEF01=x,20,S
T(3,CdCode.Sex)

#SexHelp=x,1024,S

!CustTypeCode 客戶別
#CDDEF02=x,20,S
T(3,CdCode.CustTypeCode)

#CustTypeCodeHelp=x,1024,S

!NationalityCode 國籍
#CDDEF03=x,25,S
T(3,CdCode.NationalityCode)

#NationalityCodeHelp=x,1024,S

!YesNo YesNo
#CDDEF04=x,20,S
T(3,CdCode.YesNo)

#YesNoHelp=x,1024,S

!EntCode 企金別
#CDDEF05=x,20,S
T(3,CdCode.EntCode)

#EntCodeHelp=x,1024,S
T(3,0:個金;2:企金自然人)

!EduCode 教育程度代號
#CDDEF06=x,20,S
T(3,CdCode.EduCode)

#EduCodeHelp=x,1024,S

!AMLCode AML組織代號
#CDDEF07=x,20,S
T(3,CdCode.AMLCode)

#AMLCodeHelp=x,1024,S

!AMLJobCode AML職業別代號
#CDDEF08=x,20,S
T(3,CdCode.AMLJobCode)

#AMLJobCodeHelp=x,1024,S

#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#CDDEF01,#CDDEF02,#CDDEF03,#CDDEF04,#CDDEF05,#CDDEF06,#CDDEF07,#CDDEF08)
R(1,XXR99)
CALL(#HelpProc)
T(2,@SexHelp,#HelpDesc1)
T(2,@CustTypeCodeHelp,#HelpDesc2)
T(2,@NationalityCodeHelp,#HelpDesc3)
T(2,@YesNoHelp,#HelpDesc4)
! T(2,@EntCodeHelp,#HelpDesc5)
T(2,@EduCodeHelp,#HelpDesc6)
T(2,@AMLCodeHelp,#HelpDesc7)
T(2,@AMLJobCodeHelp,#HelpDesc8)

! 調RIM取縣市代碼
#RimL6r03City=X,1,S
E(0,@RimFunCd,1)
T(2,@RimCityCode,)
T(2,@RimAreaCode,)
RESET_RIM(#RimL6r03City,L6R03)
S(L6R03,1,#RimFunCd,#RimCityCode,#RimAreaCode)
R(1,L6R03)

! 縣市代碼的下拉選單
#CityHelp=X,10000,S
T(2,#L6r03Result)

#CHAIN=A,1,S
T(4,CHAIN$)
C(3,#FKEY,7,$,IF(#CHAIN!=1,V(P,此為連動交易，請從交易:[L1001 顧客明細資料查詢]進入),$))
T(2,@RimTxCode,#TXCD)

#NTXBUF=X,11,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
T(1,@CustId,#NTXBUF,2,10)

#TemFuncd=A,1,S
E(0,2)

#AGAIN=X,1,S
C(2,#TemFuncd,$,$,E(0,1),$,E(0,1))
ASGN(AGAIN$)

#CustUKey=x,32,S

!身分證字號
#CustId=X,10,L
!C(3,#CHAIN,1,s,$)
!@
!V(7)
A(ID_UNINO,0,#CustId)

#MRKEY=_,_,S
T(2,#CustId)

#checkchain=X,1,S
C(3,#CHAIN,1,T(F,@CustId,0),T(F,@CustId,1))

#RimL1r01=X,1,S
C(2,#FKEY,$,s,s,s,$,$,s,s,$,$)
T(2,@RimCustId,#CustId)
E(0,@RimFunCd,5)
RESET_RIM(#RimL1r01,L1R01)
S(L1R01,1,#RimCustId,#RimCustNo,#RimFunCd)
R(1,L1R01)
T(2,@CustUKey,#L1r01CustUKey)
T(2,@BranchNoBef,#L1r01BranchNo)
T(2,@CustIdBef,#L1r01CustId)
T(2,@CustIdAft,#L1r01CustId)
T(2,@CustNameBef,#L1r01CustName)
T(2,@CustNameAft,#L1r01CustName)
E(0,@BirthdayBef,#L1r01Birthday)
E(0,@BirthdayAft,#L1r01Birthday)
E(0,@GenderBef,#L1r01Sex)
E(0,@GenderAft,#L1r01Sex)
E(0,@CustTypeBef,#L1r01CustTypeCode)
E(0,@CustTypeAft,#L1r01CustTypeCode)
T(2,@IndustryBef,#L1r01IndustryCode)
T(2,@IndustryAft,#L1r01IndustryCode)
T(2,@CountryBef,#L1r01NationalityCode)
T(2,@CountryAft,#L1r01NationalityCode)
T(2,@BussNationalityCodeBef,#L1r01BussNationalityCode)
T(2,@BussNationalityCodeAft,#L1r01BussNationalityCode)
T(2,@SpouseIdBef,#L1r01SpouseId)
T(2,@SpouseIdAft,#L1r01SpouseId)
T(2,@SpouseNmBef,#L1r01SpouseName)
T(2,@SpouseNmAft,#L1r01SpouseName)
T(2,@RegZip3Bef,#L1r01RegZip3)
T(2,@RegZip3Aft,#L1r01RegZip3)
T(2,@RegZip2Bef,#L1r01RegZip2)
T(2,@RegZip2Aft,#L1r01RegZip2)
T(2,@RegCityCodeBef,#L1r01RegCityCode)
T(2,@RegCityCodeAft,#L1r01RegCityCode)
T(2,@RegAreaCodeBef,#L1r01RegAreaCode)
T(2,@RegAreaCodeAft,#L1r01RegAreaCode)
T(2,@RegRoadBef,#L1r01RegRoad)
T(2,@RegRoadAft,#L1r01RegRoad)
T(2,@RegSectionBef,#L1r01RegSection)
T(2,@RegSectionAft,#L1r01RegSection)
T(2,@RegAlleyBef,#L1r01RegAlley)
T(2,@RegAlleyAft,#L1r01RegAlley)
T(2,@RegLaneBef,#L1r01RegLane)
T(2,@RegLaneAft,#L1r01RegLane)
T(2,@RegNumBef,#L1r01RegNum)
T(2,@RegNumAft,#L1r01RegNum)
T(2,@RegNumDashBef,#L1r01RegNumDash)
T(2,@RegNumDashAft,#L1r01RegNumDash)
T(2,@RegFloorBef,#L1r01RegFloor)
T(2,@RegFloorAft,#L1r01RegFloor)
T(2,@RegFloorDashBef,#L1r01RegFloorDash)
T(2,@RegFloorDashAft,#L1r01RegFloorDash)
T(2,@CurrZip3Bef,#L1r01CurrZip3)
T(2,@CurrZip3Aft,#L1r01CurrZip3)
T(2,@CurrZip2Bef,#L1r01CurrZip2)
T(2,@CurrZip2Aft,#L1r01CurrZip2)
T(2,@CurrCityCodeBef,#L1r01CurrCityCode)
T(2,@CurrCityCodeAft,#L1r01CurrCityCode)
T(2,@CurrAreaCodeBef,#L1r01CurrAreaCode)
T(2,@CurrAreaCodeAft,#L1r01CurrAreaCode)
T(2,@CurrRoadBef,#L1r01CurrRoad)
T(2,@CurrRoadAft,#L1r01CurrRoad)
T(2,@CurrSectionBef,#L1r01CurrSection)
T(2,@CurrSectionAft,#L1r01CurrSection)
T(2,@CurrAlleyBef,#L1r01CurrAlley)
T(2,@CurrAlleyAft,#L1r01CurrAlley)
T(2,@CurrLaneBef,#L1r01CurrLane)
T(2,@CurrLaneAft,#L1r01CurrLane)
T(2,@CurrNumBef,#L1r01CurrNum)
T(2,@CurrNumAft,#L1r01CurrNum)
T(2,@CurrNumDashBef,#L1r01CurrNumDash)
T(2,@CurrNumDashAft,#L1r01CurrNumDash)
T(2,@CurrFloorBef,#L1r01CurrFloor)
T(2,@CurrFloorAft,#L1r01CurrFloor)
T(2,@CurrFloorDashBef,#L1r01CurrFloorDash)
T(2,@CurrFloorDashAft,#L1r01CurrFloorDash)
T(2,@EmailBef,#L1r01EMail)
T(2,@EmailAft,#L1r01EMail)
T(2,@EntcodeBef,#L1r01EntCode)
T(2,@EntcodeAft,#L1r01EntCode)
T(2,@EmpnoBef,#L1r01EmpNo)
T(2,@EmpnoAft,#L1r01EmpNo)
T(2,@EnameBef,#L1r01EName)
T(2,@EnameAft,#L1r01EName)
T(2,@EducodeBef,#L1r01EduCode)
T(2,@EducodeAft,#L1r01EduCode)
T(2,@OwnedhomeBef,#L1r01OwnedHome)
T(2,@OwnedhomeAft,#L1r01OwnedHome)
T(2,@CurrcompnameBef,#L1r01CurrCompName)
T(2,@CurrcompnameAft,#L1r01CurrCompName)
T(2,@CurrcompidBef,#L1r01CurrCompId)
T(2,@CurrcompidAft,#L1r01CurrCompId)
T(2,@CurrcomptelBef,#L1r01CurrCompTel)
T(2,@CurrcomptelAft,#L1r01CurrCompTel)
T(2,@JobtitleBef,#L1r01JobTitle)
T(2,@JobtitleAft,#L1r01JobTitle)
T(2,@JobTenureBef,#L1r01JobTenure)
T(2,@JobTenureAft,#L1r01JobTenure)
E(0,@IncomeofyearlyBef,#L1r01IncomeOfYearly)
E(0,@IncomeofyearlyAft,#L1r01IncomeOfYearly)
T(2,@IncomedatadateBef,#L1r01IncomeDataDate)
T(2,@IncomedatadateAft,#L1r01IncomeDataDate)
T(2,@PassportnoBef,#L1r01PassportNo)
T(2,@PassportnoAft,#L1r01PassportNo)
T(2,@AmljobcodeBef,#L1r01AMLJobCode)
T(2,@AmljobcodeAft,#L1r01AMLJobCode)
T(2,@AmlgroupBef,#L1r01AMLGroup)
T(2,@AmlgroupAft,#L1r01AMLGroup)
T(2,@IndigenousnameBef,#L1r01IndigenousName)
T(2,@IndigenousnameAft,#L1r01IndigenousName)
T(H,@RegCityItemBef,#RegCityCodeBef,#CityHelp)
T(H,@RegCityItemAft,#RegCityCodeAft,#CityHelp)
T(H,@CurrCityItemBef,#CurrCityCodeBef,#CityHelp)
T(H,@CurrCityItemAft,#CurrCityCodeAft,#CityHelp)
T(2,@TypeCodeBef,#L1r01TypeCode)
T(2,@TypeCodeAft,#L1r01TypeCode)
T(H,@TypeCodeXBef,#L1r01TypeCode,#TypeCodeHelp)
T(H,@TypeCodeXAft,#L1r01TypeCode,#TypeCodeHelp)
T(2,@RegAddressBef,#L1r01RegAddress)
T(2,@CurrAddressBef,#L1r01CurrAddress)

#RIM_L2R08a=X,1,S
C(4,#EmpnoBef,S,$)
RESET_RIM(#RIM_L2R08a,L2R08)
T(2,@RimEmployeeNo,#EmpnoBef)
S(L2R08,1,#RimTxCode,#RimEmployeeNo)
R(1,L2R08)
T(2,@EmpnameBef,#L2r08FullName)
T(2,@EmpnameAft,#L2r08FullName)

! 預先調rim塞值1
#SendL6R06AA=X,1,S
#RimIndustryCode=X,6,S
E(0,@RimFuncCode,5)
T(2,@RimIndustryCode,#IndustryBef)
RESET_RIM(#SendL6R06A,L6R06)
S(L6R06,1,#RimFuncCode,#RimTxCode,#RimIndustryCode)
R(1,L6R06)
#RL6R06AA=X,1,S
T(2,@IndustryBefX,#L6R06IndustryItem)
#SendL6R06BB=X,1,S
E(0,@RimFuncCode,5)
T(2,@RimIndustryCode,#IndustryAft)
RESET_RIM(#SendL6R06A,L6R06)
S(L6R06,1,#RimFuncCode,#RimTxCode,#RimIndustryCode)
R(1,L6R06)
#RL6R06BB=X,1,S
T(2,@IndustryAftX,#L6R06IndustryItem)

! 預先調rim塞值2-1
#SendL1R17=X,1,S
!#RimCityCode2=X,2,S
!T(2,#L1r01RegCityCode)
!#RimAreaCode2=X,2,S
!T(2,#L1r01RegAreaCode)
!RESET_RIM(#SendL1R17,L1R17)
!S(L1R17,1,#RimAreaCode2,#RimCityCode2)
!R(1,L1R17)
!T(2,@RegAreaItemX,#L1R17AreaItem)
!T(2,@RegAreaItemXAft,#L1R17AreaItem)
! 預先調rim塞值2-2
!#Space22=X,1,S
!T(2,@RimCityCode2,#L1r01CurrCityCode)
!T(2,@RimAreaCode2,#L1r01CurrAreaCode)
!RESET_RIM(#SendL1R17,L1R17)
!S(L1R17,1,#RimAreaCode2,#RimCityCode2)
!R(1,L1R17)
!T(2,@CurrAreaItemX,#L1R17AreaItem)
!T(2,@CurrAreaItemXAft,#L1R17AreaItem)
! 預先調rim塞值3

! 調是否為關係人rim
!#RimL1R16=X,1,S
!RESET_RIM(#RimL1r16,L1R16)
!S(L1R16,1,#RimCustId)
!R(1,L1R16)
!T(2,@IsLimit,#L1R16IsLimitYn)
!T(2,@IsRelated,#L1R16IsRelatedYn)
!T(2,@IsLnrelNear,#L1R16IsLnrelNearYn)
!T(H,@IsLimitX,#IsLimit,#YesNoHelp)
!T(H,@IsRelatedX,#IsRelated,#YesNoHelp)
!T(H,@IsLnrelNearX,#IsLnrelNear,#YesNoHelp)
!T(H,@IsLimitXAft,#IsLimit,#YesNoHelp)
!T(H,@IsRelatedXAft,#IsRelated,#YesNoHelp)
!T(H,@IsLnrelNearXAft,#IsLnrelNear,#YesNoHelp)

! AML欄位塞值
#AmlD=X,1,S
T(H,@AmljobcodeBefX,#AmljobcodeBef,#AMLJobCodeHelp)
T(H,@AmljobcodeAftX,#AmljobcodeAft,#AMLJobCodeHelp)
T(H,@AmlgroupBefX,#AmlgroupBef,#AMLCodeHelp)
T(H,@AmlgroupAftX,#AmlgroupAft,#AMLCodeHelp)
!性別
#SexD=X,1,S
T(H,@SexBefX,#GenderBef,#SexHelp)
T(H,@SexAftX,#GenderAft,#SexHelp)
!客戶別
#CustTypeD=X,1,S
T(H,@CustTypeCodeBefX,#CustTypeBef,#CustTypeCodeHelp)
T(H,@CustTypeCodeAftX,#CustTypeAft,#CustTypeCodeHelp)
!出生地國籍
#CountryD=X,1,S
T(H,@CountryX,#CountryBef,#NationalityCodeHelp)
T(H,@CountryXAft,#CountryAft,#NationalityCodeHelp)
T(H,@BussNationalityCodeBefX,#BussNationalityCodeBef,#NationalityCodeHelp)
T(H,@BussNationalityCodeAftX,#BussNationalityCodeAft,#NationalityCodeHelp)
!企金別
#EntD=X,1,S
T(H,@EntcodeBefX,#EntcodeBef,#EntCodeHelp)
T(H,@EntcodeAftX,#EntcodeAft,#EntCodeHelp)
!教育程度
#EduD=X,1,S
T(H,@EducodeBefX,#EducodeBef,#EduCodeHelp)
T(H,@EducodeAftX,#EducodeAft,#EduCodeHelp)

! 單位別
#BranchNoBef=X,4,S

#BranchNoInd=X,1,L

#BranchNo=X,4,S
T(4,BRN$)

#BranchNoInd=_,_,L
IF(#BranchNoBef == #BranchNo,T(3,),T(3,X))

!身分證字號
#CustIdBef=X,10,L

#CustIdInd=X,1,L

#CustIdAft=X,10,L
!@
!V(7)
A(ID_UNINO,0,#CustIdAft)

#IdSTAT=A,1,S
T(4,STAT$)
C(3,#IdSTAT,4,T(2,@FdPassportnoBef,*),T(2,@FdPassportnoBef, ))


#CustIdInd=_,_,L
!IF(#CustIdAft==#CustId || #CustIdAft == "",T(3,),T(3,X))


#TypeCodeBef=A,1,L

#TypeCodeXBef=x,20,L
T(H,#TypeCodeBef,#TypeCodeHelp)

#TypeCodeAft=A,1,I
C(2,#TypeCodeBef,s,$,$,$,$)
HELP(#TypeCodeHelp)
@
C(3,#TypeCodeBef,#TypeCodeAft,s,$)
C(2,#TypeCodeBef,V(1,0),V(1,0,1),V(1,0,1,2,3,4),V(1,0,1,2,3,4),V(1,0,1,2,3,4))
!V(H,#TypeCodeHelp)

#TypeCodeXAft=x,20,L
T(H,#TypeCodeAft,#TypeCodeHelp)

#TypeCodeInd=X,1,L
IF(#TypeCodeAft==#TypeCodeBef,T(3,),T(3,X))

#FdCustNameBef1=X,2,L
#FdCustNameBef2=X,2,L
T(3,*)
#FdBirthdayBef=X,2,L
T(3,*)
#FdGenderBef=X,2,L
T(3,*)

#FdCustTypeBef=X,2,L

#FdIndustryBef=X,2,L
T(3,)
#FdCountryBef=X,2,L
T(3,*)
#FdBussNationalityCode=X,2,L
T(3,*)
#FdSpouseIdBef=X,2,L
#FdSpouseNmBef1=X,2,L
#FdSpouseNmBef2=X,2,L

#FdRegAdrBef=X,2,L
#FdRegZipBef=X,2,L
#FdRegAdrAft=X,2,L
C(2,#TypeCodeAft,T(3,*),T(3,*),T(3,),T(3,),T(3,))
#FdRegZipAft=X,2,L

#FdCurrAdrBef=X,2,L
#FdCurrZipBef=X,2,L
#FdCurrAdrAft=X,2,L
C(2,#TypeCodeAft,T(3,*),T(3,*),T(3,),T(3,),T(3,))
#FdCurrZipAft=X,2,L

#FdEmailBef=X,2,L
C(2,#TypeCodeAft,T(3,*),T(3,*),T(3,),T(3,),T(3,))

#FdEntcodeBef=X,2,L
C(2,#TypeCodeAft,T(3,*),T(3,*),T(3,),T(3,),T(3,))

#FdEmpnoBef=X,2,L
#FdEnameBef=X,2,L
#FdEducodeBef=X,2,L
C(2,#TypeCodeAft,T(3,*),T(3,*),T(3,),T(3,),T(3,))

#FdOwnedhomeBef=X,2,L
C(2,#TypeCodeAft,T(3,*),T(3,*),T(3,),T(3,),T(3,))

#FdCurrcompnameBef=X,2,L
#FdCurrcompidBef=X,2,L
#FdCurrcomptelBef=X,2,L
#FdJobtitleBef=X,2,L
#FdJobTenureBef=X,2,L
#FdIncomeofyearlyBef=X,2,L
#FdIncomedatadateBef=X,2,L
#FdPassportnoBef=X,2,L
#FdAmljobcodeBef=X,2,L
C(2,#TypeCodeAft,T(3,*),T(3,*),T(3,),T(3,),T(3,))

#FdAmlgroupBef=X,2,L
C(2,#TypeCodeAft,T(3,*),T(3,*),T(3,),T(3,),T(3,))

#FdIndigenousnameBef1=X,2,L
#FdIndigenousnameBef2=X,2,L
#FdIsLimit=X,2,L
#FdIsRelated=X,2,L
#FdIsLnrelNear=X,2,L

!戶名
#CustNameBef=x,100,L


#CustNameInd=X,1,L

#CustNameAft=x,100,I
@
V(7)

#CustNameInd=_,_,L
C(5,#CustNameAft,#CustNameBef,T(3,),T(3,X))

!英文姓名
#EnameBef=X,50,L

#EnameInd=X,1,L

#EnameAft=X,50,I

#EnameInd=_,_,L
IF(#EnameAft==#EnameBef,T(3,),T(3,X))

#DATE=D,8,S
T(4,DATE$)

#DT=D,7,S
T(1,#DATE,2,7)

!出生年月日
#BirthdayBef=D,7,L

#BirthdayInd=X,1,L

#BirthdayAft=D,7,I
@
C(5,#TypeCodeInd,X,V(7),C(3,#BirthdayBef,#BirthdayAft,s,V(7)))
A(DATE,0,#BirthdayAft)
V(5,0010101,#SYSCDATE)

!出生日期比較
#BirthdayBef8=D,8,S
E(0,#BirthdayBef)
#BirthdayAft8=D,8,S
E(0,#BirthdayAft)

#Birthdaydiff=+n,8,L
E(0,#BirthdayBef-#BirthdayAft)

#BirthdayInd=_,_,L
IF(#Birthdaydiff == 0,T(3,),T(3,X))
! ALERT(#Birthdaydiff)

!性別
#GenderBef=A,1,L

#SexBefX=X,2,L
T(H,#GenderBef,#SexHelp)

#GenderInd=X,1,L

#GenderAft=A,1,I
HELP(#SexHelp)
@
C(5,#TypeCodeInd,X,$,C(3,#GenderBef,#GenderAft,s,$))
V(H,#SexHelp)

#SexAftX=X,2,L
T(H,#GenderAft,#SexHelp)

#GenderInd=_,_,L
IF(#GenderAft==#GenderBef || #GenderAft == 0,T(3,),T(3,X))

!客戶別
#CustTypeBef=A,2,L


#CustTypeCodeBefX=X,10,L
T(H,#CustTypeBef,#CustTypeCodeHelp)

#CustTypeInd=X,1,L

#CustTypeAft=A,2,I
HELP(#CustTypeCodeHelp)
@
C(5,#TypeCodeInd,X,$,C(3,#CustTypeAft,#CustTypeBef,s,$))
V(H,#CustTypeCodeHelp)

#ii=X,1,S
C(3,#CustTypeAft,1,T(F,@EmpnoAft,1),T(F,@EmpnoAft,0))
C(3,#CustTypeAft,1,SHOW(#BtnCdEmp),HIDE(#BtnCdEmp))

#CustTypeCodeAftX=X,10,L
T(H,#CustTypeAft,#CustTypeCodeHelp)
C(5,#CustTypeAft,01,T(3,@FdEmpnoBef,*),T(3,@FdEmpnoBef,))

#CustTypeInd=_,_,L
IF(#CustTypeAft==#CustTypeBef,T(3,),T(3,X))

!員工代號
#EmpnoBef=X,6,L

#EmpnameBef=x,40,L

#EmpnoInd=X,1,L

#EmpnoAft=X,6,I
C(5,#CustTypeAft,01,$,S)
@
C(5,#CustTypeBef,#CustTypeAft,C(5,#EmpnoBef,#EmpnoAft,$,V(7)),$)

#EmpnoInd=_,_,L
IF(#EmpnoAft==#EmpnoBef,T(3,),T(3,X))

#RIM_L2R08=X,1,S
C(5,#CustTypeAft,01,$,S)
C(5,#CustTypeBef,#CustTypeAft,C(5,#EmpnoBef,#EmpnoAft,S,$),$)
T(3,@EmpnameAft,)
RESET_RIM(#RIM_L2R08,L2R08)
T(2,@RimEmployeeNo,#EmpnoAft)
S(L2R08,1,#RimTxCode,#RimEmployeeNo)
R(1,L2R08)
T(2,@EmpnameAft,#L2r08FullName)

#EmpnameAft=x,40,L
C(5,#CustTypeAft,01,$,S)

!企金別
#EntcodeBef=X,1,L

#EntcodeBefX=X,10,L
T(H,#EntcodeBef,#EntCodeHelp)

#EntcodeInd=X,1,L

#EntcodeAft=X,1,I
HELP(#EntCodeHelp)
@
C(5,#TypeCodeInd,X,$,C(3,#EntcodeBef,#EntcodeAft,s,$))
V(H,#EntCodeHelp)

#EntcodeAftX=X,10,L
T(H,#EntcodeAft,#EntCodeHelp)

#EntcodeInd=_,_,L
IF(#EntcodeAft==#EntcodeBef,T(3,),T(3,X))



!行業別查詢按鈕
#BUF2=X,18,S

!#BIND2=X,1,S
!BIND(#BTN2,click, {cmd=CHAIN; ntxcd=L6062; ntxbuf=#BUF2;ntxbuf5=type<-1:IndustryAft<-OOIndustryCode})

!行業別
#IndustryBef=X,6,L

#SendL6R06A=X,1,S
E(0,@RimFuncCode,5)
T(2,@RimIndustryCode,#IndustryBef)
RESET_RIM(#SendL6R06,L6R06)
S(L6R06,1,#RimFuncCode,#RimTxCode,#RimIndustryCode)
R(1,L6R06)

#RL6R06A=X,1,S
T(2,@IndustryBefX,#L6R06IndustryItem)

#IndustryBefX=X,40,L

#IndustryInd=X,1,L

#IndustryAft=X,6,L


!#SendL6R06B=X,1,S
!E(0,@RimFuncCode,5)
!T(2,@RimIndustryCode,#IndustryAft)
!C(5,#IndustryAft,#IndustryBef,S,$)
!RESET_RIM(#SendL6R06,L6R06)
!S(L6R06,1,#RimFuncCode,#RimTxCode,#RimIndustryCode)
!R(1,L6R06)
!
!#RL6R06B=X,1,S
!T(2,@IndustryAftX,#L6R06IndustryItem)

#IndustryAftX=X,40,L
!C(5,#IndustryAft,#IndustryBef,T(2,@IndustryAftX,#IndustryBefX),$)

#IndustryInd=_,_,L
IF(#IndustryAft==#IndustryBef || #IndustryAft == 0,T(3,),T(3,X))


!出生地國籍
#CountryBef=X,2,L

#CountryX=X,50,L
T(H,#CountryBef,#NationalityCodeHelp)

#CountryInd=X,1,L

#CountryAft=X,2,I
HELP(#NationalityCodeHelp)
@
C(5,#TypeCodeInd,X,$,C(5,#CountryBef,#CountryAft,s,$))
V(H,#NationalityCodeHelp)

#CountryXAft=X,50,L
T(H,#CountryAft,#NationalityCodeHelp)


#CountryInd=_,_,L
IF(#CountryAft==#CountryBef || #CountryAft == "",T(3,),T(3,X))


!居住地國籍
#BussNationalityCodeBef=X,2,L

#BussNationalityCodeBefX=X,50,L
!T(H,#BussNationalityCodeBef,#NationalityCodeHelp)

#BussNationalityCodeInd=X,1,L

#BussNationalityCodeAft=X,2,I
HELP(#NationalityCodeHelp)
@
C(5,#TypeCodeInd,X,$,C(5,#BussNationalityCodeBef,#BussNationalityCodeAft,s,$))
V(H,#NationalityCodeHelp)

#BussNationalityCodeAftX=X,50,L
T(H,#BussNationalityCodeAft,#NationalityCodeHelp)


#BussNationalityCodeInd=_,_,L
IF(#BussNationalityCodeBef==#BussNationalityCodeAft || #BussNationalityCodeAft == "",T(3,),T(3,X))

!配偶身分證字號
#SpouseIdBef=X,10,L

#SpouseIdInd=X,1,L

#SpouseIdAft=X,10,I
@C(4,#SpouseIdAft,S,A(ID_UNINO,0,#SpouseIdAft))

#SpouseIdInd=_,_,L
IF(#SpouseIdAft==#SpouseIdBef,T(3,),T(3,X))
IF(#SpouseIdAft==#SpouseIdBef,T(3,@FdSpouseNmBef2,),C(4,#SpouseIdAft,T(3,@FdSpouseNmBef2,),T(3,@FdSpouseNmBef2,X)))

!配偶姓名
#SpouseNmBef=x,100,L

#SpouseNmInd=X,1,L

#SpouseNmAft=x,100,I
@
C(5,#SpouseIdAft,#SpouseIdBef,C(5,#SpouseNmAft,#SpouseNmBef,s,$),$)
C(4,#SpouseIdAft,$,V(7))

#SpouseNmInd=_,_,L
C(5,#SpouseNmAft,#SpouseNmBef,T(3,),T(3,X))

!戶籍-地址
#RegAddressBef=x,115,L

!戶籍-縣市代碼
#RegCityCodeBef=X,2,L

! 調RIM取鄉鎮市區代碼
#RimL6r03AreaBef=X,1,S
C(4,#RegCityCodeBef,S,$)
E(0,@RimFunCd,2)
T(2,@RimCityCode,#RegCityCodeBef)
T(2,@RimAreaCode,)
RESET_RIM(#RimL6r03AreaBef,L6R03)
S(L6R03,1,#RimFunCd,#RimCityCode,#RimAreaCode)
R(1,L6R03)

! 鄉鎮市區代碼的下拉選單
#L6r03ResultAreaBef=X,10000,S
C(4,#L6r03ResultAreaBef,T(2,#L6r03Result),$)

! 縣市代碼對應名稱
#RegCityItemBef=X,10,L
T(H,#RegCityCodeBef,#L6r03ResultAreaBef)

#RegCityCodeInd=X,1,L

#RegCityCodeAft=X,2,I
HELP(#CityHelp,cols:5)
@
C(5,#TypeCodeInd,X,C(5,#FdRegAdrAft,*,V(7),$),C(5,#RegCityCodeAft,#RegCityCodeBef,$,C(5,#FdRegAdrAft,*,V(7),$)))
C(4,#RegCityCodeAft,T(3,@RegAddressAft,)T(3,@RegZip3Aft,),C(5,#RegCityCodeAft,#RegCityCodeBef,$,V(H,#CityHelp)))

! 縣市代碼對應名稱
#RegCityItemAft=X,10,L
T(H,#RegCityCodeAft,#CityHelp)

#RegCityCodeInd=_,_,L
IF(#RegCityCodeAft==#RegCityCodeBef,T(3,),T(3,X))


! 調RIM取鄉鎮市區代碼
#RimL6r03Area=X,1,S
C(4,#RegCityCodeAft,S,$)
E(0,@RimFunCd,2)
T(2,@RimCityCode,#RegCityCodeAft)
T(2,@RimAreaCode,)
RESET_RIM(#RimL6r03Area,L6R03)
S(L6R03,1,#RimFunCd,#RimCityCode,#RimAreaCode)
R(1,L6R03)

!戶籍-鄉鎮市區代碼
#RegAreaCodeBef=X,3,L

!鄉鎮市區代碼的對應名稱
#RegAreaItemBef=X,20,L
T(H,#RegAreaCodeBef,#L6r03ResultAreaBef)

#L6r03ResultArea=X,10000,S
T(2,#L6r03Result)

#RegAreaCodeInd=X,1,L
IF(#RegCityCodeInd=="X",T(3,X),$)

#RegAreaCodeAft=X,3,I
C(4,#RegCityCodeAft,S,$)
HELP(#L6r03ResultArea,cols:5)
@
C(5,#RegCityCodeAft,#RegCityCodeBef,C(5,#RegAreaCodeBef,#RegAreaCodeAft,s,$),$)
V(H,#L6r03ResultArea)

! 鄉鎮市區代碼的對應名稱
#RegAreaItemAft=X,20,L
T(H,#RegAreaCodeAft,#L6r03ResultArea)

#RegAreaCodeInd=_,_,L
IF(#RegCityCodeInd=="X",T(3,X),IF(#RegAreaCodeAft==#RegAreaCodeBef,T(3,),T(3,X)))

! 調RIM取鄉鎮市區代碼B
#RimL1r10A=X,1,S
C(4,#RegCityCodeAft,S,$)
C(4,#RegAreaCodeAft,S,$)
T(2,@RimCityCode,#RegCityCodeAft)
T(2,@RimAreaCode,#RegAreaCodeAft)
RESET_RIM(#RimL1r10A,L1R10)
S(L1R10,1,#RimZip3,#RimZip2,#RimCityCode,#RimAreaCode)
R(1,L1R10)
E(0,@RegZip3Aft,#L1r10Zip3)

!戶籍-路名
#RegRoadBef=c,40,L

#RegRoadInd=X,1,L

#RegRoadAft=x,40,I
C(4,#RegCityCodeAft,S,$)
TOOLTIP(請自行輸入完整路名，包含路／街／村／里／鄰)
@
!C(4,#L1r01RegRoad,$,V(7))
V(7)

#RegRoadInd=_,_,L
IF(#RegRoadAft==#RegRoadBef,T(3,),T(3,X))

!戶籍-段
#RegSectionBef=X,5,L

#RegSectionInd=X,1,L

#RegSectionAft=X,5,I
C(4,#RegCityCodeAft,S,$)

#RegSectionInd=_,_,L
IF(#RegSectionAft==#RegSectionBef,T(3,),T(3,X))

!戶籍-巷
#RegAlleyBef=X,5,L

#RegAlleyInd=X,1,L

#RegAlleyAft=X,5,I
C(4,#RegCityCodeAft,S,$)

#RegAlleyInd=_,_,L
IF(#RegAlleyAft==#RegAlleyBef,T(3,),T(3,X))

!戶籍-弄
#RegLaneBef=X,5,L

#RegLaneInd=X,1,L

#RegLaneAft=X,5,I
C(4,#RegCityCodeAft,S,$)

#RegLaneInd=_,_,L
IF(#RegLaneAft==#RegLaneBef,T(3,),T(3,X))

!戶籍-號
#RegNumBef=X,5,L

#RegNumInd=X,1,L

#RegNumAft=X,5,I
C(4,#RegCityCodeAft,S,$)

#RegNumInd=_,_,L
IF(#RegNumAft==#RegNumBef,T(3,),T(3,X))

!戶籍-號之
#RegNumDashBef=X,5,L

#RegNumDashInd=X,1,L

#RegNumDashAft=X,5,I
C(4,#RegCityCodeAft,S,$)

#RegNumDashInd=_,_,L
IF(#RegNumDashAft==#RegNumDashBef,T(3,),T(3,X))

!戶籍-樓
#RegFloorBef=X,5,L

#RegFloorInd=X,1,L

#RegFloorAft=X,5,I
C(4,#RegCityCodeAft,S,$)

#RegFloorInd=_,_,L
IF(#RegFloorAft==#RegFloorBef,T(3,),T(3,X))

!戶籍-戶籍-樓之
#RegFloorDashBef=X,5,L

#RegFloorDashInd=X,1,L

#RegFloorDashAft=X,5,I
C(4,#RegCityCodeAft,S,$)
C(4,#RegFloorAft,S,$)

#RegFloorDashInd=_,_,L
IF(#RegFloorDashAft==#RegFloorDashBef,T(3,),T(3,X))

!戶籍-地址
#RegAddressAft=x,115,L
C(4,#RegCityCodeAft,S,$)


!戶籍地址
#RimL1r12AddressA=X,1,S
C(4,#RegCityCodeAft,S,$)
T(2,@RimCityCode,#RegCityCodeAft)
T(2,@RimAreaCode,#RegAreaCodeAft)
T(2,@RimRoad,#RegRoadAft)
T(2,@RimSection,#RegSectionAft)
T(2,@RimAlley,#RegAlleyAft)
T(2,@RimLane,#RegLaneAft)
T(2,@RimNum,#RegNumAft)
T(2,@RimNumDash,#RegNumDashAft)
T(2,@RimFloor,#RegFloorAft)
T(2,@RimFloorDash,#RegFloorDashAft)
RESET_RIM(#RimL1r12AddressA,L1R12)
S(L1R12,1,#RimCityCode,#RimAreaCode,#RimRoad,#RimSection,#RimAlley,#RimLane,#RimNum,#RimNumDash,#RimFloor,#RimFloorDash)
R(1,L1R12)
T(2,@RegAddressAft,#L1r12Address)

#RegAddressInd=X,27,L
IF(#RegAddressAft==#RegAddressBef,T(3,),T(3,                         X))

!戶籍-郵遞區號前三碼
#RegZip3Bef=X,3,L

#RegZip3Ind=X,1,L

#RegZip3Aft=X,3,L

#RegZip3Ind=_,_,L
IF(#RegZip3Aft==#RegZip3Bef,T(3,),T(3,X))

!戶籍-郵遞區號後兩碼
#RegZip2Bef=X,3,L

#RegZip2Ind=X,1,L

#RegZip2Aft=X,3,I
C(4,#RegCityCodeAft,S,$)
@
C(4,#RegZip2Aft,$,V(9))

#RegZip2Ind=_,_,L
IF(#RegZip2Aft==#RegZip2Bef,T(3,),T(3,X))

!通訊-地址
#CurrAddressBef=x,115,L

!通訊-縣市代碼
#CurrCityCodeBef=X,2,L

!通訊-縣市代碼對應名稱
#CurrCityItemBef=X,10,L
T(H,#CurrCityCodeBef,#CityHelp)

#CurrCityCodeInd=X,1,L

!通訊-縣市代碼的下拉選單
#L6r03ResultCity1=X,1000,S
T(2,#L6r03Result)

! 調RIM取鄉鎮市區代碼
#RimL6r03Area1Bef=X,1,S
C(4,#CurrCityCodeBef,S,$)
E(0,@RimFunCd,2)
T(2,@RimCityCode,#CurrCityCodeBef)
T(2,@RimAreaCode,)
RESET_RIM(#RimL6r03Area1Bef,L6R03)
S(L6R03,1,#RimFunCd,#RimCityCode,#RimAreaCode)
R(1,L6R03)

!通訊-鄉鎮市區代碼的下拉選單
#L6r03ResultArea1Bef=X,1000,S
C(4,#L6r03ResultArea1Bef,T(2,#L6r03Result),$)

#SameRegHelp=X,100,S
T(3,N:另行輸入;Y:同戶籍地址)

!---- 同戶籍地址
#SameReg=X,1,I
C(4,#RegCityCodeAft,T(3,N),$)
C(4,#RegCityCodeAft,s,$)
C(4,#SameReg,T(3,N),$)
HELP(#SameRegHelp)
@
V(H,#SameRegHelp)

#SameRegX=X,30,L
T(H,#SameReg,#SameRegHelp)
C(5,#SameReg,Y,$,s)
T(2,@CurrZip3Aft,#RegZip3Aft)
T(2,@CurrZip2Aft,#RegZip2Aft)
T(2,@CurrCityCodeAft,#RegCityCodeAft)
T(2,@CurrAreaCodeAft,#RegAreaCodeAft)
T(2,@CurrRoadAft,#RegRoadAft)
T(2,@CurrSectionAft,#RegSectionAft)
T(2,@CurrAlleyAft,#RegAlleyAft)
T(2,@CurrLaneAft,#RegLaneAft)
T(2,@CurrNumAft,#RegNumAft)
T(2,@CurrNumDashAft,#RegNumDashAft)
T(2,@CurrFloorAft,#RegFloorAft)
T(2,@CurrFloorDashAft,#RegFloorDashAft)
!T(2,@CurraddressAft,#RegaddressAft)

#CurrCityCodeAft=X,2,I
C(5,#SameReg,Y,s,$)
HELP(#CityHelp,cols:5)
@
C(5,#TypeCodeInd,X,C(5,#FdCurrAdrAft,*,V(7),$),C(5,#CurrCityCodeAft,#CurrCityCodeBef,$,C(5,#FdCurrAdrAft,*,V(7),$)))
C(4,#CurrCityCodeAft,T(3,@CurrAddressAft,)T(3,@CurrZip3Aft,),C(5,#CurrCityCodeAft,#CurrCityCodeBef,$,V(H,#CityHelp)))

!通訊-縣市代碼對應名稱
#CurrCityItemAft=X,10,L
T(H,#CurrCityCodeAft,#CityHelp)

#CurrCityCodeInd=_,_,L
IF(#CurrCityCodeAft==#CurrCityCodeBef,T(3,),T(3,X))

! 調RIM取鄉鎮市區代碼
#RimL6r03Area1=X,1,S
C(5,#SameReg,Y,s,$)
C(4,#CurrCityCodeAft,S,$)
E(0,@RimFunCd,2)
T(2,@RimCityCode,#CurrCityCodeAft)
T(2,@RimAreaCode,)
RESET_RIM(#RimL6r03Area1,L6R03)
S(L6R03,1,#RimFunCd,#RimCityCode,#RimAreaCode)
R(1,L6R03)
T(2,@L6r03ResultArea1,#L6r03Result)

!通訊-鄉鎮市區代碼
#CurrAreaCodeBef=X,3,L


!通訊 鄉鎮市區代碼的對應名稱
#CurrAreaItemBef=X,20,L
T(H,#CurrAreaCodeBef,#L6r03ResultArea1Bef)

#CurrAreaCodeInd=X,1,L


!通訊-鄉鎮市區代碼的下拉選單
#L6r03ResultArea1=X,1000,S
T(2,#L6r03Result)

#CurrAreaCodeAft=X,3,I
C(5,#SameReg,Y,s,$)
C(4,#CurrCityCodeAft,S,$)
HELP(#L6r03ResultArea1,cols:5)
@
C(5,#CurrCityCodeAft,#CurrCityCodeBef,C(5,#CurrAreaCodeBef,#CurrAreaCodeAft,s,$),$)
V(H,#L6r03ResultArea)

!通訊 鄉鎮市區代碼的對應名稱
#CurrAreaItemAft=X,20,L
T(H,#CurrAreaCodeAft,#L6r03ResultArea1)

#CurrAreaCodeInd=_,_,L
IF(#CurrCityCodeInd=="X",T(3,X),IF(#CurrAreaCodeAft==#CurrAreaCodeBef,T(3,),T(3,X)))
! IF(#CurrAreaCodeAft==#CurrAreaCodeBef,T(3,),T(3,X))

! 調RIM取鄉鎮市區代碼B
#RimL1r10B=X,1,S
C(5,#SameReg,Y,s,$)
C(4,#CurrCityCodeAft,S,$)
T(2,@RimCityCode,#CurrCityCodeAft)
T(2,@RimAreaCode,#CurrAreaCodeAft)
RESET_RIM(#RimL1r10B,L1R10)
S(L1R10,1,#RimZip3,#RimZip2,#RimCityCode,#RimAreaCode)
R(1,L1R10)
E(0,@CurrZip3Aft,#L1r10Zip3)


!通訊-路名
#CurrRoadBef=x,40,L

#CurrRoadInd=X,1,L

#CurrRoadAft=x,40,I
C(5,#SameReg,Y,s,$)
C(4,#CurrCityCodeAft,S,$)
TOOLTIP(請自行輸入完整路名，包含路／街／村／里／鄰)
@
!C(4,#L1r01CurrRoad,$,V(7))
V(7)

#CurrRoadInd=_,_,L
IF(#CurrRoadAft==#CurrRoadBef,T(3,),T(3,X))

!通訊-段
#CurrSectionBef=X,5,L

#CurrSectionInd=X,1,L

#CurrSectionAft=X,5,I
C(5,#SameReg,Y,s,$)
C(4,#CurrCityCodeAft,S,$)

#CurrSectionInd=_,_,L
IF(#CurrSectionAft==#CurrSectionBef,T(3,),T(3,X))

!通訊-巷
#CurrAlleyBef=X,5,L

#CurrAlleyInd=X,1,L

#CurrAlleyAft=X,5,I
C(5,#SameReg,Y,s,$)
C(4,#CurrCityCodeAft,S,$)

#CurrAlleyInd=_,_,L
IF(#CurrAlleyAft==#CurrAlleyBef,T(3,),T(3,X))

!通訊-弄
#CurrLaneBef=X,5,L

#CurrLaneInd=X,1,L

#CurrLaneAft=X,5,I
C(5,#SameReg,Y,s,$)
C(4,#CurrCityCodeAft,S,$)

#CurrLaneInd=_,_,L
IF(#CurrLaneAft==#CurrLaneBef,T(3,),T(3,X))

!通訊-號
#CurrNumBef=X,5,L

#CurrNumInd=X,1,L

#CurrNumAft=X,5,I
C(5,#SameReg,Y,s,$)
C(4,#CurrCityCodeAft,S,$)

#CurrNumInd=_,_,L
IF(#CurrNumAft==#CurrNumBef,T(3,),T(3,X))

!通訊-號之
#CurrNumDashBef=X,5,L

#CurrNumDashInd=X,1,L

#CurrNumDashAft=X,5,I
C(5,#SameReg,Y,s,$)
C(4,#CurrCityCodeAft,S,$)

#CurrNumDashInd=_,_,L
IF(#CurrNumDashAft==#CurrNumDashBef,T(3,),T(3,X))

!通訊-樓
#CurrFloorBef=X,5,L

#CurrFloorInd=X,1,L

#CurrFloorAft=X,5,I
C(5,#SameReg,Y,s,$)
C(4,#CurrCityCodeAft,S,$)

#CurrFloorInd=_,_,L
IF(#CurrFloorAft==#CurrFloorBef,T(3,),T(3,X))

!通訊-樓之
#CurrFloorDashBef=X,5,L

#CurrFloorDashInd=X,1,L

#CurrFloorDashAft=X,5,I
C(5,#SameReg,Y,s,$)
C(4,#CurrCityCodeAft,S,$)
C(4,#CurrFloorAft,S,$)

#CurrFloorDashInd=_,_,L
IF(#CurrFloorDashAft==#CurrFloorDashBef,T(3,),T(3,X))


!通訊-地址
#CurrAddressAft=x,115,L
C(4,#CurrCityCodeAft,S,$)

#RimL1r12AddressB=X,1,S
C(4,#CurrCityCodeAft,S,$)
T(2,@RimCityCode,#CurrCityCodeAft)
T(2,@RimAreaCode,#CurrAreaCodeAft)
T(2,@RimRoad,#CurrRoadAft)
T(2,@RimSection,#CurrSectionAft)
T(2,@RimAlley,#CurrAlleyAft)
T(2,@RimLane,#CurrLaneAft)
T(2,@RimNum,#CurrNumAft)
T(2,@RimNumDash,#CurrNumDashAft)
T(2,@RimFloor,#CurrFloorAft)
T(2,@RimFloorDash,#CurrFloorDashAft)
RESET_RIM(#RimL1r12AddressB,L1R12)
S(L1R12,1,#RimCityCode,#RimAreaCode,#RimRoad,#RimSection,#RimAlley,#RimLane,#RimNum,#RimNumDash,#RimFloor,#RimFloorDash)
R(1,L1R12)
T(2,@CurrAddressAft,#L1r12Address)

#CurrAddressInd=X,27,L
IF(#CurrAddressAft==#CurrAddressBef,T(3,),T(3,                         X))

!通訊-郵遞區號前三碼
#CurrZip3Bef=X,3,L

#CurrZip3Ind=X,1,L

#CurrZip3Aft=X,3,L

#CurrZip3Ind=_,_,L
IF(#CurrZip3Aft==#CurrZip3Bef,T(3,),T(3,X))

!通訊-郵遞區號後兩碼
#CurrZip2Bef=X,3,L

#CurrZip2Ind=X,1,L

#CurrZip2Aft=X,3,I
C(5,#SameReg,Y,s,$)
C(4,#CurrCityCodeAft,S,$)
@
C(4,#CurrZip2Aft,$,V(9))


#CurrZip2Ind=_,_,L
IF(#CurrZip2Aft==#CurrZip2Bef,T(3,),T(3,X))

!電子信箱
#EmailBef=x,50,L

#EmailInd=X,1,L

#EmailAft=x,50,I
@
C(5,#TypeCodeInd,X,$,C(5,#EmailBef,#EmailAft,s,$))
IF(#FdEmailBef=="*",V(7),$)
C(4,#EmailAft,$,A(M,0,#EmailAft))

#EmailInd=_,_,L
IF(#EmailAft==#EmailBef,T(3,),T(3,X))



! 關係人欄位
#IsLimit=X,1,S
#IsRelated=X,1,S
#IsLnrelNear=X,1,S

#IsLimitXInd=X,1,L
#IsRelatedXInd=X,1,L
#IsLnrelNearXInd=X,1,L

#IsLimitX=X,2,L
#IsRelatedX=X,2,L
#IsLnrelNearX=X,2,L
#IsLimitXAft=X,2,L
#IsRelatedXAft=X,2,L
#IsLnrelNearXAft=X,2,L


!教育程度代號
#EducodeBef=X,1,L

#EducodeBefX=X,10,L
T(H,#EducodeBef,#EduCodeHelp)

#EducodeInd=X,1,L

#EducodeAft=X,1,I
HELP(#EduCodeHelp)
@
C(5,#TypeCodeInd,X,$,C(5,#EducodeBef,#EducodeAft,s,$))
IF(#FdEducodeBef=="*",V(7),$)
C(4,#EducodeAft,$,V(H,#EduCodeHelp))

#EducodeAftX=X,10,L
T(H,#EducodeAft,#EduCodeHelp)

#EducodeInd=_,_,L
IF(#EducodeAft==#EducodeBef,T(3,),T(3,X))

!自有住宅有無
#OwnedhomeBef=X,1,L

#OwnedhomeInd=X,1,L

#OwnedhomeAft=X,1,I
HELP(#YesNoHelp)
@
C(5,#TypeCodeInd,X,$,C(5,#OwnedhomeBef,#OwnedhomeAft,s,$))
IF(#FdOwnedhomeBef=="*",V(7),$)
C(4,#OwnedhomeAft,$,V(H,#YesNoHelp))

#OwnedhomeInd=_,_,L
IF(#OwnedhomeAft==#OwnedhomeBef,T(3,),T(3,X))

!任職機構統編
#CurrcompidBef=X,8,L

#CurrcompidInd=X,1,L

#CurrcompidAft=X,8,I
@C(4,#CurrcompidAft,S,A(ID_UNINO,0,#CurrcompidAft))

#CurrcompidInd=_,_,L
IF(#CurrcompidAft==#CurrcompidBef,T(3,),T(3,X))

!任職機構名稱
#CurrcompnameBef=c,60,L

#CurrcompnameInd=X,1,L

#CurrcompnameAft=c,60,I

#CurrcompnameInd=_,_,L
IF(#CurrcompnameAft==#CurrcompnameBef,T(3,),T(3,X))


!任職機構電話
#CurrcomptelBef=X,16,L

#CurrcomptelInd=X,1,L

#CurrcomptelAft=X,16,I

#CurrcomptelInd=_,_,L
IF(#CurrcomptelAft==#CurrcomptelBef,T(3,),T(3,X))

!職位名稱
#JobtitleBef=c,20,L

#JobtitleInd=X,1,L

#JobtitleAft=c,20,I

#JobtitleInd=_,_,L
IF(#JobtitleAft==#JobtitleBef,T(3,),T(3,X))

!服務年資
#JobTenureBef=X,2,L

#JobTenureInd=X,1,L

#JobTenureAft=X,2,I
@
C(4,#JobTenureAft,$,V(9))

#JobTenureInd=_,_,L
IF(#JobTenureAft==#JobTenureBef,T(3,),T(3,X))

!年收入
#IncomeofyearlyBef=n,9,L

#IncomeofyearlyInd=X,1,L

#IncomeofyearlyAft=n,9,I

#IncomeofyearlyInd=_,_,L
IF(#IncomeofyearlyAft==#IncomeofyearlyBef,T(3,),T(3,X))

!年收入資料年月
#IncomedatadateBef=X,5,L

#IncomedatadateInd=X,1,L

#MANU_MM=A,2,S

#IncomedatadateAft=X,5,I
@C(4,#IncomedatadateAft,S,V(9))
T(1,@MANU_MM,#IncomedatadateAft,4,5)
IF(#MANU_MM==0 || #MANU_MM >= 13,V(P,請輸入年月，格式YYYMM),$)

#IncomedatadateInd=_,_,L
IF(#IncomedatadateAft==#IncomedatadateBef,T(3,),T(3,X))

!護照號碼
#PassportnoBef=X,20,L

#PassportnoInd=X,1,L

#PassportnoAft=X,20,I
@
C(5,#PassportnoBef,#PassportnoAft,s,$)
C(3,#IdSTAT,4,C(4,#PassportnoAft,V(P,外國人使用稅籍編號建檔，需輸入護照號碼),$),$)

#PassportnoInd=_,_,L
IF(#PassportnoAft==#PassportnoBef,T(3,),T(3,X))

!AML職業別
#AmljobcodeBef=X,3,L
#AmljobcodeBefX=X,30,L
#AmljobcodeInd=X,1,L

#AmljobcodeAft=X,3,I
HELP(#AMLJobCodeHelp)
@
C(5,#TypeCodeInd,X,$,C(5,#AmljobcodeAft,#AmljobcodeBef,s,$))
IF(#FdAmljobcodeBef=="*",V(7),$)
C(4,#AmljobcodeAft,$,V(H,#AMLJobCodeHelp))

#AmljobcodeAftX=X,30,L
T(H,#AmljobcodeAft,#AMLJobCodeHelp)

#AmljobcodeInd=_,_,L
IF(#AmljobcodeAft==#AmljobcodeBef,T(3,),T(3,X))

!AML組織
#AmlgroupBef=X,3,L
#AmlgroupBefX=X,30,L
#AmlgroupInd=X,1,L

#AmlgroupAft=X,3,I
HELP(#AMLCodeHelp)
@
C(5,#TypeCodeInd,X,$,C(5,#AmlgroupAft,#AmlgroupBef,s,$))
IF(#FdAmlgroupBef=="*",V(7),$)
C(4,#AmlgroupAft,$,V(H,#AMLCodeHelp))

#AmlgroupAftX=X,30,L
T(H,#AmlgroupAft,#AMLCodeHelp)

#AmlgroupInd=_,_,L
IF(#AmlgroupAft==#AmlgroupBef,T(3,),T(3,X))

!原住民姓名
#IndigenousnameBef=x,100,L


#IndigenousnameInd=X,1,L

#IndigenousnameAft=x,100,I

#IndigenousnameInd=_,_,L
C(5,#IndigenousnameAft,#IndigenousnameBef,T(3,),T(3,X))



!串IND IF空白跳ERROR

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>


!---------- TXFORM = L1103 ----------
<sub type="FORM" name="L1103">

!#SCRPRT=_,_,S
!C(5,#TXFORM,L1103,$,S)

#SCRTIL=_,_,S
T(3,[L1103] 顧客基本資料變更-自然人)

!------ TOM(HEAD)   Variables (FOR OUTPUT SCREEN) ------
!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------


!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------



</sub>


!------ 上行電文 ------
<sub type="TIM">
#CustUKey
#CustId
#BranchNoBef
#BranchNo
#BranchNoInd
#CustIdBef
#CustIdInd
#CustIdAft
#TypeCodeBef
#TypeCodeAft
#TypeCodeInd
#CustNameBef
#CustNameInd
#CustNameAft
#BirthdayBef
#BirthdayInd
#BirthdayAft
#GenderBef
#GenderInd
#GenderAft
#CustTypeBef
#CustTypeInd
#CustTypeAft
#IndustryBef
#IndustryInd
#IndustryAft
#CountryBef
#CountryInd
#CountryAft
#BussNationalityCodeBef
#BussNationalityCodeAft
#BussNationalityCodeInd
#SpouseIdBef
#SpouseIdInd
#SpouseIdAft
#SpouseNmBef
#SpouseNmInd
#SpouseNmAft
#RegZip3Bef
#RegZip3Ind
#RegZip3Aft
#RegZip2Bef
#RegZip2Ind
#RegZip2Aft
#RegCityCodeBef
#RegCityCodeInd
#RegCityCodeAft
#RegAreaCodeBef
#RegAreaCodeInd
#RegAreaCodeAft
#RegRoadBef
#RegRoadInd
#RegRoadAft
#RegSectionBef
#RegSectionInd
#RegSectionAft
#RegAlleyBef
#RegAlleyInd
#RegAlleyAft
#RegLaneBef
#RegLaneInd
#RegLaneAft
#RegNumBef
#RegNumInd
#RegNumAft
#RegNumDashBef
#RegNumDashInd
#RegNumDashAft
#RegFloorBef
#RegFloorInd
#RegFloorAft
#RegFloorDashBef
#RegFloorDashInd
#RegFloorDashAft
#CurrZip3Bef
#CurrZip3Ind
#CurrZip3Aft
#CurrZip2Bef
#CurrZip2Ind
#CurrZip2Aft
#CurrCityCodeBef
#CurrCityCodeInd
#CurrCityCodeAft
#CurrAreaCodeBef
#CurrAreaCodeInd
#CurrAreaCodeAft
#CurrRoadBef
#CurrRoadInd
#CurrRoadAft
#CurrSectionBef
#CurrSectionInd
#CurrSectionAft
#CurrAlleyBef
#CurrAlleyInd
#CurrAlleyAft
#CurrLaneBef
#CurrLaneInd
#CurrLaneAft
#CurrNumBef
#CurrNumInd
#CurrNumAft
#CurrNumDashBef
#CurrNumDashInd
#CurrNumDashAft
#CurrFloorBef
#CurrFloorInd
#CurrFloorAft
#CurrFloorDashBef
#CurrFloorDashInd
#CurrFloorDashAft
#EmailBef
#EmailInd
#EmailAft
#EntcodeBef
#EntcodeInd
#EntcodeAft
#EmpnoBef
#EmpnoInd
#EmpnoAft
#EnameBef
#EnameInd
#EnameAft
#EducodeBef
#EducodeInd
#EducodeAft
#OwnedhomeBef
#OwnedhomeInd
#OwnedhomeAft
#CurrcompnameBef
#CurrcompnameInd
#CurrcompnameAft
#CurrcompidBef
#CurrcompidInd
#CurrcompidAft
#CurrcomptelBef
#CurrcomptelInd
#CurrcomptelAft
#JobtitleBef
#JobtitleInd
#JobtitleAft
#JobTenureBef
#JobTenureInd
#JobTenureAft
#IncomeofyearlyBef
#IncomeofyearlyInd
#IncomeofyearlyAft
#IncomedatadateBef
#IncomedatadateInd
#IncomedatadateAft
#PassportnoBef
#PassportnoInd
#PassportnoAft
#AmljobcodeBef
#AmljobcodeInd
#AmljobcodeAft
#AmlgroupBef
#AmlgroupInd
#AmlgroupAft
#IndigenousnameBef
#IndigenousnameInd
#IndigenousnameAft
#END

</sub>


!------ 下行電文TOM ------
<sub type="TOM">
TXFORM=L1103
^
<include src="ROM.icf::L1R01.tom"/>
<include src="ROM.icf::L1R10.tom"/>
<include src="ROM.icf::L1R12.tom"/>
<include src="ROM.icf::L1R16.tom"/>
<include src="ROM.icf::L1R17.tom"/>
<include src="ROM.icf::L2R08.tom"/>
<include src="ROM.icf::L6R03.tom"/>
<include src="ROM.icf::L6R06.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
<include src="COM.icf::TRCTL.tom"/>
</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">
<include src="PRT.icf::UPD01.sel"/>
</sub>
