----- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">

![一段式/二段式/三段式]
!#RELCD=_,_,S
!E(0,1)

!#ACTFG=_,_,S
!E(0,1)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD2.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
</sub>

! <sub type="PREDC" name="PreDC">

! ! 排除區塊的開關
! #HIDEBANFG=A,1,S
! E(0,0)

! #HIDEBAN=@,1,S
! C(3,#HIDEBANFG,1,E(0,@HIDEBANFG,0),E(0,@HIDEBANFG,1))
! INVOKEJS(SHOW,p1,4,7,#HIDEBANFG)

! ! 獎勵津貼標準區塊的開關
! #HIDEBONUSRULEFG=A,1,S
! E(0,0)

! #HIDEBONUSRULE=@,1,S
! C(3,#HIDEBONUSRULEFG,1,E(0,@HIDEBONUSRULEFG,0),E(0,@HIDEBONUSRULEFG,1))
! INVOKEJS(SHOW,p1,9,16,#HIDEBONUSRULEFG)

! </sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[150,850];printer.width=[20,20];">
[
["[L6701]                                 行庫資料維護"],
["#R1+@功能",#FuncCodeX],
["#R2+@行庫代號",#BankCode,#BranchCode],
["#R3+@行庫名稱",#BankItem],
["#R4+@分行名稱",#BranchItem],
]
!---------- AP Button AREA ----------
![Buttom資料查詢]
#BUF1=X,42,S

! 必輸欄位
##loop{times:4,i:1}
#R{i}=X,1,L
INVOKEJS(SHOW,#R{i},0)
!K(LIGHT,#R{i},TXTRED,0)
##end

! 永遠為必輸欄位
#ALWAYS_HIGHLIGHT=@,1,S
!T(3,@R1,*)

! FUNCD=1 新增時為必輸欄位
#HIGHLIGHT_AFTER_FUNCD=@,1,S
##loop{times:3,i:2}
IF(#FuncCode==1 || #FuncCode==2,T(3,@R{i},*),T(3,@R{i}, ))
IF(#FuncCode==1 || #FuncCode==2,INVOKEJS(SHOW,#R{i},1),INVOKEJS(SHOW,#R{i},0))
##end


!---------- AP TEXT AREA Variables ----------
<include src="HELPRIM.icf::HELPRIM.rtn"/>

!FuncCode2(1:新增;2:修改;4:刪除)
#CODEFuncCode2=x,20,S                  
T(3,CdCode.FuncCode2)                  
#FuncCode2Help=x,50,S     

#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#CODEFuncCode2)
R(1,XXR99)
CALL(#HelpProc)
T(2,@FuncCode2Help,#HelpDesc1)

#CHAIN=A,1,S
T(4,CHAIN$)
T(2,@RimTxCode,#TXCD)
IF(#CHAIN!=1,V(P,此為連動交易，請從交易:[L6071 行庫資料查詢]進入),$)

#INIT=X,1,S
CALL(#ALWAYS_HIGHLIGHT)

#NTXBUF=X,208,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)
!ALERT(#NTXBUF)

#CHAIN_FuncCode=X,1,S
T(1,#NTXBUF,1,1)

#CHAIN_BankCode=X,3,S
T(1,#NTXBUF,2,3)

#CHAIN_BranchCode=X,4,S
T(1,#NTXBUF,5,4)

#CHAIN_BankItem=x,100,S
T(1,#NTXBUF,9,50)

#CHAIN_BranchItem=x,100,S
T(1,#NTXBUF,59,50)

#CHAINSET=X,1,S
C(3,#CHAIN,1,$,S)
T(2,@FuncCode,#CHAIN_FuncCode)
C(3,#FuncCode,1,S,$)
T(2,@BankCode,#CHAIN_BankCode)
T(2,@BranchCode,#CHAIN_BranchCode)
T(2,@BankItem,#CHAIN_BankItem)
T(2,@BranchItem,#CHAIN_BranchItem)

! 功能 必須輸入(1: 新增;2: 修改;4: 刪除)
#FuncCode=A,1,S
T(F,@FuncCode,0)
C(3,#CHAIN,1,s,$)
HELP(#FuncCode2Help)
@V(H,#FuncCode2Help)

#FuncCodeX=X,12,L
T(H,#FuncCode,#FuncCode2Help)
C(2,#FuncCode,$,K(MODIFYBUTTON,新增),K(MODIFYBUTTON,修改),$,K(MODIFYBUTTON,刪除))

#AGAIN=X,1,S
IF(#FuncCode==4 || #FuncCode==2,$,S)
E(0,1)ASGN(AGAIN$)

#FUNCIND=_,_,S
E(0,#FuncCode)
<include src="COM.icf::CheckAuth.rtn"/>

!顯示框線
#WKTF=X,1,S
IF (#FuncCode==1 || #FuncCode==2 ,T(F,@BankItem,1)T(F,@BranchItem,1),
                                  T(F,@BankItem,0)T(F,@BranchItem,0))
IF (#FuncCode==1 || #CHAIN==0 ,T(F,@BankCode,1)T(F,@BranchCode,1),T(F,@BankCode,0)T(F,@BranchCode,0))

#WKPSC=X,2,S

#WKSTAR1=X,2,S
C(3,#CHAIN,1,C(2,#FuncCode,S,T(3,*),S,S,S,S),T(3,*))

#WKSTAR2=X,2,S
C(2,#FuncCode,S,T(3,*),T(3,*),S,S,S)

#WKNAME=X,1,S
T(2,@R2,#WKSTAR1)
T(2,@R3,#WKSTAR2)

! 行庫代號
#BankCode=X,3,I
C(3,#CHAIN,1,T(2,#CHAIN_BankCode),)
C(3,#CHAIN,1,C(2,#FuncCode,$,$,s,$,s,s),$)
@V(7)V(5,0,999)

! 分行代號
#BranchCode=X,4,I
C(3,#CHAIN,1,T(2,#CHAIN_BranchCode),)
C(3,#CHAIN,1,C(2,#FuncCode,$,$,s,$,s,s),$)
@
C(4,#BranchCode,T(3,@R4,),T(3,@R4,*))
C(4,#BranchCode,s,V(5,0,9999))

#SendL2r09A=X,1,S
C(3,#FuncCode,4,s,$)
C(4,#BranchCode,S,$)
T(2,@RimBankCode,#BankCode)
RESET_RIM(#SendL2r09A,L2R09)
S(L2R09,1,#RimTxCode,#RimBankCode)
R(1,L2R09)
T(2,@BankItem,#L2r09BankItem)

#SendL6R01=X,1,S
C(3,#CHAIN,1,s,$)
E(0,@RimFuncCode,#FuncCode)
T(2,@RimL6R01BankCode,#BankCode)
T(2,@RimL6R01BranchCode,#BranchCode)
RESET_RIM(#SendL6R01,L6R01)
S(L6R01,1,#RimFuncCode,#RimTxCode,#RimL6R01BankCode,#RimL6R01BranchCode)
R(1,L6R01)

#RecRim=X,1,S
C(3,#CHAIN,1,s,$)
T(2,@BankItem,#L6R01BankItem)
T(2,@BranchItem,#L6R01BranchItem)

! 行庫名稱
#BankItem=x,50,I
! C(3,#CHAIN,1,T(2,#CHAIN_BankItem),$)
C(3,#FuncCode,4,s,$)
@V(7)

! 分行名稱
#BranchItem=x,50,I
! C(3,#CHAIN,1,T(2,#CHAIN_BranchItem),$)
C(3,#FuncCode,4,s,$)
C(4,#BranchCode,S,$)
@V(7)

#RPTFG=A,1,S
E(0,0)

!參考編號
#MRKEY=_,_,S
T(2,#BankCode)

<include src="ROM.icf::L0Rim.dec"/>
<include src="ROM.icf::L2Rim.dec"/>
<include src="ROM.icf::L6R01Rim.dec"/>
<include src="ROM.icf::L6R01.dec"/>
<include src="ROM.icf::L2R09.dec"/>

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!---------- TXFORM = L6701 ----------
<sub type="FORM" name="L6701">

#SCRPRT=_,_,S
C(5,#TXFORM,L6701,$,S)

#SCRTIL=_,_,S
T(3,[L6701] 行庫資料維護)

</sub>


!------ 上行電文 TEXT ------
<sub type="TIM">

#FuncCode#BankCode#BranchCode#BankItem#BranchItem#END

</sub>


!------ 下行電文TOM ------
<sub type="TOM">
TXFORM=L6701
^
<include src="ROM.icf::L6R01.tom"/>
<include src="ROM.icf::L2R09.tom"/>
<include src="COM.icf::TRCTL.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
</sub>


!---------- 單據輸出組合 ----------
<sub type="SELECT">
<include src="PRT.icf::UPD01.sel"/>
</sub>
