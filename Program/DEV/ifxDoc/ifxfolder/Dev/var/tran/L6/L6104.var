!----- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">


</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)

#Help=X,200,S
T(3,1:設定;2:解除;3:查詢)

#Help2=X,200,S
T(3,0:未生效;1:生效)

</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[150,650];printer.width=[20,40];">
[
["[L6104]                                 代理人設定"],
["#FdFunCode+功能",#FunCode,#FunCodeX],
["#FdNone+代理人1",#AgentTlrno1,#AgentTlrnoNa1],
["#FdNone+代理人2",#AgentTlrno2,#AgentTlrnoNa2],
["#FdNone+代理人3",#AgentTlrno3,#AgentTlrnoNa3],
["#FdNone+代理人4",#AgentTlrno4,#AgentTlrnoNa4],
["#FdNone+代理人5",#AgentTlrno5,#AgentTlrnoNa5],
["#FdBegin+開始日期",#BeginDate," 開始時間",#BeginTimeh,#BeginTimem],
["#FdEnd+結束日期",#EndDate," 結束時間",#EndTimeh,#EndTimem],
["#FdNone+設定狀態",#Status,#StatusX],
]
!---------- AP Button AREA ----------

!---------- AP TEXT AREA Variables ----------
<include src="HELPRIM.icf::HELPRIM.rtn"/>

#tlrnoH=x,1000,S
T(3,Teller)
S(XXR99,01,#tlrnoH)
R(1,XXR99)
CALL(#HelpProc)
T(2,#HelpDesc1)

#CHAIN=A,1,S
T(4,CHAIN$)

!日曆日
#CDATE=D,8,S
T(4,CDATE$)
#CDATEX=D,7,S
T(1,#CDATE,2,7)

#FdFunCode=X,2,L
T(3,*)

#FdNone=X,2,L
T(3, )

#FunCode=A,1,I
HELP(#Help)
@V(H,#Help)


#FunCodeX=X,10,L
T(H,#FunCode,#Help)
!C(3,#FunCode,3,K(NOBUTTON,CLOSEY),$)


#FdBegin=X,2,L
C(3,#FunCode,1,T(3,*),T(3, ))
C(5,#FdBegin,*,T(F,@BeginDate,1),T(F,@BeginDate,0))
C(5,#FdBegin,*,T(F,@BeginTimeh,1)T(F,@BeginTimem,1),T(F,@BeginTimeh,0)T(F,@BeginTimem,0))

#FdEnd=X,2,L
C(3,#FunCode,1,T(3,*),T(3, ))
C(5,#FdEnd,*,T(F,@EndDate,1),T(F,@EndDate,0))
C(5,#FdEnd,*,T(F,@EndTimeh,1)T(F,@EndTimem,1),T(F,@EndTimeh,0)T(F,@EndTimem,0))

#FdAgent=X,1,S
C(3,#FunCode,1,T(F,@AgentTlrno1,1),T(F,@AgentTlrno1,0))
C(3,#FunCode,1,T(F,@AgentTlrno2,1),T(F,@AgentTlrno2,0))
C(3,#FunCode,1,T(F,@AgentTlrno3,1),T(F,@AgentTlrno3,0))
C(3,#FunCode,1,T(F,@AgentTlrno4,1),T(F,@AgentTlrno4,0))
C(3,#FunCode,1,T(F,@AgentTlrno5,1),T(F,@AgentTlrno5,0))

#R1=x,1,S
RESET_RIM(#R1,L6R30)
S(L6R30,01,#TLRNO)
R(1,L6R30)
T(H,@AgentTlrnoNa1,#AgentTlrno1,#tlrnoH)
T(H,@AgentTlrnoNa2,#AgentTlrno2,#tlrnoH)
T(H,@AgentTlrnoNa3,#AgentTlrno3,#tlrnoH)
T(H,@AgentTlrnoNa4,#AgentTlrno4,#tlrnoH)
T(H,@AgentTlrnoNa5,#AgentTlrno5,#tlrnoH)
C(3,#FunCode,1,$,s)
T(1,@BeginTimeh,#BeginTime,1,2)
T(1,@BeginTimem,#BeginTime,3,2)
T(1,@EndTimeh,#EndTime,1,2)
T(1,@EndTimem,#EndTime,3,2)

#Status=A,1,L
C(2,#FunCode,$,T(3,1),T(3,0),$)

#StatusX=X,6,L
T(H,#Status,#Help2)

#AgentTlrno1=X,6,I
C(3,#FunCode,1,$,s)
HELP(#tlrnoH,cols:3)
@
V(7)
V(4,#TLRNO)
V(H,#tlrnoH)

#AgentTlrnoNa1=X,20,L
C(4,#AgentTlrno1,S,$)
T(H,#AgentTlrno1,#tlrnoH)

#AgentTlrno2=X,6,I
C(3,#FunCode,1,$,s)
C(4,#AgentTlrno1,s,$)
HELP(#tlrnoH,cols:3)
@
C(4,#AgentTlrno2,S,$)
V(4,#TLRNO)
V(H,#tlrnoH)
IF (#AgentTlrno2==#AgentTlrno1,V(P,和代理人1重複),$) 

#AgentTlrnoNa2=X,20,L
C(4,#AgentTlrno2,S,$)
T(H,#AgentTlrno2,#tlrnoH)

#AgentTlrno3=X,6,I
C(3,#FunCode,1,$,s)
C(4,#AgentTlrno2,s,$)
HELP(#tlrnoH,cols:3)
@
C(4,#AgentTlrno3,S,$)
V(4,#TLRNO)
V(H,#tlrnoH)
IF (#AgentTlrno3==#AgentTlrno1,V(P,和代理人1重複),$) 
IF (#AgentTlrno3==#AgentTlrno2,V(P,和代理人2重複),$) 

#AgentTlrnoNa3=X,20,L
C(4,#AgentTlrno3,S,$)
T(H,#AgentTlrno3,#tlrnoH)

#AgentTlrno4=X,6,I
C(3,#FunCode,1,$,s)
C(4,#AgentTlrno3,s,$)
HELP(#tlrnoH,cols:3)
@
C(4,#AgentTlrno4,S,$)
V(4,#TLRNO)
V(H,#tlrnoH)
IF (#AgentTlrno4==#AgentTlrno1,V(P,和代理人1重複),$) 
IF (#AgentTlrno4==#AgentTlrno2,V(P,和代理人2重複),$) 
IF (#AgentTlrno4==#AgentTlrno3,V(P,和代理人3重複),$) 

#AgentTlrnoNa4=X,20,L
C(4,#AgentTlrno4,S,$)
T(H,#AgentTlrno4,#tlrnoH)

#AgentTlrno5=X,6,I
C(3,#FunCode,1,$,s)
C(4,#AgentTlrno4,s,$)
HELP(#tlrnoH,cols:3)
@
C(4,#AgentTlrno5,S,$)
V(4,#TLRNO)
V(H,#tlrnoH)
IF (#AgentTlrno5==#AgentTlrno1,V(P,和代理人1重複),$) 
IF (#AgentTlrno5==#AgentTlrno2,V(P,和代理人2重複),$) 
IF (#AgentTlrno5==#AgentTlrno3,V(P,和代理人3重複),$) 
IF (#AgentTlrno5==#AgentTlrno4,V(P,和代理人3重複),$) 

#AgentTlrnoNa5=X,20,L
C(4,#AgentTlrno5,S,$)
T(H,#AgentTlrno5,#tlrnoH)

#BeginDate=D,7,I
C(3,#FunCode,1,$,s)
@V(7)A(DATE,0,#BeginDate)
IF(#BeginDate<#CDATEX,V(P,開始日期不可小於日曆日),$)

#BeginTime=A,4,S

#BeginTimeh=A,2,I
T(1,#BeginTime,1,2)
C(3,#FunCode,1,$,s)
@
C(3,#BeginTimeh,0,$,V(5,1,23))


#BeginTimem=A,2,I
T(1,#BeginTime,3,2)
C(3,#FunCode,1,$,s)
@
C(3,#BeginTimem,0,$,V(5,0,59))
T(2,@BeginTime,#BeginTimeh+#BeginTimem)



#EndDate=D,7,I
C(3,#FunCode,1,$,s)
@V(7)A(DATE,0,#EndDate)
V(5,#BeginDate,9991231)
C(3,#BeginTimeh,24,C(3,#BeginDate,#EndDate,V(P,結束日期不可等於開始日期),$),$)
IF(#EndDate<#BeginDate,V(P,結束日期不可小於開始日期),$)

#EndTime=A,4,S

#EndTimeh=A,2,I
T(1,#EndTime,1,2)
C(3,#FunCode,1,$,s)
@
V(5,0,23)
C(3,#BeginDate,#EndDate,V(5,#BeginTimeh,23),$)

#EndTimem=A,2,I
T(1,#EndTime,3,2)
C(3,#FunCode,1,$,s)
@
C(3,#EndTimem,0,$,V(5,0,59))
C(3,#BeginDate,#EndDate,V(5,#BeginTimem,59),$)
T(2,@EndTime,#EndTimeh+#EndTimem)




</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!---------- TXFORM = L6104 ----------
<sub type="FORM" name="L6104">

#SCRPRT=_,_,S
C(5,#TXFORM,L6104,$,S)

#SCRTIL=_,_,S
T(3,[L6104] 代理人設定)


</sub>


!------ 上行電文 ------
<sub type="TIM">
#FunCode
#AgentTlrno1
#AgentTlrno2
#AgentTlrno3
#AgentTlrno4
#AgentTlrno5
#BeginDate
#BeginTime
#EndDate
#EndTime
#Status
#END
</sub>

!------ 下行電文TOM ------
<sub type="TOM">
<include src="COM.icf::TRCTL.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>

TXFORM=L6104
^

TXFORM=L6R30
#AgentTlrno1
#AgentTlrno2
#AgentTlrno3
#AgentTlrno4
#AgentTlrno5
#BeginDate
#BeginTime
#EndDate
#EndTime
#Status
^

</sub>


!---------- 單據輸出組合 ----------
<sub type="SELECT">
<include src="PRT.icf::UPD01.sel"/>
<include src="PRT.icf::UPDH01.sel"/>
</sub>
