----- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">

#TXCD
T(3,L6709)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD2.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[170,830];printer.width=[20,20];">
[
["[L6709]                                 帳冊別目標金額維護"],
["#FdFuncCode+功能",#FuncCodeX],
["#FdAcBookCode+帳冊別",#AcBookCode,#AcBookItem],
["#FdAcSubBookCode+區隔帳冊",#AcSubBookCode],
["#FdAcSubBookItem+區隔帳冊名稱",#AcSubBookItem],
["#FdCurrencyCode+放款目標金額幣別",#CurrencyCode],
["#FdTargetAmt+放款目標金額",#TargetAmt],
["#FdAssignSeq+分配順序",#AssignSeq],
["#FdAcctSource+資金來源",#AcctSource],
["#FdAdjDate+帳務調整日",#AdjDate],
]
!---------- AP Button AREA ----------
![Buttom資料查詢]
! #BTN_SELECT_ALL=X,15,I,ui:button;value:查詢;enable:0;tabbable:0;title:LXXXX

#FdFuncCode=X,2,L
#FdAcBookCode=X,2,L
#FdAcSubBookCode=X,2,L
#FdAcSubBookItem=X,2,L
#FdCurrencyCode=X,2,L
#FdTargetAmt=X,2,L
#FdAssignSeq=X,2,L
#FdAcctSource=X,2,L
#FdAdjDate=X,2,L

!---------- AP TEXT AREA Variables ----------
<include src="HELPRIM.icf::HELPRIM.rtn"/>

!FuncCode2(1:新增;2:修改;4:刪除)
#CODEFuncCode2=x,20,S                  
T(3,CdCode.FuncCode2)                  
#FuncCode2Help=x,50,S 

!帳冊別
#CODEAcBookCode=x,20,S
T(3,CdCode.AcBookCode)
#ApHelp=x,1024,S

#SubBookHelp=x,1024,S
T(3,CdCode.AcSubBookCode)
#AcSubBookCodeHelp=x,1024,S

#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#CODEFuncCode2,#CODEAcBookCode,#SubBookHelp)
R(1,XXR99)
CALL(#HelpProc)
T(2,@FuncCode2Help,#HelpDesc1)
T(2,@ApHelp,#HelpDesc2)
T(2,@AcSubBookCodeHelp,#HelpDesc3)

#CHAIN=A,1,S
T(4,CHAIN$)
T(2,@RimTxCode,#TXCD)
IF(#CHAIN!=1,V(P,此為連動交易，請從交易:L6079進入),$)

#NTXBUF=X,78,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)

#CHAIN_FuncCode=X,1,S
T(1,#NTXBUF,1,1)

#CHAIN_AcSubBookCode=X,3,S
T(1,#NTXBUF,2,3)

#CHAIN_AcSubBookItem=X,40,S
T(1,#NTXBUF,5,40)

#CHAIN_CurrencyCode=X,3,S
T(1,#NTXBUF,45,3)

#CHAIN_TargetAmt=m,14,S
T(1,#NTXBUF,48,14)

#CHAIN_ActualAmt=m,14,S
T(1,#NTXBUF,62,14)

#CHAIN_AssignSeq=n,2,S
T(1,#NTXBUF,76,2)

#CHAIN_AcctSource=X,1,S
T(1,#NTXBUF,78,1)

C(3,#CHAIN,1,T(2,@FuncCode,#CHAIN_FuncCode),)
C(3,#CHAIN,1,T(2,@AcSubBookCode,#CHAIN_AcSubBookCode),)
C(3,#CHAIN,1,T(2,@AcSubBookItem,#CHAIN_AcSubBookItem),)
C(3,#CHAIN,1,T(2,@CurrencyCode,#CHAIN_CurrencyCode),)
C(3,#CHAIN,1,E(0,@TargetAmt,#CHAIN_TargetAmt),)
C(3,#CHAIN,1,E(0,@AssignSeq,#CHAIN_AssignSeq),)
C(3,#CHAIN,1,T(2,@AcctSource,#CHAIN_AcctSource),)

! 下營業日
#NBSDY=D,8,S
T(4,NBSDY$)
E(0,@AdjDate,#NBSDY)

! 功能
#FuncCode=A,1,S
T(F,@FuncCode,0)
C(3,#CHAIN,1,s,$)
HELP(#FuncCode2Help)
@V(H,#FuncCode2Help)

#FuncCodeX=X,12,L
T(H,#FuncCode,#FuncCode2Help)
C(2,#FuncCode,$,K(MODIFYBUTTON,新增),K(MODIFYBUTTON,修改),$,K(MODIFYBUTTON,刪除))

#FUNCIND=_,_,S
E(0,#FuncCode)
<include src="COM.icf::CheckAuth.rtn"/>

!FuncCode=1,2 顯示框線
#WKTF=X,1,S
IF (#FuncCode==1 || #FuncCode==2 ,T(F,@TargetAmt,1)T(F,@AssignSeq,1)T(F,@AcctSource,1),
                                  T(F,@TargetAmt,0)T(F,@AssignSeq,0)T(F,@AcctSource,0))
                                  
#WKPSC=X,2,S

#WKSTAR1=X,2,S
C(2,#FuncCode,S,T(3,*),S,S,S,S)

#WKSTAR2=X,2,S
C(2,#FuncCode,S,T(3,*),T(3,*),S,S,S)

#WKNAME=X,1,S
T(2,@FdAcSubBookCode,#WKSTAR1)
T(2,@FdAcSubBookItem,#WKSTAR1)
!T(2,@FdTargetAmt,#WKSTAR2)
T(2,@FdAssignSeq,#WKSTAR2)
T(2,@FdAcctSource,#WKSTAR2)

! 帳冊別
#AcBookCode=X,3,L
T(3,000)

#AcBookItem=x,20,L
T(3,全帳冊)

!區隔帳冊
#AcSubBookCode=X,3,I
T(F,@AcSubBookCode,0)
C(3,#CHAIN,1,C(3,#FuncCode,1,$,s),$)
HELP(#AcSubBookCodeHelp)
@C(3,#FuncCode,1,$,V(H,#AcSubBookCodeHelp))
V(7)V(NL)

#AcSubBookItem=X,20,I
T(F,@AcSubBookItem,0)
C(3,#CHAIN,1,C(3,#FuncCode,1,$,s),$)
T(H,#AcSubBookCode,#AcSubBookCodeHelp)
@V(7)

#SendL6R26=X,1,S
E(0,@RimFuncCode,#FuncCode)
T(2,@RimAcBookCode,#AcBookCode)
T(2,@RimAcSubBookCode,#AcSubBookCode)
RESET_RIM(#SendL6R26,L6R26)
S(L6R26,1,#RimFuncCode,#RimTxCode,#RimAcBookCode,#RimAcSubBookCode)
R(1,L6R26)

! 放款目標金額幣別
#CurrencyCode=X,3,L
T(3,TWD)
@V(7)

! 放款目標金額
#TargetAmt=m,14,I
C(3,#FuncCode,4,s)
!@V(2,0)

! 分配順序
#AssignSeq=n,2,I
C(3,#FuncCode,4,s)
@V(2,0)

! 資金來源
#AcctSource=X,1,I
C(3,#FuncCode,4,s)
@V(7)

! 帳務調整日
! 下營業日
#AdjDate=D,7,L

#AGAIN=X,1,S
IF(#FuncCode==4 || #FuncCode==2,$,S)
E(0,1)ASGN(AGAIN$)

#RPTFG=A,1,S
E(0,0)

<include src="ROM.icf::L0Rim.dec"/>
<include src="ROM.icf::L6R26Rim.dec"/>
<include src="ROM.icf::L6R26.dec"/>

</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!---------- TXFORM = L6709 ----------
<sub type="FORM" name="L6709">

#SCRPRT=_,_,S
C(5,#TXFORM,L6709,$,S)

#SCRTIL=_,_,S
T(3,[L6709] 帳冊別目標金額維護)

</sub>


!------ 上行電文 ------
<sub type="TIM">
#FuncCode
#AcBookCode
#AcSubBookCode
#AcBookItem
#AcSubBookItem
#CurrencyCode
#TargetAmt
#AssignSeq
#AcctSource
#AdjDate
#END
</sub>


!------ 下行電文TOM ------
<sub type="TOM">
TXFORM=L6709^
<include src="COM.icf::TRCTL.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
<include src="ROM.icf::L6R26.tom"/>

</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">
<include src="PRT.icf::UPD01.sel"/>
</sub>

