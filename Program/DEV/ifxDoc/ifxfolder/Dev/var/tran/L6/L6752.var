----- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">

![一段式/二段式/三段式]
!#RELCD=_,_,S
!E(0,1)

!#ACTFG=_,_,S
!E(0,1)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD2.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
</sub>

!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[150,850];printer.width=[20,30];">
[
["[L6752]                                 放款業績工作月維護"],
["#R1+@功能",#FuncCodeX],
["#R2+@業績年度",#Year],
["@","#R3+開始日期","@@@","#R4+終止日期","@@@@@@@@","#R5+獎金發放日"],
["@第01工作月",#StartDate1,"@~@",#EndDate1,"@@@@@",#BonusDate1],
["@第02工作月",#StartDate2,"@~@",#EndDate2,"@@@@@",#BonusDate2],
["@第03工作月",#StartDate3,"@~@",#EndDate3,"@@@@@",#BonusDate3],
["@第04工作月",#StartDate4,"@~@",#EndDate4,"@@@@@",#BonusDate4],
["@第05工作月",#StartDate5,"@~@",#EndDate5,"@@@@@",#BonusDate5],
["@第06工作月",#StartDate6,"@~@",#EndDate6,"@@@@@",#BonusDate6],
["@第07工作月",#StartDate7,"@~@",#EndDate7,"@@@@@",#BonusDate7],
["@第08工作月",#StartDate8,"@~@",#EndDate8,"@@@@@",#BonusDate8],
["@第09工作月",#StartDate9,"@~@",#EndDate9,"@@@@@",#BonusDate9],
["@第10工作月",#StartDate10,"@~@",#EndDate10,"@@@@@",#BonusDate10],
["@第11工作月",#StartDate11,"@~@",#EndDate11,"@@@@@",#BonusDate11],
["@第12工作月",#StartDate12,"@~@",#EndDate12,"@@@@@",#BonusDate12],
["@第13工作月",#StartDate13,"@~@",#EndDate13,"@@@@@",#BonusDate13],
]
!---------- AP Button AREA ----------
![Buttom資料查詢]

! 必輸欄位
##loop{times:4,i:1}
#R{i}=X,1,L
INVOKEJS(SHOW,#R{i},0)
##end

! 永遠為必輸欄位
#ALWAYS_HIGHLIGHT=@,1,S
T(3,@R2,*)
T(3,@R3,*)
T(3,@R4,*)
T(3,@R5,*)

#ALWAYS_HIGHLIGHT1=@,1,S
T(3,@R3,*)
T(3,@R4,*)
T(3,@R5,*)

#R5=X,2,L

!---------- AP TEXT AREA Variables ----------
<include src="HELPRIM.icf::HELPRIM.rtn"/>

!FuncCode2(1:新增;2:修改;4:刪除)
#CODEFuncCode2=x,20,S                  
T(3,CdCode.FuncCode1)                  
#FuncCode2Help=x,50,S

#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#CODEFuncCode2)
R(1,XXR99)
CALL(#HelpProc)
T(2,@FuncCode2Help,#HelpDesc1)


#CHAIN=X,1,S
T(4,CHAIN$)
T(2,@RimTxCode,#TXCD)
IF(#CHAIN!=1,V(P,此為連動交易，請從交易:[L6082 放款業績工作月查詢]進入),$)

#NTXBUF=X,4,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)

#CHAIN_FuncCode=X,1,S
T(1,#NTXBUF,1,1)

#CHAIN_Year=X,3,S
T(1,#NTXBUF,2,3)

#CHAINSET=X,1,S
C(3,#CHAIN,1,$,S)
T(2,@FuncCode,#CHAIN_FuncCode)
C(3,#FuncCode,1,S,$)
T(2,@Year,#CHAIN_Year)


! 功能 必須輸入(1: 新增;2: 修改;4: 刪除)
#FuncCode=A,1,S
T(F,@FuncCode,0)
C(3,#CHAIN,1,s,$)
HELP(#FuncCode2Help)
@V(H,#FuncCode2Help)

#FuncCodeX=X,12,L
T(H,#FuncCode,#FuncCode2Help)
C(2,#FuncCode,$,K(MODIFYBUTTON,新增),K(MODIFYBUTTON,修改),$,K(MODIFYBUTTON,刪除),K(NOBUTTON,CLOSEY))

#FUNCIND=_,_,S
E(0,#FuncCode)
<include src="COM.icf::CheckAuth.rtn"/>

!FuncCode=1,2 顯示框線
#WKTF=X,1,S
##loop{times:13,i:1}
IF (#FuncCode==1 || #FuncCode==2 ,T(F,@StartDate{i},1)T(F,@EndDate{i},1)T(F,@BonusDate{i},1),
                                  T(F,@StartDate{i},0)T(F,@EndDate{i},0)T(F,@BonusDate{i},0))
##end
IF (#FuncCode==1 ,T(F,@Year,1),T(F,@Year,0))
    
#WKTF1=X,1,S
##loop{times:13,i:2}
IF (#FuncCode==1 || #FuncCode==2 ,T(F,@StartDate{i},0),$)
##end
              
#INIT=X,1,S
C(2,#FuncCode,S,CALL(#ALWAYS_HIGHLIGHT),CALL(#ALWAYS_HIGHLIGHT1),S,S,S)

!日歷日
#CDate=D,8,S
T(4,CDATE$)
#Date=A,3,S
T(1,#CDate,2,3)

#Check=X,1,S
C(3,#FuncCode,4,$,s)
IF(#Year<=#Date,V(P,業績年度<=日曆日時不可刪除),$)

! 業績年度
#Year=A,3,I
C(3,#CHAIN,1,C(3,#FuncCode,1,$,s),$)
C(2,#FuncCode,$,$,$,$,s,s)
@V(2,0)

#SendL6R19=X,1,S
E(0,@RimFuncCode,#FuncCode)
E(0,@RimYear,#Year)
RESET_RIM(#SendL6R19,L6R19)
S(L6R19,1,#RimFuncCode,#RimTxCode,#RimYear)
R(1,L6R19)

#RecL6R19=X,1,S
C(3,#FuncCode,1,S,$)
##loop{times:13,i:1}
T(2,@StartDate{i},#L6R19StartDate{i})
T(2,@EndDate{i},#L6R19EndDate{i})
T(2,@BonusDate{i},#L6R19BonusDate{i})
##end

! 組出第01工作月開始日期的預設值
#DT=A,4,S
E(0,0101)

! 第01工作月
#DEFAULT_ST_1=D,8,S
C(3,#FuncCode,1,T(2,0+#Year+#DT),T(2,0+#L6R19StartDate1))

#Month1=N,2,S
E(0,1)

#StartDate1=D,7,I
E(0,#DEFAULT_ST_1)
C(2,#FuncCode,$,$,$,$,s,s)
D(8)
@V(2,0)V(7)A(4,0,#StartDate1)


#DEFAULT_ED_1=D,8,S
C(3,#FuncCode,1,D(7,2,#StartDate1,0,27),T(2,0+#L6R19EndDate1))
C(3,#FuncCode,2,D(7,2,#StartDate1,0,27),$)

#EndDate1=D,7,I
C(3,#L6R19EndDate1,0,E(0,#DEFAULT_ED_1),$)
C(2,#FuncCode,$,$,$,$,s,s)
D(8)
@V(2,0)V(7)A(4,0,#EndDate1)V(5,#StartDate1,9991231)

#EndDateN1=D,8,S
D(7,2,#EndDate1,0,1)


#BonusDate1=D,7,I
E(0,#EndDate1)
C(2,#FuncCode,$,$,$,$,s,s)
D(8)
@V(2,0)V(7)A(4,0,#BonusDate1)V(5,#EndDate1,9991231)

##loop{times:12,i:2,j:1}

! 第 i 工作月
#DEFAULT_ST_{i}=D,8,L
!C(3,#FuncCode,1,D(7,2,#EndDate{j},0,1),T(2,0+#L6R19StartDate{i}))
D(7,2,#EndDate{j},0,1)

#Month{i}=N,2,S
E(0,{i})

#StartDate{i}=D,7,I
E(0,#DEFAULT_ST_{i})
C(2,#FuncCode,$,s,s,s,s,s)
!D(8)
!@V(2,0)V(7)A(4,0,#StartDate{i})V(5,#EndDateN{j},9991231)

#DEFAULT_ED_{i}=D,8,S
C(3,#FuncCode,1,D(7,2,#StartDate{i},0,27),T(2,0+#L6R19EndDate{i}))
C(3,#FuncCode,2,D(7,2,#StartDate{i},0,27),$)

#EndDate{i}=D,7,I
C(3,#L6R19EndDate{i},0,E(0,#DEFAULT_ED_{i}),$)
C(2,#FuncCode,$,$,$,$,s,s)
D(8)
@V(2,0)V(7)A(4,0,#EndDate{i})V(5,#StartDate{i},9991231)

#EndDateN{i}=D,8,S
D(7,2,#EndDate{i},0,1)

#BonusDate{i}=D,7,I
E(0,#EndDate{i})
C(2,#FuncCode,$,$,$,$,s,s)
D(8)
@V(2,0)V(7)A(4,0,#BonusDate{i})V(5,#EndDate{i},9991231)

##end


#RPTFG=A,1,S
E(0,0)

#AGAIN=X,1,S
IF(#FuncCode==4 || #FuncCode==2,$,S)
E(0,1)ASGN(AGAIN$)

!參考編號
#MRKEY=_,_,S
T(2,#Year)


<include src="ROM.icf::L0Rim.dec"/>
<include src="ROM.icf::L6R19Rim.dec"/>
<include src="ROM.icf::L6R19.dec"/>
</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!---------- TXFORM = L6752 ----------
<sub type="FORM" name="L6752">

!#SCRPRT=_,_,S
!C(5,#TXFORM,L6752,$,S)

#SCRTIL=_,_,S
T(3,[L6752] 放款業績工作月維護)

!------ TOM(HEAD)   Variables (FOR OUTPUT SCREEN) ------

!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------

#LOOP=X,1,S
T(3,1)ASGN(LOOP$)

</sub>

!------ 上行電文 ------
<sub type="TIM">
#FuncCode
#Year
##loop{times:13,i:1}
#Month{i}
#StartDate{i}
#EndDate{i}
#BonusDate{i}
##end
#END
</sub>

!------ 下行電文TOM ------
<sub type="TOM">
TXFORM=L6752
^

<include src="COM.icf::TRCTL.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
<include src="ROM.icf::L6R19.tom"/>
</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">
<include src="PRT.icf::UPD01.sel"/>
</sub>
