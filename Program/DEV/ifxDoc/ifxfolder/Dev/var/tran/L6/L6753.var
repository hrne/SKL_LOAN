----- BASIC LABEL Variables ----------
<sub type="SYS">
</sub>

<sub type="SYS" name="label">

![一段式/二段式/三段式]
!#RELCD=_,_,S
!E(0,1)

!#ACTFG=_,_,S
!E(0,1)

</sub>

<sub type="DC" name="BFHEAD">
<include src="COM.icf::BFHEAD2.dec"/>
!起始交易記號  0:起始交易,1:非起始交易
#ORGFG=_,_,S
E(0,0)
</sub>


!---------- 交易畫面及個別交易變數宣告 ----------
<sub type="DC" name="p1" layout="cols=1;screen.width=[130,870];printer.width=[20,20];">
[
["[L6753]                                 房貸專員所屬業務部室維護"],
["@功能",#FuncCodeX],
["#grid#,{id:1,expand:true,loop:20,row_height:1,s_cols:[], p_cols:[]}","","","","",
["員工編號","員工姓名","部室代號","部室名稱"],
[
  [#EmployeeNo1],[#Fullname1],[#DeptCode1,#DeptCodeBTN1],[#DeptItem1]
],
],
]
!---------- AP Button AREA ----------
![Buttom資料查詢]
!#BTN1=X,15,I,ui:button;value:瀏覽;enable:0;tabbable:0
!#BTN2=X,15,I,ui:button;value:瀏覽;enable:0;tabbable:0
!#BTN3=X,15,I,ui:button;value:瀏覽;enable:0;tabbable:0
#BUF1=X,42,S
!ENABLE(#BTN1)
!ENABLE(#BTN2)
!ENABLE(#BTN3)
!---------- AP TEXT AREA Variables ----------
#INIT=X,1,S
INVOKEJS(SHOW,grd1_4,0)
INVOKEJS(SHOW,grd1_5,0)
INVOKEJS(SHOW,grd1_6,0)
INVOKEJS(SHOW,grd1_7,0)
INVOKEJS(SHOW,grd1_8,0)
INVOKEJS(SHOW,grd1_9,0)
INVOKEJS(SHOW,grd1_10,0)
INVOKEJS(SHOW,grd1_11,0)
INVOKEJS(SHOW,grd1_12,0)
INVOKEJS(SHOW,grd1_13,0)
INVOKEJS(SHOW,grd1_14,0)
INVOKEJS(SHOW,grd1_15,0)
INVOKEJS(SHOW,grd1_16,0)
INVOKEJS(SHOW,grd1_17,0)
INVOKEJS(SHOW,grd1_18,0)
INVOKEJS(SHOW,grd1_19,0)
INVOKEJS(SHOW,grd1_20,0)
INVOKEJS(SHOW,grd1_21,0)
INVOKEJS(SHOW,grd1_22,0)

<include src="HELPRIM.icf::HELPRIM.rtn"/>

!FuncCode2(1:新增;2:修改;4:刪除)
#CODEFuncCode2=x,20,S                  
T(3,CdCode.FuncCode2)                  
#FuncCode2Help=x,50,S

#HelpRim=X,1,S
RESET_RIM(#HelpRim,XXR99)
S(XXR99,01,#CODEFuncCode2)
R(1,XXR99)
CALL(#HelpProc)
T(2,@FuncCode2Help,#HelpDesc1)

#CHAIN=X,1,S
T(4,CHAIN$)
T(2,@RimTxCode,#TXCD)
IF(#CHAIN!=1,V(P,此為連動交易，請從交易:[L6083 房貸專員所屬業務部室]進入),$)

#NTXBUF=X,93,S
C(3,#CHAIN,1,T(4,NTXBUF$),S)

#CHAIN_FuncCode=X,1,S
T(1,#NTXBUF,1,1)

#CHAIN_EmployeeNo=X,6,S
T(1,#NTXBUF,2,6)

#CHAIN_Fullname=X,40,S
T(1,#NTXBUF,8,40)

#CHAIN_DeptCode=X,6,S
T(1,#NTXBUF,48,6)

#CHAIN_DeptItem=X,40,S
T(1,#NTXBUF,54,40)

#CHAINSET=X,1,S
C(3,#CHAIN,1,$,S)
T(2,@FuncCode,#CHAIN_FuncCode)
C(3,#FuncCode,1,S,$)
T(2,@EmployeeNo1,#CHAIN_EmployeeNo)
T(2,@Fullname1,#CHAIN_Fullname)
T(2,@DeptCode1,#CHAIN_DeptCode)
T(2,@DeptItem1,#CHAIN_DeptItem)

! 功能 必須輸入(1: 新增;2: 修改;4: 刪除)
#FuncCode=A,1,S
T(F,@FuncCode,0)
C(3,#CHAIN,1,s,$)
HELP(#FuncCode2Help)
@V(H,#FuncCode2Help)

#FuncCodeX=X,12,L
T(H,#FuncCode,#FuncCode2Help)
C(2,#FuncCode,$,K(MODIFYBUTTON,新增),K(MODIFYBUTTON,修改),$,K(MODIFYBUTTON,刪除))
IF(#FuncCode==4,HIDE(#DeptCodeBTN1),SHOW(#DeptCodeBTN1))

#AGAIN=X,1,S
IF(#FuncCode==2 || #FuncCode==4,$,S)
E(0,1)ASGN(AGAIN$)

#FUNCIND=_,_,S
E(0,#FuncCode)
<include src="COM.icf::CheckAuth.rtn"/>


! 員工編號
#EmployeeNo1=X,6,I
C(3,#CHAIN,1,C(3,#FuncCode,1,$,s),$)
C(2,#FuncCode,$,$,$,$,s,s)
@T(3,@Fullname1,)
V(7)

#SendL6R18=X,1,S
E(0,@RimFuncCode,#FuncCode)
T(2,@RimL6R18EmployeeNo,#EmployeeNo1)
RESET_RIM(#SendL6R18,L6R18)
S(L6R18,1,#RimFuncCode,#RimTxCode,#RimL6R18EmployeeNo)
R(1,L6R18)

#RecL6R18=X,1,S
T(2,@Fullname1,#L6R18Fullname)
T(2,@DeptCode1,#L6R18DeptCode)
T(2,@Fullname1,#L6R18Fullname)

! 員工姓名
#Fullname1=x,40,O
C(2,#FuncCode,$,$,$,$,s,s)

! 部室代號
#DeptCodeBTN1=X,1,I,ui:button;value:單位代號查詢;enable:1;tabbable:0
#DeptCodeBUF1=X,6,S
#DeptCodeBIND1=X,1,S
BIND(#DeptCodeBTN1,click, {cmd=CHAIN; ntxcd=L6086; ntxbuf=#DeptCodeBUF1;ntxbuf5=type<-1:DeptCode1<-OODeptCode:DeptItem1<-OODeptItem})

#DeptCode1=X,6,I
C(2,#FuncCode,$,$,$,$,s,s)
@V(7)

#RimChoose=X,1,S
#RimDeptCode=X,6,S

#SendL5R13=X,1,S
E(0,@RimChoose,2)
T(2,@RimDeptCode,#DeptCode1)
RESET_RIM(#SendL5R13,L5R13)
S(L5R13,1,#RimChoose,#RimDeptCode)
R(1,L5R13)

#RecL5R13=X,1,S
T(2,@DeptItem1,#L5R13DeptItem)

! 部室名稱
#DeptItem1=x,40,O
C(2,#FuncCode,$,$,$,$,s,s)

##loop{times:19,i:2,j:1,k:5,l:4}

! 員工編號
#EmployeeNo{i}=X,6,I
C(3,#FuncCode,1,$,C(3,#CHAIN,1,s,$))
C(4,#EmployeeNo{j},S,$)
C(4,#EmployeeNo{j},INVOKEJS(SHOW,grd1_{l},0),INVOKEJS(SHOW,grd1_{l},1))
C(2,#FuncCode,$,$,$,$,s,s)
@T(3,@Fullname{i},)



#RimL6R18{i}=X,1,S
C(4,#EmployeeNo{i},S,$)
E(0,@RimFuncCode,#FuncCode)
T(2,@RimL6R18EmployeeNo,#EmployeeNo{i})
RESET_RIM(#RimL6R18,L6R18)
S(L6R18,1,#RimFuncCode,#RimTxCode,#RimL6R18EmployeeNo)
R(1,L6R18)

#RecL6R18{i}=X,1,S
T(2,@Fullname{i},#L6R18Fullname)
T(2,@DeptCode{i},#L6R18DeptCode)
T(2,@Fullname{i},#L6R18Fullname)

! 員工姓名
#Fullname{i}=x,40,O
C(4,#EmployeeNo{i},S,$)
C(2,#FuncCode,$,$,$,$,s,s)

! 部室代號
#DeptCodeBTN{i}=X,1,I,ui:button;value:單位代號查詢;enable:1;tabbable:0
#DeptCodeBUF{i}=X,6,S
#DeptCodeBIND{i}=X,1,S
BIND(#DeptCodeBTN{i},click, {cmd=CHAIN; ntxcd=L6086; ntxbuf=#DeptCodeBUF{i};ntxbuf5=type<-1:DeptCode{i}<-OODeptCode:DeptItem{i}<-OODeptItem})

#DeptCode{i}=X,6,I
C(4,#EmployeeNo{i},S,$)
C(2,#FuncCode,$,$,$,$,s,s)
@T(3,@DeptItem{i},)
V(7)

#SendL5R13{i}=X,1,S
E(0,@RimChoose,2)
T(2,@RimDeptCode,#DeptCode{i})
RESET_RIM(#SendL5R13,L5R13)
S(L5R13,1,#RimChoose,#RimDeptCode)
R(1,L5R13)

#RecL5R13{i}=X,1,S
T(2,@DeptItem{i},#L5R13DeptItem)

! 部室名稱
#DeptItem{i}=x,40,O
C(4,#EmployeeNo{i},S,$)
C(2,#FuncCode,$,$,$,$,s,s)

#show{i}=X,1,S
C(4,#EmployeeNo{i},INVOKEJS(SHOW,grd1_{l},0),INVOKEJS(SHOW,grd1_{l},1))

##end

#RPTFG=A,1,S
E(0,0)

<include src="ROM.icf::L0Rim.dec"/>
<include src="ROM.icf::L6R18Rim.dec"/>
<include src="ROM.icf::L6R18.dec"/>
<include src="ROM.icf::L5R13.dec"/>
</sub>

!---------- 輸出共用變數宣告區 ----------
<sub type="RTN" name="AFXMT">
<include src="PRT.icf::PRTHEAD.rtn"/>
</sub>

!---------- TXFORM = L6753 ----------
<sub type="FORM" name="L6753">

!#SCRPRT=_,_,S
!C(5,#TXFORM,L6753,$,S)

#SCRTIL=_,_,S
T(3,[L6753] 房貸專員所屬業務部室維護)

!------ TOM(HEAD)   Variables (FOR OUTPUT SCREEN) ------
!------ TOM(OCCURS) Variables (FOR OUTPUT SCREEN) ------

#LOOP=X,1,S
T(3,1)ASGN(LOOP$)

</sub>

!------ 上行電文 ------
<sub type="TIM">
#FuncCode
##loop{times:20,i:1}
#EmployeeNo{i}
#DeptCode{i}
##end
#END
</sub>

!------ 下行電文TOM ------
<sub type="TOM">
TXFORM=L6753^

<include src="COM.icf::TRCTL.tom"/>
<include src="HELPRIM.icf::HELPRIM.tom"/>
<include src="ROM.icf::L6R18.tom"/>
<include src="ROM.icf::L5R13.tom"/>
</sub>

!---------- 單據輸出組合 ----------
<sub type="SELECT">
<include src="PRT.icf::UPD01.sel"/>
</sub>
